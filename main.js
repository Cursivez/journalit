/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository
*/

var A7=Object.create;var Xg=Object.defineProperty;var I7=Object.getOwnPropertyDescriptor;var N7=Object.getOwnPropertyNames;var L7=Object.getPrototypeOf,M7=Object.prototype.hasOwnProperty;var O7=(e,t,r)=>t in e?Xg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var te=(e,t)=>()=>(e&&(t=e(e=0)),t);var de=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Zs=(e,t)=>{for(var r in t)Xg(e,r,{get:t[r],enumerable:!0})},y2=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of N7(t))!M7.call(e,a)&&a!==r&&Xg(e,a,{get:()=>t[a],enumerable:!(n=I7(t,a))||n.enumerable});return e};var _=(e,t,r)=>(r=e!=null?A7(L7(e)):{},y2(t||!e||!e.__esModule?Xg(r,"default",{value:e,enumerable:!0}):r,e)),Wb=e=>y2(Xg({},"__esModule",{value:!0}),e);var Rp=(e,t,r)=>O7(e,typeof t!="symbol"?t+"":t,r);var I2=de(vt=>{"use strict";var Qg=Symbol.for("react.element"),F7=Symbol.for("react.portal"),j7=Symbol.for("react.fragment"),z7=Symbol.for("react.strict_mode"),_7=Symbol.for("react.profiler"),B7=Symbol.for("react.provider"),$7=Symbol.for("react.context"),R7=Symbol.for("react.forward_ref"),W7=Symbol.for("react.suspense"),U7=Symbol.for("react.memo"),q7=Symbol.for("react.lazy"),b2=Symbol.iterator;function H7(e){return e===null||typeof e!="object"?null:(e=b2&&e[b2]||e["@@iterator"],typeof e=="function"?e:null)}var S2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k2=Object.assign,C2={};function Wp(e,t,r){this.props=e,this.context=t,this.refs=C2,this.updater=r||S2}Wp.prototype.isReactComponent={};Wp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function T2(){}T2.prototype=Wp.prototype;function i1(e,t,r){this.props=e,this.context=t,this.refs=C2,this.updater=r||S2}var s1=i1.prototype=new T2;s1.constructor=i1;k2(s1,Wp.prototype);s1.isPureReactComponent=!0;var x2=Array.isArray,P2=Object.prototype.hasOwnProperty,l1={current:null},D2={key:!0,ref:!0,__self:!0,__source:!0};function E2(e,t,r){var n,a={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)P2.call(t,n)&&!D2.hasOwnProperty(n)&&(a[n]=t[n]);var s=arguments.length-2;if(s===1)a.children=r;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:Qg,type:e,key:o,ref:i,props:a,_owner:l1.current}}function V7(e,t){return{$$typeof:Qg,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function c1(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qg}function G7(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var w2=/\/+/g;function o1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?G7(""+e.key):t.toString(36)}function qb(e,t,r,n,a){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Qg:case F7:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+o1(i,0):n,x2(a)?(r="",e!=null&&(r=e.replace(w2,"$&/")+"/"),qb(a,t,r,"",function(c){return c})):a!=null&&(c1(a)&&(a=V7(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(w2,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",x2(e))for(var s=0;s<e.length;s++){o=e[s];var l=n+o1(o,s);i+=qb(o,t,r,l,a)}else if(l=H7(e),typeof l=="function")for(e=l.call(e),s=0;!(o=e.next()).done;)o=o.value,l=n+o1(o,s++),i+=qb(o,t,r,l,a);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Ub(e,t,r){if(e==null)return e;var n=[],a=0;return qb(e,n,"","",function(o){return t.call(r,o,a++)}),n}function Y7(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ha={current:null},Hb={transition:null},K7={ReactCurrentDispatcher:Ha,ReactCurrentBatchConfig:Hb,ReactCurrentOwner:l1};function A2(){throw Error("act(...) is not supported in production builds of React.")}vt.Children={map:Ub,forEach:function(e,t,r){Ub(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ub(e,function(){t++}),t},toArray:function(e){return Ub(e,function(t){return t})||[]},only:function(e){if(!c1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};vt.Component=Wp;vt.Fragment=j7;vt.Profiler=_7;vt.PureComponent=i1;vt.StrictMode=z7;vt.Suspense=W7;vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K7;vt.act=A2;vt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=k2({},e.props),a=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=l1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)P2.call(t,l)&&!D2.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];n.children=s}return{$$typeof:Qg,type:e.type,key:a,ref:o,props:n,_owner:i}};vt.createContext=function(e){return e={$$typeof:$7,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:B7,_context:e},e.Consumer=e};vt.createElement=E2;vt.createFactory=function(e){var t=E2.bind(null,e);return t.type=e,t};vt.createRef=function(){return{current:null}};vt.forwardRef=function(e){return{$$typeof:R7,render:e}};vt.isValidElement=c1;vt.lazy=function(e){return{$$typeof:q7,_payload:{_status:-1,_result:e},_init:Y7}};vt.memo=function(e,t){return{$$typeof:U7,type:e,compare:t===void 0?null:t}};vt.startTransition=function(e){var t=Hb.transition;Hb.transition={};try{e()}finally{Hb.transition=t}};vt.unstable_act=A2;vt.useCallback=function(e,t){return Ha.current.useCallback(e,t)};vt.useContext=function(e){return Ha.current.useContext(e)};vt.useDebugValue=function(){};vt.useDeferredValue=function(e){return Ha.current.useDeferredValue(e)};vt.useEffect=function(e,t){return Ha.current.useEffect(e,t)};vt.useId=function(){return Ha.current.useId()};vt.useImperativeHandle=function(e,t,r){return Ha.current.useImperativeHandle(e,t,r)};vt.useInsertionEffect=function(e,t){return Ha.current.useInsertionEffect(e,t)};vt.useLayoutEffect=function(e,t){return Ha.current.useLayoutEffect(e,t)};vt.useMemo=function(e,t){return Ha.current.useMemo(e,t)};vt.useReducer=function(e,t,r){return Ha.current.useReducer(e,t,r)};vt.useRef=function(e){return Ha.current.useRef(e)};vt.useState=function(e){return Ha.current.useState(e)};vt.useSyncExternalStore=function(e,t,r){return Ha.current.useSyncExternalStore(e,t,r)};vt.useTransition=function(){return Ha.current.useTransition()};vt.version="18.3.1"});var B=de((txe,N2)=>{"use strict";N2.exports=I2()});var R2=de(cr=>{"use strict";function m1(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(0<Vb(a,t))e[n]=t,e[r]=a,r=n;else break e}}function ms(e){return e.length===0?null:e[0]}function Yb(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,o=a>>>1;n<o;){var i=2*(n+1)-1,s=e[i],l=i+1,c=e[l];if(0>Vb(s,r))l<a&&0>Vb(c,s)?(e[n]=c,e[l]=r,n=l):(e[n]=s,e[i]=r,n=i);else if(l<a&&0>Vb(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function Vb(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(L2=performance,cr.unstable_now=function(){return L2.now()}):(d1=Date,M2=d1.now(),cr.unstable_now=function(){return d1.now()-M2});var L2,d1,M2,el=[],Oc=[],J7=1,Di=null,wa=3,Kb=!1,Qd=!1,eh=!1,j2=typeof setTimeout=="function"?setTimeout:null,z2=typeof clearTimeout=="function"?clearTimeout:null,O2=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f1(e){for(var t=ms(Oc);t!==null;){if(t.callback===null)Yb(Oc);else if(t.startTime<=e)Yb(Oc),t.sortIndex=t.expirationTime,m1(el,t);else break;t=ms(Oc)}}function g1(e){if(eh=!1,f1(e),!Qd)if(ms(el)!==null)Qd=!0,v1(h1);else{var t=ms(Oc);t!==null&&y1(g1,t.startTime-e)}}function h1(e,t){Qd=!1,eh&&(eh=!1,z2(th),th=-1),Kb=!0;var r=wa;try{for(f1(t),Di=ms(el);Di!==null&&(!(Di.expirationTime>t)||e&&!$2());){var n=Di.callback;if(typeof n=="function"){Di.callback=null,wa=Di.priorityLevel;var a=n(Di.expirationTime<=t);t=cr.unstable_now(),typeof a=="function"?Di.callback=a:Di===ms(el)&&Yb(el),f1(t)}else Yb(el);Di=ms(el)}if(Di!==null)var o=!0;else{var i=ms(Oc);i!==null&&y1(g1,i.startTime-t),o=!1}return o}finally{Di=null,wa=r,Kb=!1}}var Jb=!1,Gb=null,th=-1,_2=5,B2=-1;function $2(){return!(cr.unstable_now()-B2<_2)}function u1(){if(Gb!==null){var e=cr.unstable_now();B2=e;var t=!0;try{t=Gb(!0,e)}finally{t?Zg():(Jb=!1,Gb=null)}}else Jb=!1}var Zg;typeof O2=="function"?Zg=function(){O2(u1)}:typeof MessageChannel!="undefined"?(p1=new MessageChannel,F2=p1.port2,p1.port1.onmessage=u1,Zg=function(){F2.postMessage(null)}):Zg=function(){j2(u1,0)};var p1,F2;function v1(e){Gb=e,Jb||(Jb=!0,Zg())}function y1(e,t){th=j2(function(){e(cr.unstable_now())},t)}cr.unstable_IdlePriority=5;cr.unstable_ImmediatePriority=1;cr.unstable_LowPriority=4;cr.unstable_NormalPriority=3;cr.unstable_Profiling=null;cr.unstable_UserBlockingPriority=2;cr.unstable_cancelCallback=function(e){e.callback=null};cr.unstable_continueExecution=function(){Qd||Kb||(Qd=!0,v1(h1))};cr.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_2=0<e?Math.floor(1e3/e):5};cr.unstable_getCurrentPriorityLevel=function(){return wa};cr.unstable_getFirstCallbackNode=function(){return ms(el)};cr.unstable_next=function(e){switch(wa){case 1:case 2:case 3:var t=3;break;default:t=wa}var r=wa;wa=t;try{return e()}finally{wa=r}};cr.unstable_pauseExecution=function(){};cr.unstable_requestPaint=function(){};cr.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=wa;wa=e;try{return t()}finally{wa=r}};cr.unstable_scheduleCallback=function(e,t,r){var n=cr.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return a=r+a,e={id:J7++,callback:t,priorityLevel:e,startTime:r,expirationTime:a,sortIndex:-1},r>n?(e.sortIndex=r,m1(Oc,e),ms(el)===null&&e===ms(Oc)&&(eh?(z2(th),th=-1):eh=!0,y1(g1,r-n))):(e.sortIndex=a,m1(el,e),Qd||Kb||(Qd=!0,v1(h1))),e};cr.unstable_shouldYield=$2;cr.unstable_wrapCallback=function(e){var t=wa;return function(){var r=wa;wa=t;try{return e.apply(this,arguments)}finally{wa=r}}}});var U2=de((nxe,W2)=>{"use strict";W2.exports=R2()});var G_=de(ni=>{"use strict";var X7=B(),ti=U2();function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jj=new Set,kh={};function uu(e,t){cm(e,t),cm(e+"Capture",t)}function cm(e,t){for(kh[e]=t,e=0;e<t.length;e++)Jj.add(t[e])}var Ul=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),R1=Object.prototype.hasOwnProperty,Q7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q2={},H2={};function Z7(e){return R1.call(H2,e)?!0:R1.call(q2,e)?!1:Q7.test(e)?H2[e]=!0:(q2[e]=!0,!1)}function eJ(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tJ(e,t,r,n){if(t===null||typeof t=="undefined"||eJ(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ya(e,t,r,n,a,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var sa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sa[e]=new Ya(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sa[t]=new Ya(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sa[e]=new Ya(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sa[e]=new Ya(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sa[e]=new Ya(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sa[e]=new Ya(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sa[e]=new Ya(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sa[e]=new Ya(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sa[e]=new Ya(e,5,!1,e.toLowerCase(),null,!1,!1)});var MP=/[\-:]([a-z])/g;function OP(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(MP,OP);sa[t]=new Ya(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(MP,OP);sa[t]=new Ya(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(MP,OP);sa[t]=new Ya(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sa[e]=new Ya(e,1,!1,e.toLowerCase(),null,!1,!1)});sa.xlinkHref=new Ya("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sa[e]=new Ya(e,1,!1,e.toLowerCase(),null,!0,!0)});function FP(e,t,r,n){var a=sa.hasOwnProperty(t)?sa[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(tJ(t,r,a,n)&&(r=null),n||a===null?Z7(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Gl=X7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xb=Symbol.for("react.element"),Hp=Symbol.for("react.portal"),Vp=Symbol.for("react.fragment"),jP=Symbol.for("react.strict_mode"),W1=Symbol.for("react.profiler"),Xj=Symbol.for("react.provider"),Qj=Symbol.for("react.context"),zP=Symbol.for("react.forward_ref"),U1=Symbol.for("react.suspense"),q1=Symbol.for("react.suspense_list"),_P=Symbol.for("react.memo"),jc=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var Zj=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var V2=Symbol.iterator;function rh(e){return e===null||typeof e!="object"?null:(e=V2&&e[V2]||e["@@iterator"],typeof e=="function"?e:null)}var Br=Object.assign,b1;function dh(e){if(b1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);b1=t&&t[1]||""}return`
`+b1+e}var x1=!1;function w1(e,t){if(!e||x1)return"";x1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),o=n.stack.split(`
`),i=a.length-1,s=o.length-1;1<=i&&0<=s&&a[i]!==o[s];)s--;for(;1<=i&&0<=s;i--,s--)if(a[i]!==o[s]){if(i!==1||s!==1)do if(i--,s--,0>s||a[i]!==o[s]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=s);break}}}finally{x1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?dh(e):""}function rJ(e){switch(e.tag){case 5:return dh(e.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return e=w1(e.type,!1),e;case 11:return e=w1(e.type.render,!1),e;case 1:return e=w1(e.type,!0),e;default:return""}}function H1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vp:return"Fragment";case Hp:return"Portal";case W1:return"Profiler";case jP:return"StrictMode";case U1:return"Suspense";case q1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qj:return(e.displayName||"Context")+".Consumer";case Xj:return(e._context.displayName||"Context")+".Provider";case zP:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _P:return t=e.displayName||null,t!==null?t:H1(e.type)||"Memo";case jc:t=e._payload,e=e._init;try{return H1(e(t))}catch(r){}}return null}function nJ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H1(t);case 8:return t===jP?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Jc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ez(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function aJ(e){var t=ez(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Qb(e){e._valueTracker||(e._valueTracker=aJ(e))}function tz(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ez(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Px(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function V1(e,t){var r=t.checked;return Br({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function G2(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Jc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function rz(e,t){t=t.checked,t!=null&&FP(e,"checked",t,!1)}function G1(e,t){rz(e,t);var r=Jc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Y1(e,t.type,r):t.hasOwnProperty("defaultValue")&&Y1(e,t.type,Jc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Y2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Y1(e,t,r){(t!=="number"||Px(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var uh=Array.isArray;function nm(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Jc(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function K1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return Br({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function K2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(me(92));if(uh(r)){if(1<r.length)throw Error(me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Jc(r)}}function nz(e,t){var r=Jc(t.value),n=Jc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function J2(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function az(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?az(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zb,oz=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zb=Zb||document.createElement("div"),Zb.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ch(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var fh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oJ=["Webkit","ms","Moz","O"];Object.keys(fh).forEach(function(e){oJ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fh[t]=fh[e]})});function iz(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||fh.hasOwnProperty(e)&&fh[e]?(""+t).trim():t+"px"}function sz(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=iz(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var iJ=Br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function X1(e,t){if(t){if(iJ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function Q1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Z1=null;function BP(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var eP=null,am=null,om=null;function X2(e){if(e=Wh(e)){if(typeof eP!="function")throw Error(me(280));var t=e.stateNode;t&&(t=ew(t),eP(e.stateNode,e.type,t))}}function lz(e){am?om?om.push(e):om=[e]:am=e}function cz(){if(am){var e=am,t=om;if(om=am=null,X2(e),t)for(e=0;e<t.length;e++)X2(t[e])}}function dz(e,t){return e(t)}function uz(){}var S1=!1;function pz(e,t,r){if(S1)return e(t,r);S1=!0;try{return dz(e,t,r)}finally{S1=!1,(am!==null||om!==null)&&(uz(),cz())}}function Th(e,t){var r=e.stateNode;if(r===null)return null;var n=ew(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(me(231,t,typeof r));return r}var tP=!1;if(Ul)try{Up={},Object.defineProperty(Up,"passive",{get:function(){tP=!0}}),window.addEventListener("test",Up,Up),window.removeEventListener("test",Up,Up)}catch(e){tP=!1}var Up;function sJ(e,t,r,n,a,o,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var gh=!1,Dx=null,Ex=!1,rP=null,lJ={onError:function(e){gh=!0,Dx=e}};function cJ(e,t,r,n,a,o,i,s,l){gh=!1,Dx=null,sJ.apply(lJ,arguments)}function dJ(e,t,r,n,a,o,i,s,l){if(cJ.apply(this,arguments),gh){if(gh){var c=Dx;gh=!1,Dx=null}else throw Error(me(198));Ex||(Ex=!0,rP=c)}}function pu(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mz(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Q2(e){if(pu(e)!==e)throw Error(me(188))}function uJ(e){var t=e.alternate;if(!t){if(t=pu(e),t===null)throw Error(me(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var o=a.alternate;if(o===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return Q2(a),e;if(o===n)return Q2(a),t;o=o.sibling}throw Error(me(188))}if(r.return!==n.return)r=a,n=o;else{for(var i=!1,s=a.child;s;){if(s===r){i=!0,r=a,n=o;break}if(s===n){i=!0,n=a,r=o;break}s=s.sibling}if(!i){for(s=o.child;s;){if(s===r){i=!0,r=o,n=a;break}if(s===n){i=!0,n=o,r=a;break}s=s.sibling}if(!i)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?e:t}function fz(e){return e=uJ(e),e!==null?gz(e):null}function gz(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=gz(e);if(t!==null)return t;e=e.sibling}return null}var hz=ti.unstable_scheduleCallback,Z2=ti.unstable_cancelCallback,pJ=ti.unstable_shouldYield,mJ=ti.unstable_requestPaint,en=ti.unstable_now,fJ=ti.unstable_getCurrentPriorityLevel,$P=ti.unstable_ImmediatePriority,vz=ti.unstable_UserBlockingPriority,Ax=ti.unstable_NormalPriority,gJ=ti.unstable_LowPriority,yz=ti.unstable_IdlePriority,Jx=null,al=null;function hJ(e){if(al&&typeof al.onCommitFiberRoot=="function")try{al.onCommitFiberRoot(Jx,e,void 0,(e.current.flags&128)===128)}catch(t){}}var ys=Math.clz32?Math.clz32:bJ,vJ=Math.log,yJ=Math.LN2;function bJ(e){return e>>>=0,e===0?32:31-(vJ(e)/yJ|0)|0}var ex=64,tx=4194304;function ph(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ix(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var s=i&~a;s!==0?n=ph(s):(o&=i,o!==0&&(n=ph(o)))}else i=r&~a,i!==0?n=ph(i):o!==0&&(n=ph(o));if(n===0)return 0;if(t!==0&&t!==n&&(t&a)===0&&(a=n&-n,o=t&-t,a>=o||a===16&&(o&4194240)!==0))return t;if((n&4)!==0&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ys(t),a=1<<r,n|=e[r],t&=~a;return n}function xJ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wJ(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-ys(o),s=1<<i,l=a[i];l===-1?((s&r)===0||(s&n)!==0)&&(a[i]=xJ(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}function nP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bz(){var e=ex;return ex<<=1,(ex&4194240)===0&&(ex=64),e}function k1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $h(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ys(t),e[t]=r}function SJ(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ys(r),o=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~o}}function RP(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ys(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ht=0;function xz(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var wz,WP,Sz,kz,Cz,aP=!1,rx=[],Wc=null,Uc=null,qc=null,Ph=new Map,Dh=new Map,_c=[],kJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ej(e,t){switch(e){case"focusin":case"focusout":Wc=null;break;case"dragenter":case"dragleave":Uc=null;break;case"mouseover":case"mouseout":qc=null;break;case"pointerover":case"pointerout":Ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dh.delete(t.pointerId)}}function nh(e,t,r,n,a,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[a]},t!==null&&(t=Wh(t),t!==null&&WP(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function CJ(e,t,r,n,a){switch(t){case"focusin":return Wc=nh(Wc,e,t,r,n,a),!0;case"dragenter":return Uc=nh(Uc,e,t,r,n,a),!0;case"mouseover":return qc=nh(qc,e,t,r,n,a),!0;case"pointerover":var o=a.pointerId;return Ph.set(o,nh(Ph.get(o)||null,e,t,r,n,a)),!0;case"gotpointercapture":return o=a.pointerId,Dh.set(o,nh(Dh.get(o)||null,e,t,r,n,a)),!0}return!1}function Tz(e){var t=tu(e.target);if(t!==null){var r=pu(t);if(r!==null){if(t=r.tag,t===13){if(t=mz(r),t!==null){e.blockedOn=t,Cz(e.priority,function(){Sz(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hx(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=oP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Z1=n,r.target.dispatchEvent(n),Z1=null}else return t=Wh(r),t!==null&&WP(t),e.blockedOn=r,!1;t.shift()}return!0}function tj(e,t,r){hx(e)&&r.delete(t)}function TJ(){aP=!1,Wc!==null&&hx(Wc)&&(Wc=null),Uc!==null&&hx(Uc)&&(Uc=null),qc!==null&&hx(qc)&&(qc=null),Ph.forEach(tj),Dh.forEach(tj)}function ah(e,t){e.blockedOn===t&&(e.blockedOn=null,aP||(aP=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,TJ)))}function Eh(e){function t(a){return ah(a,e)}if(0<rx.length){ah(rx[0],e);for(var r=1;r<rx.length;r++){var n=rx[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Wc!==null&&ah(Wc,e),Uc!==null&&ah(Uc,e),qc!==null&&ah(qc,e),Ph.forEach(t),Dh.forEach(t),r=0;r<_c.length;r++)n=_c[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<_c.length&&(r=_c[0],r.blockedOn===null);)Tz(r),r.blockedOn===null&&_c.shift()}var im=Gl.ReactCurrentBatchConfig,Nx=!0;function PJ(e,t,r,n){var a=Ht,o=im.transition;im.transition=null;try{Ht=1,UP(e,t,r,n)}finally{Ht=a,im.transition=o}}function DJ(e,t,r,n){var a=Ht,o=im.transition;im.transition=null;try{Ht=4,UP(e,t,r,n)}finally{Ht=a,im.transition=o}}function UP(e,t,r,n){if(Nx){var a=oP(e,t,r,n);if(a===null)I1(e,t,n,Lx,r),ej(e,n);else if(CJ(a,e,t,r,n))n.stopPropagation();else if(ej(e,n),t&4&&-1<kJ.indexOf(e)){for(;a!==null;){var o=Wh(a);if(o!==null&&wz(o),o=oP(e,t,r,n),o===null&&I1(e,t,n,Lx,r),o===a)break;a=o}a!==null&&n.stopPropagation()}else I1(e,t,n,null,r)}}var Lx=null;function oP(e,t,r,n){if(Lx=null,e=BP(n),e=tu(e),e!==null)if(t=pu(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mz(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Lx=e,null}function Pz(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fJ()){case $P:return 1;case vz:return 4;case Ax:case gJ:return 16;case yz:return 536870912;default:return 16}default:return 16}}var $c=null,qP=null,vx=null;function Dz(){if(vx)return vx;var e,t=qP,r=t.length,n,a="value"in $c?$c.value:$c.textContent,o=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[o-n];n++);return vx=a.slice(e,1<n?1-n:void 0)}function yx(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nx(){return!0}function rj(){return!1}function ri(e){function t(r,n,a,o,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?nx:rj,this.isPropagationStopped=rj,this}return Br(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=nx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=nx)},persist:function(){},isPersistent:nx}),t}var hm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},HP=ri(hm),Rh=Br({},hm,{view:0,detail:0}),EJ=ri(Rh),C1,T1,oh,Xx=Br({},Rh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:VP,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oh&&(oh&&e.type==="mousemove"?(C1=e.screenX-oh.screenX,T1=e.screenY-oh.screenY):T1=C1=0,oh=e),C1)},movementY:function(e){return"movementY"in e?e.movementY:T1}}),nj=ri(Xx),AJ=Br({},Xx,{dataTransfer:0}),IJ=ri(AJ),NJ=Br({},Rh,{relatedTarget:0}),P1=ri(NJ),LJ=Br({},hm,{animationName:0,elapsedTime:0,pseudoElement:0}),MJ=ri(LJ),OJ=Br({},hm,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),FJ=ri(OJ),jJ=Br({},hm,{data:0}),aj=ri(jJ),zJ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_J={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BJ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $J(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=BJ[e])?!!t[e]:!1}function VP(){return $J}var RJ=Br({},Rh,{key:function(e){if(e.key){var t=zJ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yx(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_J[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:VP,charCode:function(e){return e.type==="keypress"?yx(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yx(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),WJ=ri(RJ),UJ=Br({},Xx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oj=ri(UJ),qJ=Br({},Rh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:VP}),HJ=ri(qJ),VJ=Br({},hm,{propertyName:0,elapsedTime:0,pseudoElement:0}),GJ=ri(VJ),YJ=Br({},Xx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),KJ=ri(YJ),JJ=[9,13,27,32],GP=Ul&&"CompositionEvent"in window,hh=null;Ul&&"documentMode"in document&&(hh=document.documentMode);var XJ=Ul&&"TextEvent"in window&&!hh,Ez=Ul&&(!GP||hh&&8<hh&&11>=hh),ij=" ",sj=!1;function Az(e,t){switch(e){case"keyup":return JJ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Iz(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gp=!1;function QJ(e,t){switch(e){case"compositionend":return Iz(t);case"keypress":return t.which!==32?null:(sj=!0,ij);case"textInput":return e=t.data,e===ij&&sj?null:e;default:return null}}function ZJ(e,t){if(Gp)return e==="compositionend"||!GP&&Az(e,t)?(e=Dz(),vx=qP=$c=null,Gp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ez&&t.locale!=="ko"?null:t.data;default:return null}}var eX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lj(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!eX[e.type]:t==="textarea"}function Nz(e,t,r,n){lz(n),t=Mx(t,"onChange"),0<t.length&&(r=new HP("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var vh=null,Ah=null;function tX(e){Wz(e,0)}function Qx(e){var t=Jp(e);if(tz(t))return e}function rX(e,t){if(e==="change")return t}var Lz=!1;Ul&&(Ul?(ox="oninput"in document,ox||(D1=document.createElement("div"),D1.setAttribute("oninput","return;"),ox=typeof D1.oninput=="function"),ax=ox):ax=!1,Lz=ax&&(!document.documentMode||9<document.documentMode));var ax,ox,D1;function cj(){vh&&(vh.detachEvent("onpropertychange",Mz),Ah=vh=null)}function Mz(e){if(e.propertyName==="value"&&Qx(Ah)){var t=[];Nz(t,Ah,e,BP(e)),pz(tX,t)}}function nX(e,t,r){e==="focusin"?(cj(),vh=t,Ah=r,vh.attachEvent("onpropertychange",Mz)):e==="focusout"&&cj()}function aX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qx(Ah)}function oX(e,t){if(e==="click")return Qx(t)}function iX(e,t){if(e==="input"||e==="change")return Qx(t)}function sX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xs=typeof Object.is=="function"?Object.is:sX;function Ih(e,t){if(xs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!R1.call(t,a)||!xs(e[a],t[a]))return!1}return!0}function dj(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uj(e,t){var r=dj(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dj(r)}}function Oz(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Oz(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fz(){for(var e=window,t=Px();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=Px(e.document)}return t}function YP(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function lX(e){var t=Fz(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Oz(r.ownerDocument.documentElement,r)){if(n!==null&&YP(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,o=Math.min(n.start,a);n=n.end===void 0?o:Math.min(n.end,a),!e.extend&&o>n&&(a=n,n=o,o=a),a=uj(r,o);var i=uj(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cX=Ul&&"documentMode"in document&&11>=document.documentMode,Yp=null,iP=null,yh=null,sP=!1;function pj(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sP||Yp==null||Yp!==Px(n)||(n=Yp,"selectionStart"in n&&YP(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yh&&Ih(yh,n)||(yh=n,n=Mx(iP,"onSelect"),0<n.length&&(t=new HP("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Yp)))}function ix(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Kp={animationend:ix("Animation","AnimationEnd"),animationiteration:ix("Animation","AnimationIteration"),animationstart:ix("Animation","AnimationStart"),transitionend:ix("Transition","TransitionEnd")},E1={},jz={};Ul&&(jz=document.createElement("div").style,"AnimationEvent"in window||(delete Kp.animationend.animation,delete Kp.animationiteration.animation,delete Kp.animationstart.animation),"TransitionEvent"in window||delete Kp.transitionend.transition);function Zx(e){if(E1[e])return E1[e];if(!Kp[e])return e;var t=Kp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in jz)return E1[e]=t[r];return e}var zz=Zx("animationend"),_z=Zx("animationiteration"),Bz=Zx("animationstart"),$z=Zx("transitionend"),Rz=new Map,mj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qc(e,t){Rz.set(e,t),uu(t,[e])}for(sx=0;sx<mj.length;sx++)lx=mj[sx],fj=lx.toLowerCase(),gj=lx[0].toUpperCase()+lx.slice(1),Qc(fj,"on"+gj);var lx,fj,gj,sx;Qc(zz,"onAnimationEnd");Qc(_z,"onAnimationIteration");Qc(Bz,"onAnimationStart");Qc("dblclick","onDoubleClick");Qc("focusin","onFocus");Qc("focusout","onBlur");Qc($z,"onTransitionEnd");cm("onMouseEnter",["mouseout","mouseover"]);cm("onMouseLeave",["mouseout","mouseover"]);cm("onPointerEnter",["pointerout","pointerover"]);cm("onPointerLeave",["pointerout","pointerover"]);uu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uu("onBeforeInput",["compositionend","keypress","textInput","paste"]);uu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dX=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function hj(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,dJ(n,t,void 0,e),e.currentTarget=null}function Wz(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var i=n.length-1;0<=i;i--){var s=n[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&a.isPropagationStopped())break e;hj(a,s,c),o=l}else for(i=0;i<n.length;i++){if(s=n[i],l=s.instance,c=s.currentTarget,s=s.listener,l!==o&&a.isPropagationStopped())break e;hj(a,s,c),o=l}}}if(Ex)throw e=rP,Ex=!1,rP=null,e}function vr(e,t){var r=t[pP];r===void 0&&(r=t[pP]=new Set);var n=e+"__bubble";r.has(n)||(Uz(t,e,2,!1),r.add(n))}function A1(e,t,r){var n=0;t&&(n|=4),Uz(r,e,n,t)}var cx="_reactListening"+Math.random().toString(36).slice(2);function Nh(e){if(!e[cx]){e[cx]=!0,Jj.forEach(function(r){r!=="selectionchange"&&(dX.has(r)||A1(r,!1,e),A1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cx]||(t[cx]=!0,A1("selectionchange",!1,t))}}function Uz(e,t,r,n){switch(Pz(t)){case 1:var a=PJ;break;case 4:a=DJ;break;default:a=UP}r=a.bind(null,t,r,e),a=void 0,!tP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function I1(e,t,r,n,a){var o=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var s=n.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;s!==null;){if(i=tu(s),i===null)return;if(l=i.tag,l===5||l===6){n=o=i;continue e}s=s.parentNode}}n=n.return}pz(function(){var c=o,d=BP(r),u=[];e:{var p=Rz.get(e);if(p!==void 0){var m=HP,h=e;switch(e){case"keypress":if(yx(r)===0)break e;case"keydown":case"keyup":m=WJ;break;case"focusin":h="focus",m=P1;break;case"focusout":h="blur",m=P1;break;case"beforeblur":case"afterblur":m=P1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=nj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=IJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=HJ;break;case zz:case _z:case Bz:m=MJ;break;case $z:m=GJ;break;case"scroll":m=EJ;break;case"wheel":m=KJ;break;case"copy":case"cut":case"paste":m=FJ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=oj}var f=(t&4)!==0,b=!f&&e==="scroll",v=f?p!==null?p+"Capture":null:p;f=[];for(var y=c,g;y!==null;){g=y;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,v!==null&&(w=Th(y,v),w!=null&&f.push(Lh(y,w,g)))),b)break;y=y.return}0<f.length&&(p=new m(p,h,null,r,d),u.push({event:p,listeners:f}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==Z1&&(h=r.relatedTarget||r.fromElement)&&(tu(h)||h[ql]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(h=r.relatedTarget||r.toElement,m=c,h=h?tu(h):null,h!==null&&(b=pu(h),h!==b||h.tag!==5&&h.tag!==6)&&(h=null)):(m=null,h=c),m!==h)){if(f=nj,w="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(f=oj,w="onPointerLeave",v="onPointerEnter",y="pointer"),b=m==null?p:Jp(m),g=h==null?p:Jp(h),p=new f(w,y+"leave",m,r,d),p.target=b,p.relatedTarget=g,w=null,tu(d)===c&&(f=new f(v,y+"enter",h,r,d),f.target=g,f.relatedTarget=b,w=f),b=w,m&&h)t:{for(f=m,v=h,y=0,g=f;g;g=qp(g))y++;for(g=0,w=v;w;w=qp(w))g++;for(;0<y-g;)f=qp(f),y--;for(;0<g-y;)v=qp(v),g--;for(;y--;){if(f===v||v!==null&&f===v.alternate)break t;f=qp(f),v=qp(v)}f=null}else f=null;m!==null&&vj(u,p,m,f,!1),h!==null&&b!==null&&vj(u,b,h,f,!0)}}e:{if(p=c?Jp(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=rX;else if(lj(p))if(Lz)C=iX;else{C=aX;var k=nX}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=oX);if(C&&(C=C(e,c))){Nz(u,C,r,d);break e}k&&k(e,p,c),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Y1(p,"number",p.value)}switch(k=c?Jp(c):window,e){case"focusin":(lj(k)||k.contentEditable==="true")&&(Yp=k,iP=c,yh=null);break;case"focusout":yh=iP=Yp=null;break;case"mousedown":sP=!0;break;case"contextmenu":case"mouseup":case"dragend":sP=!1,pj(u,r,d);break;case"selectionchange":if(cX)break;case"keydown":case"keyup":pj(u,r,d)}var x;if(GP)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Gp?Az(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(Ez&&r.locale!=="ko"&&(Gp||S!=="onCompositionStart"?S==="onCompositionEnd"&&Gp&&(x=Dz()):($c=d,qP="value"in $c?$c.value:$c.textContent,Gp=!0)),k=Mx(c,S),0<k.length&&(S=new aj(S,e,null,r,d),u.push({event:S,listeners:k}),x?S.data=x:(x=Iz(r),x!==null&&(S.data=x)))),(x=XJ?QJ(e,r):ZJ(e,r))&&(c=Mx(c,"onBeforeInput"),0<c.length&&(d=new aj("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:c}),d.data=x))}Wz(u,t)})}function Lh(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Mx(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=Th(e,r),o!=null&&n.unshift(Lh(e,o,a)),o=Th(e,t),o!=null&&n.push(Lh(e,o,a))),e=e.return}return n}function qp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vj(e,t,r,n,a){for(var o=t._reactName,i=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&c!==null&&(s=c,a?(l=Th(r,o),l!=null&&i.unshift(Lh(r,l,s))):a||(l=Th(r,o),l!=null&&i.push(Lh(r,l,s)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var uX=/\r\n?/g,pX=/\u0000|\uFFFD/g;function yj(e){return(typeof e=="string"?e:""+e).replace(uX,`
`).replace(pX,"")}function dx(e,t,r){if(t=yj(t),yj(e)!==t&&r)throw Error(me(425))}function Ox(){}var lP=null,cP=null;function dP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var uP=typeof setTimeout=="function"?setTimeout:void 0,mX=typeof clearTimeout=="function"?clearTimeout:void 0,bj=typeof Promise=="function"?Promise:void 0,fX=typeof queueMicrotask=="function"?queueMicrotask:typeof bj!="undefined"?function(e){return bj.resolve(null).then(e).catch(gX)}:uP;function gX(e){setTimeout(function(){throw e})}function N1(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Eh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Eh(t)}function Hc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xj(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vm=Math.random().toString(36).slice(2),nl="__reactFiber$"+vm,Mh="__reactProps$"+vm,ql="__reactContainer$"+vm,pP="__reactEvents$"+vm,hX="__reactListeners$"+vm,vX="__reactHandles$"+vm;function tu(e){var t=e[nl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ql]||r[nl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=xj(e);e!==null;){if(r=e[nl])return r;e=xj(e)}return t}e=r,r=e.parentNode}return null}function Wh(e){return e=e[nl]||e[ql],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function ew(e){return e[Mh]||null}var mP=[],Xp=-1;function Zc(e){return{current:e}}function yr(e){0>Xp||(e.current=mP[Xp],mP[Xp]=null,Xp--)}function dr(e,t){Xp++,mP[Xp]=e.current,e.current=t}var Xc={},Ta=Zc(Xc),fo=Zc(!1),iu=Xc;function dm(e,t){var r=e.type.contextTypes;if(!r)return Xc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in r)a[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function go(e){return e=e.childContextTypes,e!=null}function Fx(){yr(fo),yr(Ta)}function wj(e,t,r){if(Ta.current!==Xc)throw Error(me(168));dr(Ta,t),dr(fo,r)}function qz(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(me(108,nJ(e)||"Unknown",a));return Br({},r,n)}function jx(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xc,iu=Ta.current,dr(Ta,e),dr(fo,fo.current),!0}function Sj(e,t,r){var n=e.stateNode;if(!n)throw Error(me(169));r?(e=qz(e,t,iu),n.__reactInternalMemoizedMergedChildContext=e,yr(fo),yr(Ta),dr(Ta,e)):yr(fo),dr(fo,r)}var Bl=null,tw=!1,L1=!1;function Hz(e){Bl===null?Bl=[e]:Bl.push(e)}function yX(e){tw=!0,Hz(e)}function ed(){if(!L1&&Bl!==null){L1=!0;var e=0,t=Ht;try{var r=Bl;for(Ht=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Bl=null,tw=!1}catch(a){throw Bl!==null&&(Bl=Bl.slice(e+1)),hz($P,ed),a}finally{Ht=t,L1=!1}}return null}var Qp=[],Zp=0,zx=null,_x=0,Ei=[],Ai=0,su=null,$l=1,Rl="";function Zd(e,t){Qp[Zp++]=_x,Qp[Zp++]=zx,zx=e,_x=t}function Vz(e,t,r){Ei[Ai++]=$l,Ei[Ai++]=Rl,Ei[Ai++]=su,su=e;var n=$l;e=Rl;var a=32-ys(n)-1;n&=~(1<<a),r+=1;var o=32-ys(t)+a;if(30<o){var i=a-a%5;o=(n&(1<<i)-1).toString(32),n>>=i,a-=i,$l=1<<32-ys(t)+a|r<<a|n,Rl=o+e}else $l=1<<o|r<<a|n,Rl=e}function KP(e){e.return!==null&&(Zd(e,1),Vz(e,1,0))}function JP(e){for(;e===zx;)zx=Qp[--Zp],Qp[Zp]=null,_x=Qp[--Zp],Qp[Zp]=null;for(;e===su;)su=Ei[--Ai],Ei[Ai]=null,Rl=Ei[--Ai],Ei[Ai]=null,$l=Ei[--Ai],Ei[Ai]=null}var ei=null,Zo=null,kr=!1,vs=null;function Gz(e,t){var r=Ii(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kj(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ei=e,Zo=Hc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ei=e,Zo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=su!==null?{id:$l,overflow:Rl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ii(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ei=e,Zo=null,!0):!1;default:return!1}}function fP(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gP(e){if(kr){var t=Zo;if(t){var r=t;if(!kj(e,t)){if(fP(e))throw Error(me(418));t=Hc(r.nextSibling);var n=ei;t&&kj(e,t)?Gz(n,r):(e.flags=e.flags&-4097|2,kr=!1,ei=e)}}else{if(fP(e))throw Error(me(418));e.flags=e.flags&-4097|2,kr=!1,ei=e}}}function Cj(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ei=e}function ux(e){if(e!==ei)return!1;if(!kr)return Cj(e),kr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!dP(e.type,e.memoizedProps)),t&&(t=Zo)){if(fP(e))throw Yz(),Error(me(418));for(;t;)Gz(e,t),t=Hc(t.nextSibling)}if(Cj(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zo=Hc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zo=null}}else Zo=ei?Hc(e.stateNode.nextSibling):null;return!0}function Yz(){for(var e=Zo;e;)e=Hc(e.nextSibling)}function um(){Zo=ei=null,kr=!1}function XP(e){vs===null?vs=[e]:vs.push(e)}var bX=Gl.ReactCurrentBatchConfig;function ih(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,e));var a=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var s=a.refs;i===null?delete s[o]:s[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,e))}return e}function px(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tj(e){var t=e._init;return t(e._payload)}function Kz(e){function t(v,y){if(e){var g=v.deletions;g===null?(v.deletions=[y],v.flags|=16):g.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=Kc(v,y),v.index=0,v.sibling=null,v}function o(v,y,g){return v.index=g,e?(g=v.alternate,g!==null?(g=g.index,g<y?(v.flags|=2,y):g):(v.flags|=2,y)):(v.flags|=1048576,y)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function s(v,y,g,w){return y===null||y.tag!==6?(y=B1(g,v.mode,w),y.return=v,y):(y=a(y,g),y.return=v,y)}function l(v,y,g,w){var C=g.type;return C===Vp?d(v,y,g.props.children,w,g.key):y!==null&&(y.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===jc&&Tj(C)===y.type)?(w=a(y,g.props),w.ref=ih(v,y,g),w.return=v,w):(w=Tx(g.type,g.key,g.props,null,v.mode,w),w.ref=ih(v,y,g),w.return=v,w)}function c(v,y,g,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=$1(g,v.mode,w),y.return=v,y):(y=a(y,g.children||[]),y.return=v,y)}function d(v,y,g,w,C){return y===null||y.tag!==7?(y=ou(g,v.mode,w,C),y.return=v,y):(y=a(y,g),y.return=v,y)}function u(v,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=B1(""+y,v.mode,g),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Xb:return g=Tx(y.type,y.key,y.props,null,v.mode,g),g.ref=ih(v,null,y),g.return=v,g;case Hp:return y=$1(y,v.mode,g),y.return=v,y;case jc:var w=y._init;return u(v,w(y._payload),g)}if(uh(y)||rh(y))return y=ou(y,v.mode,g,null),y.return=v,y;px(v,y)}return null}function p(v,y,g,w){var C=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return C!==null?null:s(v,y,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Xb:return g.key===C?l(v,y,g,w):null;case Hp:return g.key===C?c(v,y,g,w):null;case jc:return C=g._init,p(v,y,C(g._payload),w)}if(uh(g)||rh(g))return C!==null?null:d(v,y,g,w,null);px(v,g)}return null}function m(v,y,g,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(g)||null,s(y,v,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xb:return v=v.get(w.key===null?g:w.key)||null,l(y,v,w,C);case Hp:return v=v.get(w.key===null?g:w.key)||null,c(y,v,w,C);case jc:var k=w._init;return m(v,y,g,k(w._payload),C)}if(uh(w)||rh(w))return v=v.get(g)||null,d(y,v,w,C,null);px(y,w)}return null}function h(v,y,g,w){for(var C=null,k=null,x=y,S=y=0,T=null;x!==null&&S<g.length;S++){x.index>S?(T=x,x=null):T=x.sibling;var P=p(v,x,g[S],w);if(P===null){x===null&&(x=T);break}e&&x&&P.alternate===null&&t(v,x),y=o(P,y,S),k===null?C=P:k.sibling=P,k=P,x=T}if(S===g.length)return r(v,x),kr&&Zd(v,S),C;if(x===null){for(;S<g.length;S++)x=u(v,g[S],w),x!==null&&(y=o(x,y,S),k===null?C=x:k.sibling=x,k=x);return kr&&Zd(v,S),C}for(x=n(v,x);S<g.length;S++)T=m(x,v,S,g[S],w),T!==null&&(e&&T.alternate!==null&&x.delete(T.key===null?S:T.key),y=o(T,y,S),k===null?C=T:k.sibling=T,k=T);return e&&x.forEach(function(M){return t(v,M)}),kr&&Zd(v,S),C}function f(v,y,g,w){var C=rh(g);if(typeof C!="function")throw Error(me(150));if(g=C.call(g),g==null)throw Error(me(151));for(var k=C=null,x=y,S=y=0,T=null,P=g.next();x!==null&&!P.done;S++,P=g.next()){x.index>S?(T=x,x=null):T=x.sibling;var M=p(v,x,P.value,w);if(M===null){x===null&&(x=T);break}e&&x&&M.alternate===null&&t(v,x),y=o(M,y,S),k===null?C=M:k.sibling=M,k=M,x=T}if(P.done)return r(v,x),kr&&Zd(v,S),C;if(x===null){for(;!P.done;S++,P=g.next())P=u(v,P.value,w),P!==null&&(y=o(P,y,S),k===null?C=P:k.sibling=P,k=P);return kr&&Zd(v,S),C}for(x=n(v,x);!P.done;S++,P=g.next())P=m(x,v,S,P.value,w),P!==null&&(e&&P.alternate!==null&&x.delete(P.key===null?S:P.key),y=o(P,y,S),k===null?C=P:k.sibling=P,k=P);return e&&x.forEach(function(D){return t(v,D)}),kr&&Zd(v,S),C}function b(v,y,g,w){if(typeof g=="object"&&g!==null&&g.type===Vp&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Xb:e:{for(var C=g.key,k=y;k!==null;){if(k.key===C){if(C=g.type,C===Vp){if(k.tag===7){r(v,k.sibling),y=a(k,g.props.children),y.return=v,v=y;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===jc&&Tj(C)===k.type){r(v,k.sibling),y=a(k,g.props),y.ref=ih(v,k,g),y.return=v,v=y;break e}r(v,k);break}else t(v,k);k=k.sibling}g.type===Vp?(y=ou(g.props.children,v.mode,w,g.key),y.return=v,v=y):(w=Tx(g.type,g.key,g.props,null,v.mode,w),w.ref=ih(v,y,g),w.return=v,v=w)}return i(v);case Hp:e:{for(k=g.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(v,y.sibling),y=a(y,g.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=$1(g,v.mode,w),y.return=v,v=y}return i(v);case jc:return k=g._init,b(v,y,k(g._payload),w)}if(uh(g))return h(v,y,g,w);if(rh(g))return f(v,y,g,w);px(v,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,g),y.return=v,v=y):(r(v,y),y=B1(g,v.mode,w),y.return=v,v=y),i(v)):r(v,y)}return b}var pm=Kz(!0),Jz=Kz(!1),Bx=Zc(null),$x=null,em=null,QP=null;function ZP(){QP=em=$x=null}function eD(e){var t=Bx.current;yr(Bx),e._currentValue=t}function hP(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function sm(e,t){$x=e,QP=em=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(mo=!0),e.firstContext=null)}function Li(e){var t=e._currentValue;if(QP!==e)if(e={context:e,memoizedValue:t,next:null},em===null){if($x===null)throw Error(me(308));em=e,$x.dependencies={lanes:0,firstContext:e}}else em=em.next=e;return t}var ru=null;function tD(e){ru===null?ru=[e]:ru.push(e)}function Xz(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,tD(t)):(r.next=a.next,a.next=r),t.interleaved=r,Hl(e,n)}function Hl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var zc=!1;function rD(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qz(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Wl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(Dt&2)!==0){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Hl(e,r)}return a=n.interleaved,a===null?(t.next=t,tD(n)):(t.next=a.next,a.next=t),n.interleaved=t,Hl(e,r)}function bx(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,RP(e,r)}}function Pj(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?a=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?a=o=t:o=o.next=t}else a=o=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Rx(e,t,r,n){var a=e.updateQueue;zc=!1;var o=a.firstBaseUpdate,i=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==i&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(o!==null){var u=a.baseState;i=0,d=c=l=null,s=o;do{var p=s.lane,m=s.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,f=s;switch(p=t,m=r,f.tag){case 1:if(h=f.payload,typeof h=="function"){u=h.call(m,u,p);break e}u=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=f.payload,p=typeof h=="function"?h.call(m,u,p):h,p==null)break e;u=Br({},u,p);break e;case 2:zc=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[s]:p.push(s))}else m={eventTime:m,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=m,l=u):d=d.next=m,i|=p;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;p=s,s=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(d===null&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else o===null&&(a.shared.lanes=0);cu|=i,e.lanes=i,e.memoizedState=u}}function Dj(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(me(191,a));a.call(n)}}}var Uh={},ol=Zc(Uh),Oh=Zc(Uh),Fh=Zc(Uh);function nu(e){if(e===Uh)throw Error(me(174));return e}function nD(e,t){switch(dr(Fh,t),dr(Oh,e),dr(ol,Uh),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:J1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=J1(t,e)}yr(ol),dr(ol,t)}function mm(){yr(ol),yr(Oh),yr(Fh)}function Zz(e){nu(Fh.current);var t=nu(ol.current),r=J1(t,e.type);t!==r&&(dr(Oh,e),dr(ol,r))}function aD(e){Oh.current===e&&(yr(ol),yr(Oh))}var zr=Zc(0);function Wx(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var M1=[];function oD(){for(var e=0;e<M1.length;e++)M1[e]._workInProgressVersionPrimary=null;M1.length=0}var xx=Gl.ReactCurrentDispatcher,O1=Gl.ReactCurrentBatchConfig,lu=0,_r=null,Dn=null,Wn=null,Ux=!1,bh=!1,jh=0,xX=0;function Sa(){throw Error(me(321))}function iD(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!xs(e[r],t[r]))return!1;return!0}function sD(e,t,r,n,a,o){if(lu=o,_r=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xx.current=e===null||e.memoizedState===null?CX:TX,e=r(n,a),bh){o=0;do{if(bh=!1,jh=0,25<=o)throw Error(me(301));o+=1,Wn=Dn=null,t.updateQueue=null,xx.current=PX,e=r(n,a)}while(bh)}if(xx.current=qx,t=Dn!==null&&Dn.next!==null,lu=0,Wn=Dn=_r=null,Ux=!1,t)throw Error(me(300));return e}function lD(){var e=jh!==0;return jh=0,e}function rl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?_r.memoizedState=Wn=e:Wn=Wn.next=e,Wn}function Mi(){if(Dn===null){var e=_r.alternate;e=e!==null?e.memoizedState:null}else e=Dn.next;var t=Wn===null?_r.memoizedState:Wn.next;if(t!==null)Wn=t,Dn=e;else{if(e===null)throw Error(me(310));Dn=e,e={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Wn===null?_r.memoizedState=Wn=e:Wn=Wn.next=e}return Wn}function zh(e,t){return typeof t=="function"?t(e):t}function F1(e){var t=Mi(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=Dn,a=n.baseQueue,o=r.pending;if(o!==null){if(a!==null){var i=a.next;a.next=o.next,o.next=i}n.baseQueue=a=o,r.pending=null}if(a!==null){o=a.next,n=n.baseState;var s=i=null,l=null,c=o;do{var d=c.lane;if((lu&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,i=n):l=l.next=u,_r.lanes|=d,cu|=d}c=c.next}while(c!==null&&c!==o);l===null?i=n:l.next=s,xs(n,t.memoizedState)||(mo=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do o=a.lane,_r.lanes|=o,cu|=o,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function j1(e){var t=Mi(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,o=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do o=e(o,i.action),i=i.next;while(i!==a);xs(o,t.memoizedState)||(mo=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function e_(){}function t_(e,t){var r=_r,n=Mi(),a=t(),o=!xs(n.memoizedState,a);if(o&&(n.memoizedState=a,mo=!0),n=n.queue,cD(a_.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Wn!==null&&Wn.memoizedState.tag&1){if(r.flags|=2048,_h(9,n_.bind(null,r,n,a,t),void 0,null),Un===null)throw Error(me(349));(lu&30)!==0||r_(r,t,a)}return a}function r_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=_r.updateQueue,t===null?(t={lastEffect:null,stores:null},_r.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function n_(e,t,r,n){t.value=r,t.getSnapshot=n,o_(t)&&i_(e)}function a_(e,t,r){return r(function(){o_(t)&&i_(e)})}function o_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!xs(e,r)}catch(n){return!0}}function i_(e){var t=Hl(e,1);t!==null&&bs(t,e,1,-1)}function Ej(e){var t=rl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zh,lastRenderedState:e},t.queue=e,e=e.dispatch=kX.bind(null,_r,e),[t.memoizedState,e]}function _h(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=_r.updateQueue,t===null?(t={lastEffect:null,stores:null},_r.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function s_(){return Mi().memoizedState}function wx(e,t,r,n){var a=rl();_r.flags|=e,a.memoizedState=_h(1|t,r,void 0,n===void 0?null:n)}function rw(e,t,r,n){var a=Mi();n=n===void 0?null:n;var o=void 0;if(Dn!==null){var i=Dn.memoizedState;if(o=i.destroy,n!==null&&iD(n,i.deps)){a.memoizedState=_h(t,r,o,n);return}}_r.flags|=e,a.memoizedState=_h(1|t,r,o,n)}function Aj(e,t){return wx(8390656,8,e,t)}function cD(e,t){return rw(2048,8,e,t)}function l_(e,t){return rw(4,2,e,t)}function c_(e,t){return rw(4,4,e,t)}function d_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function u_(e,t,r){return r=r!=null?r.concat([e]):null,rw(4,4,d_.bind(null,t,e),r)}function dD(){}function p_(e,t){var r=Mi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&iD(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function m_(e,t){var r=Mi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&iD(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function f_(e,t,r){return(lu&21)===0?(e.baseState&&(e.baseState=!1,mo=!0),e.memoizedState=r):(xs(r,t)||(r=bz(),_r.lanes|=r,cu|=r,e.baseState=!0),t)}function wX(e,t){var r=Ht;Ht=r!==0&&4>r?r:4,e(!0);var n=O1.transition;O1.transition={};try{e(!1),t()}finally{Ht=r,O1.transition=n}}function g_(){return Mi().memoizedState}function SX(e,t,r){var n=Yc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},h_(e))v_(t,r);else if(r=Xz(e,t,r,n),r!==null){var a=Ga();bs(r,e,n,a),y_(r,t,n)}}function kX(e,t,r){var n=Yc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(h_(e))v_(t,a);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,s=o(i,r);if(a.hasEagerState=!0,a.eagerState=s,xs(s,i)){var l=t.interleaved;l===null?(a.next=a,tD(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch(c){}finally{}r=Xz(e,t,a,n),r!==null&&(a=Ga(),bs(r,e,n,a),y_(r,t,n))}}function h_(e){var t=e.alternate;return e===_r||t!==null&&t===_r}function v_(e,t){bh=Ux=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function y_(e,t,r){if((r&4194240)!==0){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,RP(e,r)}}var qx={readContext:Li,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useInsertionEffect:Sa,useLayoutEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useMutableSource:Sa,useSyncExternalStore:Sa,useId:Sa,unstable_isNewReconciler:!1},CX={readContext:Li,useCallback:function(e,t){return rl().memoizedState=[e,t===void 0?null:t],e},useContext:Li,useEffect:Aj,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wx(4194308,4,d_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wx(4194308,4,e,t)},useInsertionEffect:function(e,t){return wx(4,2,e,t)},useMemo:function(e,t){var r=rl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=rl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=SX.bind(null,_r,e),[n.memoizedState,e]},useRef:function(e){var t=rl();return e={current:e},t.memoizedState=e},useState:Ej,useDebugValue:dD,useDeferredValue:function(e){return rl().memoizedState=e},useTransition:function(){var e=Ej(!1),t=e[0];return e=wX.bind(null,e[1]),rl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=_r,a=rl();if(kr){if(r===void 0)throw Error(me(407));r=r()}else{if(r=t(),Un===null)throw Error(me(349));(lu&30)!==0||r_(n,t,r)}a.memoizedState=r;var o={value:r,getSnapshot:t};return a.queue=o,Aj(a_.bind(null,n,o,e),[e]),n.flags|=2048,_h(9,n_.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=rl(),t=Un.identifierPrefix;if(kr){var r=Rl,n=$l;r=(n&~(1<<32-ys(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=jh++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=xX++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},TX={readContext:Li,useCallback:p_,useContext:Li,useEffect:cD,useImperativeHandle:u_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:m_,useReducer:F1,useRef:s_,useState:function(){return F1(zh)},useDebugValue:dD,useDeferredValue:function(e){var t=Mi();return f_(t,Dn.memoizedState,e)},useTransition:function(){var e=F1(zh)[0],t=Mi().memoizedState;return[e,t]},useMutableSource:e_,useSyncExternalStore:t_,useId:g_,unstable_isNewReconciler:!1},PX={readContext:Li,useCallback:p_,useContext:Li,useEffect:cD,useImperativeHandle:u_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:m_,useReducer:j1,useRef:s_,useState:function(){return j1(zh)},useDebugValue:dD,useDeferredValue:function(e){var t=Mi();return Dn===null?t.memoizedState=e:f_(t,Dn.memoizedState,e)},useTransition:function(){var e=j1(zh)[0],t=Mi().memoizedState;return[e,t]},useMutableSource:e_,useSyncExternalStore:t_,useId:g_,unstable_isNewReconciler:!1};function gs(e,t){if(e&&e.defaultProps){t=Br({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function vP(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Br({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nw={isMounted:function(e){return(e=e._reactInternals)?pu(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ga(),a=Yc(e),o=Wl(n,a);o.payload=t,r!=null&&(o.callback=r),t=Vc(e,o,a),t!==null&&(bs(t,e,a,n),bx(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ga(),a=Yc(e),o=Wl(n,a);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=Vc(e,o,a),t!==null&&(bs(t,e,a,n),bx(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ga(),n=Yc(e),a=Wl(r,n);a.tag=2,t!=null&&(a.callback=t),t=Vc(e,a,n),t!==null&&(bs(t,e,n,r),bx(t,e,n))}};function Ij(e,t,r,n,a,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,i):t.prototype&&t.prototype.isPureReactComponent?!Ih(r,n)||!Ih(a,o):!0}function b_(e,t,r){var n=!1,a=Xc,o=t.contextType;return typeof o=="object"&&o!==null?o=Li(o):(a=go(t)?iu:Ta.current,n=t.contextTypes,o=(n=n!=null)?dm(e,a):Xc),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nw,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function Nj(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nw.enqueueReplaceState(t,t.state,null)}function yP(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},rD(e);var o=t.contextType;typeof o=="object"&&o!==null?a.context=Li(o):(o=go(t)?iu:Ta.current,a.context=dm(e,o)),a.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(vP(e,t,o,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&nw.enqueueReplaceState(a,a.state,null),Rx(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function fm(e,t){try{var r="",n=t;do r+=rJ(n),n=n.return;while(n);var a=r}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:a,digest:null}}function z1(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function bP(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var DX=typeof WeakMap=="function"?WeakMap:Map;function x_(e,t,r){r=Wl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vx||(Vx=!0,AP=n),bP(e,t)},r}function w_(e,t,r){r=Wl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){bP(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){bP(e,t),typeof n!="function"&&(Gc===null?Gc=new Set([this]):Gc.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Lj(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new DX;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=RX.bind(null,e,t,r),t.then(e,e))}function Mj(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Oj(e,t,r,n,a){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Wl(-1,1),t.tag=2,Vc(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var EX=Gl.ReactCurrentOwner,mo=!1;function Va(e,t,r,n){t.child=e===null?Jz(t,null,r,n):pm(t,e.child,r,n)}function Fj(e,t,r,n,a){r=r.render;var o=t.ref;return sm(t,a),n=sD(e,t,r,n,o,a),r=lD(),e!==null&&!mo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vl(e,t,a)):(kr&&r&&KP(t),t.flags|=1,Va(e,t,n,a),t.child)}function jj(e,t,r,n,a){if(e===null){var o=r.type;return typeof o=="function"&&!yD(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,S_(e,t,o,n,a)):(e=Tx(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,(e.lanes&a)===0){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ih,r(i,n)&&e.ref===t.ref)return Vl(e,t,a)}return t.flags|=1,e=Kc(o,n),e.ref=t.ref,e.return=t,t.child=e}function S_(e,t,r,n,a){if(e!==null){var o=e.memoizedProps;if(Ih(o,n)&&e.ref===t.ref)if(mo=!1,t.pendingProps=n=o,(e.lanes&a)!==0)(e.flags&131072)!==0&&(mo=!0);else return t.lanes=e.lanes,Vl(e,t,a)}return xP(e,t,r,n,a)}function k_(e,t,r){var n=t.pendingProps,a=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dr(rm,Qo),Qo|=r;else{if((r&1073741824)===0)return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dr(rm,Qo),Qo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,dr(rm,Qo),Qo|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,dr(rm,Qo),Qo|=n;return Va(e,t,a,r),t.child}function C_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function xP(e,t,r,n,a){var o=go(r)?iu:Ta.current;return o=dm(t,o),sm(t,a),r=sD(e,t,r,n,o,a),n=lD(),e!==null&&!mo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vl(e,t,a)):(kr&&n&&KP(t),t.flags|=1,Va(e,t,r,a),t.child)}function zj(e,t,r,n,a){if(go(r)){var o=!0;jx(t)}else o=!1;if(sm(t,a),t.stateNode===null)Sx(e,t),b_(t,r,n),yP(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Li(c):(c=go(r)?iu:Ta.current,c=dm(t,c));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";u||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==n||l!==c)&&Nj(t,i,n,c),zc=!1;var p=t.memoizedState;i.state=p,Rx(t,n,i,a),l=t.memoizedState,s!==n||p!==l||fo.current||zc?(typeof d=="function"&&(vP(t,r,d,n),l=t.memoizedState),(s=zc||Ij(t,r,s,n,p,l,c))?(u||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=s):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Qz(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:gs(t.type,s),i.props=c,u=t.pendingProps,p=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Li(l):(l=go(r)?iu:Ta.current,l=dm(t,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==u||p!==l)&&Nj(t,i,n,l),zc=!1,p=t.memoizedState,i.state=p,Rx(t,n,i,a);var h=t.memoizedState;s!==u||p!==h||fo.current||zc?(typeof m=="function"&&(vP(t,r,m,n),h=t.memoizedState),(c=zc||Ij(t,r,c,n,p,h,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,h,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,h,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=h),i.props=n,i.state=h,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return wP(e,t,r,n,o,a)}function wP(e,t,r,n,a,o){C_(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Sj(t,r,!1),Vl(e,t,o);n=t.stateNode,EX.current=t;var s=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=pm(t,e.child,null,o),t.child=pm(t,null,s,o)):Va(e,t,s,o),t.memoizedState=n.state,a&&Sj(t,r,!0),t.child}function T_(e){var t=e.stateNode;t.pendingContext?wj(e,t.pendingContext,t.pendingContext!==t.context):t.context&&wj(e,t.context,!1),nD(e,t.containerInfo)}function _j(e,t,r,n,a){return um(),XP(a),t.flags|=256,Va(e,t,r,n),t.child}var SP={dehydrated:null,treeContext:null,retryLane:0};function kP(e){return{baseLanes:e,cachePool:null,transitions:null}}function P_(e,t,r){var n=t.pendingProps,a=zr.current,o=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(a&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),dr(zr,a&1),e===null)return gP(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(i=n.children,e=n.fallback,o?(n=t.mode,o=t.child,i={mode:"hidden",children:i},(n&1)===0&&o!==null?(o.childLanes=0,o.pendingProps=i):o=iw(i,n,0,null),e=ou(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=kP(r),t.memoizedState=SP,e):uD(t,i));if(a=e.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return AX(e,t,i,n,s,a,r);if(o){o=n.fallback,i=t.mode,a=e.child,s=a.sibling;var l={mode:"hidden",children:n.children};return(i&1)===0&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Kc(a,l),n.subtreeFlags=a.subtreeFlags&14680064),s!==null?o=Kc(s,o):(o=ou(o,i,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,i=e.child.memoizedState,i=i===null?kP(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=SP,n}return o=e.child,e=o.sibling,n=Kc(o,{mode:"visible",children:n.children}),(t.mode&1)===0&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function uD(e,t){return t=iw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mx(e,t,r,n){return n!==null&&XP(n),pm(t,e.child,null,r),e=uD(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function AX(e,t,r,n,a,o,i){if(r)return t.flags&256?(t.flags&=-257,n=z1(Error(me(422))),mx(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,a=t.mode,n=iw({mode:"visible",children:n.children},a,0,null),o=ou(o,a,i,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,(t.mode&1)!==0&&pm(t,e.child,null,i),t.child.memoizedState=kP(i),t.memoizedState=SP,o);if((t.mode&1)===0)return mx(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var s=n.dgst;return n=s,o=Error(me(419)),n=z1(o,n,void 0),mx(e,t,i,n)}if(s=(i&e.childLanes)!==0,mo||s){if(n=Un,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=(a&(n.suspendedLanes|i))!==0?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,Hl(e,a),bs(n,e,a,-1))}return vD(),n=z1(Error(me(421))),mx(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=WX.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,Zo=Hc(a.nextSibling),ei=t,kr=!0,vs=null,e!==null&&(Ei[Ai++]=$l,Ei[Ai++]=Rl,Ei[Ai++]=su,$l=e.id,Rl=e.overflow,su=t),t=uD(t,n.children),t.flags|=4096,t)}function Bj(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),hP(e.return,t,r)}function _1(e,t,r,n,a){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=a)}function D_(e,t,r){var n=t.pendingProps,a=n.revealOrder,o=n.tail;if(Va(e,t,n.children,r),n=zr.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Bj(e,r,t);else if(e.tag===19)Bj(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dr(zr,n),(t.mode&1)===0)t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Wx(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),_1(t,!1,a,r,o);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Wx(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}_1(t,!0,r,null,o);break;case"together":_1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sx(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),cu|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,r=Kc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Kc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function IX(e,t,r){switch(t.tag){case 3:T_(t),um();break;case 5:Zz(t);break;case 1:go(t.type)&&jx(t);break;case 4:nD(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;dr(Bx,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(dr(zr,zr.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?P_(e,t,r):(dr(zr,zr.current&1),e=Vl(e,t,r),e!==null?e.sibling:null);dr(zr,zr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,(e.flags&128)!==0){if(n)return D_(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),dr(zr,zr.current),n)break;return null;case 22:case 23:return t.lanes=0,k_(e,t,r)}return Vl(e,t,r)}var E_,CP,A_,I_;E_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};CP=function(){};A_=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,nu(ol.current);var o=null;switch(r){case"input":a=V1(e,a),n=V1(e,n),o=[];break;case"select":a=Br({},a,{value:void 0}),n=Br({},n,{value:void 0}),o=[];break;case"textarea":a=K1(e,a),n=K1(e,n),o=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ox)}X1(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var s=a[c];for(i in s)s.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(kh.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in n){var l=n[c];if(s=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(i in s)!s.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&s[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(o||(o=[]),o.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(kh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&vr("scroll",e),o||s===l||(o=[])):(o=o||[]).push(c,l))}r&&(o=o||[]).push("style",r);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};I_=function(e,t,r,n){r!==n&&(t.flags|=4)};function sh(e,t){if(!kr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ka(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function NX(e,t,r){var n=t.pendingProps;switch(JP(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ka(t),null;case 1:return go(t.type)&&Fx(),ka(t),null;case 3:return n=t.stateNode,mm(),yr(fo),yr(Ta),oD(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ux(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,vs!==null&&(LP(vs),vs=null))),CP(e,t),ka(t),null;case 5:aD(t);var a=nu(Fh.current);if(r=t.type,e!==null&&t.stateNode!=null)A_(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(me(166));return ka(t),null}if(e=nu(ol.current),ux(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[nl]=t,n[Mh]=o,e=(t.mode&1)!==0,r){case"dialog":vr("cancel",n),vr("close",n);break;case"iframe":case"object":case"embed":vr("load",n);break;case"video":case"audio":for(a=0;a<mh.length;a++)vr(mh[a],n);break;case"source":vr("error",n);break;case"img":case"image":case"link":vr("error",n),vr("load",n);break;case"details":vr("toggle",n);break;case"input":G2(n,o),vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},vr("invalid",n);break;case"textarea":K2(n,o),vr("invalid",n)}X1(r,o),a=null;for(var i in o)if(o.hasOwnProperty(i)){var s=o[i];i==="children"?typeof s=="string"?n.textContent!==s&&(o.suppressHydrationWarning!==!0&&dx(n.textContent,s,e),a=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&dx(n.textContent,s,e),a=["children",""+s]):kh.hasOwnProperty(i)&&s!=null&&i==="onScroll"&&vr("scroll",n)}switch(r){case"input":Qb(n),Y2(n,o,!0);break;case"textarea":Qb(n),J2(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Ox)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=az(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[nl]=t,e[Mh]=n,E_(e,t,!1,!1),t.stateNode=e;e:{switch(i=Q1(r,n),r){case"dialog":vr("cancel",e),vr("close",e),a=n;break;case"iframe":case"object":case"embed":vr("load",e),a=n;break;case"video":case"audio":for(a=0;a<mh.length;a++)vr(mh[a],e);a=n;break;case"source":vr("error",e),a=n;break;case"img":case"image":case"link":vr("error",e),vr("load",e),a=n;break;case"details":vr("toggle",e),a=n;break;case"input":G2(e,n),a=V1(e,n),vr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Br({},n,{value:void 0}),vr("invalid",e);break;case"textarea":K2(e,n),a=K1(e,n),vr("invalid",e);break;default:a=n}X1(r,a),s=a;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?sz(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&oz(e,l)):o==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ch(e,l):typeof l=="number"&&Ch(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(kh.hasOwnProperty(o)?l!=null&&o==="onScroll"&&vr("scroll",e):l!=null&&FP(e,o,l,i))}switch(r){case"input":Qb(e),Y2(e,n,!1);break;case"textarea":Qb(e),J2(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Jc(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?nm(e,!!n.multiple,o,!1):n.defaultValue!=null&&nm(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ox)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ka(t),null;case 6:if(e&&t.stateNode!=null)I_(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(me(166));if(r=nu(Fh.current),nu(ol.current),ux(t)){if(n=t.stateNode,r=t.memoizedProps,n[nl]=t,(o=n.nodeValue!==r)&&(e=ei,e!==null))switch(e.tag){case 3:dx(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&dx(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[nl]=t,t.stateNode=n}return ka(t),null;case 13:if(yr(zr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kr&&Zo!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Yz(),um(),t.flags|=98560,o=!1;else if(o=ux(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(me(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(me(317));o[nl]=t}else um(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ka(t),o=!1}else vs!==null&&(LP(vs),vs=null),o=!0;if(!o)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(zr.current&1)!==0?En===0&&(En=3):vD())),t.updateQueue!==null&&(t.flags|=4),ka(t),null);case 4:return mm(),CP(e,t),e===null&&Nh(t.stateNode.containerInfo),ka(t),null;case 10:return eD(t.type._context),ka(t),null;case 17:return go(t.type)&&Fx(),ka(t),null;case 19:if(yr(zr),o=t.memoizedState,o===null)return ka(t),null;if(n=(t.flags&128)!==0,i=o.rendering,i===null)if(n)sh(o,!1);else{if(En!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(i=Wx(e),i!==null){for(t.flags|=128,sh(o,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dr(zr,zr.current&1|2),t.child}e=e.sibling}o.tail!==null&&en()>gm&&(t.flags|=128,n=!0,sh(o,!1),t.lanes=4194304)}else{if(!n)if(e=Wx(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),sh(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!kr)return ka(t),null}else 2*en()-o.renderingStartTime>gm&&r!==1073741824&&(t.flags|=128,n=!0,sh(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=en(),t.sibling=null,r=zr.current,dr(zr,n?r&1|2:r&1),t):(ka(t),null);case 22:case 23:return hD(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(Qo&1073741824)!==0&&(ka(t),t.subtreeFlags&6&&(t.flags|=8192)):ka(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function LX(e,t){switch(JP(t),t.tag){case 1:return go(t.type)&&Fx(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return mm(),yr(fo),yr(Ta),oD(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return aD(t),null;case 13:if(yr(zr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));um()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yr(zr),null;case 4:return mm(),null;case 10:return eD(t.type._context),null;case 22:case 23:return hD(),null;case 24:return null;default:return null}}var fx=!1,Ca=!1,MX=typeof WeakSet=="function"?WeakSet:Set,Te=null;function tm(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Hr(e,t,n)}else r.current=null}function TP(e,t,r){try{r()}catch(n){Hr(e,t,n)}}var $j=!1;function OX(e,t){if(lP=Nx,e=Fz(),YP(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(w){r=null;break e}var i=0,s=-1,l=-1,c=0,d=0,u=e,p=null;t:for(;;){for(var m;u!==r||a!==0&&u.nodeType!==3||(s=i+a),u!==o||n!==0&&u.nodeType!==3||(l=i+n),u.nodeType===3&&(i+=u.nodeValue.length),(m=u.firstChild)!==null;)p=u,u=m;for(;;){if(u===e)break t;if(p===r&&++c===a&&(s=i),p===o&&++d===n&&(l=i),(m=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(cP={focusedElem:e,selectionRange:r},Nx=!1,Te=t;Te!==null;)if(t=Te,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Te=e;else for(;Te!==null;){t=Te;try{var h=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var f=h.memoizedProps,b=h.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?f:gs(t.type,f),b);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(w){Hr(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Te=e;break}Te=t.return}return h=$j,$j=!1,h}function xh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,o!==void 0&&TP(t,r,o)}a=a.next}while(a!==n)}}function aw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function PP(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function N_(e){var t=e.alternate;t!==null&&(e.alternate=null,N_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[nl],delete t[Mh],delete t[pP],delete t[hX],delete t[vX])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function L_(e){return e.tag===5||e.tag===3||e.tag===4}function Rj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||L_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function DP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ox));else if(n!==4&&(e=e.child,e!==null))for(DP(e,t,r),e=e.sibling;e!==null;)DP(e,t,r),e=e.sibling}function EP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(EP(e,t,r),e=e.sibling;e!==null;)EP(e,t,r),e=e.sibling}var oa=null,hs=!1;function Fc(e,t,r){for(r=r.child;r!==null;)M_(e,t,r),r=r.sibling}function M_(e,t,r){if(al&&typeof al.onCommitFiberUnmount=="function")try{al.onCommitFiberUnmount(Jx,r)}catch(s){}switch(r.tag){case 5:Ca||tm(r,t);case 6:var n=oa,a=hs;oa=null,Fc(e,t,r),oa=n,hs=a,oa!==null&&(hs?(e=oa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):oa.removeChild(r.stateNode));break;case 18:oa!==null&&(hs?(e=oa,r=r.stateNode,e.nodeType===8?N1(e.parentNode,r):e.nodeType===1&&N1(e,r),Eh(e)):N1(oa,r.stateNode));break;case 4:n=oa,a=hs,oa=r.stateNode.containerInfo,hs=!0,Fc(e,t,r),oa=n,hs=a;break;case 0:case 11:case 14:case 15:if(!Ca&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var o=a,i=o.destroy;o=o.tag,i!==void 0&&((o&2)!==0||(o&4)!==0)&&TP(r,t,i),a=a.next}while(a!==n)}Fc(e,t,r);break;case 1:if(!Ca&&(tm(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Hr(r,t,s)}Fc(e,t,r);break;case 21:Fc(e,t,r);break;case 22:r.mode&1?(Ca=(n=Ca)||r.memoizedState!==null,Fc(e,t,r),Ca=n):Fc(e,t,r);break;default:Fc(e,t,r)}}function Wj(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new MX),t.forEach(function(n){var a=UX.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function fs(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var o=e,i=t,s=i;e:for(;s!==null;){switch(s.tag){case 5:oa=s.stateNode,hs=!1;break e;case 3:oa=s.stateNode.containerInfo,hs=!0;break e;case 4:oa=s.stateNode.containerInfo,hs=!0;break e}s=s.return}if(oa===null)throw Error(me(160));M_(o,i,a),oa=null,hs=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Hr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)O_(t,e),t=t.sibling}function O_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fs(t,e),tl(e),n&4){try{xh(3,e,e.return),aw(3,e)}catch(f){Hr(e,e.return,f)}try{xh(5,e,e.return)}catch(f){Hr(e,e.return,f)}}break;case 1:fs(t,e),tl(e),n&512&&r!==null&&tm(r,r.return);break;case 5:if(fs(t,e),tl(e),n&512&&r!==null&&tm(r,r.return),e.flags&32){var a=e.stateNode;try{Ch(a,"")}catch(f){Hr(e,e.return,f)}}if(n&4&&(a=e.stateNode,a!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&rz(a,o),Q1(s,i);var c=Q1(s,o);for(i=0;i<l.length;i+=2){var d=l[i],u=l[i+1];d==="style"?sz(a,u):d==="dangerouslySetInnerHTML"?oz(a,u):d==="children"?Ch(a,u):FP(a,d,u,c)}switch(s){case"input":G1(a,o);break;case"textarea":nz(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?nm(a,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?nm(a,!!o.multiple,o.defaultValue,!0):nm(a,!!o.multiple,o.multiple?[]:"",!1))}a[Mh]=o}catch(f){Hr(e,e.return,f)}}break;case 6:if(fs(t,e),tl(e),n&4){if(e.stateNode===null)throw Error(me(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(f){Hr(e,e.return,f)}}break;case 3:if(fs(t,e),tl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Eh(t.containerInfo)}catch(f){Hr(e,e.return,f)}break;case 4:fs(t,e),tl(e);break;case 13:fs(t,e),tl(e),a=e.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(fD=en())),n&4&&Wj(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ca=(c=Ca)||d,fs(t,e),Ca=c):fs(t,e),tl(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&(e.mode&1)!==0)for(Te=e,d=e.child;d!==null;){for(u=Te=d;Te!==null;){switch(p=Te,m=p.child,p.tag){case 0:case 11:case 14:case 15:xh(4,p,p.return);break;case 1:tm(p,p.return);var h=p.stateNode;if(typeof h.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,h.props=t.memoizedProps,h.state=t.memoizedState,h.componentWillUnmount()}catch(f){Hr(n,r,f)}}break;case 5:tm(p,p.return);break;case 22:if(p.memoizedState!==null){qj(u);continue}}m!==null?(m.return=p,Te=m):qj(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{a=u.stateNode,c?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=u.stateNode,l=u.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=iz("display",i))}catch(f){Hr(e,e.return,f)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(f){Hr(e,e.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:fs(t,e),tl(e),n&4&&Wj(e);break;case 21:break;default:fs(t,e),tl(e)}}function tl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(L_(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ch(a,""),n.flags&=-33);var o=Rj(e);EP(e,o,a);break;case 3:case 4:var i=n.stateNode.containerInfo,s=Rj(e);DP(e,s,i);break;default:throw Error(me(161))}}catch(l){Hr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function FX(e,t,r){Te=e,F_(e,t,r)}function F_(e,t,r){for(var n=(e.mode&1)!==0;Te!==null;){var a=Te,o=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||fx;if(!i){var s=a.alternate,l=s!==null&&s.memoizedState!==null||Ca;s=fx;var c=Ca;if(fx=i,(Ca=l)&&!c)for(Te=a;Te!==null;)i=Te,l=i.child,i.tag===22&&i.memoizedState!==null?Hj(a):l!==null?(l.return=i,Te=l):Hj(a);for(;o!==null;)Te=o,F_(o,t,r),o=o.sibling;Te=a,fx=s,Ca=c}Uj(e,t,r)}else(a.subtreeFlags&8772)!==0&&o!==null?(o.return=a,Te=o):Uj(e,t,r)}}function Uj(e){for(;Te!==null;){var t=Te;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Ca||aw(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ca)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:gs(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Dj(t,o,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Dj(t,i,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&Eh(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Ca||t.flags&512&&PP(t)}catch(p){Hr(t,t.return,p)}}if(t===e){Te=null;break}if(r=t.sibling,r!==null){r.return=t.return,Te=r;break}Te=t.return}}function qj(e){for(;Te!==null;){var t=Te;if(t===e){Te=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Te=r;break}Te=t.return}}function Hj(e){for(;Te!==null;){var t=Te;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{aw(4,t)}catch(l){Hr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Hr(t,a,l)}}var o=t.return;try{PP(t)}catch(l){Hr(t,o,l)}break;case 5:var i=t.return;try{PP(t)}catch(l){Hr(t,i,l)}}}catch(l){Hr(t,t.return,l)}if(t===e){Te=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Te=s;break}Te=t.return}}var jX=Math.ceil,Hx=Gl.ReactCurrentDispatcher,pD=Gl.ReactCurrentOwner,Ni=Gl.ReactCurrentBatchConfig,Dt=0,Un=null,cn=null,ia=0,Qo=0,rm=Zc(0),En=0,Bh=null,cu=0,ow=0,mD=0,wh=null,po=null,fD=0,gm=1/0,_l=null,Vx=!1,AP=null,Gc=null,gx=!1,Rc=null,Gx=0,Sh=0,IP=null,kx=-1,Cx=0;function Ga(){return(Dt&6)!==0?en():kx!==-1?kx:kx=en()}function Yc(e){return(e.mode&1)===0?1:(Dt&2)!==0&&ia!==0?ia&-ia:bX.transition!==null?(Cx===0&&(Cx=bz()),Cx):(e=Ht,e!==0||(e=window.event,e=e===void 0?16:Pz(e.type)),e)}function bs(e,t,r,n){if(50<Sh)throw Sh=0,IP=null,Error(me(185));$h(e,r,n),((Dt&2)===0||e!==Un)&&(e===Un&&((Dt&2)===0&&(ow|=r),En===4&&Bc(e,ia)),ho(e,n),r===1&&Dt===0&&(t.mode&1)===0&&(gm=en()+500,tw&&ed()))}function ho(e,t){var r=e.callbackNode;wJ(e,t);var n=Ix(e,e===Un?ia:0);if(n===0)r!==null&&Z2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Z2(r),t===1)e.tag===0?yX(Vj.bind(null,e)):Hz(Vj.bind(null,e)),fX(function(){(Dt&6)===0&&ed()}),r=null;else{switch(xz(n)){case 1:r=$P;break;case 4:r=vz;break;case 16:r=Ax;break;case 536870912:r=yz;break;default:r=Ax}r=U_(r,j_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function j_(e,t){if(kx=-1,Cx=0,(Dt&6)!==0)throw Error(me(327));var r=e.callbackNode;if(lm()&&e.callbackNode!==r)return null;var n=Ix(e,e===Un?ia:0);if(n===0)return null;if((n&30)!==0||(n&e.expiredLanes)!==0||t)t=Yx(e,n);else{t=n;var a=Dt;Dt|=2;var o=__();(Un!==e||ia!==t)&&(_l=null,gm=en()+500,au(e,t));do try{BX();break}catch(s){z_(e,s)}while(!0);ZP(),Hx.current=o,Dt=a,cn!==null?t=0:(Un=null,ia=0,t=En)}if(t!==0){if(t===2&&(a=nP(e),a!==0&&(n=a,t=NP(e,a))),t===1)throw r=Bh,au(e,0),Bc(e,n),ho(e,en()),r;if(t===6)Bc(e,n);else{if(a=e.current.alternate,(n&30)===0&&!zX(a)&&(t=Yx(e,n),t===2&&(o=nP(e),o!==0&&(n=o,t=NP(e,o))),t===1))throw r=Bh,au(e,0),Bc(e,n),ho(e,en()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(me(345));case 2:eu(e,po,_l);break;case 3:if(Bc(e,n),(n&130023424)===n&&(t=fD+500-en(),10<t)){if(Ix(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ga(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=uP(eu.bind(null,e,po,_l),t);break}eu(e,po,_l);break;case 4:if(Bc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-ys(n);o=1<<i,i=t[i],i>a&&(a=i),n&=~o}if(n=a,n=en()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jX(n/1960))-n,10<n){e.timeoutHandle=uP(eu.bind(null,e,po,_l),n);break}eu(e,po,_l);break;case 5:eu(e,po,_l);break;default:throw Error(me(329))}}}return ho(e,en()),e.callbackNode===r?j_.bind(null,e):null}function NP(e,t){var r=wh;return e.current.memoizedState.isDehydrated&&(au(e,t).flags|=256),e=Yx(e,t),e!==2&&(t=po,po=r,t!==null&&LP(t)),e}function LP(e){po===null?po=e:po.push.apply(po,e)}function zX(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],o=a.getSnapshot;a=a.value;try{if(!xs(o(),a))return!1}catch(i){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t){for(t&=~mD,t&=~ow,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ys(t),n=1<<r;e[r]=-1,t&=~n}}function Vj(e){if((Dt&6)!==0)throw Error(me(327));lm();var t=Ix(e,0);if((t&1)===0)return ho(e,en()),null;var r=Yx(e,t);if(e.tag!==0&&r===2){var n=nP(e);n!==0&&(t=n,r=NP(e,n))}if(r===1)throw r=Bh,au(e,0),Bc(e,t),ho(e,en()),r;if(r===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,eu(e,po,_l),ho(e,en()),null}function gD(e,t){var r=Dt;Dt|=1;try{return e(t)}finally{Dt=r,Dt===0&&(gm=en()+500,tw&&ed())}}function du(e){Rc!==null&&Rc.tag===0&&(Dt&6)===0&&lm();var t=Dt;Dt|=1;var r=Ni.transition,n=Ht;try{if(Ni.transition=null,Ht=1,e)return e()}finally{Ht=n,Ni.transition=r,Dt=t,(Dt&6)===0&&ed()}}function hD(){Qo=rm.current,yr(rm)}function au(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,mX(r)),cn!==null)for(r=cn.return;r!==null;){var n=r;switch(JP(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fx();break;case 3:mm(),yr(fo),yr(Ta),oD();break;case 5:aD(n);break;case 4:mm();break;case 13:yr(zr);break;case 19:yr(zr);break;case 10:eD(n.type._context);break;case 22:case 23:hD()}r=r.return}if(Un=e,cn=e=Kc(e.current,null),ia=Qo=t,En=0,Bh=null,mD=ow=cu=0,po=wh=null,ru!==null){for(t=0;t<ru.length;t++)if(r=ru[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=a,n.next=i}r.pending=n}ru=null}return e}function z_(e,t){do{var r=cn;try{if(ZP(),xx.current=qx,Ux){for(var n=_r.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ux=!1}if(lu=0,Wn=Dn=_r=null,bh=!1,jh=0,pD.current=null,r===null||r.return===null){En=1,Bh=t,cn=null;break}e:{var o=e,i=r.return,s=r,l=t;if(t=ia,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=s,u=d.tag;if((d.mode&1)===0&&(u===0||u===11||u===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=Mj(i);if(m!==null){m.flags&=-257,Oj(m,i,s,o,t),m.mode&1&&Lj(o,c,t),t=m,l=c;var h=t.updateQueue;if(h===null){var f=new Set;f.add(l),t.updateQueue=f}else h.add(l);break e}else{if((t&1)===0){Lj(o,c,t),vD();break e}l=Error(me(426))}}else if(kr&&s.mode&1){var b=Mj(i);if(b!==null){(b.flags&65536)===0&&(b.flags|=256),Oj(b,i,s,o,t),XP(fm(l,s));break e}}o=l=fm(l,s),En!==4&&(En=2),wh===null?wh=[o]:wh.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=x_(o,l,t);Pj(o,v);break e;case 1:s=l;var y=o.type,g=o.stateNode;if((o.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Gc===null||!Gc.has(g)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=w_(o,s,t);Pj(o,w);break e}}o=o.return}while(o!==null)}$_(r)}catch(C){t=C,cn===r&&r!==null&&(cn=r=r.return);continue}break}while(!0)}function __(){var e=Hx.current;return Hx.current=qx,e===null?qx:e}function vD(){(En===0||En===3||En===2)&&(En=4),Un===null||(cu&268435455)===0&&(ow&268435455)===0||Bc(Un,ia)}function Yx(e,t){var r=Dt;Dt|=2;var n=__();(Un!==e||ia!==t)&&(_l=null,au(e,t));do try{_X();break}catch(a){z_(e,a)}while(!0);if(ZP(),Dt=r,Hx.current=n,cn!==null)throw Error(me(261));return Un=null,ia=0,En}function _X(){for(;cn!==null;)B_(cn)}function BX(){for(;cn!==null&&!pJ();)B_(cn)}function B_(e){var t=W_(e.alternate,e,Qo);e.memoizedProps=e.pendingProps,t===null?$_(e):cn=t,pD.current=null}function $_(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=NX(r,t,Qo),r!==null){cn=r;return}}else{if(r=LX(r,t),r!==null){r.flags&=32767,cn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{En=6,cn=null;return}}if(t=t.sibling,t!==null){cn=t;return}cn=t=e}while(t!==null);En===0&&(En=5)}function eu(e,t,r){var n=Ht,a=Ni.transition;try{Ni.transition=null,Ht=1,$X(e,t,r,n)}finally{Ni.transition=a,Ht=n}return null}function $X(e,t,r,n){do lm();while(Rc!==null);if((Dt&6)!==0)throw Error(me(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(SJ(e,o),e===Un&&(cn=Un=null,ia=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||gx||(gx=!0,U_(Ax,function(){return lm(),null})),o=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||o){o=Ni.transition,Ni.transition=null;var i=Ht;Ht=1;var s=Dt;Dt|=4,pD.current=null,OX(e,r),O_(r,e),lX(cP),Nx=!!lP,cP=lP=null,e.current=r,FX(r,e,a),mJ(),Dt=s,Ht=i,Ni.transition=o}else e.current=r;if(gx&&(gx=!1,Rc=e,Gx=a),o=e.pendingLanes,o===0&&(Gc=null),hJ(r.stateNode,n),ho(e,en()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Vx)throw Vx=!1,e=AP,AP=null,e;return(Gx&1)!==0&&e.tag!==0&&lm(),o=e.pendingLanes,(o&1)!==0?e===IP?Sh++:(Sh=0,IP=e):Sh=0,ed(),null}function lm(){if(Rc!==null){var e=xz(Gx),t=Ni.transition,r=Ht;try{if(Ni.transition=null,Ht=16>e?16:e,Rc===null)var n=!1;else{if(e=Rc,Rc=null,Gx=0,(Dt&6)!==0)throw Error(me(331));var a=Dt;for(Dt|=4,Te=e.current;Te!==null;){var o=Te,i=o.child;if((Te.flags&16)!==0){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(Te=c;Te!==null;){var d=Te;switch(d.tag){case 0:case 11:case 15:xh(8,d,o)}var u=d.child;if(u!==null)u.return=d,Te=u;else for(;Te!==null;){d=Te;var p=d.sibling,m=d.return;if(N_(d),d===c){Te=null;break}if(p!==null){p.return=m,Te=p;break}Te=m}}}var h=o.alternate;if(h!==null){var f=h.child;if(f!==null){h.child=null;do{var b=f.sibling;f.sibling=null,f=b}while(f!==null)}}Te=o}}if((o.subtreeFlags&2064)!==0&&i!==null)i.return=o,Te=i;else e:for(;Te!==null;){if(o=Te,(o.flags&2048)!==0)switch(o.tag){case 0:case 11:case 15:xh(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,Te=v;break e}Te=o.return}}var y=e.current;for(Te=y;Te!==null;){i=Te;var g=i.child;if((i.subtreeFlags&2064)!==0&&g!==null)g.return=i,Te=g;else e:for(i=y;Te!==null;){if(s=Te,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:aw(9,s)}}catch(C){Hr(s,s.return,C)}if(s===i){Te=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,Te=w;break e}Te=s.return}}if(Dt=a,ed(),al&&typeof al.onPostCommitFiberRoot=="function")try{al.onPostCommitFiberRoot(Jx,e)}catch(C){}n=!0}return n}finally{Ht=r,Ni.transition=t}}return!1}function Gj(e,t,r){t=fm(r,t),t=x_(e,t,1),e=Vc(e,t,1),t=Ga(),e!==null&&($h(e,1,t),ho(e,t))}function Hr(e,t,r){if(e.tag===3)Gj(e,e,r);else for(;t!==null;){if(t.tag===3){Gj(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gc===null||!Gc.has(n))){e=fm(r,e),e=w_(t,e,1),t=Vc(t,e,1),e=Ga(),t!==null&&($h(t,1,e),ho(t,e));break}}t=t.return}}function RX(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ga(),e.pingedLanes|=e.suspendedLanes&r,Un===e&&(ia&r)===r&&(En===4||En===3&&(ia&130023424)===ia&&500>en()-fD?au(e,0):mD|=r),ho(e,t)}function R_(e,t){t===0&&((e.mode&1)===0?t=1:(t=tx,tx<<=1,(tx&130023424)===0&&(tx=4194304)));var r=Ga();e=Hl(e,t),e!==null&&($h(e,t,r),ho(e,r))}function WX(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),R_(e,r)}function UX(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(t),R_(e,r)}var W_;W_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fo.current)mo=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return mo=!1,IX(e,t,r);mo=(e.flags&131072)!==0}else mo=!1,kr&&(t.flags&1048576)!==0&&Vz(t,_x,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Sx(e,t),e=t.pendingProps;var a=dm(t,Ta.current);sm(t,r),a=sD(null,t,n,e,a,r);var o=lD();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,go(n)?(o=!0,jx(t)):o=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,rD(t),a.updater=nw,t.stateNode=a,a._reactInternals=t,yP(t,n,e,r),t=wP(null,t,n,!0,o,r)):(t.tag=0,kr&&o&&KP(t),Va(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Sx(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=HX(n),e=gs(n,e),a){case 0:t=xP(null,t,n,e,r);break e;case 1:t=zj(null,t,n,e,r);break e;case 11:t=Fj(null,t,n,e,r);break e;case 14:t=jj(null,t,n,gs(n.type,e),r);break e}throw Error(me(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gs(n,a),xP(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gs(n,a),zj(e,t,n,a,r);case 3:e:{if(T_(t),e===null)throw Error(me(387));n=t.pendingProps,o=t.memoizedState,a=o.element,Qz(e,t),Rx(t,n,null,r);var i=t.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){a=fm(Error(me(423)),t),t=_j(e,t,n,r,a);break e}else if(n!==a){a=fm(Error(me(424)),t),t=_j(e,t,n,r,a);break e}else for(Zo=Hc(t.stateNode.containerInfo.firstChild),ei=t,kr=!0,vs=null,r=Jz(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(um(),n===a){t=Vl(e,t,r);break e}Va(e,t,n,r)}t=t.child}return t;case 5:return Zz(t),e===null&&gP(t),n=t.type,a=t.pendingProps,o=e!==null?e.memoizedProps:null,i=a.children,dP(n,a)?i=null:o!==null&&dP(n,o)&&(t.flags|=32),C_(e,t),Va(e,t,i,r),t.child;case 6:return e===null&&gP(t),null;case 13:return P_(e,t,r);case 4:return nD(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=pm(t,null,n,r):Va(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gs(n,a),Fj(e,t,n,a,r);case 7:return Va(e,t,t.pendingProps,r),t.child;case 8:return Va(e,t,t.pendingProps.children,r),t.child;case 12:return Va(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,dr(Bx,n._currentValue),n._currentValue=i,o!==null)if(xs(o.value,i)){if(o.children===a.children&&!fo.current){t=Vl(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){i=o.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(o.tag===1){l=Wl(-1,r&-r),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),hP(o.return,r,t),s.lanes|=r;break}l=l.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(me(341));i.lanes|=r,s=i.alternate,s!==null&&(s.lanes|=r),hP(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Va(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,sm(t,r),a=Li(a),n=n(a),t.flags|=1,Va(e,t,n,r),t.child;case 14:return n=t.type,a=gs(n,t.pendingProps),a=gs(n.type,a),jj(e,t,n,a,r);case 15:return S_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gs(n,a),Sx(e,t),t.tag=1,go(n)?(e=!0,jx(t)):e=!1,sm(t,r),b_(t,n,a),yP(t,n,a,r),wP(null,t,n,!0,e,r);case 19:return D_(e,t,r);case 22:return k_(e,t,r)}throw Error(me(156,t.tag))};function U_(e,t){return hz(e,t)}function qX(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ii(e,t,r,n){return new qX(e,t,r,n)}function yD(e){return e=e.prototype,!(!e||!e.isReactComponent)}function HX(e){if(typeof e=="function")return yD(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zP)return 11;if(e===_P)return 14}return 2}function Kc(e,t){var r=e.alternate;return r===null?(r=Ii(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tx(e,t,r,n,a,o){var i=2;if(n=e,typeof e=="function")yD(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Vp:return ou(r.children,a,o,t);case jP:i=8,a|=8;break;case W1:return e=Ii(12,r,t,a|2),e.elementType=W1,e.lanes=o,e;case U1:return e=Ii(13,r,t,a),e.elementType=U1,e.lanes=o,e;case q1:return e=Ii(19,r,t,a),e.elementType=q1,e.lanes=o,e;case Zj:return iw(r,a,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xj:i=10;break e;case Qj:i=9;break e;case zP:i=11;break e;case _P:i=14;break e;case jc:i=16,n=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=Ii(i,r,t,a),t.elementType=e,t.type=n,t.lanes=o,t}function ou(e,t,r,n){return e=Ii(7,e,n,t),e.lanes=r,e}function iw(e,t,r,n){return e=Ii(22,e,n,t),e.elementType=Zj,e.lanes=r,e.stateNode={isHidden:!1},e}function B1(e,t,r){return e=Ii(6,e,null,t),e.lanes=r,e}function $1(e,t,r){return t=Ii(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function VX(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=k1(0),this.expirationTimes=k1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=k1(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bD(e,t,r,n,a,o,i,s,l){return e=new VX(e,t,r,s,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ii(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rD(o),e}function GX(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hp,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function q_(e){if(!e)return Xc;e=e._reactInternals;e:{if(pu(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(go(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var r=e.type;if(go(r))return qz(e,r,t)}return t}function H_(e,t,r,n,a,o,i,s,l){return e=bD(r,n,!0,e,a,o,i,s,l),e.context=q_(null),r=e.current,n=Ga(),a=Yc(r),o=Wl(n,a),o.callback=t!=null?t:null,Vc(r,o,a),e.current.lanes=a,$h(e,a,n),ho(e,n),e}function sw(e,t,r,n){var a=t.current,o=Ga(),i=Yc(a);return r=q_(r),t.context===null?t.context=r:t.pendingContext=r,t=Wl(o,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Vc(a,t,i),e!==null&&(bs(e,a,i,o),bx(e,a,i)),i}function Kx(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yj(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xD(e,t){Yj(e,t),(e=e.alternate)&&Yj(e,t)}function YX(){return null}var V_=typeof reportError=="function"?reportError:function(e){console.error(e)};function wD(e){this._internalRoot=e}lw.prototype.render=wD.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));sw(e,t,null,null)};lw.prototype.unmount=wD.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;du(function(){sw(null,e,null,null)}),t[ql]=null}};function lw(e){this._internalRoot=e}lw.prototype.unstable_scheduleHydration=function(e){if(e){var t=kz();e={blockedOn:null,target:e,priority:t};for(var r=0;r<_c.length&&t!==0&&t<_c[r].priority;r++);_c.splice(r,0,e),r===0&&Tz(e)}};function SD(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kj(){}function KX(e,t,r,n,a){if(a){if(typeof n=="function"){var o=n;n=function(){var c=Kx(i);o.call(c)}}var i=H_(t,n,e,0,null,!1,!1,"",Kj);return e._reactRootContainer=i,e[ql]=i.current,Nh(e.nodeType===8?e.parentNode:e),du(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var s=n;n=function(){var c=Kx(l);s.call(c)}}var l=bD(e,0,!1,null,null,!1,!1,"",Kj);return e._reactRootContainer=l,e[ql]=l.current,Nh(e.nodeType===8?e.parentNode:e),du(function(){sw(t,l,r,n)}),l}function dw(e,t,r,n,a){var o=r._reactRootContainer;if(o){var i=o;if(typeof a=="function"){var s=a;a=function(){var l=Kx(i);s.call(l)}}sw(t,i,e,a)}else i=KX(r,t,e,a,n);return Kx(i)}wz=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ph(t.pendingLanes);r!==0&&(RP(t,r|1),ho(t,en()),(Dt&6)===0&&(gm=en()+500,ed()))}break;case 13:du(function(){var n=Hl(e,1);if(n!==null){var a=Ga();bs(n,e,1,a)}}),xD(e,1)}};WP=function(e){if(e.tag===13){var t=Hl(e,134217728);if(t!==null){var r=Ga();bs(t,e,134217728,r)}xD(e,134217728)}};Sz=function(e){if(e.tag===13){var t=Yc(e),r=Hl(e,t);if(r!==null){var n=Ga();bs(r,e,t,n)}xD(e,t)}};kz=function(){return Ht};Cz=function(e,t){var r=Ht;try{return Ht=e,t()}finally{Ht=r}};eP=function(e,t,r){switch(t){case"input":if(G1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ew(n);if(!a)throw Error(me(90));tz(n),G1(n,a)}}}break;case"textarea":nz(e,r);break;case"select":t=r.value,t!=null&&nm(e,!!r.multiple,t,!1)}};dz=gD;uz=du;var JX={usingClientEntryPoint:!1,Events:[Wh,Jp,ew,lz,cz,gD]},lh={findFiberByHostInstance:tu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XX={bundleType:lh.bundleType,version:lh.version,rendererPackageName:lh.rendererPackageName,rendererConfig:lh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fz(e),e===null?null:e.stateNode},findFiberByHostInstance:lh.findFiberByHostInstance||YX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&(ch=__REACT_DEVTOOLS_GLOBAL_HOOK__,!ch.isDisabled&&ch.supportsFiber))try{Jx=ch.inject(XX),al=ch}catch(e){}var ch;ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JX;ni.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!SD(t))throw Error(me(200));return GX(e,t,null,r)};ni.createRoot=function(e,t){if(!SD(e))throw Error(me(299));var r=!1,n="",a=V_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=bD(e,1,!1,null,null,r,!1,n,a),e[ql]=t.current,Nh(e.nodeType===8?e.parentNode:e),new wD(t)};ni.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=fz(t),e=e===null?null:e.stateNode,e};ni.flushSync=function(e){return du(e)};ni.hydrate=function(e,t,r){if(!cw(t))throw Error(me(200));return dw(null,e,t,!0,r)};ni.hydrateRoot=function(e,t,r){if(!SD(e))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,a=!1,o="",i=V_;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=H_(t,null,e,1,r!=null?r:null,a,!1,o,i),e[ql]=t.current,Nh(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new lw(t)};ni.render=function(e,t,r){if(!cw(t))throw Error(me(200));return dw(null,e,t,!1,r)};ni.unmountComponentAtNode=function(e){if(!cw(e))throw Error(me(40));return e._reactRootContainer?(du(function(){dw(null,null,e,!1,function(){e._reactRootContainer=null,e[ql]=null})}),!0):!1};ni.unstable_batchedUpdates=gD;ni.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cw(r))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return dw(e,t,r,!1,n)};ni.version="18.3.1-next-f1338f8080-20240426"});var Yl=de((oxe,K_)=>{"use strict";function Y_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y_)}catch(e){console.error(e)}}Y_(),K_.exports=G_()});var vo=de(kD=>{"use strict";var J_=Yl();kD.createRoot=J_.createRoot,kD.hydrateRoot=J_.hydrateRoot;var ixe});var X_,De,yo=te(()=>{X_=_(B()),De=({variant:e="secondary",size:t="medium",fullWidth:r=!1,className:n="",children:a,...o})=>{let i="journalit-button",s=[i,`${i}--${e}`,`${i}--${t}`,r?`${i}--full-width`:"",n].filter(Boolean).join(" ");return X_.default.createElement("button",{className:s,type:o.type||"button",...o},a)}});var Kl,eB=te(()=>{Kl={select:"r",placeholder:"b",selectContainer:"g",label:"u",selectWrapper:"e",sm:"x",md:"f",lg:"h",error:"d",errorMessage:"v",helperText:"w"}});var Oi,la,rd=te(()=>{Oi=_(B());eB();la=Oi.default.forwardRef(({className:e="",id:t,label:r,options:n=[],error:a,helperText:o,disabled:i=!1,size:s="md",placeholder:l="Select an option",onChange:c,...d},u)=>{let p=(0,Oi.useId)(),m=t||`select-${p}`,h=`helper-${m}`,f=`error-${m}`,b=[Kl.select,Kl[s],a?Kl.error:"",e,"select",s,a?"error":"","obsidian-select"].filter(Boolean).join(" "),v=y=>{c&&c(y.target.value),y.target&&y.target.setAttribute("data-has-value",y.target.value?"true":"false")};return Oi.default.createElement("div",{className:`${Kl.selectContainer} selectContainer`},r&&Oi.default.createElement("label",{htmlFor:m,className:`${Kl.label} label`},r),Oi.default.createElement("div",{className:`${Kl.selectWrapper} selectWrapper`},Oi.default.createElement("select",{ref:u,id:m,className:b,disabled:i,"data-has-value":d.value||d.defaultValue?"true":"false","aria-invalid":!!a,"aria-describedby":a?f:o?h:void 0,onChange:v,style:{color:d.value?"var(--text-normal)":"var(--text-muted)",opacity:d.value?1:.7},...d},!d.value&&!d.defaultValue&&Oi.default.createElement("option",{value:"",disabled:!0,className:"select-placeholder",style:{color:"var(--text-muted)",opacity:.9,padding:"8px",fontSize:"14px",lineHeight:"normal",height:"auto"}},l),n.map(y=>Oi.default.createElement("option",{key:y.value,value:y.value,style:{color:"var(--text-normal)",opacity:1}},y.label)))),a&&Oi.default.createElement("div",{id:f,className:`${Kl.errorMessage} errorMessage`,role:"alert"},a),!a&&o&&Oi.default.createElement("div",{id:h,className:`${Kl.helperText} helperText`},o))});la.displayName="Select"});function uw(e){return tB[e]}function rB(){return Object.values(tB).map(e=>({value:e.code,label:`${e.symbol} ${e.name} (${e.code})`}))}var tB,ym=te(()=>{tB={USD:{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US",decimalPlaces:2,symbolBefore:!0},EUR:{code:"EUR",symbol:"\u20AC",name:"Euro",locale:"en-IE",decimalPlaces:2,symbolBefore:!0},GBP:{code:"GBP",symbol:"\xA3",name:"British Pound",locale:"en-GB",decimalPlaces:2,symbolBefore:!0},JPY:{code:"JPY",symbol:"\xA5",name:"Japanese Yen",locale:"ja-JP",decimalPlaces:0,symbolBefore:!0},CAD:{code:"CAD",symbol:"C$",name:"Canadian Dollar",locale:"en-CA",decimalPlaces:2,symbolBefore:!0},AUD:{code:"AUD",symbol:"A$",name:"Australian Dollar",locale:"en-AU",decimalPlaces:2,symbolBefore:!0},CHF:{code:"CHF",symbol:"Fr",name:"Swiss Franc",locale:"de-CH",decimalPlaces:2,symbolBefore:!1},CNY:{code:"CNY",symbol:"\xA5",name:"Chinese Yuan",locale:"zh-CN",decimalPlaces:2,symbolBefore:!0}}});var ws,iB=te(()=>{ws={inputContainer:"j",label:"y",inputWrapper:"k",input:"t",sm:"z",md:"C",lg:"Y",default:"A",filled:"M",outlined:"S",error:"p",errorMessage:"T",helperText:"Z",loading:"B","loading-shimmer":"s"}});var xo,Xt,Jl=te(()=>{xo=_(B());iB();Xt=xo.default.forwardRef(({className:e="",id:t,label:r,error:n,helperText:a,disabled:o=!1,size:i="md",variant:s="default",loading:l=!1,onChange:c,multiline:d=!1,rows:u=3,required:p=!1,...m},h)=>{let f=(0,xo.useId)(),b=t||`input-${f}`,v=`helper-${b}`,y=`error-${b}`,[g,w]=(0,xo.useState)(!1),C=typeof m.value=="string"&&(m.value==="0"||m.value==="0.00"||/^0\.0+$/.test(m.value)),k=[ws.input,ws[i],ws[s],n?ws.error:"",C?"default-value":"",e,"input",i,s,n?"error":"",C?"default-value":""].filter(Boolean).join(" "),x=[ws.inputContainer,l?ws.loading:"","inputContainer",l?"loading":""].filter(Boolean).join(" "),S=P=>{c&&c(P.target.value)},T=P=>{c&&c(P.target.value)};return xo.default.createElement("div",{className:x},r&&xo.default.createElement("label",{htmlFor:b,className:`${ws.label} label`},r,p&&xo.default.createElement("span",{className:"required-indicator"},"*")),xo.default.createElement("div",{className:`${ws.inputWrapper} inputWrapper`},d?xo.default.createElement("textarea",{id:b,className:k,disabled:o||l,"aria-invalid":!!n,"aria-describedby":n?y:a?v:void 0,rows:u,onFocus:P=>{w(!0)},onBlur:P=>{w(!1)},onChange:T,value:m.value,placeholder:m.placeholder}):xo.default.createElement("input",{ref:h,id:b,className:k,disabled:o||l,"aria-invalid":!!n,"aria-describedby":n?y:a?v:void 0,onFocus:P=>{var M;w(!0),(M=m.onFocus)==null||M.call(m,P)},onBlur:P=>{var M;w(!1),(M=m.onBlur)==null||M.call(m,P)},onChange:S,...m})),n&&xo.default.createElement("div",{id:y,className:`${ws.errorMessage} errorMessage`,role:"alert"},n),!n&&a&&xo.default.createElement("div",{id:v,className:`${ws.helperText} helperText`},a))});Xt.displayName="Input"});var mB={};Zs(mB,{createDebouncedRefresh:()=>iQ,forceCompleteFileRefresh:()=>nQ,forceFileRefreshByPath:()=>aQ,forceFolderRefresh:()=>rQ,forceGlobalDataRefresh:()=>oQ,forceMetadataCacheRefresh:()=>Wt,forceMultipleFilesRefresh:()=>CD,getFileByPath:()=>pB});async function Wt(e,t,r=100){e.metadataCache.getCache(t.path)&&delete e.metadataCache.metadataCache[t.path],await e.vault.cachedRead(t),e.metadataCache.trigger("resolve",t),await new Promise(a=>setTimeout(a,r)),e.metadataCache.trigger("changed",t)}async function CD(e,t,r=100){await Promise.all(t.map(n=>Wt(e,n,r)))}async function rQ(e,t,r=100){let n=e.vault.getMarkdownFiles().filter(a=>a.path.startsWith(t));await CD(e,n,r)}async function nQ(e,t,r,n){if(await Wt(e,t),r){let o=new CustomEvent(r,{detail:{...n,filePath:t.path,timestamp:Date.now()}});document.dispatchEvent(o)}let a=new CustomEvent("journalit:file-refreshed",{detail:{filePath:t.path,timestamp:Date.now()}});document.dispatchEvent(a)}function pB(e,t){let r=e.vault.getAbstractFileByPath(t);return!r||!(r instanceof uB.TFile)?null:r}async function aQ(e,t){let r=pB(e,t);return r?(await Wt(e,r),!0):(console.warn(`File not found for refresh: ${t}`),!1)}async function oQ(e){e.metadataCache.metadataCache={},e.metadataCache.trigger("resolved");let t=new CustomEvent("journalit:global-data-refreshed",{detail:{timestamp:Date.now()}});document.dispatchEvent(t)}function iQ(e,t=300){let r=null,n=new Set;return a=>{n.add(a),r&&clearTimeout(r),r=setTimeout(async()=>{let o=Array.from(n);n.clear(),await CD(e,o)},t)}}var uB,Ss=te(()=>{uB=require("obsidian")});var Vn,ks,fw,Hn,So=te(()=>{Ss();Vn=(s=>(s.INSTRUMENT="instrument",s.ACCOUNT="account",s.ACCOUNT_TYPE="account_type",s.SETUP="setup",s.MISTAKE="mistake",s.TAG="tag",s.EVENT="event",s))(Vn||{}),ks={instrument:[],account:[],account_type:[],setup:[],mistake:[],tag:[],event:[]},fw={instrument:[{name:"AAPL",assetType:"stock"},{name:"MSFT",assetType:"stock"},{name:"TSLA",assetType:"stock"},{name:"ES1",assetType:"futures",futuresData:{dollarPerPoint:50,tickSize:.25,tickValue:12.5}},{name:"NQ1",assetType:"futures",futuresData:{dollarPerPoint:20,tickSize:.25,tickValue:5}},{name:"EURUSD",assetType:"forex"}],account:["Trading Account","Investment Account"],account_type:["Demo","Evaluation","Funded","Archived"],setup:["Breakout Setup","Reversal Pattern"],mistake:["Early Entry","Poor Position Sizing"],tag:["Swing Trade","Day Trade","Momentum","Reversal","Earnings"],event:[{name:"FOMC Meeting",color:"gray"},{name:"Earnings Announcement",color:"gray"},{name:"Economic Data Release",color:"gray"},{name:"Fed Speech",color:"gray"},{name:"Market Holiday",color:"gray"}]},Hn=class{constructor(t,r){this.options={...ks};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadOptions(),this.initializeDefaultOptionsIfNeeded()}getOptionsKey(){return this.namespace?`customOptions_${this.namespace}`:"customOptions"}async loadOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...ks,...r.settings[t]};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(o=>({name:o,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=n.account,this.options.account_type=n.account_type,this.options.setup=n.setup,this.options.mistake=n.mistake,this.options.tag=n.tag,Array.isArray(n.event)?this.options.event=n.event.map(a=>typeof a=="string"?{name:a,color:"gray"}:typeof a=="object"&&a!==null&&a.name?{name:a.name,color:a.color||"gray"}:null).filter(Boolean):this.options.event=[]}else if(!this.namespace&&r.settings&&r.settings.customOptions){let n={...ks,...r.settings.customOptions};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(o=>({name:o,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=n.account,this.options.account_type=n.account_type,this.options.setup=n.setup,this.options.mistake=n.mistake,this.options.tag=n.tag,Array.isArray(n.event)?this.options.event=n.event.map(a=>typeof a=="string"?{name:a,color:"gray"}:typeof a=="object"&&a!==null&&a.name?{name:a.name,color:a.color||"gray"}:null).filter(Boolean):this.options.event=[]}else{let n=await this.plugin.loadData(),a=this.namespace?`customOptions_${this.namespace}`:"customOptions";if(n&&n[a]){let o={...ks,...n[a]};Array.isArray(o.instrument)&&(typeof o.instrument[0]=="string"?this.options.instrument=o.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=o.instrument),this.options.account=o.account,this.options.account_type=o.account_type,this.options.setup=o.setup,this.options.mistake=o.mistake,this.options.tag=o.tag,this.options.event=o.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else if(!this.namespace&&n&&n.customOptions){let o={...ks,...n.customOptions};Array.isArray(o.instrument)&&(typeof o.instrument[0]=="string"?this.options.instrument=o.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=o.instrument),this.options.account=o.account,this.options.account_type=o.account_type,this.options.setup=o.setup,this.options.mistake=o.mistake,this.options.tag=o.tag,this.options.event=o.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else this.options={...ks},this.initializeDefaultOptionsIfNeeded(),r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}}catch(t){console.error("Failed to load custom options:",t),this.options={...ks},this.initializeDefaultOptionsIfNeeded()}}async saveOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.options},await r.saveSettings();else{console.warn(`Plugin settings not accessible, using legacy save method with key: ${t}`);let a={...await this.plugin.loadData()||{},[t]:this.options};await this.plugin.saveData(a)}}catch(t){console.error(`Failed to save custom options with key: ${this.getOptionsKey()}:`,t)}}getOptions(t){return t==="event"?this.options.event.map(r=>r.name):t==="instrument"?this.options.instrument.map(r=>r.name):this.options[t]?[...this.options[t]]:(console.warn(`Options for type ${t} not initialized, returning empty array`),[])}getInstrumentsForAssetType(t){return this.options.instrument.filter(r=>r.assetType===t).map(r=>r.name)}isInstrumentValidForAssetType(t,r){return!t||!r?!1:this.options.instrument.some(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType===r)}getAssetTypeForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase());return r==null?void 0:r.assetType}getFuturesDataForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType==="futures");return r==null?void 0:r.futuresData}async setFuturesDataForInstrument(t,r){if(!t)return!1;let n=this.options.instrument.findIndex(o=>o.name.toLowerCase()===t.toLowerCase()&&o.assetType==="futures");if(n===-1)return!1;let a={...r};return a.dollarPerPoint===0&&(a.dollarPerPoint=void 0),this.options.instrument[n].futuresData={...this.options.instrument[n].futuresData,...a},await this.saveOptions(),this.notifyOptionsChanged(),!0}getAllOptions(){return{...this.options}}async addOption(t,r,n,a){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors."),!1;let o=r.trim();if(!o)return!1;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding an instrument"),!1;if(this.options.instrument.some(l=>l.name.toLowerCase()===o.toLowerCase()&&l.assetType===n))return!1;let s={name:o,assetType:n};n==="futures"&&a&&(s.futuresData=a),this.options.instrument.push(s)}else{if(this.options[t].some(s=>s.toLowerCase()===o.toLowerCase()))return!1;this.options[t]=[...this.options[t],o]}return await this.saveOptions(),!0}async addOrUpdateEventOption(t,r){let n=t.trim(),o=["red","orange","yellow","gray"].includes(r)?r:"gray";if(!n)return!1;let i=this.options.event.findIndex(s=>s.name.toLowerCase()===n.toLowerCase());return i!==-1?this.options.event[i].color=o:this.options.event.push({name:n,color:o}),await this.saveOptions(),this.notifyOptionsChanged(),!0}async addOptions(t,r,n){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors. Skipping addOptions for EVENT."),0;if(!r.length)return 0;let a=r.map(o=>o.trim()).filter(o=>!!o);if(!a.length)return 0;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding instruments"),0;let o=0;for(let i of a)if(!this.options.instrument.some(l=>l.name.toLowerCase()===i.toLowerCase()&&l.assetType===n)){let l={name:i,assetType:n};n==="futures"&&(l.futuresData={dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument.push(l),o++}return o>0&&await this.saveOptions(),o}else{let o=a.filter(i=>!this.options[t].some(s=>s.toLowerCase()===i.toLowerCase()));return o.length?(this.options[t]=[...this.options[t],...o],await this.saveOptions(),o.length):0}}async removeOption(t,r){let n=!1;if(t==="event"){let a=this.options.event.length;this.options.event=this.options.event.filter(o=>o.name.toLowerCase()!==r.toLowerCase()),n=a!==this.options.event.length}else if(t==="instrument"){let a=this.options.instrument.length;this.options.instrument=this.options.instrument.filter(o=>o.name.toLowerCase()!==r.toLowerCase()),n=a!==this.options.instrument.length}else{let a=this.options[t].length;this.options[t]=this.options[t].filter(o=>o.toLowerCase()!==r.toLowerCase()),n=a!==this.options[t].length}return n?(await this.saveOptions(),await new Promise(a=>setTimeout(a,200)),this.notifyOptionsChanged()):console.warn(`Failed to remove option '${r}' from ${t} - option not found`),n}async updateInstrument(t,r,n,a,o=!1){let i=r.trim();if(!i)return{success:!1};if(!n)return{success:!1};let s=this.options.instrument.findIndex(u=>u.name.toLowerCase()===t.toLowerCase());if(s===-1)return console.warn(`Instrument '${t}' not found`),{success:!1};if(this.options.instrument.some((u,p)=>p!==s&&u.name.toLowerCase()===i.toLowerCase()&&u.assetType===n))return console.warn(`Instrument '${i}' already exists with asset type '${n}'`),{success:!1};let c={name:i,assetType:n};n==="futures"&&(c.futuresData=a||this.options.instrument[s].futuresData||{dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument[s]=c,await this.saveOptions();let d=0;return o&&t!==i&&(d=await this.updateNotesWithOption("instrument",t,i)),this.notifyOptionsChanged(),{success:!0,updatedNotes:d}}async updateOption(t,r,n,a=!1){let o=n.trim();if(!o)return{success:!1};if(t==="instrument")return console.warn("Use updateInstrument method for instruments"),{success:!1};let i=!1,s=-1;if(t==="event"){if(this.options.event.some(d=>d.name.toLowerCase()===o.toLowerCase()&&d.name.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options.event.findIndex(d=>d.name.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options.event[s].name=o,i=!0)}else{if(this.options[t].some(d=>d.toLowerCase()===o.toLowerCase()&&d.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options[t].findIndex(d=>d.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options[t][s]=o,i=!0)}if(!i)return{success:!1};await this.saveOptions();let l=0;return a&&(l=await this.updateNotesWithOption(t,r,n)),this.notifyOptionsChanged(),{success:!0,updatedNotes:l}}async updateNotesWithOption(t,r,n){try{let a=this.getApp().vault.getMarkdownFiles(),i={instrument:["instrument"],account:["account","accountIds"],setup:["setup","setupIds"],mistake:["mistake","mistakeIds"],tag:["ctags"],event:["keyEvents"]}[t];if(!i||i.length===0)return console.warn(`No property names defined for option type: ${t}`),0;let s=0;for(let l of a)try{let c=await this.getApp().vault.read(l),d=c.match(/^---\n([\s\S]*?)\n---/);if(!d)continue;let p=d[1].split(`
`),m=!1,h=p.map(f=>{var b;for(let v of i)if(v==="keyEvents"&&t==="event"){let y=f.match(/^(\s*-\s*event:\s*)(.+)$/);if(y){let g=y[1],w=y[2].trim();if(this.optionValueMatches(w,r))return m=!0,`${g}${n}`}}else if(f.trim().startsWith(`${v}:`)&&!f.includes("[")){let y=(b=f.split(":")[1])==null?void 0:b.trim();if(y&&this.optionValueMatches(y,r))return m=!0,`${v}: ${n}`}else if(f.trim().startsWith(`${v}:`)&&f.includes("[")){let y=f.match(/\[(.*?)\]/);if(y){let g=y[1].split(",").map(C=>C.trim()),w=g.map(C=>this.optionValueMatches(C,r)?n:C);if(g.some((C,k)=>C!==w[k]))return m=!0,`${v}: [${w.join(", ")}]`}}return f});if(m){let f=c.replace(/^---\n[\s\S]*?\n---/,`---
${h.join(`
`)}
---`);await this.getApp().vault.modify(l,f),await Wt(this.getApp(),l);let b=new CustomEvent(`journalit:${this.namespace}-updated`,{detail:{id:l.path}});document.dispatchEvent(b),s++,t==="instrument"&&await this.updateFileNameForInstrument(l,r,n)}}catch(c){console.error(`Error processing file ${l.path}:`,c)}return s}catch(a){return console.error("Error updating notes with new option value:",a),0}}optionValueMatches(t,r){return t.toLowerCase()===r.toLowerCase()}async updateFileNameForInstrument(t,r,n){try{let a=this.extractTickerPart(r),o=this.extractTickerPart(n),i=this.sanitizeTickerForFilename(a),s=this.sanitizeTickerForFilename(o),l=t.path.split("/"),c=l.pop()||"",d=l.join("/");if(!c.match(/^[A-Z0-9-]+-[0-9]{6}-T\d+\.md$/)||!c.startsWith(`${i}-`))return;let u=c.replace(new RegExp(`^${i}-`),`${s}-`),p=`${d}/${u}`;if(p===t.path)return;await this.getApp().fileManager.renameFile(t,p)}catch(a){console.error(`Error updating filename for '${t.path}':`,a)}}extractTickerPart(t){if(!t)return"";let r=t.match(/^([A-Z0-9.^-]+)(?:\s+-\s+|$)/);return r&&r[1]?r[1].trim():t}sanitizeTickerForFilename(t){if(!t)return"UNKNOWN";let r=t.trim().toUpperCase();if(r=r.replace(/[\\/:*?"<>|+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!r)return"UNKNOWN";let n=20;return r.length>n&&(r=r.substring(0,n)),r}getApp(){return this.plugin.app}async clearOptions(t){let r=t==="instrument"?this.options[t].length:this.options[t].length;return r===0?0:(t==="instrument"?this.options[t]=[]:t==="event"?this.options[t]=[]:this.options[t]=[],await this.saveOptions(),await new Promise(n=>setTimeout(n,200)),this.notifyOptionsChanged(),r)}async resetAllOptions(){this.options={...ks},await this.saveOptions(),await new Promise(t=>setTimeout(t,200)),this.notifyOptionsChanged()}async reloadOptions(){await this.loadOptions()}async initializeDefaultOptionsIfNeeded(){try{let t=!1;for(let r of Object.values(Vn))if(this.options[r].length===0&&fw[r].length>0)if(t=!0,r==="event"){let n=fw.event;for(let a of n)this.options.event.findIndex(i=>i.name.toLowerCase()===a.name.toLowerCase())===-1&&this.options.event.push({name:a.name,color:a.color||"gray"})}else if(r==="instrument"){let n=fw.instrument;for(let a of n)this.options.instrument.findIndex(i=>i.name.toLowerCase()===a.name.toLowerCase())===-1&&this.options.instrument.push({name:a.name,assetType:a.assetType,futuresData:a.futuresData})}else{let n=fw[r];this.options[r]=[...this.options[r],...n]}t&&await this.saveOptions()}catch(t){console.error("Failed to initialize default options:",t)}}notifyOptionsChanged(){try{let t={timestamp:Date.now(),...this.namespace?{namespace:this.namespace}:{}},r=new CustomEvent("journalit-options-changed",{detail:t});document.dispatchEvent(r)}catch(t){console.error("Failed to dispatch options changed event:",t)}}getEventOptionByName(t){let r=t.trim().toLowerCase();return this.options.event.find(n=>n.name.toLowerCase()===r)}getNamespace(){return this.namespace}async setNamespace(t){this.namespace!==t&&(this.namespace=t,this.options={...ks},await this.loadOptions(),this.notifyOptionsChanged())}}});var Ja=te(()=>{});function TD(){return`custom_field_${Date.now()}_${Math.random().toString(36).substr(2,5)}`}function nd(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/gi,"").replace(/\s+/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"")}function gw(e){return!e||e.trim()===""?"Field key cannot be empty":bm.has(e)?"This field name conflicts with built-in trade fields":/^[a-z][a-z0-9_]*$/i.test(e)?null:"Field key must start with a letter and contain only letters, numbers, and underscores"}function xm(e,t=[]){let r=nd(e);(!r||bm.has(r))&&(r="custom_field");let n=r,a=1;for(;t.includes(n)||bm.has(n);)n=`${r}_${a}`,a++;return n}function fB(e,t=[]){let r=TD(),n=`New ${e.charAt(0).toUpperCase()+e.slice(1)} Field`,a=xm(n,t);return{id:r,label:n,fieldKey:a,type:e,validation:{},order:Date.now()}}function hw(e,t,r){let{validation:n={},type:a}=t,o=()=>{let i=(t.options||[]).map(s=>s.value);return!r||r.length===0?i:[...new Set([...i,...r])]};if(n.required&&(e==null||e===""))return`${t.label} is required`;if(e==null||e==="")return null;switch(a){case"text":if(typeof e!="string")return`${t.label} must be text`;if(n.minLength&&e.length<n.minLength)return`${t.label} must be at least ${n.minLength} characters`;if(n.maxLength&&e.length>n.maxLength)return`${t.label} must be no more than ${n.maxLength} characters`;if(n.pattern)try{if(!new RegExp(n.pattern).test(e))return`${t.label} format is invalid`}catch(y){return console.warn("[CustomFields] Invalid regex pattern:",n.pattern),`${t.label} has an invalid validation pattern`}break;case"number":let i=Number(e);if(isNaN(i))return`${t.label} must be a number`;if(n.min!==void 0&&i<n.min)return`${t.label} must be at least ${n.min}`;if(n.max!==void 0&&i>n.max)return`${t.label} must be no more than ${n.max}`;break;case"dropdown":if(typeof e!="string")return`${t.label} must be a valid selection`;if(t.allowCreateOptions)break;let s=o();if(s.length>0&&!s.includes(e))return`${t.label} must be a valid option`;break;case"multiselect":if(!Array.isArray(e))return`${t.label} must be an array of selections`;if(t.allowCreateOptions)break;let l=o();if(l.length>0){for(let y of e)if(!l.includes(y))return`${t.label} contains invalid option: ${y}`}break;case"date":case"datetime":let c=new Date(e);if(isNaN(c.getTime()))return`${t.label} must be a valid date`;break;case"time":if(typeof e!="string")return`${t.label} must be a valid time`;let d=e.trim().toLowerCase();if(d==="")return n.required?`${t.label} is required`:null;let u=!1,p="",m=/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9]))?$/,h=d.match(m);if(h){u=!0;let y=h[1].padStart(2,"0"),g=h[2],w=h[3]||"00";p=`${y}:${g}:${w}`}else{let y=/^(1[0-2]|0?[1-9]):([0-5][0-9])(?::([0-5][0-9]))?\s*(am|pm)$/,g=d.match(y);if(g){u=!0;let w=parseInt(g[1]),C=g[2],k=g[3]||"00",x=g[4];x==="pm"&&w!==12?w+=12:x==="am"&&w===12&&(w=0),p=`${w.toString().padStart(2,"0")}:${C}:${k}`}}if(!u)return`${t.label} must be a valid time format (HH:MM, HH:MM:SS, or 12-hour with AM/PM)`;let[f,b,v]=p.split(":").map(Number);if(f>23||b>59||v>59)return`${t.label} contains invalid time values`;break}return null}var Gh,fu,bm,wm=te(()=>{Gh=(s=>(s.TEXT="text",s.NUMBER="number",s.DROPDOWN="dropdown",s.MULTISELECT="multiselect",s.DATE="date",s.DATETIME="datetime",s.TIME="time",s))(Gh||{}),fu={fields:[]},bm=new Set(["type","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","tradeStatus","entries","exits","commission","fees","setupIds","mistakeIds","accountIds","instrument","assetType","account","setup","mistake","ctags","tags","pnl","useDirectPnLInput","directPnL","lossReview","reviewed","reviewedAt","exchange","optionType","strikePrice","expirationDate","dollarPerPoint","tickSize","tickValue","currencyPair","cryptoPair","cryptoExchange","leverageRatio","backendTradeId","backendAccountId","isMissedTrade","filePath","thesis","images","contractSize","lotSize","pipValue","pricePerShare","dividendPerShare","swap","notes","originalPnl"])});var xB,sQ,PD,yw,wB,DD=te(()=>{xB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sQ=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),PD=e=>{let t=sQ(e);return t.charAt(0).toUpperCase()+t.slice(1)},yw=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),wB=e=>{for(let t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0}});var SB,kB=te(()=>{SB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}});var Yh,CB,TB=te(()=>{Yh=_(B());kB();DD();CB=(0,Yh.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:i,...s},l)=>(0,Yh.createElement)("svg",{ref:l,...SB,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:yw("lucide",a),...!o&&!wB(s)&&{"aria-hidden":"true"},...s},[...i.map(([c,d])=>(0,Yh.createElement)(c,d)),...Array.isArray(o)?o:[o]]))});var bw,Vr,ji=te(()=>{bw=_(B());DD();TB();Vr=(e,t)=>{let r=(0,bw.forwardRef)(({className:n,...a},o)=>(0,bw.createElement)(CB,{ref:o,iconNode:t,className:yw(`lucide-${xB(PD(e))}`,`lucide-${e}`,n),...a}));return r.displayName=PD(e),r}});var lQ,Kh,PB=te(()=>{ji();lQ=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Kh=Vr("award",lQ)});var cQ,hu,DB=te(()=>{ji();cQ=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hu=Vr("check",cQ)});var dQ,Jh,EB=te(()=>{ji();dQ=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],Jh=Vr("clipboard-paste",dQ)});var uQ,id,AB=te(()=>{ji();uQ=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],id=Vr("ellipsis",uQ)});var pQ,Xh,IB=te(()=>{ji();pQ=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],Xh=Vr("ghost",pQ)});var mQ,zi,NB=te(()=>{ji();mQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],zi=Vr("plus",mQ)});var fQ,Qh,LB=te(()=>{ji();fQ=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Qh=Vr("rotate-ccw",fQ)});var gQ,un,MB=te(()=>{ji();gQ=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],un=Vr("square-pen",gQ)});var hQ,vu,OB=te(()=>{ji();hQ=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],vu=Vr("trash",hQ)});var vQ,sd,FB=te(()=>{ji();vQ=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],sd=Vr("triangle-alert",vQ)});var yQ,yu,jB=te(()=>{ji();yQ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],yu=Vr("x",yQ)});var ll=te(()=>{AB();MB();FB();PB();DB();EB();IB();NB();LB();OB();jB();});var ld,zB,cd=te(()=>{ld=(i=>(i.STOCK="stock",i.OPTIONS="options",i.FUTURES="futures",i.FOREX="forex",i.CRYPTO="crypto",i.CFD="cfd",i))(ld||{}),zB={entries:[{time:new Date,price:0,size:0}],exits:[{time:new Date,price:0,size:0}],entryTime:new Date,exitTime:new Date,entryPrice:0,exitPrice:0,positionSize:0,direction:"",instrument:"",assetType:"",setupIds:[],mistakeIds:[],accountIds:[],thesis:"",images:[],ctags:[],tags:[],setup:[],mistake:[],account:[],filePath:"",pnl:0,useDirectPnLInput:!1,directPnL:0,commission:0,swap:0,fees:0,exchange:"",expirationDate:new Date,strikePrice:0,optionType:"call",contractSize:100,contractSymbol:"",dollarPerPoint:0,tickSize:0,tickValue:0,currencyPair:"",lotSize:0,pipValue:0,tradingPair:"",cryptoExchange:"",leverageRatio:0,isMissedTrade:!1,missedReason:"",customFields:{}}});var km,BB=te(()=>{km={button:"l",sm:"E",md:"L",lg:"D",primary:"o",secondary:"a",outline:"i",text:"n",fullWidth:"F",loading:"c","button-spinner":"m"}});var ww,$e,_i=te(()=>{ww=_(B());BB();$e=ww.default.forwardRef(({children:e,className:t="",variant:r="primary",size:n="md",disabled:a=!1,fullWidth:o=!1,loading:i=!1,icon:s,...l},c)=>{let d=[km.button,km[r],km[n],o?km.fullWidth:"",i?km.loading:"",t,"button",r,n,o?"fullWidth":"",i?"loading":""].filter(Boolean).join(" "),u=p=>{var m;(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),p.currentTarget.click()),(m=l.onKeyDown)==null||m.call(l,p)};return ww.default.createElement("button",{ref:c,className:d,disabled:a||i,type:l.type||"button",onKeyDown:u,"aria-busy":i,...l},s&&ww.default.createElement("span",{className:"button-icon"},s),e)});$e.displayName="Button"});var bu,Mt,Sw=te(()=>{bu=_(B());Jl();Mt=({value:e,onChange:t,min:r,max:n,step:a=1,precision:o=2,allowDecimal:i=!0,...s})=>{let[l,c]=(0,bu.useState)(e!=null?e.toString():""),[d,u]=(0,bu.useState)(!1);return(0,bu.useEffect)(()=>{if(!d&&e!==void 0&&e!==null){let b=i&&o>0?e.toFixed(o):e.toString();c(b)}else!d&&e==null&&c("")},[e,i,o,d]),bu.default.createElement(Xt,{...s,type:"text",inputMode:i?"decimal":"numeric",value:l,onChange:b=>{if(u(!0),!b){c(""),t==null||t(void 0);return}if(!(i?/^-?\d*\.?\d*$/:/^-?\d*$/).test(b)||(c(b),b==="-"||b==="."||b==="-."))return;let y=i?parseFloat(b):parseInt(b,10);if(!isNaN(y)){let g=y;r!==void 0&&y<r&&(g=r),n!==void 0&&y>n&&(g=n),t==null||t(g)}},onFocus:b=>{var y;u(!0),(parseFloat(l)===0||l==="0"||/^0\.0+$/.test(l))&&b.target.select(),(y=s.onFocus)==null||y.call(s,b)},onBlur:b=>{var v;if(u(!1),l&&!isNaN(parseFloat(l))){let y=parseFloat(l);i&&o>0&&c(y.toFixed(o))}else(l==="-"||l===".")&&(c(""),t==null||t(void 0));(v=s.onBlur)==null||v.call(s,b)},onKeyDown:b=>{var v;if(b.key==="ArrowUp"||b.key==="ArrowDown"){b.preventDefault();let y=l?parseFloat(l):0;if(!isNaN(y)){let g=b.key==="ArrowUp"?a:-a,w=y+g,C=w;r!==void 0&&w<r&&(C=r),n!==void 0&&w>n&&(C=n);let k=i&&o>0?C.toFixed(o):C.toString();c(k),t==null||t(C)}}(v=s.onKeyDown)==null||v.call(s,b)},min:r,max:n,step:a})};Mt.displayName="NumberInput"});function $B(e,t){let r=Object.keys(t).map(n=>xQ(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function xQ(e,t,r){let n=e[t],a=e.hasOwnProperty(t),o=a?n:function(){return Object.getPrototypeOf(e)[t].apply(this,arguments)},i=r(o);return n&&Object.setPrototypeOf(i,n),Object.setPrototypeOf(s,i),e[t]=s,l;function s(...c){return i===o&&e[t]===s&&l(),i.apply(this,c)}function l(){e[t]===s&&(a?e[t]=o:delete e[t]),i!==o&&(i=o,Object.setPrototypeOf(s,n||Function))}}var RB=te(()=>{});var dd,Zh,kw,ev,wQ,WB,Ee,Zt=te(()=>{dd=_(B());RB();Zh=null,kw=!1,ev=new Set,wQ=()=>{kw=!0,ev.forEach(e=>e()),ev.clear()},WB=e=>{Zh=e,setTimeout(wQ,0);let t=$B(e,{unload:r=>async()=>(Zh=null,kw=!1,ev.clear(),await r())});document.dispatchEvent(new CustomEvent("journalit:plugin-updated"))},Ee=()=>{let[e,t]=(0,dd.useState)(kw?Zh:null),r=(0,dd.useRef)(!0),n=(0,dd.useCallback)(()=>{r.current&&Zh!==e&&t(Zh)},[e]);return(0,dd.useEffect)(()=>(r.current=!0,kw?n():ev.add(n),document.addEventListener("journalit:plugin-updated",n),()=>{r.current=!1,ev.delete(n),document.removeEventListener("journalit:plugin-updated",n)}),[n]),e}});function Cw(e){let{currentDate:t,navigateTo:r,getAdjacentReview:n,getRelatedReviewPaths:a={},serviceName:o,calculateAdjacentDate:i,newReviewPathTemplate:s}=e,[l,c]=(0,tv.useState)(!1),d=Ee(),u=(0,tv.useCallback)(async m=>{if(!l)try{c(!0);let h=await n(m);if(h)r(h,!1);else if(i&&s){let f=i(t,m),b=s(f),v;b instanceof Promise?v=await b:v=b,r(v,!1)}}catch(h){console.error("Navigation error:",h)}finally{c(!1)}},[l,n,r,t,i,s]),p=(0,tv.useCallback)(async m=>{var h;try{let f=a[m];if(!f){console.error(`No path function found for review type: ${m}`);return}let b=f(t);if(!b){console.error(`Unable to get review path for type: ${m}`);return}let v=window.app,y=!1;if((h=v==null?void 0:v.vault)!=null&&h.adapter&&(y=await v.vault.adapter.exists(b)),!y&&d)try{let g=o&&d[o];if(g){let w=`create${m.charAt(0).toUpperCase()+m.slice(1)}Review`,C=g[w],k=g.createReview;typeof C=="function"?await C.call(g,t):typeof k=="function"&&await k.call(g,t,m)}}catch(g){console.error(`Error creating ${m} review:`,g)}r(b,!1)}catch(f){console.error(`Error navigating to ${m} review:`,f)}},[a,t,r,d,o]);return{isNavigating:l,handleNavigation:u,navigateToRelatedReview:p}}var tv,Tw=te(()=>{tv=_(B());Zt()});function Cs(e){let t=Ee(),[r,n]=(0,Cm.useState)("loading"),[a,o]=(0,Cm.useState)(null),[i,s]=(0,Cm.useState)(null);return(0,Cm.useEffect)(()=>{let l=!0,c=null,d=async()=>{if(!t){c=setTimeout(d,100);return}try{if(t.serviceManager){let p=`get${e.charAt(0).toUpperCase()+e.slice(1)}`,m=t.serviceManager;if(typeof m[p]=="function"){let h=await m[p]();l&&(o(h),n("ready"),s(null));return}}let u=t;if(u[e]){l&&(o(u[e]),n("ready"),s(null));return}throw new Error(`Service '${e}' not found on plugin instance`)}catch(u){console.error(`Error loading ${e}:`,u),l&&(o(null),n("error"),s(u instanceof Error?u:new Error(`Failed to load ${e}`)))}};return d(),()=>{l=!1,c&&clearTimeout(c)}},[t,e]),{service:a,status:r,error:i}}function UB(){return Cs("drcService")}function qB(){return Cs("weeklyReviewService")}function HB(){return Cs("accountPageService")}var Cm,Tm=te(()=>{Cm=_(B());Zt()});var xu,VB,AD=te(()=>{xu=_(B()),VB=({plugin:e,initialData:t,onUpdate:r})=>{var l;let[n,a]=(0,xu.useState)(((l=e.settings.trade)==null?void 0:l.lossReview)||{enabled:!1,sections:[]}),[o,i]=(0,xu.useState)(t);(0,xu.useEffect)(()=>{let c=d=>{var u,p;if(((u=d.detail)==null?void 0:u.component)==="lossReview"){let m=((p=e.settings.trade)==null?void 0:p.lossReview)||{enabled:!1,sections:[]};a(m)}};return document.addEventListener("journalit-settings-updated",c),()=>{document.removeEventListener("journalit-settings-updated",c)}},[e]);let s=(0,xu.useCallback)(c=>{i(c),r(c)},[r]);return{settings:n,data:o,updateLossReview:s}}});function GB(e=768){let[t,r]=(0,Pm.useState)(()=>window.innerWidth<e);return(0,Pm.useEffect)(()=>{let n=()=>{let s=window.innerWidth<e;r(l=>l!==s?s:l)},a,o=()=>{clearTimeout(a),a=setTimeout(n,100)};window.addEventListener("resize",o);let i=window;return i.app&&i.app.workspace&&i.app.workspace.on("resize",o),()=>{clearTimeout(a),window.removeEventListener("resize",o),i.app&&i.app.workspace&&i.app.workspace.off("resize",o)}},[e]),t}var Pm,YB=te(()=>{Pm=_(B())});function KB(e,t){let[r,n]=(0,wu.useState)(e);return(0,wu.useEffect)(()=>{let a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}var wu,JB=te(()=>{wu=_(B())});var rv,XB=te(()=>{rv=_(B())});var Su=te(()=>{Zt();Tw();Tm();AD();YB();JB();XB()});var re,ca=te(()=>{re={}});function Pr(e){return e==null||isNaN(e)?"N/A":e.toFixed(1)+"%"}function av(e,t="USD"){if(e==null||isNaN(e))return"N/A";let r=uw(t),n=Math.abs(e);if(e===0)return r.symbolBefore?`${r.symbol}0`:`0${r.symbol}`;let a=r.decimalPlaces;if(n===Math.floor(n)||a===0){let i=Math.floor(n).toLocaleString(r.locale);return r.symbolBefore?`${r.symbol}${i}`:`${i}${r.symbol}`}let o=n.toLocaleString(r.locale,{minimumFractionDigits:0,maximumFractionDigits:a});return r.symbolBefore?`${r.symbol}${o}`:`${o}${r.symbol}`}function Da(e,t=!1,r="USD"){if(e==null||isNaN(e))return"N/A";let n=uw(r),a=e<0,o=Math.abs(e),i=t&&e>0?"+":"",s=n.decimalPlaces,l=n.decimalPlaces;n.decimalPlaces>0&&(o===0?(s=0,l=0):o<10?(s=4,l=5):o<100?(s=3,l=4):o>=100&&(o===Math.floor(o)?(s=0,l=0):(s=n.decimalPlaces,l=n.decimalPlaces)));let c=o.toLocaleString(n.locale,{style:"currency",currency:n.code,minimumFractionDigits:s,maximumFractionDigits:l});return a?"-"+c.replace("-",""):i+c}function ue(e,t=!0,r="USD"){if(e===void 0||isNaN(e))return"N/A";let n=uw(r),a=e<0,o=Math.abs(e);if(o>=1e6){let d=o/1e6,u;if(!t||n.decimalPlaces===0)u=Math.round(d)+"M";else{let h=Math.min(n.decimalPlaces,2),f=d.toFixed(h);f.endsWith(".00")?u=f.slice(0,-3)+"M":f.endsWith("0")&&h>1?u=f.slice(0,-1)+"M":u=f+"M"}let p=n.symbolBefore?n.symbol:"",m=n.symbolBefore?"":n.symbol;return a?`-${p}${u}${m}`:`${p}${u}${m}`}if(o>=1e5){let d=o/1e3,u;if(!t||n.decimalPlaces===0)u=Math.round(d)+"K";else{let h=Math.min(n.decimalPlaces,2),f=d.toFixed(h);f.endsWith(".00")?u=f.slice(0,-3)+"K":f.endsWith("0")&&h>1?u=f.slice(0,-1)+"K":u=f+"K"}let p=n.symbolBefore?n.symbol:"",m=n.symbolBefore?"":n.symbol;return a?`-${p}${u}${m}`:`${p}${u}${m}`}let i=o!==Math.floor(o),s;if(!t||n.decimalPlaces===0)s=Math.round(o).toLocaleString(n.locale);else if(i){let d=Math.floor(o).toLocaleString(n.locale),u=(o-Math.floor(o)).toFixed(n.decimalPlaces).substring(1);s=`${d}${u}`}else s=Math.floor(o).toLocaleString(n.locale);let l=n.symbolBefore?n.symbol:"",c=n.symbolBefore?"":n.symbol;return a?`-${l}${s}${c}`:`${l}${s}${c}`}function OD(e){if(!e||e<0)return"N/A";let t=Math.floor(e/1e3),r=Math.floor(t/60),n=Math.floor(r/60),a=Math.floor(n/24);if(a>0){let o=n%24;return o>0?`${a}d ${o}h`:`${a}d`}else if(n>0){let o=r%60;return o>0?`${n}h ${o}m`:`${n}h`}else if(r>0){let o=t%60;return o>0?`${r}m ${o}s`:`${r}m`}else return`${t}s`}var er=te(()=>{ym()});function pn(e){let t=e.getDay(),r=t===0?6:t-1,n=new Date(e);return n.setDate(e.getDate()-r),n.setHours(0,0,0,0),n}function FD(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()+1),r;r.setDate(r.getDate()+1);let n=r.getDay();return n===0?r.setDate(r.getDate()+1):n===6&&r.setDate(r.getDate()+2),r}function jD(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()-1),r;r.setDate(r.getDate()-1);let n=r.getDay();return n===0?r.setDate(r.getDate()-2):n===6&&r.setDate(r.getDate()-1),r}function cl(e){if(e.getFullYear()===2025&&e.getMonth()===2){if(e.getDate()>=10&&e.getDate()<=16)return 11;if(e.getDate()===31)return 14}let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));let r=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7)}function Ts(e){return`W${cl(e).toString().padStart(2,"0")}`}function Pw(e){var t,r,n,a,o,i,s,l,c,d;if(e&&e.settings&&e.settings.trade)return e.settings.trade.skipWeekends!==!1;try{if(((n=(r=(t=window.journalitPlugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.skipWeekends)!==void 0)return window.journalitPlugin.settings.trade.skipWeekends;if((o=(a=window.journalitPlugin)==null?void 0:a.settings)!=null&&o.trade){window.journalitPlugin.settings.trade.skipWeekends=!0;try{window.journalitPlugin.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends",p)}return!0}let u=window.JournalitPlugin;if(((l=(s=(i=u==null?void 0:u.instance)==null?void 0:i.settings)==null?void 0:s.trade)==null?void 0:l.skipWeekends)!==void 0)return u.instance.settings.trade.skipWeekends;if((d=(c=u==null?void 0:u.instance)==null?void 0:c.settings)!=null&&d.trade){u.instance.settings.trade.skipWeekends=!0;try{u.instance.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends via static instance",p)}return!0}return!0}catch(u){return console.warn("Error accessing plugin settings, using default (skip weekends)"),!0}}function mn(e,t=!0){let r;typeof e=="string"?r=new Date(e):r=e;let n=r.getFullYear(),a=r.getMonth(),o=r.getDate(),i=new Date(n,a,o);return t?i.setHours(0,0,0,0):i.setHours(23,59,59,999),i}function Fe(e,t="DDMMYY",r="/"){if(!e)return"Unknown";let n=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${n}${r}${a}${r}${o}`;case"MMDDYY":return`${a}${r}${n}${r}${o}`;case"YYMMDD":return`${o}${r}${a}${r}${n}`;default:return`${n}${r}${a}${r}${o}`}}function Ot(){var e,t,r,n,a,o;try{if((r=(t=(e=window.journalitPlugin)==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.dateFormat)return window.journalitPlugin.settings.trade.dateFormat;let i=window.JournalitPlugin;return(o=(a=(n=i==null?void 0:i.instance)==null?void 0:n.settings)==null?void 0:a.trade)!=null&&o.dateFormat?i.instance.settings.trade.dateFormat:"DDMMYY"}catch(i){return console.warn("Error accessing date format setting, using default (DDMMYY)",i),"DDMMYY"}}function zD(e){let t=e.getMonth();return Math.floor(t/3)+1}var Ft=te(()=>{});function CQ(e){return e.tradeStatus==="OPEN"?!0:e.tradeStatus==="CLOSED"?!1:!e.exitTime&&(e.pnl===null||e.pnl===void 0)}function ct(e){if(e.useDirectPnLInput===!0)return!1;if(e.tradeStatus==="OPEN")return!0;if(e.tradeStatus==="CLOSED")return!1;let t=e.exits&&e.exits.length>0&&e.exits.some(n=>n.price!==void 0&&n.price!==null&&n.price!==0||n.size!==void 0&&n.size!==null&&n.size!==0),r=e.pnl!==null&&e.pnl!==void 0;return!t&&!r}function ZB(e){if(e.isMissedTrade)return"missed";if(CQ(e))return"open";let t=e.pnl||0;return t>0?"win":t<0?"loss":"breakeven"}function e$(e){if(e.isMissedTrade)return"missed";if(ct(e))return"open";let t=e.pnl||0;return t>0?"win":t<0?"loss":"breakeven"}var Ea=te(()=>{});var Dm,t$,_D,ov,sv,iv,ku,lv,ai,cv,Xl=te(()=>{er();Ft();Ea();Dm=(e,t,r=5)=>{let n=[];if(isNaN(e)||isNaN(t)||e===t)return[0];let a=t-e,o=a/(r-1);if(isNaN(o)||o<=0)return[e,t];let i=Math.pow(10,Math.floor(Math.log10(o)));if(isNaN(i)||i<=0)return[e,t];let s;o/i<1.5?s=i:o/i<3.5?s=2*i:o/i<7.5?s=5*i:s=10*i,a<10*i&&s>i&&(s=i);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},t$=(e,t,r,n,a=.05)=>{isNaN(e)&&(e=0),isNaN(t)&&(t=0),isNaN(a)&&(a=.05);let o=r!==void 0?r:Math.min(0,e),i=n!==void 0?n:Math.max(0,t);if(isNaN(o)&&(o=0),isNaN(i)&&(i=0),r===void 0&&e<0){let s=Math.abs(e)*a;isNaN(s)||(o=Math.min(o,e-s))}if(n===void 0&&t>0){let s=t*a;isNaN(s)||(i=Math.max(i,t+s))}return isNaN(o)&&(o=0),isNaN(i)&&(i=0),[o,i]},_D=e=>e===0?"0.00%":"-"+Math.abs(e).toFixed(2)+"%",ov=new Map,sv=(e,t)=>{var l;if(!e||!Array.isArray(e))return[{date:Fe(new Date,t),pnl:0,tradePnL:0}];let r=e.filter(c=>!ct({tradeStatus:c.tradeStatus,exitTime:c.exitTime,pnl:c._originalPnlWasNull?null:c.pnl,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits})),n=`pnl:${r.length}:${t}:${((l=r[0])==null?void 0:l.path)||""}`,a=ov.get(n);if(a)return a;let o=[...r].sort((c,d)=>c.entryTime.getTime()-d.entryTime.getTime()),i=0,s=[];if(o.length>0){let c=new Date(o[0].entryTime);s.push({date:Fe(c,t),pnl:0,tradePnL:0})}else s.push({date:Fe(new Date,t),pnl:0,tradePnL:0});if(o.forEach(c=>{let d=c.pnl==null||isNaN(c.pnl)?0:c.pnl;i+=d,isNaN(i)&&(i=0),s.push({date:Fe(c.entryTime,t),pnl:i,tradePnL:d})}),ov.set(n,s),ov.size>50){let c=ov.keys().next().value;ov.delete(c)}return s},iv=new Map,ku=(e,t)=>{var c;if(!e||!Array.isArray(e))return[{date:Fe(new Date,t),drawdown:0,pnl:0,cumPnL:0,peakEquity:0}];let r=e.filter(d=>!ct({tradeStatus:d.tradeStatus,exitTime:d.exitTime,pnl:d._originalPnlWasNull?null:d.pnl,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits})),n=`drawdown:${r.length}:${t}:${((c=r[0])==null?void 0:c.path)||""}`,a=iv.get(n);if(a)return a;let o=[...r].sort((d,u)=>d.entryTime.getTime()-u.entryTime.getTime()),i=0,s=0,l=[];if(o.length>0){let d=new Date(o[0].entryTime);l.push({date:Fe(d,t),drawdown:0,pnl:0,cumPnL:0,peakEquity:0})}else l.push({date:Fe(new Date,t),drawdown:0,pnl:0,cumPnL:0,peakEquity:0});if(o.forEach(d=>{let u=d.pnl==null||isNaN(d.pnl)?0:d.pnl;i+=u,isNaN(i)&&(i=0),i>s&&(s=i);let p=0;if(s>0){let m=-((s-i)/s)*100;p=isNaN(m)?0:m}else if(i<0){let m=o.filter(h=>h.pnl!=null&&!isNaN(h.pnl)&&h.pnl!==0);if(m.length>0){let h=Math.min(...m.map(b=>b.pnl)),f=Math.abs(h)*10;if(f>0){let b=-(Math.abs(i)/f)*100;p=isNaN(b)?0:b}}}l.push({date:Fe(d.entryTime,t),drawdown:p,pnl:u,cumPnL:i,peakEquity:s})}),iv.set(n,l),iv.size>50){let d=iv.keys().next().value;iv.delete(d)}return l},lv=e=>[...e.filter(n=>!ct({tradeStatus:n.tradeStatus,exitTime:n.exitTime,pnl:n._originalPnlWasNull?null:n.pnl,useDirectPnLInput:n.useDirectPnLInput,exits:n.exits}))].sort((n,a)=>n.entryTime.getTime()-a.entryTime.getTime()).map((n,a)=>{let o=n.pnl||0,i=o>=0;return{tradeIndex:a+1,pnl:o,fill:i?"var(--chart-positive)":"var(--chart-negative)",instrument:n.instrument,direction:n.direction,entryTime:n.entryTime,exitTime:n.exitTime,path:n.path}}),ai={container:"journalit-chart-tooltip",date:"journalit-chart-tooltip-date",value:"journalit-chart-tooltip-value",info:"journalit-chart-tooltip-info",positive:"positive",negative:"negative"},cv=(e,t,r)=>{switch(t){case"pnl":return ue(e,!0,r);case"drawdown":return _D(e);case"number":default:return e.toFixed(2)}}});function r$(e){try{let t=[];return JSON.stringify(e,(r,n)=>{if(typeof n=="object"&&n!==null){if(t.includes(n))return"[Circular Reference]";t.push(n)}return n},2)}catch(t){return console.error("safeStringify error:",t),`[Error serializing object: ${t instanceof Error?t.message:String(t)}]`}}function BD(e,t=["plugin","app"]){let r={};return Object.entries(e).forEach(([n,a])=>{a!==null&&typeof a!="function"&&!(a instanceof Node)&&!t.includes(n)&&(typeof a=="object"&&!Array.isArray(a)?r[n]=BD(a,t):r[n]=a)}),r}function n$(e){try{return{...e}}catch(t){return console.error("Error normalizing data:",t),e}}function a$(e,t){try{let r={...e},n={...t};return{...r,...n}}catch(r){return console.error("Error in safeUpdateObject:",r),{...e,...t}}}var dv=te(()=>{});function o$(e,t,r){let n=null,a=null,o=0,i=null,s=null,l,{leading:c=!1,trailing:d=!0,maxWait:u}=r||{};function p(k){let x=i,S=s;return i=s=null,o=k,l=e.apply(S,x),l}function m(k){return o=k,n=setTimeout(b,t),c?p(k):l}function h(k){let x=k-(a||0),S=k-o,T=t-x;return u!==void 0?Math.min(T,u-S):T}function f(k){let x=k-(a||0),S=k-o;return a===null||x>=t||x<0||u!==void 0&&S>=u}function b(){let k=Date.now();if(f(k))return v(k);n=setTimeout(b,h(k))}function v(k){return n=null,d&&i?p(k):(i=s=null,l)}function y(){n!==null&&clearTimeout(n),o=0,i=a=s=n=null}function g(){return n===null?l:v(Date.now())}function w(){return n!==null}function C(...k){let x=Date.now(),S=f(x);if(i=k,s=this,a=x,S){if(n===null)return m(a);if(u!==void 0)return n=setTimeout(b,t),p(a)}return n===null&&(n=setTimeout(b,t)),l}return C.cancel=y,C.flush=g,C.pending=w,C}function $D(e,t){let r=null,n=null,a=null,o=null;function i(){r!==null&&(clearTimeout(r),r=null),o&&(o(new Error("Debounced function cancelled")),a=o=null,n=null)}async function s(){if(r!==null&&(clearTimeout(r),r=null,n))try{let u=await e.apply(c,l);return a&&a(u),u}catch(u){throw o&&o(u),u}}let l=null,c=null,d=function(...u){return l=u,c=this,i(),n=new Promise((p,m)=>{a=p,o=m,r=setTimeout(async()=>{try{let h=await e.apply(c,l);p(h)}catch(h){m(h)}finally{r=null,n=null,a=o=null}},t)}),n};return d.cancel=i,d.flush=s,d}var Dw=te(()=>{});function uv(){if(document.head.querySelector("#dropdown-fix-script"))return;let e=document.createElement("script");e.id="dropdown-fix-script",e.textContent=TQ,document.head.appendChild(e)}function RD(){let e=document.head.querySelector("#dropdown-fix-script");e&&e.remove()}var TQ,i$=te(()=>{TQ=`
  // Global event handler to forcibly close dropdowns when clicking outside
  (function() {
    // Only add this handler once
    if (window.__dropdownClickHandlerAdded) return;
    
    // Mark this handler as added to prevent multiple instances
    window.__dropdownClickHandlerAdded = true;
    
    // Initialize the remove handling flag
    window.__isHandlingComboBoxRemove = false;
    
    // Add capture phase handler to catch clicks early
    document.addEventListener('mousedown', function(event) {
      // Skip if event is already being handled
      if (window.__isHandlingComboBoxRemove) return;
      
      // Mark as handling to prevent recursive handling
      window.__isHandlingComboBoxRemove = true;
      
      try {
        // Find all open comboboxes/dropdowns
        const openDropdowns = document.querySelectorAll('[data-is-open="true"], [data-combobox-type][aria-expanded="true"]');
        
        if (openDropdowns.length > 0) {
          let shouldClose = true;
          
          // Check if the click was inside any dropdown
          for (const dropdown of openDropdowns) {
            if (dropdown.contains(event.target)) {
              shouldClose = false;
              break;
            }
          }
          
          // If clicked outside, close all dropdowns by triggering blur on their inputs
          if (shouldClose) {
            openDropdowns.forEach(dropdown => {
              const input = dropdown.querySelector('input[role="combobox"]');
              if (input) {
                // Trigger blur to close the dropdown
                input.blur();
                
                // Additional attribute cleanup to ensure closure
                dropdown.setAttribute('data-is-open', 'false');
                if (input.hasAttribute('aria-expanded')) {
                  input.setAttribute('aria-expanded', 'false');
                }
              }
            });
          }
        }
      } catch (err) {
        console.error('Error in dropdown click handler:', err);
      } finally {
        // Release handling flag
        window.__isHandlingComboBoxRemove = false;
      }
    }, true);
  })();
`});function Bi(e){let{message:t,error:r,component:n="unknown",operation:a="unknown",data:o,severity:i="error"}=e,s=r instanceof Error?r:new Error(t),l=i==="info"?console.info:i==="warning"?console.warn:console.error,c={error:s,operation:a,component:n};if(o&&(c.data=typeof o=="object"?r$(o):o),l(`[${i.toUpperCase()}] [${n}] ${t}`,c),i==="critical")try{let d=window.app;d!=null&&d.notices&&d.notices.show(`${t} (See console for details)`,1e4)}catch(d){console.error("Failed to show error notification:",d)}return s}function Em(e,t){return(r,n)=>Bi({message:n||`Error in ${t}`,error:r,component:e,operation:t,severity:"error"})}var pv=te(()=>{dv()});function br(){let e=window.app;if(!e)throw new Error("Could not access Obsidian app instance");return e}var Cu=te(()=>{});function Aa(e){let t=e.pnl;return e.commission<0?t+=e.commission:t-=e.commission,e.swap<0?t+=e.swap:t-=e.swap,e.fees<0?t+=e.fees:t-=e.fees,t}var mv=te(()=>{});var ud=te(()=>{Xl();dv();Ft();Dw();i$();pv();er();Cu();Ss();mv()});function Ps(e=!1,t=!1,r=!1,n=!1,a=!1,o=!1,i=!1,s=!1,l=!1){try{if(!t&&re.tradeNote&&re.tradeNote.remove(),!o&&re.image&&re.image.remove(),e||(re.drc&&re.drc.remove(),re.drcNote&&re.drcNote.remove()),!r&&re.settings&&re.settings.remove(),!n&&(re.dashboard&&re.dashboard.remove(),!i)){let c=document.head.querySelector("#dashboard-transparency-styles");c&&c.remove()}re.weeklyReview&&re.weeklyReview.remove(),re.monthlyReview&&re.monthlyReview.remove(),!s&&re.shared&&re.shared.remove(),re.tooltip&&re.tooltip.remove(),re.dragOverlay&&re.dragOverlay.remove(),re.tradeForm&&re.tradeForm.remove(),!a&&re.chart&&re.chart.remove(),!l&&re.tradeLog&&re.tradeLog.remove(),RD(),window.__isHandlingComboBoxRemove=!1}catch(c){console.error("Failed to remove styles:",c)}}function Tu(e=!1,t=!1,r=!0,n=!0,a=!0,o=!0,i=!1,s=!0,l=!0,c=!0){var d,u,p,m,h,f,b;if(e&&((d=re.drc)!=null&&d.inject)&&re.drc.inject(),t&&((u=re.tradeNote)!=null&&u.inject)&&re.tradeNote.inject(),n&&((p=re.dashboard)!=null&&p.inject)&&re.dashboard.inject(),r&&((m=re.settings)!=null&&m.inject)&&re.settings.inject(),a&&((h=re.chart)!=null&&h.inject)&&re.chart.inject(),o&&((f=re.image)!=null&&f.inject)&&re.image.inject(),c&&((b=re.tradeLog)!=null&&b.inject)&&re.tradeLog.inject(),!(window.__isInjectingStyles&&!i)){window.__isInjectingStyles=!0;try{Ps(e,t,r,n,a,o,s,l,c),re.shared&&re.shared.inject(),re.tooltip&&re.tooltip.inject(),re.dragOverlay&&re.dragOverlay.inject(),re.tradeForm&&re.tradeForm.inject(),re.chart&&re.chart.inject(),uv(),re.weeklyReview&&re.weeklyReview.inject(),re.monthlyReview&&re.monthlyReview.inject(),re.image&&re.image.inject(),re.tradeLog&&re.tradeLog.inject(),e||(re.drc&&re.drc.inject(),re.drcNote&&re.drcNote.inject()),!t&&re.tradeNote&&re.tradeNote.inject(),!r&&re.settings&&re.settings.inject(),!n&&re.dashboard&&re.dashboard.inject(),typeof window!="undefined"&&re.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=re.drc.inject)}catch(v){console.error("Failed to inject styles:",v)}finally{window.__isInjectingStyles=!1}}}var WD=te(()=>{ca();ud()});function UD(){try{let e="weekly-review-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=PQ,document.head.appendChild(t)}catch(e){console.error("Failed to inject Weekly Review styles:",e)}}function s$(){try{let t=document.getElementById("weekly-review-styles");t&&t.parentNode&&t.parentNode.removeChild(t)}catch(e){console.error("Failed to remove Weekly Review styles:",e)}}function DQ(){try{let e="weekly-review-alignment-fix";if(!document.getElementById(e)){let t=document.createElement("style");t.id=e,t.textContent=`
        /* Core alignment fixes for Weekly Review */
        .weekly-review-content {
          padding: 20px 0 0 !important;
        }

        .weekly-review-section {
          width: 100% !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          margin-bottom: 24px !important;
          box-sizing: border-box !important;
        }

        /* Fix for nested containers in tabs */
        .weekly-review-preparation,
        .weekly-review-overview,
        .weekly-review-review {
          padding: 0 !important;
          width: 100% !important;
        }

        /* High priority rule for all event/forecast/question containers */
        .weekly-review-event-item,
        .weekly-review-forecast-section,
        .weekly-review-grade-item,
        .weekly-review-question,
        /* .weekly-review-drc-list, /* These seem specific to Overview/Review tabs */
        /* .weekly-review-goals-list, */
        /* .weekly-review-drc-card, */
        .weekly-review-event-selector {
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure tables span full width and have consistent styling */
        .weekly-review-trades-table,
        .weekly-review-setup-table {
          width: 100% !important;
          overflow-x: auto !important;
          margin-bottom: 16px !important;
        }

        /* Table styling with high specificity for consistent rendering */
        .weekly-review-trades-table table,
        .weekly-review-setup-table table {
          width: 100% !important;
          border-collapse: collapse !important;
          font-size: 14px !important;
          text-align: left !important;
          margin: 0 !important;
          table-layout: auto !important;
        }

        /* Table headers */
        .weekly-review-trades-table th,
        .weekly-review-setup-table th {
          padding: 10px 12px !important;
          border-bottom: 2px solid var(--background-modifier-border) !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          background-color: var(--background-secondary) !important;
          text-align: left !important;
          white-space: nowrap !important;
        }

        /* Table cells */
        .weekly-review-trades-table td,
        .weekly-review-setup-table td {
          padding: 8px 12px !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          text-align: left !important;
          transition: background-color 0.2s ease !important;
        }

        /* Clickable trade rows */
        .weekly-review-trade-row {
          cursor: pointer !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-trade-row:hover {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Hover effect for table rows */
        .weekly-review-trades-table tr:hover td,
        .weekly-review-setup-table tr:hover td {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Ensure color styles are properly applied in table cells */
        .weekly-review-trades-table td[style*="color: var(--color-green)"],
        .weekly-review-setup-table td[style*="color: var(--color-green)"] {
          color: var(--color-green, #43a047) !important;
        }

        .weekly-review-trades-table td[style*="color: var(--color-red)"],
        .weekly-review-setup-table td[style*="color: var(--color-red)"] {
          color: var(--color-red, #e53935) !important;
        }

        /* Best/Worst Trade section styles */
.weekly-review-best-trade {
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 6px !important;
        overflow: hidden !important;
        background-color: var(--background-secondary) !important;
}

/* Added styling for the notes section with tags and mistakes */
.weekly-review-best-trade-notes {
        padding: 0 16px 12px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
}

/* Special styling for best/worst trades */
.weekly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green, #43a047) !important;
}

.weekly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red, #e53935) !important;
}

        .weekly-review-best-trade-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          padding: 12px 16px !important;
          background-color: var(--background-secondary-alt, var(--background-secondary)) !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
        }

        .weekly-review-best-trade-details {
          padding: 12px 16px !important;
        }

        .weekly-review-best-trade-detail {
          margin-bottom: 6px !important; /* Reduced from 8px for more even spacing */
          display: flex !important;
          align-items: center !important;
          width: 100% !important;
        }
        
        /* Last detail item should have no bottom margin */
        .weekly-review-best-trade-detail:last-child {
          margin-bottom: 0 !important;
        }

        .weekly-review-best-trade-label {
          font-weight: 500 !important;
          width: 80px !important;
          color: var(--text-muted) !important;
        }

        .weekly-review-view-button {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border: none !important;
          border-radius: 4px !important;
          padding: 8px 16px !important;
          font-size: 14px !important;
          cursor: pointer !important;
          margin-top: 8px !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-view-button:hover {
          background-color: var(--interactive-accent-hover) !important;
        }

        .weekly-review-view-button:disabled {
          opacity: 0.5 !important;
          cursor: not-allowed !important;
        }

        .weekly-review-best-trade-actions {
          padding: 0 16px 16px !important;
          display: flex !important;
          justify-content: flex-end !important;
        }
        
        /* Force proper styling for tags and mistakes section */
        .weekly-review-best-trade-notes {
          padding: 0 16px 12px !important;
          display: flex !important;
          flex-direction: column !important;
          gap: 8px !important;
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure charts span full width */
        .recharts-responsive-container {
          width: 100% !important;
        }

        /* Force layout of header to match DRC style exactly */
        .weekly-review-header {
          padding: 16px 20px 12px !important;
          background-color: var(--background-secondary) !important;
          text-align: center !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          display: block !important;
          flex-direction: unset !important;
          box-sizing: border-box !important;
          width: 100% !important;
        }

        .weekly-review-date {
          font-size: 18px !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          margin-bottom: 12px !important;
          text-align: center !important;
        }

        .weekly-review-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
          display: block !important;
          /* Removed margin overrides from invalid file */
        }

        .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Higher specificity for navigation buttons */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          gap: 6px !important;
          /* Flex restored */
          flex: 1 !important;
          justify-content: center !important;
          text-align: center !important;
          min-width: 120px !important;
        }

        /* Extra specificity for hover state */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        html .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover {
          background-color: var(--background-modifier-hover) !important;
          transform: translateY(-1px) !important;
        }

        /* Fix for nav icon in weekly review - higher specificity */
        body .weekly-review-nav-button .nav-icon,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }

        /* Enhanced duplicate prevention for weekly review components */
        /* First rule: Hide any weekly review view that comes after another one */
        .markdown-preview-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        .markdown-reading-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        /* Second rule: Hide direct duplicates */
        .markdown-preview-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        .markdown-reading-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        /* Third rule: Hide duplicate wrappers */
        .weekly-review-wrapper + .weekly-review-wrapper {
          display: none !important; /* Hide any second Weekly Review component that appears after another one */
        }

        /* Ensure we never show multiple instances in any mode - additional rules */
        /* Add data-view-mode attribute based rules */
        [data-view-mode="preview"] + [data-view-mode="preview"],
        [data-view-mode="source"] + [data-view-mode="source"],
        /* Strict duplicate prevention by adding direct adjacency rules */
        .journalit-weekly-review-view + .journalit-weekly-review-view,
        [data-view-mode="read"] + [data-view-mode="read"],
        [data-view-mode="read"] + [data-view-mode="read-fallback"],
        [data-view-mode="read-fallback"] + [data-view-mode="read"] {
          display: none !important;
        }

        /* Ultra-high specificity rule for weekly review navigation buttons container */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Ultra-high specificity rule for each weekly navigation button */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
        }

        /* Fix mobile layout */
        @media (max-width: 768px) {
          .weekly-review-navigation-links {
            justify-content: center !important;
            flex-wrap: wrap !important;
            width: 100% !important;
          }

          .weekly-review-nav-button {
            flex: 1 !important;
            min-width: 120px !important;
            justify-content: center !important;
          }
        }
      `,document.head.appendChild(t)}}catch(e){console.error("Failed to apply Weekly Review alignment fix:",e)}}function fv(){if(document.getElementById("weekly-review-styles")||UD(),DQ(),!document.getElementById("critical-weekly-review-styles")){let e=document.createElement("style");e.id="critical-weekly-review-styles",e.textContent=`
      /* Critical core styles for Weekly Review */
      .journalit-weekly-review-view {
        display: block !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        z-index: 100 !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .weekly-review-wrapper {
        display: block !important; /* Changed from flex */
        width: 100% !important;
        position: relative !important;
        z-index: 100 !important;
      }

      .weekly-review-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
      }

      .weekly-review-content {
        display: block !important; /* Ensure content area displays */
        width: 100% !important;
      }

      /* Critical navigation button styling - highest possible specificity (Restored) */
       html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
         /* Keeping basic display/visibility, detailed styles in ensureAlignmentFix */
         display: flex !important;
         visibility: visible !important;
         opacity: 1 !important;
       }

       /* Removed duplicate .weekly-review-wrapper, .container, .content rules */
    `,document.head.appendChild(e)}}var PQ,gv=te(()=>{PQ=`
/* Color variables for event colors and consistency */
:root {
  --chart-positive: var(--color-green, #43a047);
  --chart-negative: var(--color-red, #e53935);
  --event-color-red: var(--color-red, #e53935);
  --event-color-orange: var(--color-orange, #fb8c00);
  --event-color-yellow: var(--color-yellow, #fdd835);
  --event-color-gray: var(--text-muted, #888888); /* Use muted text color as base for gray */
  --event-text-color-on-dark: #ffffff; /* Text color for darker backgrounds */
  --event-text-color-on-light: #000000; /* Text color for lighter backgrounds (like yellow) */
  --interactive-accent-rgb: 83, 141, 226; /* Default RGB values for interactive accent - synced with tradeForm */
}

/* Weekly Review View container - ensures no extra margins/padding */
.journalit-weekly-review-view,
.markdown-preview-view .journalit-weekly-review-view {
  margin: 0 !important; /* Remove all margins */
  border-bottom: none !important; /* Remove bottom border causing extra space */
  padding: 0 !important; /* Remove all padding */
  display: block !important;
  width: 100% !important;
  z-index: 100 !important;
  /* Force visibility */
  visibility: visible !important;
  opacity: 1 !important;
  background-color: var(--background-primary) !important;
  /* Removed borders */
  border: none !important;
  border-radius: 8px !important;
  /* Ensure proper containment */
  position: relative;
  box-sizing: border-box;
  /* Prevent overlaps */
  contain: content;
  /* Ensure proper isolation from other views */
  isolation: isolate;
}

/* Weekly Review React root wrapper */
.weekly-review-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  contain: content;
  /* Keep React root fully contained */
  isolation: isolate;
  /* Create a new stacking context */
  position: relative;
  /* Ensure clean slate for each instance */
  box-sizing: border-box;
  margin: 0 !important;
  z-index: 100 !important;
}


/* Weekly Review Container */
.weekly-review-container {
  display: flex;
  flex-direction: column;
  font-family: var(--font-text);
  color: var(--text-normal);
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  position: relative; /* Establish positioning context to prevent jumping */
  z-index: 1; /* Ensure proper stacking context */
  transform: translateZ(0); /* Force GPU acceleration for stability */
  will-change: auto !important; /* Prevent aggressive optimization */
  contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
}

/* Header and Navigation - Styled to match DRC */
.weekly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-date {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 12px;
}

/* Navigation - Matches DRC navigation */
.weekly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
}

.weekly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100% !important;
}

.weekly-review-nav-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
}

.weekly-review-nav-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.weekly-review-nav-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.nav-icon {
  font-size: 14px;
  margin-right: 4px;
  margin-left: 4px;
}

/* Critical navigation styles with high specificity */
html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 8px !important;
  flex-wrap: wrap !important;
  width: 100% !important;
}

html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
  padding: 8px 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
  font-size: 14px !important;
  transition: all 0.2s !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
  flex: 1 !important;
  text-align: center !important;
  min-width: 120px !important;
  box-sizing: border-box !important;
  max-width: none !important;
  margin: 0 !important;
}

/* Ensure proper icon spacing */
html body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon,
body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
  font-size: 16px !important;
  line-height: 1 !important;
}

/* Tabs */
.weekly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.weekly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.weekly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.weekly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.weekly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Content */
.weekly-review-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0 0; /* Only top padding, no horizontal padding */
}

/* Sections */
.weekly-review-section {
  margin: 0 0 24px 0; /* Explicit horizontal margin of 0 */
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 16px;
  width: 100%; /* Ensure full width */
  box-sizing: border-box; /* Include padding in width calculation */
}

.weekly-review-section-title {
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  text-align: center;
}

/* Fix Section title styling - especially for Previous Week Goals */
.weekly-review-previous-goals h3,
.weekly-review-section h3 {
  font-size: 1rem !important;
  margin-top: 0.5rem !important;
  margin-bottom: 1rem !important;
  text-align: center !important;
  font-weight: 600 !important;
  color: var(--text-normal) !important;
  padding-bottom: 0.5rem !important;
  border-bottom: 1px solid var(--background-modifier-border) !important;
}

/* Empty states */
.weekly-review-empty-state,
.weekly-review-no-trades,
.weekly-review-no-drcs,
.weekly-review-no-events,
.weekly-review-no-questions {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

/* Checklist for previous goals - Modified for 2-column grid layout */
.weekly-review-checklist {
  display: grid; /* Changed from flex */
  grid-template-columns: repeat(2, 1fr); /* Create two equal columns */
  gap: 12px; /* Increased gap for grid layout */
}

.weekly-review-checklist-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 4px;
  background-color: var(--background-secondary);
  cursor: pointer; /* Make the entire area clickable */
  transition: background-color 0.2s ease;
}

.weekly-review-checklist-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-checkbox {
  width: 18px;
  height: 18px;
  margin: 0;
  cursor: pointer;
}

/* Key Events */
.weekly-review-key-events {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-event-selector {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
}

/* ComboBox styling - matched with DRC implementation */
.weekly-review-container .combobox-container,
.weekly-review-container [data-combobox-type],
.weekly-review-event-selector .combobox-container,
.weekly-review-section .combobox-container {
  position: relative !important;
  width: 100% !important;
  margin-bottom: 8px !important;
  z-index: 10 !important;
}

/* Increased z-index when dropdown is open */
.weekly-review-container .combobox-container[data-is-open="true"],
.weekly-review-container [data-combobox-type][data-is-open="true"],
.weekly-review-event-selector .combobox-container[data-is-open="true"],
.weekly-review-section .combobox-container[data-is-open="true"] {
  z-index: 9999 !important;
}

/* Dropdown caret for Weekly Review ComboBox */
.weekly-review-container [data-combobox-type] .input-container::after,
.weekly-review-event-selector .combobox-container .input-container::after,
.weekly-review-section .combobox-container .input-container::after {
  content: "" !important;
  position: absolute !important;
  right: 12px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 0 !important;
  height: 0 !important;
  border-left: 5px solid transparent !important;
  border-right: 5px solid transparent !important;
  border-top: 5px solid var(--text-normal) !important;
  pointer-events: none !important;
  z-index: 10 !important;
}

/* Input padding to make room for dropdown arrow */
.weekly-review-container [data-combobox-type] input[role="combobox"],
.weekly-review-event-selector .combobox-container input[role="combobox"],
.weekly-review-section .combobox-container input[role="combobox"] {
  padding-right: 30px !important;
  width: 100% !important;
  padding: 8px 12px !important;
  padding-right: 30px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  font-size: 16px !important;
  cursor: pointer !important;
  position: relative !important;
  z-index: 10000 !important; /* Higher than dropdown (9999) to ensure focus border shows on top */
}

/* Input field focus styling - ensure focus outlines appear above dropdown */
.weekly-review-container [data-combobox-type] input[role="combobox"]:focus,
.weekly-review-event-selector .combobox-container input[role="combobox"]:focus,
.weekly-review-section .combobox-container input[role="combobox"]:focus {
  outline: 2px solid var(--interactive-accent) !important; /* Match Obsidian's focus style */
  outline-offset: -1px !important;
  border-color: var(--interactive-accent) !important;
  box-shadow: 0 0 0 1px var(--interactive-accent) !important;
  z-index: 10001 !important; /* Ensure focus styling is above even the input */
}

/* Weekly Review dropdown options - remove bullets and match DRC */
.weekly-review-container [data-combobox-type] ul[role="listbox"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-top: none !important;
  border-radius: 0 0 4px 4px !important;
  margin-top: -1px !important;
  z-index: 9999 !important;
  list-style: none !important; /* Remove bullets */
  padding: 0 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  clip-path: inset(1px -15px -15px -15px) !important; /* Clip top edge to prevent covering the focus border */
}

/* Weekly Review dropdown options styling */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li {
  padding: 8px 12px !important;
  cursor: pointer !important;
  transition: background-color 150ms ease !important;
  margin: 0 !important;
  list-style: none !important; /* Ensure no bullets */
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
}

/* Hover and selected state for Weekly Review dropdown options */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
  background-color: var(--background-secondary) !important;
}

/* Special styling for "Add new" option in Weekly Review */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
  font-style: italic !important;
  border-top: 1px dashed var(--background-modifier-border) !important;
}

/* When dropdown is open, change input border radius */
.weekly-review-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-event-selector [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-section [data-combobox-type][data-is-open="true"] input[role="combobox"] {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* Weekly Review Multi-select styling - fixed for better visibility */
.weekly-review-event-selector .selected-options,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-options,
.weekly-review-section .selected-item,
.weekly-review-container [data-combobox-type="multi"] > div:first-of-type {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 4px !important;
  max-width: 100% !important;
  padding: 2px 0 !important;
  z-index: 5 !important;
  position: relative !important;
}

/* Style selected tags to match the DRC */
.weekly-review-event-selector .selected-option,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-option,
.weekly-review-section .selected-item {
  display: inline-flex !important;
  align-items: center !important;
  background-color: var(--interactive-accent, #7c3aed) !important;
  color: white !important;
  border-radius: 4px !important;
  padding: 4px 8px !important;
  font-size: 12px !important;
  margin: 0 4px 4px 0 !important;
  font-weight: 500 !important;
  z-index: 6 !important;
  position: relative !important;
  gap: 6px !important;
}

/* Style remove buttons ('\xD7') - matched with DRC */
.weekly-review-event-selector .selected-option-remove,
.weekly-review-event-selector .selected-item button,
.weekly-review-section .selected-option-remove,
.weekly-review-section .selected-item button {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  padding: 0 !important;
  margin-left: 4px !important;
  cursor: pointer !important;
  background: rgba(255, 255, 255, 0.2) !important;
  border: none !important;
  border-radius: 50% !important;
  color: white !important;
  font-size: 14px !important;
  line-height: 1 !important;
  text-align: center !important;
  z-index: 7 !important;
  position: relative !important;
  transition: background-color 0.2s !important;
}

/* Add hover effect for remove buttons */
.weekly-review-event-selector .selected-option-remove:hover,
.weekly-review-event-selector .selected-item button:hover,
.weekly-review-section .selected-option-remove:hover,
.weekly-review-section .selected-item button:hover {
  background: rgba(255, 255, 255, 0.4) !important;
}

/* ADDED: Styles for the event color picker UI */
.weekly-review-event-color-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-color-selector span { /* Style the "Color:" text */
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-color-selector label {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.weekly-review-event-color-selector input[type="radio"] {
  margin-right: 4px;
  cursor: pointer;
  /* Consider using appearance: none and custom styling */
}

.weekly-review-event-color-selector label span { /* Style the colored circle */
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--background-modifier-border);
}
/* END ADDED color picker styles */


.weekly-review-events-list {
  display: flex;
  flex-direction: column;
  gap: 12px; /* Changed from 12px to 10px in invalid file, reverting */
}

/* MODIFIED: Event item styling with color-specific borders */
.weekly-review-event-item {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border-left: 5px solid var(--event-color-gray); /* Default border color */
  margin-bottom: 8px; /* Add some spacing */
  transition: border-color 0.3s ease; /* Smooth transition for border color */
}

/* ADDED: Event color classes */
.weekly-review-event-item.event-color-red {
  border-left-color: var(--event-color-red);
}
.weekly-review-event-item.event-color-orange {
  border-left-color: var(--event-color-orange);
}
.weekly-review-event-item.event-color-yellow {
  border-left-color: var(--event-color-yellow);
}
.weekly-review-event-item.event-color-gray {
  border-left-color: var(--event-color-gray);
}
/* END ADDED color classes */

/* Day selector styling */
.weekly-review-event-day-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-day-selector span {
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-day-selector select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  width: 150px;
}

/* Day badge in event items */
.weekly-review-event-day {
  font-size: 12px;
  padding: 2px 8px;
  background-color: var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-normal);
  font-weight: 500;
  white-space: nowrap;
}

.weekly-review-event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.weekly-review-event-header h4 {
  margin: 0;
  font-size: 14px; /* Restored from 1.05em */
  font-weight: 600;
}

/* Forecast */
.weekly-review-forecast-section {
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--background-secondary); /* Restored from primary-alt */
  border-radius: 8px; /* Restored from 5px */
}

.weekly-review-forecast-section h4 { /* Added missing styling */
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 1.05em; /* Keep consistent sizing */
}

.weekly-review-image-container {
  margin-bottom: 12px; /* Restored from 15px */
}

.weekly-review-image {
  position: relative;
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px;
  background-color: var(--background-primary);
}

.weekly-review-forecast-image {
  width: auto; /* Allow natural width */
  max-width: 100%; /* Prevent overflow */
  max-height: 300px; /* Limit height */
  object-fit: contain; /* Maintain aspect ratio */
  border-radius: 6px;
  margin-bottom: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Add subtle shadow */
  background-color: var(--background-primary); /* Ensure transparent PNGs have a background */
}

.weekly-review-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 80px;
  border: 2px dashed var(--background-modifier-border);
  border-radius: 6px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.weekly-review-image-upload:hover {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
}

.weekly-review-image-upload.dragging-over {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
  transform: scale(1.02);
  box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
}

.weekly-review-image-upload::after {
  content: "Drag and drop here";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 16px;
  font-weight: 600;
  color: var(--interactive-accent);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.weekly-review-image-upload.dragging-over::after {
  opacity: 1;
}

.weekly-review-image-upload.dragging-over .weekly-review-image-label {
  opacity: 0;
}

.weekly-review-image-label {
  font-size: 14px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.weekly-review-image-upload:hover .weekly-review-image-label {
  color: var(--interactive-accent);
}

.weekly-review-image-input {
  display: none;
}

.weekly-review-image-delete {
  /* Position restored from absolute in invalid file */
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
  /* Remove transition/opacity from invalid file */
}

/* Buttons */
.weekly-review-add-button {
  background-color: var(--interactive-accent);
  color: white; /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 8px 16px; /* Restored */
  font-size: 14px; /* Restored */
  cursor: pointer;
  font-weight: normal; /* Reset from invalid file */
  /* Removed align-self from invalid file, handled by container */
}

.weekly-review-add-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-add-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.weekly-review-remove-button,
.weekly-review-event-remove { /* Combined rule restored */
  background-color: rgba(229, 57, 53, 0.1); /* Restored from var */
  color: var(--color-error, #e53935); /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
}

/* Image error message */
.weekly-review-image-error {
  color: var(--text-error, var(--color-red, #e53935));
  font-size: 12px;
  text-align: center;
  margin-top: 4px;
  margin-bottom: 8px;
  padding: 6px 10px;
  background-color: rgba(229, 57, 53, 0.1);
  border-radius: 4px;
  width: 100%;
}

.weekly-review-remove-button:hover,
.weekly-review-event-remove:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-add-event { /* This class seems unused, keeping for history */
  align-self: flex-start;
  margin-top: 12px;
}

/* Text Areas and Inputs */
.weekly-review-textarea {
  width: 100%;
  min-height: 80px; /* Restored from 100px */
  padding: 12px; /* Restored from 10px */
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px; /* Restored from 4px */
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text); /* Added back */
  font-size: 16px; /* Updated from unset */
  resize: vertical;
}

.weekly-review-input { /* For generic inputs if used */
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text);
  font-size: 16px;
}

/* Metric Cards */
.weekly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.weekly-review-metric-card {
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  transition: transform 0.2s ease;
}

.weekly-review-metric-card:hover {
  transform: translateY(-2px);
}

.weekly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.weekly-review-metric-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-normal);
}

.weekly-review-metric-value[style*="color: var(--color-green)"],
.weekly-review-metric-value[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-metric-value.positive { /* Added specific class */
  color: var(--chart-positive) !important;
}

.weekly-review-metric-value[style*="color: var(--color-red)"],
.weekly-review-metric-value[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-metric-value.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}


/* Trades list */
.weekly-review-trades {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.weekly-review-trade-item { /* Used if list view is implemented */
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-trade-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.weekly-review-trade-instrument {
  font-weight: 600;
}

.weekly-review-trade-direction {
  color: var(--text-muted);
  font-size: 12px;
}

.weekly-review-trade-pnl {
  font-weight: 600;
}

.weekly-review-trade-pnl[style*="color: var(--color-green)"],
.weekly-review-trade-pnl[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-trade-pnl.positive { /* Added specific class */
   color: var(--chart-positive) !important;
}

.weekly-review-trade-pnl[style*="color: var(--color-red)"],
.weekly-review-trade-pnl[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-trade-pnl.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}

/* Performance Grades */
.weekly-review-grades { /* Restored simple container */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-grade-item { /* Restored simpler item */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-grade-label {
  font-size: 14px; /* Restored */
  font-weight: 500;
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* Performance grade stars */
.weekly-review-grade-stars {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  position: relative;
}

.weekly-review-star {
  cursor: pointer;
  color: var(--text-muted);
  transition: color 0.2s ease;
  font-size: 1.5em;
  user-select: none;
  position: relative;
  display: inline-block;
  width: 1em;
  height: 1em;
  line-height: 1;
  text-align: center;
}

.weekly-review-star.full {
  color: gold !important;
}

.weekly-review-star.half {
  position: relative;
  color: var(--text-muted);
}

.weekly-review-star.half::after {
  content: "\u2605";
  position: absolute;
  left: 0;
  top: 0;
  width: 50%;
  overflow: hidden;
  color: gold !important;
  pointer-events: none;
}

/* Tooltip for star rating help */
.weekly-review-grade-stars::after {
  content: "Left click for full star, right click for half star";
  position: absolute;
  font-size: 10px;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.3s ease;
  margin-top: 30px;
  background: var(--background-primary);
  padding: 4px 8px;
  border-radius: 4px;
  pointer-events: none;
  border: 1px solid var(--background-modifier-border);
  white-space: nowrap;
  z-index: 100;
}

.weekly-review-grade-stars:hover::after {
  opacity: 1;
}


/* Daily Report Cards (DRCs) List - Modernized Styling */
.weekly-review-drcs {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* DRC List Container */
.weekly-review-drc-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
}

/* DRC Card Container - modern card styling */
.weekly-review-drc-card {
  background-color: var(--background-primary);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  border: 1px solid var(--background-modifier-border);
}

/* DRC Header with date, grades and button */
.weekly-review-drc-header {
  background-color: var(--background-secondary-alt, var(--background-secondary));
  padding: 10px 16px; /* Reduced padding */
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-drc-date {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-normal);
  flex: 1;
}

/* Grade Pills in the center */
.weekly-review-drc-grades {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex: 2;
}

.weekly-review-drc-grade {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 4px;
  background-color: var(--background-secondary-alt, var(--background-secondary));
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  line-height: 1;
  color: white;
}

/* Color coding for grades */
.weekly-review-drc-grade.grade-a {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade.grade-b {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade.grade-c {
  background-color: var(--color-red, #e53935);
}

/* Fallback for direct text matching if classes aren't applied */
.weekly-review-drc-grade[data-grade="A"] {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade[data-grade="B"] {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade[data-grade="C"] {
  background-color: var(--color-red, #e53935);
}

/* DRC Content Area */
.weekly-review-drc-summary {
  padding: 14px 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background-color: var(--background-primary-alt, var(--background-primary));
}

.weekly-review-drc-section {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

.weekly-review-drc-section-label {
  font-weight: 500;
  font-size: 13px;
  margin-bottom: 6px;
  color: var(--text-accent);
}

.weekly-review-drc-section-content {
  font-size: 14px;
  line-height: 1.5;
  color: var(--text-normal);
  white-space: pre-line;
  overflow-wrap: break-word;
}

/* DRC Actions Area - now in header */
.weekly-review-drc-actions {
  display: flex;
  justify-content: flex-end;
  flex: 1;
}

.weekly-review-drc-button {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent, white);
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.weekly-review-drc-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-drc-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Legacy DRC item style for compatibility */
.weekly-review-drc-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-drc-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Review Questions Section */
.weekly-review-questions { /* Restored */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-question-section { /* Added back if used */
  margin-bottom: 15px;
}

.weekly-review-question { /* For individual question container */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-question-text { /* For the text of the question */
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-normal);
}

/* Goals Section Restored */
.weekly-review-goal-input {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.weekly-review-goal-input input {
  flex: 1;
  padding: 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}
.weekly-review-goals-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-review-goal-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background-color: var(--background-secondary);
  border-radius: 4px;
}


/* Chart Tooltip */
.weekly-review-chart-tooltip {
  background-color: var(--background-primary) !important;
  border-radius: 10px !important;
  padding: 14px 18px !important;
  border: 1px solid var(--background-modifier-border) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2) !important;
}

.weekly-review-tooltip-setup,
.weekly-review-tooltip-date {
  font-size: 14px !important;
  font-weight: 500 !important;
  color: var(--text-normal) !important;
  margin-bottom: 8px !important;
  text-align: center !important;
}

.weekly-review-tooltip-value {
  font-size: 20px !important;
  font-weight: 600 !important;
  text-align: center !important;
}

.weekly-review-tooltip-value.positive {
  color: var(--chart-positive) !important;
}

.weekly-review-tooltip-value.negative {
  color: var(--chart-negative) !important;
}

.weekly-review-tooltip-info {
  font-size: 12px !important;
  color: var(--text-muted) !important;
  margin-top: 6px !important;
  text-align: center !important;
}

/* Responsive Styles */
@media (max-width: 768px) {
  .weekly-review-metric-cards {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }

  .weekly-review-navigation-links {
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
  }

  .weekly-review-nav-button {
    flex: 1;
    min-width: 120px;
    justify-content: center;
  }

  .weekly-review-tab {
    padding: 10px 12px;
    font-size: 13px;
  }

  /* Added back */
  .weekly-review-tabs {
    flex-wrap: wrap;
  }
  .weekly-review-tab {
    flex-grow: 1;
    text-align: center;
  }
}

/* Removed duplicate :root block */

/* Fullscreen Image Styles */
.weekly-review-fullscreen-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.85);
  z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-in-out;
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  cursor: pointer;
}

.weekly-review-fullscreen-content {
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
  animation: zoomIn 0.3s ease-in-out;
  overflow: hidden;
  cursor: default;
}

.weekly-review-fullscreen-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background-color: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-fullscreen-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
}

.weekly-review-fullscreen-close {
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
}

.weekly-review-fullscreen-close:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-fullscreen-image-container {
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background-color: var(--background-primary);
  max-height: calc(90vh - 120px);
  /* Add subtle grid background for transparency */
  background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

.weekly-review-fullscreen-image {
  max-width: 100%;
  max-height: calc(90vh - 120px);
  object-fit: contain;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.weekly-review-fullscreen-footer {
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  text-align: center;
}

.weekly-review-fullscreen-footer p {
  margin: 0;
  font-size: 12px;
  color: var(--text-muted);
}

/* Info text for guidance */
.weekly-review-info-text {
  padding: 10px 14px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-primary-alt, var(--background-secondary));
  border-radius: 6px;
  border-left: 3px solid var(--text-accent);
  margin-top: 8px;
  font-size: 14px;
}

/* Add hint that images can be clicked and held */
.weekly-review-forecast-image {
  cursor: zoom-in !important;
  position: relative;
}

.weekly-review-forecast-image::after {
  content: "Click or hold to enlarge";
  position: absolute;
  bottom: 8px;
  right: 8px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.weekly-review-forecast-image:hover::after {
  opacity: 1;
}

/* Enhanced PnL values for better visibility */
.weekly-review-best-trade-pnl {
  font-size: 20px !important;
  font-weight: 700 !important;
  padding: 4px 10px !important;
  border-radius: 4px !important;
  display: inline-block !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-green)"] {
  background-color: rgba(67, 160, 71, 0.15) !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-red)"] {
  background-color: rgba(229, 57, 53, 0.15) !important;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoomIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* Metadata container positioning fix to prevent jumping */
.metadata-container {
  position: relative !important;
  z-index: 1 !important;
  transform: translateZ(0) !important;
  will-change: auto !important;
}

/* Prevent parent containers from affecting child positioning during re-renders */
.workspace-leaf-content[data-type="journalit-weekly-review"],
.view-content,
.markdown-source-view,
.markdown-preview-view {
  position: relative !important;
  overflow: auto !important;
}

/* Ensure proper stacking context for nested scrollable elements */
.weekly-tabs-content,
.tab-content {
  position: relative !important;
  z-index: 1 !important;
}

/* Prevent layout shift from margin collapsing */
.weekly-review-container::before {
  content: '';
  display: table;
}

/* Fix for when Obsidian adds inline styles during re-render */
.metadata-container[style*="position"] {
  position: relative !important;
}

/* Ensure dropdowns and inputs don't cause layout shifts */
.weekly-review-container select,
.weekly-review-container input,
.weekly-review-container textarea {
  box-sizing: border-box !important;
  max-width: 100% !important;
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .weekly-review-container input[role="combobox"],
  .weekly-review-container input,
  .weekly-review-container textarea,
  .weekly-review-textarea,
  .weekly-review-input,
  .weekly-review-goal-input input {
    font-size: 18px !important;
  }
}
`});var l$,c$=te(()=>{l$=`
/* Monthly Review Container */
.monthly-review {
  width: 100%;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.monthly-review-title {
  text-align: center;
  margin-bottom: 20px;
  font-size: 28px;
  font-weight: 600;
}

/* Monthly Review Content */
.monthly-review-content {
  margin-top: 8px;
}

/* Section Styles */
.monthly-review-section {
  margin-bottom: 20px;
  background: var(--background-primary-alt);
  padding: 20px;
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.monthly-review-section-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: var(--text-normal);
  text-align: center;
}

.monthly-review-section-description {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 15px;
}

/* Metric Cards */
.monthly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.monthly-review-metric-card {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 15px;
  text-align: center;
}

.monthly-review-metric-card.highlight-card {
  position: relative;
}

.monthly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.monthly-review-metric-value {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-normal);
}

.monthly-review-metric-detail {
  font-size: 14px;
  color: var(--text-muted);
  margin-top: 4px;
}

/* Best/Worst Trade Cards */
.monthly-review-best-trade {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 20px;
}

.monthly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green);
}

.monthly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red);
}

.monthly-review-best-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.monthly-review-best-trade-title {
  font-size: 16px;
  font-weight: 600;
}

.monthly-review-best-trade-pnl {
  font-size: 20px;
  font-weight: 600;
}

.monthly-review-best-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.monthly-review-best-trade-detail {
  display: flex;
  gap: 8px;
  font-size: 14px;
}

.monthly-review-best-trade-label {
  color: var(--text-muted);
  font-weight: 500;
}

.monthly-review-best-trade-value {
  color: var(--text-normal);
}

.monthly-review-best-trade-actions {
  margin-top: 15px;
}

.monthly-review-view-button {
  padding: 6px 12px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.monthly-review-view-button:hover {
  background: var(--interactive-accent-hover);
}

.monthly-review-link-button {
  padding: 4px 8px;
  background: transparent;
  color: var(--text-accent);
  border: 1px solid var(--text-accent);
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  margin-top: 8px;
}

.monthly-review-link-button:hover {
  background: var(--text-accent);
  color: var(--text-on-accent);
}

/* Week Highlights */
.monthly-review-week-highlights {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

/* Weekly Performance Table */
.monthly-review-trades-table {
  width: 100%;
  overflow-x: auto;
}

.monthly-review-trades-table table {
  width: 100%;
  border-collapse: collapse;
}

.monthly-review-trades-table th,
.monthly-review-trades-table td {
  padding: 10px;
  text-align: left;
  border-bottom: 1px solid var(--background-modifier-border);
}

.monthly-review-trades-table th {
  font-weight: 600;
  color: var(--text-muted);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.monthly-review-trade-row {
  cursor: pointer;
  transition: background-color 0.2s;
}

.monthly-review-trade-row:hover {
  background: var(--background-modifier-hover);
}

/* Demon Tracker Styles */
.demon-tracker-container {
  margin-top: 15px;
}

.demon-tracker-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
}

.demon-tracker-table th,
.demon-tracker-table td {
  padding: 12px;
  text-align: center;
  border-right: 1px solid var(--background-modifier-border);
}

.demon-tracker-table th:last-child,
.demon-tracker-table td:last-child {
  border-right: none;
}

.demon-tracker-header {
  background: var(--background-secondary);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.demon-tracker-header.stop-trading {
  background: var(--background-modifier-error);
  color: var(--text-error);
}

.demon-tracker-row {
  border-top: 1px solid var(--background-modifier-border);
}

.demon-tracker-row:hover {
  background: var(--background-modifier-hover);
}

.demon-name {
  text-align: left;
  font-weight: 500;
  color: var(--text-normal);
}

.demon-occurrence {
  position: relative;
}

.demon-x {
  color: var(--text-error);
  font-weight: 600;
  font-size: 18px;
}

.demon-x.stop {
  color: var(--text-on-accent);
  background: var(--background-modifier-error);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.demon-empty {
  color: var(--text-faint);
  font-size: 14px;
}

/* Demon Tracker Summary */
.demon-tracker-summary {
  margin-top: 20px;
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.demon-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.demon-summary-label {
  font-size: 14px;
  color: var(--text-muted);
}

.demon-summary-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.demon-summary-item.warning .demon-summary-value {
  color: var(--text-error);
}

/* Review Content Placeholder */
.monthly-review-content-placeholder {
  padding: 40px;
  text-align: center;
  color: var(--text-muted);
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px dashed var(--background-modifier-border);
}

/* Navigation */
.monthly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  margin-bottom: 8px;
}

.monthly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100%;
}

.monthly-review-navigation-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
  box-sizing: border-box;
}

.monthly-review-navigation-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.monthly-review-navigation-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Tab Navigation */
.monthly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
  margin-bottom: 8px;
}

.monthly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.monthly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.monthly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.monthly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Charts */
.monthly-review-overview .recharts-responsive-container {
  margin: 0 auto;
}

/* Overview Tab */
.monthly-review-overview {
  padding-top: 4px;
}

/* Review Tab */
.monthly-review-review {
  padding-top: 4px;
}

/* Reduce spacing for first elements in tab content */
.monthly-review-overview > *:first-child,
.monthly-review-review > *:first-child {
  margin-top: 0 !important;
}

/* Game Performance Tables */
.grade-count {
  text-align: center;
  font-weight: 600;
  padding: 8px;
}

.grade-count.grade-a {
  color: var(--color-green, #43a047);
}

.grade-count.grade-b {
  color: var(--color-orange, #fb8c00);
}

.grade-count.grade-c {
  color: var(--color-red, #e53935);
}

.rating-cell {
  text-align: center;
  font-weight: 600;
}

.notes-cell {
  max-width: 300px;
}

.notes-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.4;
  color: var(--text-muted);
  font-size: 13px;
}

.empty-performance-message {
  text-align: center;
  color: var(--text-muted);
  padding: 20px;
  font-style: italic;
}
`});function d$(){Ql||(Ql=document.createElement("style"),Ql.textContent=l$,Ql.id="journalit-monthly-review-styles",document.head.appendChild(Ql))}function EQ(){Ql&&(Ql.remove(),Ql=null)}function hv(){Ql||d$()}var Ql,Ew=te(()=>{ca();c$();Ql=null;re.monthlyReview={inject:d$,remove:EQ}});function qD(){if(document.head.querySelector("#settings-tab-styles"))return;let e=document.createElement("style");e.id="settings-tab-styles",e.textContent=AQ,document.head.appendChild(e)}var AQ,HD=te(()=>{AQ=`
  /* Fix for Custom Options edit input */
  .journalit-settings.journalit-settings-tab .option-edit-input {
    flex: 1 !important;
    margin-right: 12px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--interactive-accent) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    position: relative !important;
    z-index: 100 !important;
    min-width: 100px !important;
    pointer-events: auto !important;
    -webkit-user-select: text !important;
    user-select: text !important;
    cursor: text !important;
  }

  /* DRC, Weekly Review, and Custom Options Settings Styles */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    width: 100% !important;
    gap: 10px !important;
    margin-bottom: 16px !important;
    position: relative !important;
    padding: 4px 0 !important;
  }

  /* Override any Obsidian styling that might interfere */
  .journalit-settings.journalit-settings-tab .drc-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    height: 34px !important;
    line-height: normal !important;
    font-size: 16px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    width: 100% !important;
    height: 34px !important;
    max-height: 34px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Style Input component's internals */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputWrapper,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputWrapper {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
    height: 34px !important;
  }

  /* Style Input's invisible parent divs */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .setting-item-info div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info div {
    height: auto !important;
    min-height: 34px !important;
    width: 100% !important;
    position: relative !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-info,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info {
    margin-right: 10px !important;
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
  }

  /* Styles for the Add button */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-control,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-control {
    display: flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
    min-width: auto !important;
    flex-shrink: 0 !important;
  }

  /* Ensure buttons have consistent styling */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add button,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add button {
    min-width: 60px !important;
    height: 34px !important;
    max-height: 34px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 16px !important;
    font-weight: 500 !important;
    padding: 6px 12px !important;
    border-radius: 4px !important;
    background-color: var(--interactive-accent) !important;
    color: #ffffff !important;
    border: 1px solid var(--interactive-accent) !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings button:hover,
  .journalit-settings.journalit-settings-tab .weekly-review-settings button:hover {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  /* Direct styling for DRCSettingsTab, WeeklyReviewSettingsTab, and CustomOptionsTab input boxes */
  /* First, add general selector for all input boxes in custom-item-add */
  .journalit-settings .drc-settings .custom-item-add input,
  .journalit-settings .weekly-review-settings .custom-item-add input,
  .journalit-settings .custom-options-settings .custom-item-add input,
  /* Then, add specific selectors for known inputs */
  .journalit-settings input[placeholder="New checklist item"],
  .journalit-settings input[placeholder="New review question"],
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"],
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"],
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"] {
    height: 34px !important;
    width: 100% !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
    margin: 0 !important;
  }

  /* Focus styles for all input boxes */
  .journalit-settings .drc-settings .custom-item-add input:focus,
  .journalit-settings .weekly-review-settings .custom-item-add input:focus,
  .journalit-settings .custom-options-settings .custom-item-add input:focus,
  .journalit-settings input[placeholder="New checklist item"]:focus,
  .journalit-settings input[placeholder="New review question"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"]:focus {
    /* These focus styles ensure all input boxes have the same appearance when focused */
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Accordion Component Styles */
  .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: visible; /* Changed from hidden to visible */
    transition: box-shadow 0.2s ease;
  }

  .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .cmdr-accordion .cmdr-accordion-content {
    max-height: none; /* Removed the fixed max-height */
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: visible; /* Changed from hidden to visible for expanded state */
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Fix for Weekly Review accordion - Remove borders from inside accordion content to prevent duplicate borders
   * This ensures consistent styling between Daily Review and Weekly Review sections.
   * The issue was that the first setting-item inside the accordion had a border-top which created
   * a duplicate border when the accordion already has its own border.
   */
  .cmdr-accordion .cmdr-accordion-content .timeframe-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content .item-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > div > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > .setting-item:first-child {
    border-top: none !important;
  }

  /* Remove border around weekly-review-section to match daily-review-section */
  .cmdr-accordion .cmdr-accordion-content .weekly-review-section {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    background-color: transparent !important;
  }

  /* Style for consistent input heights/spacing specifically for the timeframe manager */
  .timeframe-manager .custom-item-add .inputContainer,
  .timeframe-manager .custom-item-add input {
    height: 34px !important;
    min-height: 34px !important;
    margin: 0 !important;
    width: 100% !important;
  }

  /* Collapsed state */
  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden; /* Keep hidden for collapsed state only */
  }
  
  /* Edit account form container - ensure proper layout */
  .journalit-settings .edit-account-form.setting-item-container,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    align-items: stretch !important;
  }

  /* Edit account buttons - updated layout for left-center-right arrangement */
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    width: 100% !important;
    margin-top: 16px !important;
    position: relative !important;
  }
  
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons .button-group-right,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons .button-group-right {
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
  }
  
  /* Force accounts to display in a single column */
  .journalit-settings .accounts-list,
  .journalit-settings.journalit-settings-tab .accounts-list {
    display: flex !important;
    flex-direction: column !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
  }

  .journalit-settings .account-items,
  .journalit-settings.journalit-settings-tab .account-items {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    flex-wrap: nowrap !important;
  }

  .journalit-settings .account-item,
  .journalit-settings.journalit-settings-tab .account-item {
    width: 100% !important;
  }

  /* MT Accounts List Styles */
  .mt-accounts-list {
    margin-top: 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    overflow: hidden;
  }

  .mt-account-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary);
  }

  .mt-account-item:last-child {
    border-bottom: none;
  }

  .mt-account-item:hover {
    background-color: var(--background-secondary);
  }

  .mt-account-info {
    flex: 1;
    min-width: 0;
  }

  .mt-account-id {
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 4px;
  }

  .mt-account-broker {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-bottom: 4px;
  }

  .mt-account-dates {
    color: var(--text-muted);
    font-size: 0.85em;
  }

  .mt-account-display {
    margin-left: 20px;
    min-width: 250px;
  }

  .mt-account-name {
    display: flex;
    align-items: center;
  }

  .mt-account-name span {
    font-weight: 500;
    color: var(--text-normal);
  }

  .mt-account-edit {
    display: flex;
    align-items: center;
  }

  .mt-account-edit input {
    background-color: var(--background-primary-alt);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    padding: 4px 8px;
    color: var(--text-normal);
  }

  .mt-account-edit input:focus {
    border-color: var(--interactive-accent);
    outline: none;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .journalit-settings.journalit-settings-tab input[type="text"],
    .journalit-settings.journalit-settings-tab .custom-item-add input,
    .journalit-settings input,
    .mt-account-edit input {
      font-size: 18px !important;
    }
  }
`});function NQ(){if(document.head.querySelector("#trade-note-styles"))return;let e=document.createElement("style");e.id="trade-note-styles",e.textContent=IQ,document.head.appendChild(e)}function Pu(){NQ()}var IQ,u$=te(()=>{IQ=`
  /**
   * Main container styles
   * These ensure proper containment and isolation of the TradeNote component
   */

  /* Main container */
  .journalit-trade-view,
  .trade-form-view-container .journalit-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Trade note React root wrapper */
  .journalit-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    /* Keep React root fully contained */
    isolation: isolate;
    /* Create a new stacking context */
    position: relative;
    /* Ensure clean slate for each instance */
    box-sizing: border-box;
  }
  
  .trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    /* Border removed per UI update request */
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
    /* Add a subtle distinguishing feature for easier debugging */
    transition: box-shadow 0.2s ease-in-out;
  }
  
  /* Header section with instrument and P&L */
  .trade-note-header {
    padding: 0.8rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
  }
  
  .trade-note-header.profit {
    background: linear-gradient(to right, rgba(102, 187, 106, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-success, #43a047);
  }
  
  .trade-note-header.loss {
    background: linear-gradient(to right, rgba(229, 57, 53, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-error, #e53935);
  }
  
  .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.1), var(--background-primary));
    border-left: 4px solid #2196f3;
  }
  
  .trade-instrument {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
    display: flex;
    align-items: center;
  }
  
  .trade-direction-icon {
    margin-right: 0.5rem;
    font-size: 1.3rem;
    line-height: 1;
  }
  
  /* Header actions container with edit button and PnL */
  .trade-header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  /* Edit button styling */
  .trade-edit-button {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    background-color: var(--interactive-accent);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .trade-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
  }
  
  .trade-edit-button svg {
    width: 14px;
    height: 14px;
  }

  .trade-pnl {
    font-size: 1.2rem;
    font-weight: 600;
  }
  
  .profit-text {
    color: var(--color-success, #43a047);
  }
  
  .loss-text {
    color: var(--color-error, #e53935);
  }
  
  .open-text {
    color: #2196f3;
    font-weight: 600;
  }
  
  /* Missed trade badge styling */
  .missed-trade-badge {
    background-color: var(--color-orange, #ff9800);
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Open trade badge styling */
  .open-trade-badge {
    background-color: #2196f3;
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Removed tabs navigation - single page layout */
  
  /* Single page content container */
  .trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem; /* Reduced gap to minimize wasted space between sections */
  }
  
  /* Trade overview section with metrics */
  .trade-overview-section {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 0;
    position: relative;
    margin-bottom: 0;
  }

  /* Metrics grid - single row */
  .trade-metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.8rem;
    margin-bottom: 0;
  }
  
  .metric-card {
    background-color: var(--background-primary);
    padding: 0.7rem;
    border-radius: var(--border-radius-md, 4px);
    border: 1px solid var(--background-modifier-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  }
  
  .metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.08);
    border-color: var(--interactive-accent-hover);
  }
  
  .metric-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 0.2rem;
    letter-spacing: 0.5px;
  }
  
  .metric-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 0.2rem;
  }
  
  .metric-subtitle {
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* Metadata container for accounts and tags - no background */
  .trade-metadata-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    padding: 0.2rem 0;
  }

  .metadata-section {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .metadata-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    white-space: nowrap;
  }

  .metadata-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
  }
  
  /* Tags styling for setups and mistakes */
  .trade-tags-container {
    margin: 0;
  }
  
  .tags-row {
    display: flex;
    gap: 1rem;
    width: 100%;
  }
  
  .tags-section {
    flex: 1;
    margin-bottom: 0;
    background-color: var(--background-primary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.7rem;
    border: 1px solid var(--background-modifier-border);
  }
  
  .tags-section h4 {
    font-size: 0.85rem;
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: var(--text-normal);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  /* Only keep icons for setup and mistake headers */
  .setup-section h4::before {
    content: '\u2713'; /* Checkmark symbol */
    color: var(--color-secondary, var(--text-accent));
    font-weight: bold;
  }

  .mistake-section h4::before {
    content: '\u26A0'; /* Warning symbol */
    color: var(--color-error, #e53935);
    font-weight: bold;
  }
  
  .tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .tag {
    padding: 0.35rem 0.7rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    transition: transform 0.15s ease;
    color: var(--text-normal);
  }

  .tag:hover {
    transform: translateY(-1px);
  }
  
  .setup-tag {
    background-color: rgba(66, 133, 244, 0.15);
    color: rgba(66, 133, 244, 1);
    border: 1px solid rgba(66, 133, 244, 0.3);
  }
  
  .mistake-tag {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border: 1px solid rgba(229, 57, 53, 0.3);
  }

  .account-tag {
    padding: 0.35rem 0.7rem;
    color: var(--text-accent);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.15s ease, color 0.15s ease;
    text-decoration: underline;
    text-decoration-style: dotted;
    text-underline-offset: 3px;
  }
  
  .account-tag:hover {
    transform: translateY(-1px);
    color: var(--text-accent-hover, var(--text-accent));
  }
  
  /* Notes preview */
  .trade-notes-preview {
    background-color: var(--background-secondary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 4px);
    margin-top: 1.5rem;
  }
  
  .trade-notes-preview h4 {
    font-size: 0.9rem;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
  }
  
  .trade-notes-preview p {
    color: var(--text-normal);
    font-size: 0.9rem;
    line-height: 1.6;
    margin: 0;
  }
  
  /* Trade details footer - modernized layout */
  .trade-details-footer {
    margin-top: 0;
  }
  
  .details-card {
    background-color: var(--background-primary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin-bottom: 0;
    transition: box-shadow 0.2s ease;
  }

  .details-card:hover {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
  }
  
  .details-card.expanded-details {
    width: 100%;
  }

  .details-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .details-card h4 {
    font-size: 1rem;
    margin: 0;
    color: var(--text-normal);
  }
  
  /* Main content area */
  .trade-main-content {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Enhanced thesis section styling - no emoji */
  .thesis-section {
    background-color: var(--background-primary);
    padding: 1rem 1.2rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin: 0;
    position: relative;
  }
  
  
  .thesis-section h4 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 1rem;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    position: relative;
  }
  
  .thesis-content {
    font-size: 0.95rem;
    line-height: 1.7;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0 0.2rem;
  }
  
  .details-card h4 {
    font-size: 0.9rem;
    margin-top: 0;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
    /* Remove the border-bottom as requested */
    padding-bottom: 0;
  }
  
  .details-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  
  .details-table td {
    padding: 0.6rem 0.5rem;
    font-size: 0.9rem;
    text-overflow: ellipsis;
    overflow: hidden;
    border-bottom: none;
  }
  
  /* Only add borders between content groups */
  .details-table tr:nth-child(2) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(3) td {
    padding-top: 0.8rem;
  }
  
  .details-table tr:nth-child(4) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(5) td {
    padding-top: 0.8rem;
  }
  
  .details-table td:nth-child(odd) {
    color: var(--text-muted);
    width: 20%;
    font-weight: 500;
  }
  
  .details-table td:nth-child(even) {
    color: var(--text-normal);
    font-weight: 500;
    width: 30%;
  }
  
  .details-list {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  
  .details-list li {
    padding: 0.4rem 0;
    font-size: 0.9rem;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border-hover, var(--background-modifier-border));
  }
  
  /* Accounts list styling */
  .accounts-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.2rem 0;
  }
  
  /* Account tags styled as clickable bubbles */
  .account-tag {
    padding: 0.4rem 0.8rem;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-normal);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: inline-block;
    cursor: pointer; /* Show pointer to indicate clickability */
    transition: background-color 0.2s;
  }
  
  .account-tag:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .notes-content {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
  }
  
  /* Trade images styling */
  .trade-images-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.6rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  /* Special styling for container with only one image - eliminate all padding */
  .trade-images-section[data-image-count="1"] {
    padding: 0; /* Remove all padding when there's only one image */
    margin: 0;
  }
  
  /* Ensure proper sizing of the ImageCarousel within the TradeNote */
  .trade-images-section .journalit-image-carousel {
    margin-bottom: 0;
    background-color: transparent;
    box-shadow: none;
    padding: 0;
  }
  
  /* Special handling for single image scenarios - remove any extra spacing */
  .trade-images-section .journalit-image-carousel[data-single-image="true"],
  .trade-images-section[data-image-count="1"] .journalit-image-carousel {
    padding: 0;
    margin: 0;
  }
  
  /* Remove all padding/margin from image container if it's a single image */
  .trade-images-section .journalit-image-carousel[data-single-image="true"] .image-container,
  .trade-images-section[data-image-count="1"] .image-container,
  .trade-images-section[data-image-count="1"] .journalit-carousel-image-container {
    margin: 0;
    padding: 0;
  }
  
  /* More aggressive fixes for single image mode - eliminate all possible gaps */
  .trade-images-section[data-image-count="1"] * {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  /* Target our specific single-image-carousel class */
  .single-image-carousel,
  .single-image-carousel .journalit-carousel-main,
  .single-image-carousel .journalit-carousel-image-container {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Force the single image to directly touch the metrics below */
  .trade-images-section[data-image-count="1"] + .trade-metrics-grid {
    margin-top: 0;
  }
  
  /* Empty state styling */
  .trade-empty-images {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.8rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  .image-carousel {
    position: relative;
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Remove all margins for single image carousels */
  .trade-images-section[data-image-count="1"] .image-carousel,
  .trade-images-section[data-image-count="1"] .journalit-carousel-main {
    margin: 0;
    padding: 0;
  }
  
  .image-container {
    width: 100%;
    max-height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: var(--border-radius-md, 4px);
  }
  
  .image-container img {
    max-width: 100%;
    max-height: 400px;
    object-fit: contain;
  }
  
  .carousel-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    opacity: 0.7;
    transition: opacity 0.2s, background-color 0.2s;
    z-index: 10;
  }
  
  .carousel-button:hover {
    opacity: 1;
    background-color: var(--background-primary);
  }
  
  .carousel-button.prev {
    left: 10px;
  }
  
  .carousel-button.next {
    right: 10px;
  }
  
  .image-counter {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.3rem;
  }
  
  /* Hide image counter completely when there's only one image */
  .trade-images-section[data-image-count="1"] .image-counter {
    display: none;
  }
  
  .image-thumbnails {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 100%;
    margin-top: 0.3rem;
  }
  
  .thumbnail {
    width: 60px;
    height: 60px;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
    border: 2px solid transparent;
  }
  
  .thumbnail:hover {
    opacity: 1;
  }
  
  .thumbnail.active {
    opacity: 1;
    border-color: var (--color-primary, var(--interactive-accent));
  }
  
  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Responsive adjustments */
  @media (max-width: 900px) {
    .trade-metrics-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .details-table {
      table-layout: auto;
    }

    .details-table td:nth-child(odd) {
      width: auto;
      min-width: 100px;
    }

    .details-table td:nth-child(even) {
      width: auto;
    }
  }

  @media (max-width: 768px) {
    .trade-note-content {
      padding: 0;
      gap: 0.6rem;
    }
    
    .tags-row {
      flex-direction: column;
      gap: 0.8rem;
    }

    .details-table {
      display: block;
      overflow-x: auto;
    }
    
    .details-table td {
      padding: 0.5rem 0.3rem;
      word-break: break-word;
    }

    .thesis-section {
      padding: 0.8rem;
    }

    .thesis-section h4 {
      font-size: 0.9rem;
      margin-bottom: 0.7rem;
    }

    .thesis-content {
      font-size: 0.85rem;
      line-height: 1.5;
    }
  }

  @media (max-width: 480px) {
    .trade-metrics-grid {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }

    .metadata-section {
      flex-direction: column;
      align-items: flex-start;
    }

    .setup-section h4::before,
    .mistake-section h4::before {
      display: none; /* Hide emojis on very small screens */
    }
  }
  
  /* Trade Navigation Styles */
  .trade-navigation-container {
    display: flex;
    flex-direction: column;
    padding: 0.2rem 0.8rem 0.6rem 0.8rem; /* Reduced padding to match DRC tightness */
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  /* Container for navigation and edit button */
  .trade-navigation-with-edit {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 0.8rem;
  }
  
  /* Container for edit button to help with alignment */
  .edit-button-container {
    display: flex;
    align-items: center;
    height: auto;
    padding-top: 0;
  }
  
  /* Timeline styles */
  .trade-timeline-container {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    margin-bottom: 0.3rem; /* Reduced bottom margin */
  }
  
  .trade-timeline {
    display: flex;
    align-items: center;
  }
  
  .timeline-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-normal);
    margin-right: 0.8rem;
    white-space: nowrap;
    min-width: 70px;
  }
  
  .timeline-label.active-ticker {
    font-weight: 600;
    color: var(--interactive-accent);
  }
  
  .timeline-items {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .timeline-item {
    padding: 0.3rem 0.6rem;
    background-color: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .timeline-item:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }
  
  /* PnL color coding */
  .timeline-item.profit {
    background-color: rgba(102, 187, 106, 0.15);
    color: var(--color-success, #43a047);
    border-color: rgba(102, 187, 106, 0.3);
  }
  
  .timeline-item.loss {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border-color: rgba(229, 57, 53, 0.3);
  }
  
  .timeline-item.open {
    background-color: rgba(33, 150, 243, 0.15);
    color: var(--color-info, #2196f3);
    border-color: rgba(33, 150, 243, 0.3);
  }
  
  .timeline-item.profit:hover {
    background-color: rgba(102, 187, 106, 0.25);
  }
  
  .timeline-item.loss:hover {
    background-color: rgba(229, 57, 53, 0.25);
  }
  
  .timeline-item.open:hover {
    background-color: rgba(33, 150, 243, 0.25);
  }
  
  /* Active state now uses a prominent border instead of background */
  .timeline-item.active {
    border: 2px solid var(--interactive-accent);
    font-weight: 600;
  }
  
  .timeline-item.active.profit {
    border-color: var(--interactive-accent);
  }
  
  .timeline-item.active.loss {
    border-color: var(--interactive-accent);
  }
  
  /* Navigation buttons for reviews */
  .trade-review-navigation {
    flex: 1;
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 0.8rem;
    margin-bottom: 0;
    margin-right: 0.8rem;
  }
  
  /* Edit button in navigation */
  .trade-nav-edit-button {
    width: auto;
    min-width: 36px;
    border-radius: 4px;
    border: 1px solid var(--interactive-accent);
    background-color: var(--interactive-accent);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
    padding: 6px 8px; /* Reduced vertical padding from 8px to 6px */
    margin: 0;
    box-sizing: border-box;
    font-size: 14px; /* Match the font size of navigation buttons */
    line-height: 1.15; /* Control the line height for better alignment */
  }
  
  .trade-nav-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  .trade-nav-edit-button svg {
    width: 14px;
    height: 14px;
  }
  
  .trade-review-navigation-links {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .trade-review-navigation-button {
    flex: 1;
    min-width: 120px;
    text-align: center;
    padding: 0.5rem;
    font-size: 0.8rem;
  }
  
  /* Multiple view compatibility - these styles ensure proper display in various Obsidian layouts */
  .workspace-split.mod-vertical .journalit-trade-view {
    /* Adjust for vertical split layout */
    max-width: 100%;
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  /* Make sure tab/content navigation is still usable in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-container {
    min-width: 0;
  }
  
  /* Responsive styles for navigation */
  @media (max-width: 576px) {
    .trade-timeline {
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 0.6rem;
    }
    
    .timeline-label {
      margin-bottom: 0.4rem;
      margin-right: 0;
      font-weight: 600;
    }
    
    .trade-timeline-container {
      gap: 1rem;
    }
    
    /* Adjust navigation with edit button layout */
    .trade-navigation-with-edit {
      align-items: center;
    }
    
    .edit-button-container {
      padding-top: 0;
    }
    
    .trade-nav-edit-button {
      padding: 5px 6px; /* Further reduced vertical padding for mobile */
      min-width: 32px;
    }
    
    .trade-nav-edit-button svg {
      width: 16px;
      height: 16px;
    }
  }

  /* Loss Review Styles */
  
  /* Loss Review Container */
  .loss-review-container {
    margin-top: 2rem;
    border-top: 1px solid var(--background-modifier-border);
    padding-top: 1.5rem;
  }

  .loss-review-accordion {
    background: var(--background-secondary);
    border-radius: 8px;
    overflow: hidden;
  }

  /* Loss Review Sections */
  .loss-review-sections {
    padding: 1.5rem;
  }

  .loss-review-section {
    margin-bottom: 1.5rem;
  }

  .loss-review-section:last-child {
    margin-bottom: 0;
  }

  /* Headers */
  .loss-review-header h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-normal);
  }

  .loss-review-content {
    color: var(--text-muted);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .loss-review-content p {
    margin: 0.5rem 0;
  }

  /* Checkboxes */
  .loss-review-checkbox,
  .loss-review-checkbox-list {
    margin: 0.5rem 0;
  }

  .loss-review-checkbox-list h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .checkbox-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .checkbox-label {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
  }

  .checkbox-label input[type="checkbox"] {
    margin-top: 0.25rem;
    cursor: pointer;
    flex-shrink: 0;
  }

  .checkbox-label span {
    flex: 1;
    line-height: 1.5;
  }

  .checkbox-label span strong {
    color: var(--text-normal);
  }

  /* Text Areas */
  .loss-review-textarea h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .loss-review-textarea-input {
    width: 100%;
    min-height: 100px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 16px;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .loss-review-textarea-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .loss-review-textarea-input::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /* Footer */
  .loss-review-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .reviewed-timestamp {
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .loss-review-sections {
      padding: 1rem;
    }
    
    .loss-review-footer {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
  }

  /* Dark theme adjustments */
  .theme-dark .loss-review-textarea-input {
    background: var(--background-secondary-alt);
  }

  .theme-dark .loss-review-accordion {
    background: var(--background-secondary-alt);
  }

  /* Accordion styles for Loss Review */
  .loss-review-container .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: hidden;
    transition: box-shadow 0.2s ease;
  }

  .loss-review-container .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-content {
    max-height: 5000px;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: hidden;
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Collapsed state */
  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .loss-review-textarea-input {
      font-size: 18px !important;
    }
  }
`});function MQ(){if(document.head.querySelector("#missed-trade-note-styles"))return;let e=document.createElement("style");e.id="missed-trade-note-styles",e.textContent=LQ,document.head.appendChild(e)}function vv(){MQ()}var LQ,p$=te(()=>{LQ=`
  /**
   * Missed Trade Note Container styles
   */

  /* Main container for missed trade notes */
  .journalit-missed-trade-view,
  .missed-trade-form-view-container .journalit-missed-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    position: relative;
    box-sizing: border-box;
    contain: content;
    isolation: isolate;
  }
  
  /* Missed trade React root wrapper */
  .journalit-missed-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    isolation: isolate;
    position: relative;
    box-sizing: border-box;
  }
  
  .missed-trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    isolation: isolate;
    contain: layout style paint;
    width: 100%;
    align-self: flex-start;
    transition: box-shadow 0.2s ease-in-out;
  }

  /**
   * MISSED Badge Styling for TradeHeader
   */
  
  /* Style the MISSED badge */
  .trade-header-actions .missed-trade-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-orange, #ff9500);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 4px rgba(255, 149, 0, 0.3);
    margin-right: 0.75rem;
  }

  /* Missed trade header styling - removed orange styling per user request */

  /**
   * Missed Trade Reason Section
   */
  
  .missed-trade-reason-section {
    margin-top: 1rem;
  }

  .missed-trade-reason-section .details-card {
    background-color: var(--background-secondary);
    border-left: 4px solid var(--color-orange, #ff9500);
  }

  .missed-trade-reason-section h4 {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .missed-trade-reason-section h4::before {
    content: '\u274C';
    font-size: 1rem;
  }

  .missed-trade-reason-content {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0.5rem 0;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: 4px;
    padding: 0.75rem;
    margin-top: 0.5rem;
  }

  /**
   * Missed Trade Timeline Styling
   */

  /* Missed trades timeline section */
  .missed-trades-timeline-section {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--background-modifier-border);
  }

  .missed-trades-label {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  /* Missed trade timeline items */
  .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.15);
    color: var(--color-orange, #ff9500);
    border-color: rgba(255, 149, 0, 0.3);
    font-weight: 500;
  }

  .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.missed-trade.active {
    border: 2px solid var(--color-orange, #ff9500);
    background-color: rgba(255, 149, 0, 0.2);
    font-weight: 600;
  }

  /**
   * Missed Trade Content Styling
   */
  
  .missed-trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  /**
   * Review Button for Missed Trades
   */
  
  .missed-trade-note-review-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /**
   * Form Styling for Missed Trade Toggle
   */
  
  /* Missed trade toggle styling in forms */
  .field .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-normal);
    transition: color 0.2s ease;
  }

  .field .checkbox-label:hover {
    color: var(--interactive-accent);
  }

  .field .checkbox-label input[type="checkbox"] {
    cursor: pointer;
    transform: scale(1.1);
  }

  .field .checkbox-label span {
    font-weight: 500;
  }

  /* Missed trade reason field styling */
  .field .textarea {
    width: 100%;
    min-height: 80px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 0.9rem;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .field .textarea:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .field .textarea::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /**
   * Responsive Design
   */
  
  @media (max-width: 768px) {
    .missed-trade-badge {
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      margin-right: 0.5rem;
    }
    
    .missed-trade-reason-content {
      font-size: 0.85rem;
      padding: 0.5rem;
    }
  }

  @media (max-width: 480px) {
    .missed-trades-timeline-section {
      margin-top: 0.75rem;
      padding-top: 0.5rem;
    }
    
    .missed-trades-label {
      font-size: 0.85rem;
    }
  }

  /**
   * Dark theme adjustments
   */
  
  /* Removed orange theme styling per user request */
  
  .theme-dark .missed-trade-reason-content {
    background-color: var(--background-secondary-alt);
  }
  
  .theme-dark .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.2);
  }
  
  .theme-dark .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.3);
  }

  /**
   * Multiple view compatibility
   */
  
  .workspace-split.mod-vertical .journalit-missed-trade-view {
    max-width: 100%;
    flex-shrink: 1;
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .missed-trade-note-container {
    min-width: 0;
  }
`});function VD(){if(document.head.querySelector("#drc-styles"))return;let e=document.createElement("style");e.id="drc-styles",e.textContent=OQ,document.head.appendChild(e)}function Aw(){VD()}var OQ,GD=te(()=>{OQ=`
  /* Daily Report Card styles */
  .drc-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    display: flex;
    flex-direction: column;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    position: relative; /* Establish positioning context to prevent jumping */
    z-index: 1; /* Ensure proper stacking context */
    transform: translateZ(0); /* Force GPU acceleration for stability */
    will-change: auto !important; /* Prevent aggressive optimization */
    contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
  }

  /* DRC ComboBox styling - matched with TradeForm styling */
  .drc-container .combobox-container,
  .drc-container [data-combobox-type],
  .drc-missed-trade .combobox-container,
  .drc-missed-trade .drc-input-group.field .combobox-container {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    z-index: 10 !important;
  }

  /* Increased z-index when dropdown is open */
  .drc-container .combobox-container[data-is-open="true"],
  .drc-container [data-combobox-type][data-is-open="true"],
  .drc-missed-trade .combobox-container[data-is-open="true"],
  .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Dropdown caret for DRC ComboBox */
  .drc-container [data-combobox-type] .input-container::after,
  .drc-missed-trade .combobox-container .input-container::after,
  .drc-missed-trade .drc-input-group.field .combobox-container .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }

  /* Input padding to make room for dropdown arrow */
  .drc-container [data-combobox-type] input[role="combobox"],
  .drc-missed-trade .combobox-container input[role="combobox"],
  .drc-missed-trade .drc-input-group.field .combobox-container input[role="combobox"] {
    padding-right: 30px !important;
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }

  /* DRC Multi-select styling - fixed for better visibility */
  .drc-missed-trade .selected-options,
  .drc-missed-trade .selected-item,
  .drc-missed-trade [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    max-width: 100% !important;
    padding: 2px 0 !important;
    z-index: 5 !important;
    position: relative !important;
  }

  /* Style selected tags to match the TradeForm */
  .drc-missed-trade .selected-option,
  .drc-missed-trade .selected-item,
  .selected-option,
  .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    background-color: var(--interactive-accent, #7c3aed) !important; /* Use Obsidian var with purple fallback */
    color: white !important;
    border-radius: 4px !important;
    padding: 4px 8px !important; /* Match TradeForm padding */
    font-size: 12px !important; /* Match TradeForm font size */
    margin: 0 4px 4px 0 !important; /* Match TradeForm margin */
    font-weight: 500 !important;
    z-index: 6 !important;
    position: relative !important;
    gap: 6px !important; /* Ensure proper spacing between text and remove button */
  }

  /* Style remove buttons ('\xD7') - matched with TradeForm */
  .drc-missed-trade .selected-option-remove,
  .drc-missed-trade .selected-item button,
  .selected-option-remove,
  .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    margin-left: 4px !important;
    cursor: pointer !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border: none !important;
    border-radius: 50% !important;
    color: white !important;
    font-size: 16px !important;
    line-height: 1 !important; /* Match TradeForm for consistent vertical centering */
    text-align: center !important;
    z-index: 7 !important;
    position: relative !important;
    transition: background-color 0.2s !important;
  }

  /* Header and Navigation */
  .drc-header {
    padding: 16px 20px 12px;
    background-color: var(--background-secondary);
    text-align: center;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-date-display {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 12px;
  }

  .drc-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }

  .drc-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100% !important;
  }

  /* Tabs Container */
  .drc-tabs-container {
    background-color: var(--background-secondary-alt, #2a2a2a);
    border-bottom: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    padding: 0;
  }

  /* Tabs */
  .drc-tabs {
    display: flex;
    justify-content: center;
    background-color: transparent;
    max-width: 600px;
    margin: 0 auto;
  }

  .drc-tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    outline: none;
    border-bottom: 2px solid transparent;
  }

  .drc-tab:hover {
    color: var(--text-normal);
    background-color: rgba(127, 127, 127, 0.05);
  }

  .drc-tab.active {
    color: var(--text-accent);
    border-bottom: 2px solid var(--text-accent);
  }

  .drc-tab.active::after {
    content: none; /* Removing the additional indicator since we're using border-bottom */
  }

  /* Content area */
  .drc-content {
    padding: 20px 0 0; /* Removed bottom padding to prevent extra space */
  }

  /* Sections */
  .drc-section {
    margin: 0 0 24px 0; /* Explicit horizontal margin of 0 to match Weekly Review */
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 16px;
    background-color: var(--background-primary);
    width: 100%; /* Ensure full width */
    box-sizing: border-box; /* Include padding in width calculation */
  }

  /* Last section should not have a bottom margin to prevent extra space */
  .drc-section:last-child {
    margin-bottom: 0 !important;
  }

  /* First section should not have a top margin to prevent extra space */
  .drc-section:first-child {
    margin-top: 0 !important;
  }

  .drc-section h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 16px;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
    text-align: center;
  }

  /* Checklist */
  .drc-checklist {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .drc-checklist-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    background-color: var(--background-secondary);
    transition: background-color 0.2s ease;
    cursor: pointer !important; /* Make the entire area clickable */
  }

  /* Custom styling to center checkbox */
  .drc-checklist-item input[type="checkbox"] {
    margin-right: 10px;
    vertical-align: middle !important;
  }

  .drc-checklist-item:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Input groups */
  .drc-input-group {
    margin-bottom: 16px;
  }

  .drc-input-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 16px;
    font-weight: 500;
    color: var(--text-normal);
  }

  .drc-input-group input,
  .drc-input-group textarea,
  .drc-input-group select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 16px;
  }

  .drc-input-group textarea,
  .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  /* Stats cards */
  .drc-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }

  .drc-stat-card {
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 16px;
    text-align: center;
    transition: transform 0.2s;
    min-width: 0; /* Enable proper overflow handling */
  }

  .drc-stat-card:hover {
    transform: translateY(-2px);
  }

  .drc-stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--text-normal);
    white-space: nowrap; /* Keep values on one line */
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis for overflow */
  }

  .drc-stat-value.positive {
    color: var(--color-success, #43a047);
  }

  .drc-stat-value.negative {
    color: var(--color-error, #e53935);
  }
  
  /* Special handling for P&L stat card which often has longer values */
  .drc-stats .drc-stat-card:nth-child(4) {
    min-width: 140px; /* Give P&L card extra space */
  }

  .drc-stat-label {
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Grades */
  .drc-grades {
    display: grid;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-grade select {
    font-size: 16px;
    font-weight: 600;
    padding: 10px 16px;
    height: auto;
    line-height: 1.5;
    text-align-last: center;
    appearance: menulist-button;
    -webkit-appearance: menulist-button;
  }

  /* Trade table */
  .drc-trade-table {
    width: 100%;
    border-collapse: collapse;
  }

  .drc-trade-table th {
    text-align: left;
    padding: 10px;
    border-bottom: 2px solid var(--background-modifier-border);
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-trade-table td {
    padding: 10px;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
  }

  .drc-trade-table td.positive {
    color: var(--color-success, #43a047);
  }

  .drc-trade-table td.negative {
    color: var(--color-error, #e53935);
  }

  .drc-trade-table select,
  .drc-trade-table input {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
  }
  
  /* Weekly review trades table for DRC compatibility */
  .weekly-review-trades-table {
    /* Table header for preview column */
    th:first-child {
      width: 60px !important; /* Fixed width for preview column */
      text-align: center !important;
      padding: 8px 4px !important;
    }
    
    /* Trade preview cell */
    .trade-preview-cell {
      width: 60px !important;
      padding: 4px !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    
    /* Image wrapper container */
    .trade-image-wrapper {
      position: relative !important;
      width: 48px !important; 
      height: 48px !important;
      display: inline-block !important;
      cursor: pointer !important;
      overflow: hidden !important;
      border-radius: 4px !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Lazy loaded image container */
    .trade-preview-thumbnail {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* Placeholder shown before image loads */
    .trade-preview-placeholder {
      width: 100% !important;
      height: 100% !important;
      background-color: var(--background-modifier-hover) !important;
      border-radius: 4px !important;
    }
    
    /* Indicator badge for multiple images */
    .trade-image-count-indicator {
      position: absolute !important;
      bottom: 2px !important;
      right: 2px !important;
      background-color: rgba(0, 0, 0, 0.7) !important;
      color: white !important;
      font-size: 10px !important;
      font-weight: bold !important;
      padding: 1px 4px !important;
      border-radius: 3px !important;
      line-height: 1 !important;
      pointer-events: none !important; /* Don't interfere with click handling */
      z-index: 2 !important;
    }
    
    /* Icon styling when no image exists */
    .trade-no-image-icon {
      color: var(--text-muted) !important;
      opacity: 0.5 !important;
    }
    
    /* Scale up image preview on hover */
    .trade-image-wrapper:hover {
      transform: scale(1.05) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
      transition: all 0.2s ease !important;
    }
  }
  
  .weekly-review-trades-table {
    width: 100% !important;
    overflow-x: auto !important;
    margin-bottom: 16px !important;
  }

  .weekly-review-trades-table table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 16px !important;
    text-align: left !important;
    margin: 0 !important;
    table-layout: auto !important;
  }

  .weekly-review-trades-table th {
    padding: 10px 12px !important;
    border-bottom: 2px solid var(--background-modifier-border) !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    text-align: left !important;
    white-space: nowrap !important;
  }

  .weekly-review-trades-table td {
    padding: 8px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    text-align: left !important;
    transition: background-color 0.2s ease !important;
  }

  .weekly-review-trades-table tr:hover td {
    background-color: var(--background-modifier-hover) !important;
  }

  .weekly-review-trade-row {
    cursor: pointer !important;
  }

  .weekly-review-trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* DRC View Button - used in trade tables */
  .drc-nav-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    text-align: center !important;
    flex: 1 !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover) !important;
    transform: translateY(-1px) !important;
  }

  /* Review sections */
  .drc-reflection-item {
    margin-bottom: 16px;
  }

  .drc-reflection-item label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-reflection-item textarea {
    width: 100%;
    min-height: 100px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    resize: vertical;
  }

  /* DRC dropdown options - remove bullets and match TradeForm */
  .drc-container [data-combobox-type] ul[role="listbox"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important;
    border-radius: 0 0 4px 4px !important;
    margin-top: -1px !important;
    z-index: 9999 !important;
    list-style: none !important; /* Remove bullets */
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    /* Fix for blurry text - add hardware acceleration properties */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    backface-visibility: hidden !important;
    perspective: 1000px !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Animation properties for smooth open effect */
    animation: drc-dropdown-open 0.15s ease forwards !important;
  }
  
  /* Animation for DRC dropdown appearance */
  @keyframes drc-dropdown-open {
    from {
      opacity: 0;
      transform: translateY(-5px) translateZ(0);
    }
    to {
      opacity: 1;
      transform: translateY(0) translateZ(0);
    }
  }

  /* DRC dropdown options styling */
  .drc-container [data-combobox-type] ul[role="listbox"] li,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
    list-style: none !important; /* Ensure no bullets */
    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* Hover and selected state for DRC dropdown options */
  .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }

  /* Special styling for "Add new" option in DRC */
  .drc-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* When dropdown is open, change input border radius */
  .drc-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
  .drc-missed-trade [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  
  /* Add hover effect for remove buttons */
  .drc-missed-trade .selected-option-remove:hover,
  .drc-missed-trade .selected-item button:hover,
  .selected-option-remove:hover,
  .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  /* Missed trades */
.drc-missed-trade {
  padding: 16px;
  padding-top: 42px; /* Extra padding at top to make space for the remove button */
  margin-bottom: 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  position: relative;
}

/* Ensure the remove button is always clickable with a high z-index */
.drc-missed-trade-remove {
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
  z-index: 12000 !important; /* Ensure it's above any dropdowns */
  padding: 6px 12px !important;
  min-width: 80px !important;
  min-height: 32px !important;
  margin: 0 !important;
}

/* Missed trade images container */
.drc-missed-trade-images-container {
  margin-top: 16px;
}

/* Container for image carousel */
.drc-missed-trade-images {
  margin-bottom: 12px;
  background-color: var(--background-primary);
  border-radius: 6px;
  padding: 12px;
  border: 1px solid var(--background-modifier-border);
}

/* Image uploader for missed trades */
.drc-missed-trade-image-uploader {
  height: 60px !important; /* Smaller height for the uploader */
  margin-top: 8px;
}

  .drc-missed-trade .drc-remove-button {
    position: absolute;
    top: 12px;
    right: 12px;
  }

  /* Buttons */
  .drc-add-button,
  .drc-remove-button,
  .drc-nav-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .drc-add-button {
    margin-bottom: 16px;
    background-color: var(--interactive-accent);
    color: white;
    border-color: var(--interactive-accent);
  }

  .drc-add-button:hover {
    background-color: var(--interactive-accent-hover);
  }

  .drc-remove-button {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border-color: var(--color-error, #e53935);
  }

  .drc-remove-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .drc-nav-button .nav-icon {
    font-size: 16px;
    line-height: 1;
  }

  /* Empty state */
  .drc-empty-state {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    background-color: var(--background-secondary);
    border-radius: 4px;
  }

  /* Goals section */
  .drc-goal-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 10px;
  }

  .drc-goal-item input {
    flex: 1;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-grades {
      grid-template-columns: 1fr;
    }

    .drc-stats {
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }

    .drc-trade-table {
      display: block;
      overflow-x: auto;
    }

    .drc-navigation-links {
      justify-content: center !important;
      width: 100% !important;
    }

    .drc-nav-button {
      flex: 1 !important;
      justify-content: center !important;
      min-width: 120px !important;
    }

    /* Make tabs more compact on mobile */
    .drc-tab {
      padding: 10px 16px;
      font-size: 13px;
    }
  }

  /* Fix for grade value display and container sizing */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
    display: block !important;
    text-align: center !important;
  }

  /* Critical fixes for grade display and containers */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: center !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
    background-color: var(--background-primary) !important;
    border-radius: var(--border-radius-md, 4px) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 12px !important;
    display: block !important;
    text-align: center !important;
    width: 100% !important;
  }

  .drc-note-grade-dropdown {
    width: 60px !important;
    height: 60px !important;
    position: relative !important;
  }

  /* Grade value styling with perfect centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    width: 60px !important;
    height: 60px !important;
    min-width: 60px !important;
    min-height: 60px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    font-size: 22px !important;
    font-weight: 600 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    text-align: center !important;
    line-height: 1 !important;
    text-indent: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important;
    position: relative !important;
  }

  /* Grade colors - A is green, B is orange, C is red */
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.3) !important;
    color: #2e7d32 !important; /* Darker green for better visibility */
  }

  .drc-note-grade-value.grade-b {
    background-color: rgba(255, 152, 0, 0.3) !important;
    color: #ef6c00 !important; /* Darker orange for better visibility */
  }

  .drc-note-grade-value.grade-c {
    background-color: rgba(229, 57, 53, 0.3) !important;
    color: #c62828 !important; /* Darker red for better visibility */
  }

  /* Hide dropdown arrow */
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown select::after,
  .drc-note-grade-dropdown select::before {
    content: none !important;
    display: none !important;
  }

  /* Media query for responsive layout */
  @media (max-width: 768px) {
    .drc-note-grades {
      grid-template-columns: 1fr !important;
      gap: 12px !important;
    }

    /* Key Levels responsive adjustments */
    .drc-levels-container {
      flex-direction: column !important;
    }

    .drc-level-section {
      width: 100% !important;
    }
  }

  @media (min-width: 768px) {
    .drc-levels-container {
      flex-direction: row !important;
      gap: 16px !important;
    }

    .drc-level-section {
      width: calc(50% - 8px) !important;
    }
  }

  /* Key Levels Component Styles */
  .drc-key-levels {
    margin-top: 16px !important;
  }
  
  /* IconSelect Component Styles */
  .icon-select-container {
    position: relative !important;
    display: inline-block !important;
    width: 40px !important;
    height: 32px !important;
    vertical-align: middle !important;
  }

  .icon-select-trigger {
    width: 100% !important;
    height: 100% !important;
    padding: 0 !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  /* Center SVG icons inside the trigger button */
  .icon-select-trigger svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-trigger:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-menu {
    position: absolute !important;
    top: calc(100% + 2px) !important;
    left: 0 !important;
    width: 40px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    z-index: 1000 !important;
    list-style: none !important;
    padding: 4px 0 !important;
    margin: 0 !important;
  }

  .icon-select-option {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 6px 0 !important;
    cursor: pointer !important;
    height: 28px !important;
  }
  
  /* Center SVG icons inside the dropdown options */
  .icon-select-option svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-option.selected {
    background-color: var(--background-secondary) !important;
  }

  .drc-levels-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 24px !important;
  }

  .drc-level-section {
    border-radius: 8px !important;
    padding: 16px !important;
    background-color: var(--background-secondary) !important;
  }

  .support-section {
    border-left: 3px solid rgba(102, 187, 106, 0.7) !important;
  }

  .resistance-section {
    border-left: 3px solid rgba(229, 57, 53, 0.7) !important;
  }

  .drc-level-header {
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }

  .support-header {
    color: var(--color-success, #43a047) !important;
  }

  .resistance-header {
    color: var(--color-error, #e53935) !important;
  }

  .drc-level-add-container {
    margin-bottom: 12px !important;
  }

  .drc-level-input-group {
    display: flex !important;
    gap: 8px !important;
    width: 100% !important;
    align-items: center !important;
  }

  .drc-level-input {
    flex: 2 !important;
    min-width: 0 !important;
    padding: 6px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    display: block !important;
  }

  .drc-level-importance-select {
    width: 40px !important;
    display: flex !important;
    align-items: center !important;
  }

  .drc-importance-select {
    width: 40px !important;
    padding: 6px 0 6px 24px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    vertical-align: middle !important;
    background-image: none !important;
    text-align: center !important;
  }

  /* Ensure select options have consistent height */
  .drc-importance-select option {
    padding: 4px 8px !important;
    height: auto !important;
    line-height: normal !important;
  }

  .drc-level-add-button {
    padding: 6px 12px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin: 0 !important;
    line-height: 20px !important;
  }

  .drc-levels-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .drc-level-item {
    display: flex !important;
    align-items: center !important;
    padding: 8px 12px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    position: relative !important;
    justify-content: flex-start !important;
  }

  .support-level {
    border-left: 3px solid rgba(102, 187, 106, 0.5) !important;
  }

  .resistance-level {
    border-left: 3px solid rgba(229, 57, 53, 0.5) !important;
  }

  .drc-level-price {
    font-weight: 500 !important;
    margin-right: 8px !important;
  }

  .drc-level-importance {
    font-size: 12px !important;
    padding: 2px 6px !important;
    border-radius: 3px !important;
  }

  .importance-high {
    background-color: rgba(229, 57, 53, 0.1) !important;
  }

  .importance-high .drc-level-importance {
    background-color: rgba(229, 57, 53, 0.2) !important;
    color: var(--color-error, #e53935) !important;
  }

  .importance-medium {
    background-color: rgba(255, 152, 0, 0.1) !important;
  }

  .importance-medium .drc-level-importance {
    background-color: rgba(255, 152, 0, 0.2) !important;
    color: var(--color-orange, #ef6c00) !important;
  }

  .importance-low {
    background-color: rgba(33, 150, 243, 0.1) !important;
  }

  .importance-low .drc-level-importance {
    background-color: rgba(33, 150, 243, 0.2) !important;
    color: var(--interactive-accent) !important;
  }

  .drc-level-remove-button {
    padding: 0 !important;
    width: 24px !important;
    height: 24px !important;
    background-color: rgba(229, 57, 53, 0.1) !important;
    color: var(--color-error, #e53935) !important;
    border: none !important;
    border-radius: 50% !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: auto !important; /* Always push to the right */
    text-align: center !important;
    vertical-align: middle !important;
  }

  .drc-empty-levels {
    color: var(--text-muted) !important;
    font-style: italic !important;
    padding: 8px !important;
    text-align: center !important;
  }

  /* Ultra-high specificity rule for DRC navigation container */
  html body .drc-container .drc-header .drc-navigation,
  body .drc-container .drc-header .drc-navigation,
  .workspace-leaf .drc-container .drc-header .drc-navigation {
    width: 100% !important;
    padding-top: 10px !important;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
  }

  /* Ultra-high specificity rule for DRC navigation links container */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  /* Forecast section styling for DRC - matches Weekly Review */
  .drc-forecast-section {
    margin-bottom: 20px;
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 8px;
  }

  /* Specific styling for forecast textareas - matching weekly review */
  .drc-forecast-section textarea,
  .drc-forecast-section .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  .drc-forecast-section h4 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.05em;
  }

  .drc-image-container {
    margin-bottom: 12px;
  }

  .drc-image {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .drc-forecast-image {
    width: auto;
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
  }

  .drc-image-upload {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .drc-image-upload:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .drc-image-upload.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .drc-image-upload::after {
    content: "Drag and drop here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .drc-image-upload.dragging-over::after {
    opacity: 1;
  }

  .drc-image-upload.dragging-over .drc-image-label {
    opacity: 0;
  }

  .drc-image-label {
    font-size: 16px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .drc-image-upload:hover .drc-image-label {
    color: var(--interactive-accent);
  }

  .drc-image-input {
    display: none;
  }

  .drc-image-delete {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .drc-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Hint for click/hold to zoom */
  .drc-forecast-image {
    cursor: zoom-in !important;
    position: relative;
  }

  .drc-forecast-image::after {
    content: "Click or hold to enlarge";
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .drc-forecast-image:hover::after {
    opacity: 1;
  }

  /* Fullscreen styles */
  .drc-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease-in-out;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    cursor: pointer;
  }

  .drc-fullscreen-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background-color: var(--background-primary);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    animation: zoomIn 0.3s ease-in-out;
    overflow: hidden;
    cursor: default;
  }

  .drc-fullscreen-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-fullscreen-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-fullscreen-close {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 16px;
    cursor: pointer;
  }

  .drc-fullscreen-close:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-fullscreen-image-container {
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    background-color: var(--background-primary);
    max-height: calc(90vh - 120px);
    /* Add subtle grid background for transparency */
    background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
  }

  .drc-fullscreen-image {
    max-width: 100%;
    max-height: calc(90vh - 120px);
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .drc-fullscreen-footer {
    padding: 10px 16px;
    background-color: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    text-align: center;
  }

  .drc-fullscreen-footer p {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes zoomIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Weekly Events Styling for DRC */
  .drc-weekly-events {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .drc-weekly-event-item {
    padding: 12px;
    background-color: var(--background-secondary);
    border-radius: 8px;
    border-left: 5px solid var(--event-color-gray, #888888);
    margin-bottom: 8px;
    transition: border-color 0.3s ease;
  }

  .drc-weekly-event-item.event-color-red {
    border-left-color: var(--event-color-red, #e53935);
  }

  .drc-weekly-event-item.event-color-orange {
    border-left-color: var(--event-color-orange, #fb8c00);
  }

  .drc-weekly-event-item.event-color-yellow {
    border-left-color: var(--event-color-yellow, #fdd835);
  }

  .drc-weekly-event-item.event-color-gray {
    border-left-color: var(--event-color-gray, #888888);
  }

  .drc-weekly-event-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .drc-weekly-event-header h4 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
  }

  .drc-weekly-event-item p {
    margin: 0;
    font-size: 16px;
    color: var(--text-normal);
    white-space: pre-line;
  }

  .drc-weekly-event-badge {
    font-size: 12px;
    padding: 2px 8px;
    background-color: var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-weight: 500;
    white-space: nowrap;
  }

  /* Ultra-high specificity rule for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 6px !important;
    flex: 1 !important;
    text-align: center !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
    max-width: none !important;
    margin: 0 !important;
  }

  /* Ensure proper icon spacing for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
  body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
    font-size: 16px !important;
    line-height: 1 !important;
  }

  /* End of Day Review Styles */
  .drc-eod-images {
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
  }

  .drc-eod-image-uploader {
    margin-top: 8px;
  }

  .drc-eod-review-button-section {
    text-align: center;
  }

  .drc-eod-review-button-section .review-button-container {
    justify-content: center;
  }

  /* No questions message */
  .drc-no-questions {
    padding: 16px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Metadata container positioning fix to prevent jumping */
  .metadata-container {
    position: relative !important;
    z-index: 1 !important;
    transform: translateZ(0) !important;
    will-change: auto !important;
  }

  /* Prevent parent containers from affecting child positioning during re-renders */
  .workspace-leaf-content[data-type="journalit-drc"],
  .view-content,
  .markdown-source-view,
  .markdown-preview-view {
    position: relative !important;
    overflow: auto !important;
  }

  /* Ensure proper stacking context for nested scrollable elements */
  .drc-tabs-content,
  .tab-content {
    position: relative !important;
    z-index: 1 !important;
  }

  /* Prevent layout shift from margin collapsing */
  .drc-container::before {
    content: '';
    display: table;
  }

  /* Fix for when Obsidian adds inline styles during re-render */
  .metadata-container[style*="position"] {
    position: relative !important;
  }

  /* Ensure dropdowns and inputs don't cause layout shifts */
  .drc-container select,
  .drc-container input,
  .drc-container textarea {
    box-sizing: border-box !important;
    max-width: 100% !important;
  }

  /* Responsive font sizing for small screens */
  @media (max-width: 600px) {
    .drc-container input[role="combobox"],
    .drc-input-group input,
    .drc-input-group textarea,
    .drc-input-group select,
    .drc-textarea,
    .drc-forecast-section textarea,
    .drc-forecast-section .drc-textarea,
    .drc-level-input,
    .drc-trade-table input,
    .drc-reflection-item textarea,
    .drc-goal-item input {
      font-size: 18px !important;
    }
  }
`});function f$(){var n,a,o;let e=window.journalitPlugin,t=(o=(a=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:a.skipWeekends)!=null?o:!0;document.querySelectorAll(".journalit-dashboard-calendar-grid").forEach(i=>{i instanceof HTMLElement&&(Object.assign(i.style,{display:"flex",flexDirection:"column",gap:"4px",width:"100%"}),i.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(Object.assign(c.style,{display:"grid",gridTemplateColumns:t?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px",width:"100%"}),t?(c.style.gridTemplateColumns="repeat(5, 1fr) 1fr",c.style.justifyContent="stretch",c.classList.add("hide-weekends")):c.classList.remove("hide-weekends"))}),i.querySelectorAll(".journalit-dashboard-calendar-day").forEach((c,d)=>{if(c instanceof HTMLElement){Object.assign(c.style,{aspectRatio:"1",display:"flex",flexDirection:"column",position:"relative",padding:"4px",borderRadius:"4px",width:"100%"}),c.classList.contains("today")&&Object.assign(c.style,{position:"relative",zIndex:"2"});let u=c.querySelector(".journalit-dashboard-calendar-day-number");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:"4px",left:"4px",textAlign:"left"});let p=c.querySelector(".journalit-dashboard-calendar-day-pnl");p instanceof HTMLElement&&Object.assign(p.style,{fontSize:"12px",marginTop:"0px",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})}}))})}function g$(){var n,a,o;let e=window.journalitPlugin,t=(o=(a=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:a.skipWeekends)!=null?o:!0;document.querySelectorAll(".journalit-dashboard-calendar-header").forEach(i=>{if(i instanceof HTMLElement){t?i.classList.add("hide-weekends"):i.classList.remove("hide-weekends");let s=t?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr";Object.assign(i.style,{display:"grid",gridTemplateColumns:s,gap:"4px",marginBottom:"8px",position:"sticky",top:"0",backgroundColor:"var(--background-primary)",zIndex:"5",padding:"4px 0",width:"100%",justifyContent:"stretch"}),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(c=>{c instanceof HTMLElement&&Object.assign(c.style,{width:"100%",textAlign:"center"})}),t&&i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.style.display="none":d.style.display=""}})}})}function YD(){var e,t,r;try{let n=window.journalitPlugin,a=(r=(t=(e=n==null?void 0:n.settings)==null?void 0:e.trade)==null?void 0:t.skipWeekends)!=null?r:!0;document.querySelectorAll(".journalit-dashboard-calendar").forEach(i=>{if(i instanceof HTMLElement){a?(i.classList.add("hide-weekends"),i.classList.add("weekends-hidden"),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.style.display="none":d.style.display=""}})):(i.classList.remove("hide-weekends"),i.classList.remove("weekends-hidden"),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{d instanceof HTMLElement&&(d.style.display="")})),i.style.width="100%",i.style.display="flex",i.style.flexDirection="column";let s=i.querySelector(".journalit-dashboard-calendar-header");s instanceof HTMLElement&&(s.style.gridTemplateColumns=a?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",s.style.width="100%"),i.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.style.gridTemplateColumns=a?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",c.style.width="100%",c.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(u=>{if(u instanceof HTMLElement){Object.assign(u.style,{position:"relative",display:"flex",flexDirection:"column"});let p=u.querySelector(".journalit-dashboard-calendar-week-number");p instanceof HTMLElement&&Object.assign(p.style,{position:"absolute",top:"4px",left:"4px",textAlign:"left",marginBottom:"0px"});let m=u.querySelector(".journalit-dashboard-calendar-weekly-pnl-value");m instanceof HTMLElement&&Object.assign(m.style,{fontSize:"12px",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})}}))})}})}catch(n){console.error("Error applying consistent grid structure:",n)}}function FQ(e){try{let t=e.clientWidth,r=12,n=12,a=10,o=1;t<25?o=.55:t<30?o=.65:t<40?o=.75:t<50?o=.85:t>90?o=1.15:t>80&&(o=1.05);let i="50%",s="65%";return t<30?(i="40%",s="78%"):t<40?(i="42%",s="75%"):t<50?(i="44%",s="73%"):t<60?(i="46%",s="70%"):(i="48%",s="68%"),{dayNumber:`${Math.max(7,Math.round(r*o))}px`,pnlValue:`${Math.max(7,Math.round(n*(o*.95)))}px`,tradeCount:`${Math.max(6,Math.round(a*(o*.9)))}px`,pnlPosition:i,tradePosition:s}}catch(t){return console.error("Error calculating responsive sizes:",t),{dayNumber:"12px",pnlValue:"12px",tradeCount:"10px",pnlPosition:"50%",tradePosition:"65%"}}}function $i(){try{if(document.querySelectorAll(".journalit-dashboard-calendar").length===0)return;let t=document.querySelector(".journalit-dashboard-calendar-day");if(!t)return;let r=FQ(t),n={position:"relative",display:"flex",alignItems:"",justifyContent:""},a={position:"absolute",top:"4px",left:"4px",textAlign:"left",fontSize:r.dayNumber,fontWeight:"500"};document.querySelectorAll(".journalit-dashboard-calendar-day").forEach(l=>{if(l instanceof HTMLElement){Object.assign(l.style,n);let c=l.querySelector(".journalit-dashboard-calendar-day-number");c instanceof HTMLElement&&Object.assign(c.style,a);let d=l.querySelector(".journalit-dashboard-calendar-day-pnl");d instanceof HTMLElement&&Object.assign(d.style,{position:"absolute",top:r.pnlPosition,left:"50%",transform:"translate(-50%, -50%)",width:"100%",marginTop:"0px",fontSize:r.pnlValue,fontWeight:"600",textAlign:"center"});let u=l.querySelector(".journalit-dashboard-calendar-day-trades");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:r.tradePosition,left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.tradeCount,fontWeight:"400",textAlign:"center",color:"var(--text-muted)",backgroundColor:"transparent",borderRadius:"0",padding:"0"})}});let i={position:"absolute",top:"4px",left:"4px",textAlign:"left",fontSize:r.dayNumber,fontWeight:"500",marginBottom:"0px"};document.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(l=>{if(l instanceof HTMLElement){Object.assign(l.style,{position:"relative"});let c=l.querySelector(".journalit-dashboard-calendar-week-number");c instanceof HTMLElement&&Object.assign(c.style,i);let d=l.querySelector(".journalit-dashboard-calendar-week-total-label");d instanceof HTMLElement&&Object.assign(d.style,{position:"absolute",top:"25%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.tradeCount,fontWeight:"600",textAlign:"center"});let u=l.querySelector(".journalit-dashboard-calendar-week-total-value");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.pnlValue,fontWeight:"700",textAlign:"center"});let p=l.querySelector(".journalit-dashboard-calendar-week-trade-count");p instanceof HTMLElement&&Object.assign(p.style,{position:"absolute",bottom:"20%",left:"50%",transform:"translate(-50%, 50%)",width:"85%",fontSize:r.tradeCount,fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-muted)",backgroundColor:"transparent",borderRadius:"0",padding:"0"})}})}catch(e){console.error("Error applying calendar cell styling:",e)}}function yv(){try{if(typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not supported in this browser. Calendar responsive text might not work.");return}window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect();let e=null,t=new ResizeObserver(o=>{e&&clearTimeout(e),e=setTimeout(()=>{o.forEach(i=>{if(i.target instanceof HTMLElement){let s=i.contentRect,l=i.target.__lastCalendarSize;if(l&&Math.abs(s.width-l.width)<5&&Math.abs(s.height-l.height)<5)return;i.target.__lastCalendarSize={width:s.width,height:s.height}}}),$i()},150)});window.__journalitCalendarResizeObserver=t,document.querySelectorAll(".journalit-dashboard-calendar").forEach(o=>{t.observe(o)}),document.querySelectorAll(".journalit-dashboard-widget").forEach(o=>{o.querySelector(".journalit-dashboard-calendar")&&t.observe(o)}),document.querySelectorAll(".react-grid-item").forEach(o=>{o.querySelector(".journalit-dashboard-calendar")&&t.observe(o)}),$i(),setTimeout($i,50),setTimeout($i,200)}catch(e){console.error("Error setting up calendar resize observer:",e)}}function bv(){try{YD(),f$(),g$(),$i(),requestAnimationFrame(()=>{$i(),window.__journalitCalendarResizeObserver||yv()}),document.removeEventListener("dashboard-styles-updated",m$),document.addEventListener("dashboard-styles-updated",m$)}catch(e){console.error("Error applying calendar style fixes:",e)}}var m$,xv=te(()=>{m$=()=>{f$(),g$(),$i()}});function Am(){let e=document.head.querySelector("#dashboard-styles"),t=document.createElement("style");t.id="dashboard-styles",t.textContent=jQ,e?(document.head.insertBefore(t,e),setTimeout(()=>e.remove(),0)):document.head.appendChild(t),zQ()}function h$(){let e=document.head.querySelector("#dashboard-styles");if(e){let r=document.createElement("style");r.id="dashboard-styles-backup",r.textContent=e.textContent,document.head.appendChild(r),e.remove(),setTimeout(()=>{let n=document.head.querySelector("#dashboard-styles-backup");n&&n.remove()},50)}let t=document.head.querySelector("#dashboard-transparency-styles");t&&t.remove()}function KD(){var e,t,r,n,a,o;Am();try{let i=(r=(t=(e=window.app)==null?void 0:e.plugins)==null?void 0:t.plugins)==null?void 0:r.journalit;if(i){let s=(o=(a=(n=i.settings)==null?void 0:n.uiCustomization)==null?void 0:a.transparentBackgrounds)!=null?o:!0;document.body.setAttribute("data-transparent-bg",String(s))}}catch(i){console.error("Error accessing plugin settings for transparency:",i),document.body.setAttribute("data-transparent-bg","true")}setTimeout(()=>Am(),50)}function Im(){var e,t,r,n,a,o;try{Am();try{let l=(r=(t=(e=window.app)==null?void 0:e.plugins)==null?void 0:t.plugins)==null?void 0:r.journalit;if(l){let c=(o=(a=(n=l.settings)==null?void 0:n.uiCustomization)==null?void 0:a.transparentBackgrounds)!=null?o:!0;document.body.setAttribute("data-transparent-bg",String(c))}}catch(l){console.error("Error accessing plugin settings for transparency:",l)}if(!document.head.querySelector("#filter-layout-fix-styles")){let l=document.createElement("style");l.id="filter-layout-fix-styles",l.textContent=`
        /* Force filters section to stay compact and left-aligned */
        .journalit-dashboard-filters-section {
          display: flex !important;
          flex-direction: row !important;
          gap: 20px !important; /* Increased from 10px to 20px for more spacing */
          justify-content: flex-start !important;
          max-width: fit-content !important;
          flex-wrap: nowrap !important;
          margin-right: 0 !important; /* Changed from auto to prevent pushing buttons off alignment */
          align-items: center !important;
        }
        
        /* Ensure account filter has proper spacing from ticker filter */
        .journalit-dashboard-accounts-section {
          margin-left: 20px !important;
          padding-left: 0 !important;
          flex: 0 0 auto !important;
          order: 2 !important;
        }
        
        /* Keep ticker filter on the left */
        .journalit-dashboard-tickers-section {
          flex: 0 0 auto !important;
          order: 1 !important;
        }
        
        /* Add spacing div to take remaining space */
        .journalit-dashboard-filters-spacer {
          flex: 1 1 auto !important;
          order: 3 !important;
        }
        
        /* Reset any existing flexbox layout for the filter row */
        .journalit-dashboard-filter-row {
          display: grid !important;
          grid-template-columns: auto 1fr auto !important;
          gap: 20px !important;
        }
        
        /* Force the action buttons to the right */
        .journalit-dashboard-filter-actions {
          justify-self: end !important;
          margin-left: auto !important;
        }
        
        /* Handle compact view filter styling */
        .journalit-dashboard-compact-filters {
          display: flex !important;
          flex-direction: row !important;
          gap: 10px !important;
          justify-content: flex-start !important;
          flex-wrap: nowrap !important;
          align-items: center !important;
        }
        
        /* Make sure compact view also has correct section styling with proper spacing */
        .journalit-dashboard-compact-filters .journalit-dashboard-tickers-section {
          margin: 0 !important;
          padding: 0 !important;
        }
        .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
          margin: 0 0 0 20px !important;
          padding: 0 !important;
        }
        
        /* Force very high specificity for filter layout fixes */
        body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section {
        display: flex !important;
        flex-direction: row !important;
        gap: 20px !important;
        justify-content: flex-start !important;
        max-width: fit-content !important;
        flex-wrap: nowrap !important;
        margin-right: auto !important;
        }
          
          /* Ultra-high specificity rule to ensure account filter spacing */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section .journalit-dashboard-accounts-section,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
            margin-left: 20px !important;
          }
          
          /* Ultra-high specificity rule to ensure buttons are properly aligned to the right */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.standard-responsive .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.compact .journalit-dashboard-filter-actions.button-container {
            justify-self: end !important;
            margin-left: auto !important;
          }
      `,document.head.appendChild(l)}[0,100,300,600,1200].forEach(l=>{setTimeout(()=>{let c=new CustomEvent("dashboard-styles-updated");if(document.dispatchEvent(c),!document.head.querySelector("#unified-component-selector-styles")){let u=document.createElement("style");u.id="unified-component-selector-styles",u.textContent=`
            .unified-selector-overlay {
              backdrop-filter: blur(3px) !important;
              z-index: 100000 !important;
              align-items: flex-start !important;
            }
            .journalit-dashboard-component-selector {
              animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
              border-radius: 12px !important;
              overflow: hidden !important;
              z-index: 100001 !important;
              margin-top: 100px !important;
            }
            /* Force specific spacing values */
            .journalit-dashboard-filter-controls {
              margin-bottom: 2px !important; /* Reduced from 10px */
            }
            .journalit-dashboard-unified-selector-button-container {
              margin-bottom: 4px !important;
              padding: 4px !important;
            }
            /* Set unified container gap to match screenshot */
            .journalit-dashboard-unified-container {
              background-color: transparent !important;
              box-shadow: none !important;
              gap: 2px !important; /* Reduced from 10px */
            }
            /* Make sure top and bottom sections have no visual separation and equal padding */
            .journalit-dashboard-top-section, 
            .journalit-dashboard-bottom-section {
              background-color: transparent !important;
              border-radius: 0 !important;
              box-shadow: none !important;
              padding: 0 !important;
            }
            /* Remove blur effects and apply transparent backgrounds to all dashboard elements */
            .journalit-dashboard-metric-card,
            .journalit-dashboard-metric-wrapper,
            .journalit-dashboard-widget,
            .react-grid-item,
            .journalit-dashboard-calendar, 
            .journalit-dashboard-calendar-grid,
            .journalit-dashboard-calendar-week,
            .journalit-dashboard-calendar-day,
            .journalit-dashboard-calendar-weekly-pnl,
            .journalit-dashboard-widget-content,
            .journalit-dashboard-widget-container,
            .journalit-chart-container,
            .recharts-wrapper,
            .recharts-surface {
              backdrop-filter: none !important;
              -webkit-backdrop-filter: none !important;
              background-color: transparent !important;
            }
            /* Category tabs - ensure they're centered */
            .journalit-dashboard-component-selector-categories {
              justify-content: center !important;
            }
            /* SVG close button styling for perfect centering */
            .journalit-dashboard-component-selector-close svg {
              width: 14px !important;
              height: 14px !important;
              display: block !important;
            }
            /* Ensure today highlighting is always applied */
            .journalit-dashboard-calendar-day.today {
              border: 2px solid var(--interactive-accent) !important;
              box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
              position: relative !important;
              z-index: 2 !important;
            }
            /* Ensure the remove buttons don't pierce through the overlay */
            .journalit-dashboard-widget-remove,
            .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
            .journalit-dashboard-widget .journalit-dashboard-widget-remove {
              z-index: 10000 !important; /* Lower than the overlay */
            }
            
            /* Ensure text in calendar cells can adjust responsively */
            .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar-weekly-pnl-value {
              transition: font-size 0.1s ease-out !important;
              /* Remove default !important font-size rules to allow dynamic sizing */
              font-size: unset !important;
            }
            
            /* Trade count text styling - keep smaller than PNL */
            .journalit-dashboard-calendar-day-trades,
            .journalit-dashboard-calendar-weekly-trades {
              transition: font-size 0.1s ease-out !important;
              font-size: 10px !important; /* Set default smaller size */
              color: var(--text-muted) !important;
              top: 70% !important; /* Position lower */
            }
            
            /* Special protection for specific elements that might get overridden */
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
              /* Further reset any default size rules to allow dynamically applied sizes */
              font-size: unset !important;
            }
          `,document.head.appendChild(u)}},l)});let s=(l,c)=>{setTimeout(()=>{try{yv(),$i(),c>0&&s(Math.min(l*1.5,1e3),c-1)}catch(d){console.error(`Error setting up calendar resize observer (attempt ${5-c}):`,d),c>0&&s(Math.min(l*1.5,1e3),c-1)}},l)};s(100,5),[100,300,500,800,1200].forEach(l=>{setTimeout(()=>{try{if(document.querySelectorAll(".journalit-dashboard-calendar").length>0){YD();let d=new CustomEvent("dashboard-styles-updated");document.dispatchEvent(d)}}catch(c){console.error(`Error in calendar-specific fixes at ${l}ms:`,c)}},l)})}catch(i){console.error("Error forcing dashboard styles:",i),Am()}}function zQ(){let e=document.head.querySelector("#dashboard-transparency-styles");e&&e.remove();let t=document.createElement("style");t.id="dashboard-transparency-styles";let r=document.body.getAttribute("data-transparent-bg")!=="false";t.textContent=r?`
    /* Transparent mode - keep or force transparent backgrounds */
    .journalit-dashboard-widget,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .react-grid-item,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl,
    .recharts-wrapper {
      background-color: transparent !important;
      backdrop-filter: none !important;
    }
    
    /* Filter Controls transparent styling */
    .journalit-dashboard-filter-controls {
      background-color: transparent !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
      box-shadow: none !important;
    }
    
    /* Make most filter buttons transparent in transparent mode, but keep dropdowns with solid backgrounds */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: transparent !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
    }
    
    /* Keep dropdown summaries with dark backgrounds to match buttons */
    .journalit-dashboard-account-summary,
    .journalit-dashboard-ticker-summary {
      background-color: var(--interactive-accent) !important;
      border: 1px solid var(--interactive-accent) !important;
      color: var(--text-on-accent) !important;
    }
    
    /* Style dropdown arrows to be visible on dark backgrounds */
    .journalit-dashboard-account-summary .dropdown-arrow,
    .journalit-dashboard-ticker-summary .dropdown-arrow {
      color: var(--text-on-accent) !important;
      opacity: 0.9 !important;
    }
    
    /* Ensure hover states are distinct and visible */
    .journalit-dashboard-account-summary:hover,
    .journalit-dashboard-ticker-summary:hover {
      background-color: var(--interactive-accent-hover, var(--interactive-accent)) !important;
      filter: brightness(1.1) !important;
      border-color: var(--interactive-accent) !important;
    }
    
    /* Maintain dropdown background colors for legibility */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08) !important;
    }
    
    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }
    `:`
    /* Filled mode - apply background colors */
    /* Keep widget headers transparent as in the screenshot */
    .journalit-dashboard-widget-header,
    .journalit-dashboard-widget-minimal-header {
      background-color: transparent !important;
      border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.3) !important;
    }
    
    /* All components should have the same dark background color as the dashboard */
    .journalit-dashboard-widget,
    .react-grid-item,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl {
      background-color: var(--background-primary) !important;
    }
    
    /* Filter Controls filled styling */
    .journalit-dashboard-filter-controls {
      background-color: var(--background-primary) !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Style for most filter buttons in filled mode */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Keep dropdown summaries with dark backgrounds to match buttons */
    .journalit-dashboard-account-summary,
    .journalit-dashboard-ticker-summary {
      background-color: var(--interactive-accent) !important;
      border: 1px solid var(--interactive-accent) !important;
      color: var(--text-on-accent) !important;
    }
    
    /* Style dropdown arrows to be visible on dark backgrounds */
    .journalit-dashboard-account-summary .dropdown-arrow,
    .journalit-dashboard-ticker-summary .dropdown-arrow {
      color: var(--text-on-accent) !important;
      opacity: 0.9 !important;
    }
    
    /* Ensure hover states are distinct and visible */
    .journalit-dashboard-account-summary:hover,
    .journalit-dashboard-ticker-summary:hover {
      background-color: var(--interactive-accent-hover, var(--interactive-accent)) !important;
      filter: brightness(1.1) !important;
      border-color: var(--interactive-accent) !important;
    }
    
    /* Ensure dropdowns match the filled style */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }
    
    /* Override positive/negative backgrounds to be more prominent against dark backgrounds */
    .journalit-dashboard-calendar-day.positive,
    .journalit-dashboard-calendar-weekly-pnl.positive {
      background-color: rgba(67, 160, 71, 0.35) !important;
    }
    
    .journalit-dashboard-calendar-day.negative,
    .journalit-dashboard-calendar-weekly-pnl.negative {
      background-color: rgba(229, 57, 53, 0.35) !important;
    }
    `,document.head.appendChild(t)}var jQ,JD=te(()=>{xv();jQ=`
  /* Base styling that applies regardless of transparency setting */
  /* Dashboard CSS variables */
  :root {
    /* Add background color variables for filled mode */
    --widget-bg-color: transparent;
    --metric-card-bg-color: transparent;
    --chart-bg-color: transparent;
    --calendar-day-bg-color: transparent;
    --calendar-weekday-bg-color: transparent;
    --interactive-accent-rgb: 94, 129, 172;
    --dashboard-dot-color: rgba(120, 120, 120, 0.15);
  }

  /* Light theme specific dot color */
  .theme-light .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px) !important;
  }

  /* Dark theme specific dot color */
  .theme-dark .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px) !important;
  }

  /* Ensure no gap below view-header */
  .view-header {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }
  
  /* Dashboard view container */
  .journalit-dashboard-view {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    background-color: var(--background-primary) !important;
    background-size: 20px 20px !important;
    background-position: 0 0 !important;
    padding: 16px !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    margin-top: 0 !important; /* Explicitly set to avoid unintended spacing */
  }
  
  /* Unified dashboard container for TopSection and BottomSection */
  .journalit-dashboard-unified-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 2.5px !important; /* Set to half of the blue line gap (5px) */
    background-color: transparent !important;
    padding: 0 !important;
    flex: 1 1 0 !important; /* CRITICAL: Force height constraint like TradeLog fix */
    min-height: 0 !important; /* Prevent flexbox expansion */
    height: 0 !important; /* Force parent to control height */
  }
  
  /* Top metrics section */
  .journalit-dashboard-top-section {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important; /* Reduced from 16px to match grid layout gap */
    margin-bottom: 0 !important;
    padding: 4px !important; /* Reduced from 8px to reduce vertical spacing */
    background-color: transparent !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
  
  /* Top metrics section styling */
  .journalit-dashboard-metrics {
    display: flex !important;
    flex-direction: row !important; /* Force horizontal layout */
    flex-wrap: wrap !important; /* Allow wrapping to new rows */
    gap: 8px !important; /* Consistent gap between cards */
    width: 100% !important; /* Ensure full width */
    overflow-x: hidden !important; /* No horizontal scrolling needed */
    overflow-y: visible !important; /* Allow vertical expansion */
    align-items: stretch !important; /* Make all cards the same height within each row */
    height: auto !important; /* Auto height based on content */
    min-height: auto !important; /* Let height be determined by content */
    padding: 10px 0 !important; /* Add some vertical padding */
    justify-content: flex-start !important; /* Align cards to the left */
  }
  
  /* Metric wrapper and card */
  .journalit-dashboard-metric-wrapper {
    position: relative !important;
    display: block !important;
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important; /* Minimum width before wrapping */
    max-width: 300px !important; /* Maximum width to prevent cards from getting too wide */
  }
  
  /* We use the widget-remove button class for both widgets and metrics for consistency */
  .journalit-dashboard-widget-remove {
    position: absolute !important;
    top: 4px !important;
    right: 4px !important;
    background-color: var(--background-modifier-error) !important;
    color: white !important;
    border: none !important;
    border-radius: 50% !important;
    width: 22px !important;
    height: 22px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
    cursor: pointer !important;
    z-index: 10000 !important; /* High, but lower than the overlay z-index */
    padding: 0 !important;
    font-weight: bold !important;
    line-height: 1 !important;
    pointer-events: auto !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 0 !important; /* Hidden by default */
  }
  
  /* Show the remove button on widget hover in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-grid-item:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Show the remove button on metric hover in edit mode */
  .journalit-dashboard-top-section .journalit-dashboard-metric-wrapper:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Ensure the remove button is always clickable and has highest z-index */
  .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
  .journalit-dashboard-widget .journalit-dashboard-widget-remove {
    pointer-events: auto !important;
    z-index: 100 !important; /* Reduced from 100000 to reasonable value */
  }
  
  .journalit-dashboard-widget-remove:hover {
    background-color: var(--text-error) !important;
    transform: scale(1.1) !important;
  }
  
  .journalit-dashboard-metric-card {
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important;
    max-width: 300px !important; /* Prevent cards from getting too wide */
    padding: 14px !important;
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08) !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
  }
  
  .journalit-dashboard-metric-name {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-muted) !important;
    margin-bottom: 6px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value {
    font-size: 24px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value.positive {
    color: #43a047 !important; /* Green for positive values */
  }
  
  .journalit-dashboard-metric-value.negative {
    color: #e53935 !important; /* Red for negative values */
  }
  
  /* Styling for cents in currency values */
  .journalit-dashboard-metric-cents {
    font-size: 16px !important;
    opacity: 0.7 !important;
    font-weight: 500 !important;
    margin-left: 1px !important;
    display: inline-block !important;
  }
  
  /* Filter controls - Redesigned for single row compact layout */
  .journalit-dashboard-filter-controls {
    --button-gap: 8px; /* Variable for consistent spacing between buttons */
    display: flex !important;
    flex-direction: column !important;
    margin-bottom: 2.5px !important; /* Reduced from 5px to 2.5px (half of original) */
    padding: 12px 16px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  /* Filter row base styles */
  .journalit-dashboard-filter-row {
    display: grid !important;
    grid-template-columns: auto 1fr auto !important;
    gap: 20px !important;
    align-items: center !important; /* Change from flex-start to center */
    width: 100% !important;
  }
  
  /* Combined filters section */
  .journalit-dashboard-filters-section {
    display: flex !important;
    flex-direction: row !important;
    gap: 10px !important;
    align-items: center !important;
    min-width: 0 !important; /* Allow content to shrink if needed */
    flex: 1 !important;
  }
  
  .journalit-dashboard-date-range-section {
    display: flex !important;
    flex-direction: row !important;
    position: relative !important; /* Needed for absolute positioning of dropdown */
    /* Removed fixed min-width */
    flex: 1 !important;
    /* Changed from fixed margin to flexible margin */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-tickers-section,
  .journalit-dashboard-accounts-section {
    display: flex !important;
    flex-direction: row !important;
    /* Remove justify-self which can cause positioning issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-filter-label {
    font-size: 13px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: inline-block !important;
  }
  
  .journalit-dashboard-filter-actions {
    display: flex !important;
    align-items: center !important;
    /* Remove justify-self that can create issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    gap: var(--button-gap) !important;
    min-width: fit-content !important; /* Ensure buttons don't get squished */
    justify-self: end !important; /* Force align to the right in grid */
    margin-left: auto !important; /* Add auto margin to push to the right */
  }
  
  /* Special container for buttons in compact view */
  .journalit-dashboard-filter-actions.button-container {
    display: flex !important;
    flex-direction: column !important;
    gap: var(--button-gap) !important;
  }
  
  /* Ensure buttons in compact view have consistent spacing */
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-reset-button,
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-edit-mode-button {
    margin-bottom: 0 !important;
    margin-top: 0 !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  /* Date range filter - More compact */
  .journalit-dashboard-date-range-filter {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    position: relative !important; /* Add this to ensure proper containment of the dropdown */
  }
  
  .journalit-dashboard-date-range-presets {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    align-items: center !important;
  }
  
  .journalit-dashboard-date-range-presets button {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-date-range-presets button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-presets button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-inputs {
    display: flex !important;
    gap: 10px !important;
    flex-wrap: nowrap !important; /* Keep horizontal layout */
    padding: 8px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    margin-top: 0 !important; /* Remove top margin */
    position: absolute !important;
    top: 0 !important; /* Align with the buttons horizontally */
    left: auto !important; /* Reset left positioning */
    right: -360px !important; /* Position to the right of buttons */
    z-index: 100 !important;
    width: 350px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
  
  /* Animation for opening/closing the dropdown */
  .journalit-dashboard-date-range-inputs.date-dropdown-visible {
    animation: dateDropdownFadeIn 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  @keyframes dateDropdownFadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Specific styling for custom date dropdown to make sure it appears in the right position */
  .journalit-dashboard-custom-date-dropdown {
    position: absolute !important;
    top: 0 !important; /* Position at the same level as buttons */
    left: auto !important;
    right: -360px !important; /* Position to the right of the custom button */
    z-index: 100 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }

  /* Position dropdown to the left when it would go off-screen */
  .journalit-dashboard-custom-date-dropdown.position-left {
    right: auto !important;
    left: -360px !important; /* Position to the left of the custom button */
  }
  
  .journalit-dashboard-date-range-start,
  .journalit-dashboard-date-range-end {
    flex: 1 !important;
    min-width: 150px !important;
  }
  
  .journalit-dashboard-date-range-start label,
  .journalit-dashboard-date-range-end label {
    display: block !important;
    font-size: 12px !important;
    margin-bottom: 4px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
  }
  
  /* Date picker input styling */
  .journalit-date-picker-input input {
    width: 100% !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }
  
  .journalit-date-picker-input input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }
  
  .journalit-date-picker-input input:hover {
    border-color: var(--interactive-hover) !important;
  }
  
  /* Account filter - New dropdown style */
  .journalit-dashboard-account-filter,
  .journalit-dashboard-ticker-filter {
    display: flex !important;
    flex-direction: column !important;
    /* Changed from fixed width to min-width for better responsiveness */
    min-width: 140px !important;
    max-width: 200px !important;
    width: 100% !important;
    position: relative !important;
  }
  
  /* Ensure filters within the combined section size properly */
  .journalit-dashboard-filters-section .journalit-dashboard-tickers-section,
  .journalit-dashboard-filters-section .journalit-dashboard-accounts-section {
    flex: 1 !important;
    min-width: 0 !important;
  }
  
  /* Responsive account/ticker filter class for enhanced appearance across screen sizes */
  .journalit-responsive-account-filter,
  .journalit-responsive-ticker-filter {
    width: auto !important;
    flex-shrink: 0 !important;
    /* Ensure dropdowns always fit content */
    white-space: nowrap !important;
    overflow: visible !important;
  }
  
  .journalit-dashboard-account-dropdown,
  .journalit-dashboard-ticker-dropdown {
    position: relative !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-account-summary,
  .journalit-dashboard-ticker-summary {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 5px 10px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-account-summary:hover,
  .journalit-dashboard-ticker-summary:hover {
    border-color: var(--interactive-accent) !important;
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-account-summary .dropdown-arrow,
  .journalit-dashboard-ticker-summary .dropdown-arrow {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    margin-left: 8px !important;
  }
  
  .journalit-dashboard-account-options-dropdown,
  .journalit-dashboard-ticker-options-dropdown {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 250px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    margin-top: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    z-index: 100 !important;
    min-width: 200px !important;
  }
  
  .journalit-dashboard-account-option-item,
  .journalit-dashboard-ticker-option-item {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 0.2s ease !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-account-option-item:hover,
  .journalit-dashboard-ticker-option-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-account-option-item.select-all,
  .journalit-dashboard-ticker-option-item.select-all {
    font-weight: 600 !important;
    color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-account-divider,
  .journalit-dashboard-ticker-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 4px 0 !important;
  }
  
  /* No accounts/tickers message */
  .journalit-dashboard-no-accounts,
  .journalit-dashboard-no-tickers {
    padding: 12px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    text-align: center !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-reset-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-reset-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-reset-button:disabled {
    opacity: 0.5 !important;
    cursor: default !important;
  }
  
  /* Grid layout container */
  .journalit-dashboard-bottom-section {
    width: 100% !important;
    min-height: 500px !important;
    background-color: transparent !important;
    border-radius: 0 !important;
    padding: 4px !important; /* Reduced from 8px to match top section */
    position: relative !important;
  }
  
  /* Widget styles */
  .journalit-dashboard-widget {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    /* backdrop-filter removed as requested */
  }
  
  /* Minimal widget header for non-edit mode */
  .journalit-dashboard-widget-minimal-header {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 4px 12px !important;
    height: 24px !important;
    background-color: transparent !important;
    border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.4) !important;
    opacity: 0.8 !important;
  }
  
  .journalit-dashboard-widget-minimal-header .journalit-dashboard-widget-title {
    font-weight: 500 !important;
    font-size: 13px !important;
    color: var(--text-muted) !important;
    letter-spacing: 0.3px !important;
    text-align: center !important;
    width: 100% !important;
    /* Add subtle text shadow for better readability */
    text-shadow: 0 1px 1px rgba(var(--background-primary-rgb), 0.8) !important;
  }
  
  .journalit-dashboard-widget-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 12px 16px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-widget-title {
    font-size: 16px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-widget-controls {
    display: flex !important;
    gap: 8px !important;
  }
  
  .journalit-dashboard-widget-content {
    flex: 1 !important;
    padding: 4px 4px 2px 1px !important;
    overflow: hidden !important;
    background-color: transparent !important;
  }
  
  /* React Grid Layout styles */
  .react-grid-item {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    /* backdrop-filter removed as requested */
  }
  
  .react-grid-item.react-grid-placeholder {
    background-color: var(--interactive-accent) !important;
    opacity: 0.3 !important;
  }
  
  .react-resizable-handle {
    position: absolute !important;
    bottom: 0 !important;
    right: 0 !important;
    width: 20px !important;
    height: 20px !important;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(120, 120, 120, 0.5)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 22L12 12M22 13V22H13"></path></svg>') !important;
    background-position: bottom right !important;
    padding: 0 3px 3px 0 !important;
    background-repeat: no-repeat !important;
    background-origin: content-box !important;
    box-sizing: border-box !important;
    cursor: se-resize !important;
    display: none !important; /* Hide resize handles by default */
  }
  
  /* Only show resize handles when in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-resizable-handle {
    display: block !important;
  }
  
  /* Chart styles */
  .recharts-wrapper {
    width: 100% !important;
    height: 100% !important;
  }
  
  .recharts-cartesian-grid-horizontal line,
  .recharts-cartesian-grid-vertical line {
    stroke: var(--background-modifier-border) !important;
    stroke-dasharray: 2 !important;
  }
  
  /* Modern custom tooltip styles */
  .recharts-tooltip-wrapper {
    pointer-events: none !important;
    z-index: 1000 !important;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25)) !important;
    background-color: transparent !important;
    border: none !important;
  }
  
  .recharts-tooltip-wrapper * {
    outline: none !important;
  }
  
  .journalit-dashboard-custom-tooltip {
    background-color: var(--background-primary, #ffffff) !important;
    border-radius: 8px !important;
    padding: 12px 16px !important;
    min-width: 120px !important;
    border: 1px solid var(--background-modifier-border, rgba(0, 0, 0, 0.05)) !important;
    transform: translateY(-4px) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  
  .journalit-dashboard-tooltip-date {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal, #333333) !important;
    margin-bottom: 6px !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value {
    font-size: 18px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value.positive {
    color: var(--text-success, #43a047) !important;
  }
  
  .journalit-dashboard-tooltip-value.negative {
    color: var(--text-error, #e53935) !important;
  }
  
  /* Calendar widget */
  .journalit-dashboard-calendar {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: auto !important;
  }
  
  .journalit-dashboard-calendar-header {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    margin-bottom: 8px !important;
    gap: 4px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: transparent !important;
    z-index: 5 !important;
    padding: 4px 0 !important;
    width: 100% !important;
    justify-content: stretch !important;
  }
  
  /* Special styling for when weekends are hidden */
  /* We apply the hide-weekends class directly to the header and week rows */
  .journalit-dashboard-calendar-header.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-header {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
    flex: 1 !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-week {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    gap: 4px !important;
    margin-bottom: 4px !important;
    width: 100% !important;
  }
  
  /* Special styling for when weekends are hidden */
  .journalit-dashboard-calendar-week.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-week {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  /* Ensure the calendar container has proper styles */
  .journalit-dashboard-calendar.hide-weekends,
  .journalit-dashboard-calendar.weekends-hidden {
    width: 100% !important;
  }
  
  /* Ensure grid cells take up full width in their columns */
  .journalit-dashboard-calendar-day,
  .journalit-dashboard-calendar-weekly-pnl {
    width: 100% !important; 
  }
  
  /* Ensure P&L header is visible in both light and dark modes */
  .theme-light .journalit-dashboard-calendar-weekday.weekly-pnl-header {
    background-color: var(--interactive-accent, #5e81ac) !important; /* Use an accent background with fallback for better contrast */
    color: var(--text-on-accent, #ffffff) !important; /* Ensure text color is appropriate for accent background */
  }

  /* Weekly P&L column styles */
  .journalit-dashboard-calendar-weekly-pnl {
    aspect-ratio: 1 !important;
    position: relative !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    padding: 4px !important;
    border-left: 1px solid rgba(0, 0, 0, 0.08) !important;
    cursor: pointer !important;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl:hover {
    transform: scale(1.05) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.positive {
    background-color: rgba(67, 160, 71, 0.15) !important;
    color: #43a047 !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.negative {
    background-color: rgba(229, 57, 53, 0.15) !important;
    color: #e53935 !important;
  }
  
  /* Weekly totals positioning */
  .journalit-dashboard-calendar-week-total-label {
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    color: var(--text-muted) !important;
    position: absolute !important;
    top: 25% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-total-value {
    font-size: 13px !important;
    font-weight: 700 !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-trade-count {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
    position: absolute !important;
    bottom: 20% !important;
    left: 50% !important;
    transform: translate(-50%, 50%) !important;
    width: 85% !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .journalit-dashboard-calendar-day {
    aspect-ratio: 1 !important;
    display: flex !important;
    position: relative !important; /* Added for absolute positioning */
    border-radius: 8px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    transition: all 0.2s !important;
    background-color: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
  }
  
  .journalit-dashboard-calendar-day:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive {
    background-color: rgba(67, 160, 71, 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(67, 160, 71, 0.05), rgba(67, 160, 71, 0.2)) !important;
    color: #43a047 !important;
    border-color: rgba(67, 160, 71, 0.3) !important;
    box-shadow: 0 2px 8px rgba(67, 160, 71, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.negative {
    background-color: rgba(229, 57, 53, 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(229, 57, 53, 0.05), rgba(229, 57, 53, 0.2)) !important;
    color: #e53935 !important;
    border-color: rgba(229, 57, 53, 0.3) !important;
    box-shadow: 0 2px 8px rgba(229, 57, 53, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive:hover {
    box-shadow: 0 4px 12px rgba(67, 160, 71, 0.2), 0 0 0 1px rgba(67, 160, 71, 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.negative:hover {
    box-shadow: 0 4px 12px rgba(229, 57, 53, 0.2), 0 0 0 1px rgba(229, 57, 53, 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.other-month {
    opacity: 0.3 !important;
  }
  
  /* Day number positioning in the top-left */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
  }
  
  /* PNL value centered and larger */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Week number positioning in the top-left */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    margin-bottom: 0 !important;
  }
  
  /* Weekly PNL value centered and larger */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Weekly trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Recent Trades widget styles */
  .journalit-dashboard-recent-trades {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    /* Remove top padding, keep padding on sides and bottom to prevent gap above sticky header */
    padding: 0 8px 8px 8px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-recent-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
    /* Add padding to the top of the table to replace container's top padding */
    padding-top: 8px !important;
    margin-top: 0 !important;
  }
  
  .journalit-dashboard-recent-trades-table th {
    text-align: left !important;
    padding: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
    font-weight: 600 !important;
    background-color: var(--background-secondary-alt) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important; /* Increased z-index to ensure header stays above content */
  }
  
  .journalit-dashboard-recent-trades-table th.pnl-column {
    text-align: right !important;
  }
  
  .journalit-dashboard-recent-trades-table td {
    padding: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row {
    cursor: pointer !important;
    transition: background-color 0.2s ease !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row:hover {
    background-color: var(--interactive-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    z-index: 2 !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row.even {
    background-color: var(--background-primary) !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row.odd {
    background-color: var(--background-secondary) !important;
  }
  
  .journalit-dashboard-recent-trades-table .ticker-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .direction-cell {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell {
    text-align: right !important;
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.positive {
    color: #4caf50 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.negative {
    color: #f44336 !important;
  }
  
  .journalit-dashboard-recent-trades-table .empty-message {
    text-align: center !important;
    padding: 16px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  
  /* Today highlight styling with high specificity to prevent overrides */
  .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day.today {
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
    position: relative !important;
    z-index: 2 !important; /* Higher z-index to ensure the highlight is visible */
    animation: pulseBorder 2s infinite ease-in-out !important;
  }
  
  .journalit-dashboard-calendar-day.neutral {
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
  }
  
  /* Table styles */
  .journalit-dashboard-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
  }
  
  .journalit-dashboard-trades-table th,
  .journalit-dashboard-trades-table td {
    padding: 8px 12px !important;
    text-align: left !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-trades-table th {
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 1 !important;
  }
  
  .journalit-dashboard-trades-table tr:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  /* Layout controls */
  .journalit-dashboard-layout-controls {
    display: flex !important;
    justify-content: flex-end !important;
    gap: 8px !important;
    margin-bottom: 16px !important;
  }
  
  /* Edit mode button in filter actions */
  .journalit-dashboard-edit-mode-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-edit-mode-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-edit-mode-button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Loading and error states */
  .journalit-dashboard-loading,
  .journalit-dashboard-error {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 20px !important;
    font-size: 16px !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-error {
    color: var(--text-error) !important;
  }
  
  /* Responsive styles - comprehensive approach for all screen sizes */
  /* XL screens - new breakpoint to handle 1560px width */
  @media (max-width: 1560px) {
    /* Adjust filter controls for this specific breakpoint range */
    .journalit-dashboard-filter-row.standard-responsive {
      grid-template-columns: minmax(300px, auto) auto 1fr auto !important;
      gap: 10px !important;
    }
    
    /* Ensure filters section stays in one line */
    .journalit-dashboard-filters-section {
      flex-wrap: nowrap !important;
      max-width: fit-content !important;
      justify-content: flex-start !important;
    }
    
    /* Make sure account and ticker filters have adequate space and stay together */
    .journalit-dashboard-account-filter,
    .journalit-dashboard-ticker-filter {
      min-width: 140px !important;
    }
    
    /* Keep account filter next to ticker filter */
    .journalit-dashboard-accounts-section {
      margin-left: 0 !important;
      padding-left: 0 !important;
    }
    
    /* Ensure the row structure stays intact at this breakpoint */
    .journalit-dashboard-filter-section {
      width: 100% !important;
    }
    
    /* Adjust date range input position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -250px !important; /* Reduce the offset */
      width: 300px !important; /* Make it slightly smaller */
    }
  }
  
  /* Large screens */
  @media (max-width: 1200px) {
    /* Slightly reduce padding and margins for better fit */
    .journalit-dashboard-view {
      padding: 12px !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: 180px !important;
    }
  }
  
  /* Medium screens */
  @media (max-width: 996px) {
    /* Further reduce spacing */
    .journalit-dashboard-view {
      padding: 10px !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: 150px !important;
      padding: 12px !important;
    }
    
    .journalit-dashboard-metric-value {
      font-size: 20px !important;
    }
    
    /* Adjust date dropdown position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -100px !important;
    }
  }
  
  /* Medium-small screens - additional breakpoint */
  @media (max-width: 900px) {
    /* Ensure the filter controls container has appropriate padding */
    .journalit-dashboard-filter-controls {
      padding: 10px 12px !important;
    }
    
    /* At this size, begin transitioning to more compact layout */
    .journalit-dashboard-filter-row.standard-responsive {
      /* More aggressive column sizing to prevent overflow */
      grid-template-columns: 1fr auto auto !important;
      gap: 8px !important;
    }
    
    /* Further reduce right margin for date section */
    .journalit-dashboard-date-range-section {
      margin-right: 5px !important;
    }
    
    /* Make buttons more compact */
    /* Ensure buttons in compact tablet views align properly */
    .journalit-dashboard-filter-actions.button-container {
      gap: var(--button-gap) !important;
    }
    
    /* Fixed height buttons in mobile view for consistent appearance */
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-reset-button,
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-edit-mode-button {
      height: 28px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      padding: 4px 8px !important;
      font-size: 11px !important;
    }
    
    /* Make account dropdown narrower */
    .journalit-dashboard-account-filter {
      min-width: 120px !important;
    }
  }
  
  /* Small tablet screens */
  @media (max-width: 768px) {
    /* Force compact view if not already applied by component */
    .journalit-dashboard-filter-controls:not(.compact-view) {
      /* Add a class to force compact view directly via CSS if needed */
      /* This is a backup in case the JS detection doesn't trigger properly */
    }
    
    /* Switch to vertical layout for filter controls */
    .journalit-dashboard-filter-row.standard-responsive,
    .journalit-dashboard-filter-row.medium-responsive,
    .journalit-dashboard-filter-row {
      grid-template-columns: 1fr !important;
      gap: 16px !important;
    }
    
    .journalit-dashboard-filter-row.compact,
    .journalit-dashboard-filter-row.medium-responsive {
      display: flex !important;
      flex-direction: column !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-date-range-section,
    .journalit-dashboard-accounts-section,
    .journalit-dashboard-filter-actions,
    .journalit-dashboard-filter-section {
      width: 100% !important;
      margin: 8px 0 !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      margin: 5px 0 !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-account-filter {
      width: 100% !important;
    }
    
    /* Force full width on select dropdowns */
    .journalit-dashboard-account-dropdown,
    .journalit-dashboard-account-summary {
      width: 100% !important;
    }
    
    /* Ensure date range selector fits properly */
    .journalit-dashboard-date-range-section {
      margin-right: 0 !important;
      width: 100% !important;
      min-width: auto !important;
    }
    
    /* Handle date inputs on small screens */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      position: static !important;
      width: 100% !important;
      margin-top: 8px !important;
      flex-direction: column !important;
      box-shadow: none !important;
    }
    
    /* Adjust metric cards for better small screen display */
    .journalit-dashboard-metrics {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: calc(50% - 8px) !important;
      max-width: none !important;
      flex: 0 0 calc(50% - 8px) !important;
      margin-bottom: 8px !important;
    }
  }
  
  /* Mobile screens */
  @media (max-width: 480px) {
    /* Extremely compact layout for very small screens */
    .journalit-dashboard-view {
      padding: 8px !important;
    }
    
    /* Make sure the filter controls are completely vertical */
    .journalit-dashboard-filter-controls.compact-view {
      padding: 8px !important;
    }
    
    /* Full width metrics on mobile */
    .journalit-dashboard-metric-card {
      min-width: 100% !important;
      flex: 0 0 100% !important;
      margin-bottom: 8px !important;
    }
    
    /* Make buttons more touch-friendly */
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button,
    .journalit-dashboard-add-component-button {
      padding: 10px !important;
      height: auto !important;
      min-height: 40px !important;
    }
    
    /* Ensure date presets fit on small screens */
    .journalit-dashboard-date-range-presets {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-date-range-presets button {
      flex: 0 1 auto !important;
      margin: 2px !important;
      font-size: 11px !important;
      padding: 4px 8px !important;
    }
    
    /* Ensure the component selector fits on small screens */
    .journalit-dashboard-component-selector {
      width: 90vw !important;
      max-height: 80vh !important;
      margin-top: 50px !important;
    }
  }
  
  /* Extra small screens */
  @media (max-width: 360px) {
    /* Extreme space optimization */
    .journalit-dashboard-view {
      padding: 4px !important;
    }
    
    .journalit-dashboard-filter-controls {
      padding: 6px !important;
    }
    
    /* Minimize all padding and margins */
    .journalit-dashboard-top-section,
    .journalit-dashboard-bottom-section {
      padding: 2px !important;
    }
    
    /* Ensure date buttons are minimal but usable */
    .journalit-dashboard-date-range-presets button {
      padding: 3px 6px !important;
      font-size: 10px !important;
    }
  }
  
  /* Unified Component Selector */
  .unified-selector-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(0, 0, 0, 0.4) !important;
    backdrop-filter: blur(3px) !important;
    z-index: 1000 !important; /* Reduced from 100000 to prevent conflicts */
    display: flex !important;
    align-items: flex-start !important;
    justify-content: center !important;
    padding: 20px !important;
    pointer-events: none !important; /* Prevent blocking interactions */
  }
  
  .journalit-dashboard-component-selector {
    position: relative !important;
    margin-top: 100px !important;
    width: 480px !important;
    max-height: 75vh !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    z-index: 1001 !important; /* One higher than the overlay */
    pointer-events: auto !important; /* Ensure modal content is interactive */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
    max-width: 90vw !important;
    animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  .journalit-dashboard-unified-selector-button-container {
    display: flex !important;
    justify-content: center !important;
    margin: 0 0 4px 0 !important; /* Reduced from 8px to 4px */
    padding: 4px !important; /* Reduced from 8px to 4px */
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px dashed var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-add-component-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 8px 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-add-component-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }
  
  .journalit-dashboard-component-selector-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 16px 20px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 12px 12px 0 0 !important;
  }
  
  .journalit-dashboard-component-selector-header h3 {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 !important;
  }
  
  .journalit-dashboard-component-selector-close {
    width: 28px !important;
    height: 28px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 6px !important;
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-muted) !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    border: none !important;
    padding: 0 !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-close svg {
    width: 14px !important;
    height: 14px !important;
    display: block !important;
  }
  
  .journalit-dashboard-component-selector-close:hover {
    background-color: var(--background-modifier-error-hover) !important;
    color: white !important;
    transform: rotate(90deg) !important;
  }
  
  .journalit-dashboard-component-selector-search {
    padding: 12px 20px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-component-selector-search input {
    width: 100% !important;
    padding: 10px 16px !important;
    border-radius: 8px !important;
    background-color: var(--background-modifier-form-field) !important;
    border: 1px solid var(--background-modifier-border) !important;
    font-size: 14px !important;
    transition: all 0.2s ease !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-component-selector-search input:focus {
    box-shadow: 0 0 0 2px var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    outline: none !important;
  }
  
  .journalit-dashboard-component-selector-categories {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    padding: 0 20px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    justify-content: center !important; /* Center tabs horizontally */
  }
  
  .journalit-dashboard-component-selector-category {
    border-radius: 20px !important;
    padding: 6px 14px !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
    border: 1px solid transparent !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: none !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-category:hover {
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-normal) !important;
    transform: translateY(-1px) !important;
  }
  
  .journalit-dashboard-component-selector-category.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    font-weight: 600 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb), 0.3) !important;
  }
  
  .journalit-dashboard-component-selector-list {
    padding: 16px 20px !important;
    max-height: 50vh !important;
    overflow-y: auto !important;
    scrollbar-width: thin !important;
  }
  
  .journalit-dashboard-component-selector-list h4 {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  /* Enhanced component item cards */
  .journalit-dashboard-component-selector-item {
    background-color: var(--background-secondary) !important;
    border-radius: 10px !important;
    padding: 14px 16px !important;
    margin-bottom: 10px !important;
    cursor: pointer !important;
    position: relative !important;
    transition: all 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
    border: 1px solid transparent !important;
  }
  
  .journalit-dashboard-component-selector-item:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    background-color: var(--background-primary) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Component item content styling */
  .journalit-dashboard-component-selector-widget-name {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 6px !important;
  }
  
  /* Visual divider to separate sections in the All tab */
  .journalit-dashboard-component-selector-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 16px 0 20px !important;
    opacity: 0.7 !important;
  }
  
  .journalit-dashboard-component-selector-widget-description {
    font-size: 13px !important;
    color: var(--text-muted) !important;
    margin-bottom: 10px !important;
    line-height: 1.4 !important;
  }
  
  /* Enhanced category badge */
  .journalit-dashboard-component-selector-widget-category {
    display: inline-block !important;
    font-size: 11px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary-alt) !important;
    padding: 3px 8px !important;
    border-radius: 12px !important;
    margin-top: 4px !important;
  }
  
  /* Enhanced status badge */
  .journalit-dashboard-component-selector-widget-badge {
    position: absolute !important;
    top: 12px !important;
    right: 12px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    color: white !important;
    background: linear-gradient(135deg, var(--text-success), #2e7d32) !important;
    padding: 3px 10px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  /* Empty list message */
  .journalit-dashboard-component-selector-empty {
    text-align: center !important;
    padding: 24px 0 !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    font-size: 14px !important;
  }
  
  /* Improved scrollbar for the component list */
  .journalit-dashboard-component-selector-list::-webkit-scrollbar {
    width: 8px !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-track {
    background: transparent !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb {
    background-color: var(--background-modifier-border) !important;
    border-radius: 4px !important;
    border: 2px solid var(--background-primary) !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb:hover {
    background-color: var(--interactive-accent) !important;
  }
  
  /* Animation for the selector */
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.92);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Animation for today's calendar cell */
  @keyframes pulseBorder {
    0% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
    50% {
      box-shadow: 0 0 0 4px rgba(var(--interactive-accent-rgb), 0.15), 0 4px 16px rgba(var(--interactive-accent-rgb), 0.3);
    }
    100% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
  }
  
  /* BaseWidget container styling */
  .journalit-dashboard-widget-container {
    background-color: transparent !important;
  }
  
  /* EmptyState integration with dashboard widgets */
  .journalit-dashboard-widget-container .journalit-empty-state {
    background-color: transparent !important;
    min-height: 140px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 auto !important;
    position: absolute !important; /* Position in the center of container */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-icon {
    margin-bottom: 12px !important;
    color: var(--text-muted) !important;
    display: flex !important;
    justify-content: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-message {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-submessage {
    font-size: 12px !important;
    color: var(--text-muted) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  /* Empty state in main dashboard view */
  .journalit-dashboard-view .journalit-empty-state {
    margin: 0 auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 200px !important;
    width: 100% !important;
  }
  
  /* Table cell EmptyState styling */
  .journalit-dashboard-recent-trades-table td .journalit-empty-state {
    padding: 16px !important;
    min-height: 100px !important;
    background-color: transparent !important;
  }
`});function BQ(){let e=document.head.querySelector("#drc-note-styles");if(e){if(e.textContent&&e.textContent.trim().length>0)return;e.remove()}if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{VD();let t=document.createElement("style");t.id="drc-note-styles",t.textContent=_Q,document.head.appendChild(t)}catch(t){console.error("Error injecting DRCNote styles:",t)}finally{window.__isInjectingStyles=!1}}}function v$(){try{let e=document.head.querySelector("#drc-note-styles");if(e&&e.textContent&&e.textContent.trim().length>0)return;BQ();let t="drc-critical-component-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
        /* Critical styles for DRC component visibility */
        .journalit-drc-view {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .journalit-drc-note-wrapper {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .drc-container {
          display: block !important;
          width: 100% !important;
          box-sizing: border-box !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      `,document.head.appendChild(r)}}catch(e){console.error("Error ensuring DRCNote styles:",e);try{let t="drc-emergency-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
          .journalit-drc-view, .journalit-drc-note-wrapper, .drc-container {
            display: block !important;
            width: 100% !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
        `,document.head.appendChild(r)}}catch(t){console.error("Complete failure in DRCNote style system:",t)}}}var _Q,y$=te(()=>{GD();_Q=`
  /* DRC note view container - match Weekly Review pattern */
  .journalit-drc-view,
  .markdown-preview-view .journalit-drc-view {
    margin: 0 !important; /* Remove all margins */
    border-bottom: none !important; /* Remove bottom border causing extra space */
    padding: 0 !important; /* Remove all padding */
    display: block !important;
    width: 100% !important;
    z-index: 100 !important;
    /* Force visibility */
    visibility: visible !important;
    opacity: 1 !important;
    background-color: var(--background-primary) !important;
    /* Removed borders */
    border: none !important;
    border-radius: 8px !important;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Add a fallback CSS pattern to highlight DRC notes */
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc")) {
    position: relative;
  }
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc"))::before {
    content: '';
    display: block;
    height: 5px;
    width: 100%;
    background-color: var(--color-secondary, var(--text-accent, var(--interactive-accent)));
    margin-bottom: 1rem;
    border-radius: 2px;
  }
  
  /* Main container - transparent to match Weekly Review */
  .drc-note-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    /* Remove border to match Weekly Review */
    border: none;
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
  }
  
  /* Header section with date and summary */
  .drc-note-header {
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .drc-note-date {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-summary {
    font-size: 1rem;
    color: var(--text-muted);
  }
  
  /* Tabs navigation */
  .drc-note-tabs {
    display: flex;
    padding: 0 1rem;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary);
  }
  
  .drc-note-tab-button {
    padding: 0.8rem 1.2rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    transition: color 0.2s;
  }
  
  .drc-note-tab-button:hover {
    color: var(--text-normal);
  }
  
  .drc-note-tab-button.active {
    color: var(--color-primary, var(--interactive-accent));
  }
  
  .drc-note-tab-button.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--color-primary, var(--interactive-accent));
    border-radius: 2px 2px 0 0;
  }
  
  /* Tab content container */
  .drc-note-content {
    padding: 1.5rem;
  }
  
  /* Section styling */
  .drc-note-section {
    margin-bottom: 2rem;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 1.2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }
  
  .drc-note-section-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
    text-align: center;
  }
  
  .drc-note-empty-state {
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: 1rem;
  }
  
  /* Checklist styling */
  .drc-note-checklist {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-checklist-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-success, #43a047);
    font-weight: bold;
    background-color: var(--background-primary);
  }
  
  .drc-note-checkbox.checked {
    background-color: var(--color-success-muted, rgba(67, 160, 71, 0.2));
    border-color: var(--color-success, #43a047);
  }
  
  /* Forecast styling */
  .drc-note-forecast {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }
  
  .drc-note-forecast-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-label {
    font-weight: 600;
    min-width: 80px;
    color: var(--text-muted);
  }
  
  .drc-note-forecast-value {
    color: var(--text-normal);
  }
  
  .drc-note-forecast-notes {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-notes p {
    margin: 0.5rem 0 0 0;
    padding-left: 80px;
    color: var(--text-normal);
  }
  
  /* Goals styling */
  .drc-note-goals ul {
    margin: 0;
    padding-left: 1.5rem;
  }
  
  .drc-note-goals li {
    margin-bottom: 0.5rem;
    color: var(--text-normal);
  }
  
  /* Trades styling */
  .drc-note-trades {
    width: 100%;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
  }
  
  .drc-note-trades-header {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 2fr 1fr;
    background-color: var(--background-modifier-hover);
    font-weight: 600;
    color: var(--text-normal);
    font-size: 0.9rem;
  }
  
  .drc-note-trade-row {
    display: grid;
    transition: background-color 0.2s;
  }
  
  .drc-note-trade-row:hover {
    background-color: var(--background-primary-alt, var(--background-primary));
  }
  
  .drc-note-trade-cell {
    padding: 0.8rem;
    align-items: center;
  }
  
  .drc-note-trade-cell.profit {
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-cell.loss {
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating {
    padding: 0.3rem 0.5rem;
    font-weight: 600;
  }
  
  .drc-note-trade-rating.rating-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-rating.rating-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-trade-rating.rating-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: #e6a700;
  }
  
  .drc-note-trade-rating.rating-d, 
  .drc-note-trade-rating.rating-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating.rating-none {
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-muted);
  }
  
  /* Missed trades styling */
  .drc-note-missed-trades {
    display: flex;
    gap: 1rem;
  }
  
  .drc-note-missed-trade {
    padding: 0.8rem;
    background-color: var(--background-primary);
  }
  
  .drc-note-missed-trade-header {
    display: flex;
    border-bottom: 1px dashed var(--background-modifier-border);
  }
  
  .drc-note-missed-trade-instrument {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-missed-trade-direction {
    color: var(--text-muted);
  }
  
  .drc-note-missed-trade-reason,
  .drc-note-missed-trade-notes {
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
  }
  
  /* Review styling */
  .drc-note-grades {
    display: flex;
    margin-bottom: 1rem;
  }
  
  .drc-note-grade {
    display: flex;
    width: 120px;
  }
  
  .drc-note-grade-label {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }
  
  .drc-note-grade-value {
    font-size: 2rem;
    border-radius: 50%;
  }
  
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-grade-value.grade-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-grade-value.grade-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: #e6a700;
  }
  
  .drc-note-grade-value.grade-d,
  .drc-note-grade-value.grade-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  /* Review questions styling */
  .drc-note-review-questions {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
  }
  
  .drc-note-review-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-review-question {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-review-answer {
    color: var(--text-normal);
    padding: 0.5rem 0 0.5rem 1rem;
  }
  
  .drc-note-review-answer em {
    color: var(--text-muted);
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-note-trades-header,
    .drc-note-trade-row {
      grid-template-columns: 1fr 1fr 1fr;
    }
    
    .drc-note-trades-header > div:nth-child(4),
    .drc-note-trades-header > div:nth-child(5),
    .drc-note-trade-row > div:nth-child(4),
    .drc-note-trade-row > div:nth-child(5) {
      display: none;
    }
    
    .drc-note-missed-trades {
      flex-direction: column;
    }
  }
  
  /* Multiple view compatibility */
  .workspace-split.mod-vertical .journalit-drc-view {
    /* Adjust for vertical split layout */
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-container {
    min-width: 0;
  }
  
  /* Wrapper for the DRC note component */
  .journalit-drc-note-wrapper {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    z-index: 100 !important;
    display: block !important;
    width: 100% !important;
    height: auto !important;
    min-height: 50px !important;
  }
  
  /* Special class for properly mounted DRC components to aid detection */
  .drc-note-mounted {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
`});var $Q,Iw,XD=te(()=>{$Q=`
/* DRC Missed Trades Section Styles */
.drc-missed-trades-section {
  margin-bottom: 24px;
}

.drc-missed-trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  gap: 12px;
  flex-wrap: wrap;
}

.drc-missed-trades-header h3 {
  margin: 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.drc-missed-trades-count {
  color: var(--text-muted);
  font-weight: 400;
  font-size: 16px;
}

.drc-add-missed-trade-btn {
  padding: 8px 16px !important;
  font-size: 14px !important;
  white-space: nowrap;
  flex-shrink: 0;
}

.drc-missed-trades-content {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
  overflow: hidden;
}

.drc-missed-trades-list {
  max-height: 400px;
  overflow-y: auto;
}

.drc-missed-trade-item {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border-subtle);
  transition: background-color 0.2s ease;
}

.drc-missed-trade-item:last-child {
  border-bottom: none;
}

.drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.drc-missed-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  gap: 12px;
}

.drc-missed-trade-main {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 0;
}

.drc-missed-trade-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.drc-missed-trade-instrument {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  flex-shrink: 0;
}

.drc-missed-trade-direction {
  color: var(--text-muted);
  font-size: 14px;
  text-transform: capitalize;
  flex-shrink: 0;
}

.drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: white;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateX(2px);
}

.drc-missed-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  color: var(--text-normal);
  font-size: 14px;
  line-height: 1.4;
}

.drc-missed-trade-setup,
.drc-missed-trade-reason {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.drc-missed-trade-setup strong,
.drc-missed-trade-reason strong {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  min-width: 45px;
}

.drc-missed-trade-reason {
  font-style: italic;
  color: var(--text-muted);
}

/* Loading and Error States */
.drc-missed-trades-loading,
.drc-missed-trades-error {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
}

.drc-missed-trades-error {
  color: var(--text-error, #e53935);
}

.drc-retry-button {
  margin-top: 12px;
  padding: 8px 16px;
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.drc-retry-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Empty State Styling Override for Missed Trades */
.drc-missed-trades-content .empty-state {
  padding: 32px 24px;
  background-color: transparent;
  border: none;
}

.drc-missed-trades-content .empty-state .empty-state-icon {
  color: var(--text-muted);
  opacity: 0.6;
}

.drc-missed-trades-content .empty-state .empty-state-message {
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.drc-missed-trades-content .empty-state .empty-state-submessage {
  color: var(--text-muted);
  font-size: 14px;
  margin-top: 8px;
  line-height: 1.4;
}

/* Responsive Design */
@media (max-width: 600px) {
  .drc-missed-trades-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .drc-missed-trade-header {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .drc-missed-trade-main {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .drc-missed-trade-open-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .drc-missed-trade-details {
    margin-top: 8px;
  }
}

/* Dark Theme Adjustments */
.theme-dark .drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: var(--text-on-accent);
}

.theme-dark .drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Integration with existing DRC styles */
.drc-section .drc-missed-trades-section {
  margin-bottom: 0; /* Remove extra margin when used inside drc-section */
}

.drc-section .drc-missed-trades-header h3 {
  margin-bottom: 0; /* Consistent with other DRC section headers */
}
`,Iw=()=>{let e="drc-missed-trades-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=$Q,document.head.appendChild(t)}});var ZD={};Zs(ZD,{ensureChartStyles:()=>b$,injectChartStyles:()=>Nw,removeChartStyles:()=>QD});function Nw(){try{if(document.head.querySelector("#journalit-chart-styles"))return;let t=document.createElement("style");t.id="journalit-chart-styles",t.textContent=RQ,document.head.appendChild(t)}catch(e){console.error("Error injecting chart styles:",e)}}function QD(){try{let e=document.head.querySelector("#journalit-chart-styles");e&&e.remove()}catch(e){console.error("Error removing chart styles:",e)}}function b$(){Nw()}var RQ,wv=te(()=>{RQ=`
/**
 * CSS Variables for chart colors & theming
 * These allow for consistent colors across all charts
 */
:root {
  /* Base chart colors with !important to ensure they're applied */
  --chart-positive: var(--text-success, #43a047) !important;
  --chart-negative: var(--text-error, #e53935) !important;
  --chart-neutral: var(--text-muted, #888888) !important;

  /* Chart background colors */
  --chart-positive-bg: rgba(67, 160, 71, 0.2) !important;
  --chart-negative-bg: rgba(229, 57, 53, 0.2) !important;

  /* Animation timings */
  --chart-animation-duration: 0.8s;
  --chart-animation-function: cubic-bezier(0.19, 1, 0.22, 1);
}

/**
 * Chart container styles
 */
.journalit-chart-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  border-radius: 8px;
  background-color: transparent;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  padding: 4px;
}

/**
 * Enhanced tooltip styles
 */
.journalit-chart-tooltip {
  background-color: var(--background-primary);
  border-radius: 10px;
  padding: 14px 18px;
  min-width: 140px;
  border: 1px solid var(--background-modifier-border);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  transform: translateY(-4px);
  position: relative;
  animation: tooltipFadeIn 0.2s var(--chart-animation-function);
  z-index: 1000;
}

/* Tooltip date */
.journalit-chart-tooltip-date {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 8px;
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 6px;
}

/* Main tooltip value */
.journalit-chart-tooltip-value {
  font-size: 20px;
  font-weight: 600;
  text-align: center;
}

.journalit-chart-tooltip-value.positive {
  color: var(--chart-positive);
}

.journalit-chart-tooltip-value.negative {
  color: var(--chart-negative);
}

/* Additional tooltip info */
.journalit-chart-tooltip-info {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 8px;
  text-align: center;
  font-style: italic;
}

/* Tooltip animation */
@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(-4px);
  }
}

/**
 * Chart SVG elements styling
 */
.recharts-cartesian-grid-horizontal line,
.recharts-cartesian-grid-vertical line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
}

.recharts-reference-line line {
  stroke: var(--text-normal);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
  stroke-width: 1.5;
}

/* Ensure profit target line is always green */
.recharts-reference-line.profit-target-line line {
  stroke: var(--chart-positive, var(--text-success, #00b300)) !important;
  stroke-opacity: 1 !important;
  stroke-dasharray: 5 5 !important;
  stroke-width: 2 !important;
}

/* Ensure profit target line label is also green */
.recharts-reference-line.profit-target-line text {
  fill: var(--chart-positive, var(--text-success, #00b300)) !important;
}

/* Axis styling */
.recharts-xAxis .recharts-cartesian-axis-line,
.recharts-yAxis .recharts-cartesian-axis-line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.5;
}

.recharts-cartesian-axis-tick-value {
  font-size: 11px;
  font-weight: 500;
  fill: var(--text-muted);
}

/* Active dot styling */
.recharts-active-dot circle,
.recharts-active-dot {
  fill: var(--interactive-accent, #4299e1);
  filter: drop-shadow(0 0 3px rgba(66, 153, 225, 0.6));
}

/* Ensure tooltip position is fixed */
.recharts-tooltip-wrapper {
  pointer-events: none;
  z-index: 1000;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25));
}

/**
 * Bar chart specific styling
 */
.recharts-bar {
  cursor: pointer;
  transition: opacity 0.3s ease;
}

.recharts-bar-rectangle {
  transition: filter 0.3s ease, transform 0.2s ease;
}

.recharts-bar-rectangle:hover {
  filter: brightness(1.1) drop-shadow(0 0 3px rgba(0, 0, 0, 0.2));
  transform: translateY(-2px);
}

/* Apply rounded corners to bar chart bars */
.recharts-bar-rectangle path {
  border-radius: 2px 2px 0 0;
}

/* Ensure bar chart colors are applied correctly */
.recharts-bar-rectangle[fill^="var(--chart-positive)"] path {
  fill: var(--chart-positive) !important;
}

.recharts-bar-rectangle[fill^="var(--chart-negative)"] path {
  fill: var(--chart-negative) !important;
}

/* Active bar styling */
.recharts-bar-rectangle.recharts-active {
  filter: brightness(1.2) drop-shadow(0 0 6px rgba(0, 0, 0, 0.3));
}

/* Enhanced cursor area for better touch experience */
.recharts-layer.recharts-bar-graphical {
  cursor: pointer;
}

/* Animations for bar charts */
@keyframes barFadeIn {
  from {
    opacity: 0;
    transform: scaleY(0.8);
  }
  to {
    opacity: 1;
    transform: scaleY(1);
  }
}

.recharts-bar-rectangle {
  /* Animation removed to prevent conflict with Recharts' built-in animations */
}

/**
 * Calendar specific animations and styles
 */
@keyframes calendarFadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseBorder {
  0% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(var(--interactive-accent-rgb), 0.3), 0 4px 15px rgba(var(--interactive-accent-rgb), 0.35);
  }
  100% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
}

/* Enhanced today indicator with pulse effect */
.journalit-dashboard-calendar-day.today {
  animation: pulseBorder 2s infinite ease-in-out;
  border: 2px solid var(--interactive-accent) !important;
  z-index: 2 !important;
}

/* Calendar cell hover effect */
.journalit-dashboard-calendar-day:hover,
.journalit-dashboard-calendar-weekly-pnl:hover {
  transform: scale(1.05) !important;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s ease-out !important;
  opacity: 1 !important;
  z-index: 5 !important;
}
`});function Du(){if(document.head.querySelector("#journalit-image-styles"))return;let e=document.createElement("style");e.id="journalit-image-styles",e.textContent=WQ,document.head.appendChild(e)}function x$(){let e=document.head.querySelector("#journalit-image-styles");e&&e.remove()}function eE(){Du()}var WQ,Sv=te(()=>{WQ=`
  /* Image Uploader Styles - New Side-by-Side Layout */
  .journalit-image-upload-wrapper {
    margin-bottom: 12px;
    position: relative;
  }

  .journalit-image-upload-layout {
    display: flex;
    gap: 8px;
    min-height: 80px;
    width: 100%;
  }

  /* Paste Button Area - 1/3 Width */
  .journalit-image-upload-paste-area {
    flex: 0 0 calc(33.333% - 4px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
    border: 2px solid var(--interactive-accent);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 12px 8px;
    min-height: 80px;
    font-size: 13px;
    font-weight: 500;
    gap: 6px;
  }

  .journalit-image-upload-paste-area:hover {
    background-color: var(--interactive-accent-hover);
    border-color: var(--interactive-accent-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.2);
  }

  .journalit-image-upload-paste-area:disabled {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .journalit-image-upload-paste-area.pasting {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: wait;
  }

  .journalit-image-upload-paste-area .paste-icon {
    flex-shrink: 0;
    line-height: 1;
  }

  .journalit-image-upload-paste-area .paste-text {
    font-size: 12px;
    text-align: center;
    line-height: 1.2;
  }

  /* File Explorer Area - 2/3 Width */
  .journalit-image-upload-file-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    background-color: var(--background-secondary);
    padding: 12px;
  }

  .journalit-image-upload-file-area.full-width {
    flex: 1;
    min-width: 100%;
  }

  .journalit-image-upload-file-area:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .journalit-image-upload-file-area:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.08);
  }

  .journalit-image-upload-file-area.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .journalit-image-upload-label {
    font-size: 14px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    line-height: 1.3;
  }

  .journalit-image-upload-file-area:hover .journalit-image-upload-label {
    color: var(--interactive-accent);
  }

  .journalit-image-upload-input {
    display: none;
  }

  /* Drag overlay message for file area */
  .journalit-image-upload-file-area::after {
    content: "Drop image here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .journalit-image-upload-file-area.dragging-over::after {
    opacity: 1;
  }

  .journalit-image-upload-file-area.dragging-over .journalit-image-upload-label {
    opacity: 0;
  }

  /* Spinner for paste loading */
  .journalit-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid var(--background-modifier-border);
    border-top: 2px solid var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spinner-rotate 1s linear infinite;
  }

  @keyframes journalit-spinner-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Responsive Design for Image Upload */
  @media (max-width: 768px) {
    .journalit-image-upload-layout {
      flex-direction: column;
      gap: 6px;
    }

    .journalit-image-upload-paste-area {
      flex: 0 0 auto;
      min-height: 60px;
      flex-direction: row;
      gap: 8px;
      padding: 12px 16px;
    }

    .journalit-image-upload-file-area {
      flex: 1;
      min-height: 70px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 13px;
    }
  }

  @media (max-width: 480px) {
    .journalit-image-upload-layout {
      gap: 4px;
    }

    .journalit-image-upload-paste-area {
      min-height: 50px;
      padding: 10px 12px;
      font-size: 12px;
    }

    .journalit-image-upload-file-area {
      min-height: 60px;
      padding: 8px;
    }

    .journalit-image-upload-label {
      font-size: 13px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 11px;
    }
  }

  /* Image Display Styles */
  .journalit-image-viewer {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .journalit-image-container {
    position: relative;
    max-width: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .journalit-image {
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
    cursor: zoom-in;
  }

  .journalit-image-delete-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    z-index: 10;
  }

  .journalit-image-delete-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .journalit-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Fullscreen Styles - Borderless Design */
  .journalit-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 10000; /* Reduced from original 1000000 */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: journalit-fade-in 0.3s ease-in-out;
    cursor: pointer; /* Indicate clickable backdrop */
    pointer-events: auto; /* Enable backdrop click-to-close */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  /* Overlay UI Elements */
  .journalit-fullscreen-overlay-ui {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none; /* Default to none, specific elements override */
    z-index: 10001; /* Slightly above overlay */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-title {
    position: absolute;
    top: 20px;
    left: 20px;
    color: white;
    font-size: 16px;
    font-weight: 500;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 8px 12px;
    border-radius: 6px;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    font-weight: 300;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: scale(1.1);
  }

  .journalit-fullscreen-content-wrapper {
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  /* Image Carousel Styles */
  .journalit-image-carousel {
    width: 100%;
    margin-bottom: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 12px;
  }

  .journalit-carousel-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
    position: relative;
    width: 100%;
  }

  .journalit-carousel-image-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 200px;
    width: 100%;
    position: relative;
    background-color: var(--background-primary);
    border-radius: 4px;
  }

  .journalit-carousel-button {
    width: 36px;
    height: 36px;
    min-width: 36px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    border-radius: 50%;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 20;
  }

  .journalit-carousel-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .journalit-carousel-counter {
    text-align: center;
    font-size: 12px;
    color: var(--text-muted);
    margin: 4px 0;
  }

  .journalit-carousel-thumbnails {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
    justify-content: center;
  }

  .journalit-carousel-thumbnail {
    width: 60px;
    height: 60px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-carousel-thumbnail:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }

  .journalit-carousel-thumbnail.active {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px var(--interactive-accent);
  }

  .journalit-carousel-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Animations */
  @keyframes journalit-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes journalit-zoom-in {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Hold to zoom indicator */
  .journalit-image-zoom-indicator {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
  }

  .journalit-image-container:hover .journalit-image-zoom-indicator {
    opacity: 1;
  }

  /* Enhanced Fullscreen Viewer Styles - Full Viewport */
  .journalit-fullscreen-viewer {
    position: relative;
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-image-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-zoomable-image {
    max-width: 90vw;
    max-height: 90vh;
    object-fit: contain;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    transform-origin: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  /* Navigation buttons - repositioned to middle sides */
  .journalit-fullscreen-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 45px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-nav-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    opacity: 1;
  }

  .journalit-fullscreen-nav-prev {
    left: 20px;
  }

  .journalit-fullscreen-nav-next {
    right: 20px;
  }

  /* Navigation indicator - moved to bottom center */
  .journalit-fullscreen-nav-indicator {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
  }

  /* Zoom indicator - moved to bottom left */
  .journalit-fullscreen-zoom-indicator {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .journalit-fullscreen-viewer:hover .journalit-fullscreen-zoom-indicator {
    opacity: 1;
  }

  /* Smooth zoom transition */
  .journalit-fullscreen-zoomable-image.zooming {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Responsive navigation buttons */
  @media (max-width: 768px) {
    .journalit-fullscreen-nav-btn {
      width: 40px;
      height: 40px;
      font-size: 20px;
    }
    
    .journalit-fullscreen-nav-prev {
      left: 10px;
    }
    
    .journalit-fullscreen-nav-next {
      right: 10px;
    }
    
    .journalit-fullscreen-nav-indicator {
      bottom: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
    
    .journalit-fullscreen-zoom-indicator {
      top: 15px;
      right: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
  }
`});var w$={};Zs(w$,{ensureSharedComponentStyles:()=>Nm,injectSharedComponentStyles:()=>Lw,removeSharedComponentStyles:()=>tE});function Lw(){if(document.head.querySelector("#shared-component-styles"))return;let e=document.createElement("style");e.id="shared-component-styles",e.textContent=UQ,document.head.appendChild(e)}function tE(){let e=document.head.querySelector("#shared-component-styles");e&&e.remove()}function Nm(){document.head.querySelector("#shared-component-styles")||Lw()}var UQ,kv=te(()=>{UQ=`
  /**
  * Container Styles for Reviews
  * Remove unused space - but preserve content area padding
  */
  .review-base-container {
    padding: 0 !important;
    margin: 0 !important;
  }

  /**
  * Navigation Styles
  * Used for navigating between reviews
  */
  .drc-navigation, .weekly-review-navigation, .daily-report-card-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }
  
  .drc-navigation-links, .weekly-review-navigation-links, .daily-report-card-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100%;
  }
  
  .drc-navigation-button, .weekly-review-navigation-button, .daily-report-card-navigation-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex: 1;
    text-align: center;
    min-width: 120px;
    box-sizing: border-box;
  }
  
  .drc-navigation-button:hover, .weekly-review-navigation-button:hover, .daily-report-card-navigation-button:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .drc-navigation-button:disabled, .weekly-review-navigation-button:disabled, .daily-report-card-navigation-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .nav-icon {
    font-size: 14px;
    line-height: 1;
  }

  /**
  * Goal Tracker Styles
  * Used for goal tracking in DRC and Weekly Review
  */
  .shared-goal-tracker h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  /* Special styling for Weekly Review's "Previous Week Goals" header */
  .weekly-review-previous-goals h3,
  .weekly-review-preparation .weekly-review-section h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  .shared-goal-tracker-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    margin-top: 0.75rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
  }

  .shared-goal-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    cursor: pointer !important;
  }

  .shared-goal-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .shared-goal-checkbox {
    margin: 0 !important;
  }

  .shared-goal-text {
    flex: 1 !important;
    font-size: 0.95rem !important;
  }

  .shared-goal-text.completed {
    text-decoration: line-through !important;
    opacity: 0.7 !important;
    color: var(--text-muted) !important;
  }
  
  /**
  * Empty State Component Styles
  * Used for displaying a friendly message when no data is available
  */
.journalit-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  text-align: center;
  background-color: var(--background-secondary);
  border-radius: 8px;
  min-height: 160px;
  width: 100%;
  height: 100%; /* Added to ensure full height usage */
  color: var(--text-muted);
  animation: fadeIn 0.3s ease-out;
  margin: 0 auto; /* Added to ensure horizontal centering */
}

.journalit-empty-state-icon {
  margin-bottom: 16px;
  opacity: 0.6;
  color: var(--text-muted);
  display: flex; /* Added to ensure icon is centered */
  justify-content: center; /* Added to ensure icon is centered */
}

.journalit-empty-state-content {
  max-width: 280px;
  display: flex; /* Added for better content alignment */
  flex-direction: column; /* Stack content vertically */
  align-items: center; /* Center content horizontally */
  justify-content: center; /* Center content vertically */
}

  .journalit-empty-state-message {
    font-size: 16px;
    font-weight: 500;
    margin: 0 0 8px 0;
    color: var(--text-normal);
  }

  .journalit-empty-state-submessage {
    font-size: 13px;
    opacity: 0.8;
    margin: 0 0 16px 0;
    color: var(--text-muted);
  }
  
  .journalit-empty-state-action-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 0 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    margin-top: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-width: 120px !important;
    height: 36px !important;
    line-height: 1 !important;
  }
  
  .journalit-empty-state-action-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }

  /* Animation for empty state */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Chart-specific empty state styling */
  .journalit-chart-container .journalit-empty-state {
    background-color: transparent;
    border: 1px dashed var(--background-modifier-border);
  }

  /* Table-specific empty state styling */
  .journalit-table-container .journalit-empty-state {
    min-height: 120px;
    padding: 16px;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .journalit-empty-state {
      padding: 16px;
      min-height: 140px;
    }
    
    .journalit-empty-state-icon {
      margin-bottom: 12px;
    }
    
    .journalit-empty-state-message {
      font-size: 14px;
    }
  }

  /**
   * Review Button Styles
   * Shared component for marking content as reviewed
   */
  .review-button-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 16px;
  }

  .review-button {
    min-width: 140px;
  }

  .review-timestamp {
    font-size: 0.85em;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Review sections for different review types */
  .drc-eod-review-button-section,
  .weekly-review-mark-reviewed-section,
  .monthly-review-mark-reviewed-section,
  .trade-note-review-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ensure consistent styling for the review button in all contexts */
  .drc-eod-review-button-section .review-button-container,
  .weekly-review-mark-reviewed-section .review-button-container,
  .monthly-review-mark-reviewed-section .review-button-container,
  .trade-note-review-section .review-button-container {
    margin-top: 0;
  }

  /**
   * Loading Spinner Styles
   * Shared loading component with animated spinner
   */
  .journalit-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px;
  }
  
  /* Ensure our spinner is not affected by other spinner styles */
  .journalit-loading-spinner .journalit-spinner-icon::before,
  .journalit-loading-spinner .journalit-spinner-icon::after {
    display: none !important;
  }

  .journalit-loading-spinner.small {
    padding: 8px;
    gap: 8px;
  }

  .journalit-loading-spinner.large {
    padding: 24px;
    gap: 16px;
  }

  .journalit-loading-spinner .journalit-spinner-icon {
    border: 2px solid var(--background-modifier-border);
    border-top-color: var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spin 0.6s linear infinite;
    flex-shrink: 0;
    /* Ensure perfect circle */
    min-width: var(--spinner-size, 24px);
    min-height: var(--spinner-size, 24px);
    max-width: var(--spinner-size, 24px);
    max-height: var(--spinner-size, 24px);
  }

  .journalit-loading-spinner .loading-message {
    color: var(--text-muted);
    font-size: 14px;
  }

  .journalit-loading-spinner.small .loading-message {
    font-size: 12px;
  }

  .journalit-loading-spinner.large .loading-message {
    font-size: 16px;
  }

  /* Fullscreen loading state */
  .journalit-loading-fullscreen {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 200px;
  }

  /* Overlay loading state */
  .journalit-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.02);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 10;
  }

  .journalit-loading-overlay-content {
    padding: 8px 16px;
    background-color: var(--background-primary);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* Spinner animation */
  @keyframes journalit-spin {
    to { transform: rotate(360deg); }
  }
`});function rE(){if(document.getElementById("journalit-combobox-styles"))return;let e=document.createElement("style");e.id="journalit-combobox-styles",e.textContent=qQ,document.head.appendChild(e)}function S$(){let e=document.getElementById("journalit-combobox-styles");e&&e.remove()}function nE(){document.getElementById("journalit-combobox-styles")||rE()}var qQ,aE=te(()=>{qQ=`
/**
 * ComboBox component styles for better performance
 * Replaces inline styles with CSS classes
 */

/* Base ComboBox container */
.combobox-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
  /* Use initial z-index, modified via inline style when open */
}

/* Input container */
.input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element for better performance */
.input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* ComboBox input */
.combobox-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Dropdown when open - hardware accelerated animation */
.combobox-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  
  /* Using actual CSS animation instead of JS-driven transition */
  animation: combobox-dropdown-open 0.15s ease forwards;
}

@keyframes combobox-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Option item in dropdown */
.combobox-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
}

.combobox-option.highlighted,
.combobox-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* "Add new" option styling */
.combobox-add-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  font-style: italic;
  border-top: 1px dashed var(--background-modifier-border, #ddd);
  transition: background-color 0.15s ease;
}

.combobox-add-option.highlighted,
.combobox-add-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Selected items in multi-select mode */
.selected-item {
  display: inline-flex;
  align-items: center;
  margin: 0 4px 4px 0;
  padding: 4px 8px;
  background-color: var(--interactive-accent, #5183e4);
  color: white;
  border-radius: 4px;
  font-size: 12px;
  gap: 6px;
}

/* Remove button in tags */
.remove-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  min-width: 16px;
  min-height: 16px;
  padding: 0;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  border-radius: 50%;
  margin-left: 4px;
  position: relative;
  z-index: 5;
  transition: background-color 0.15s ease;
}

.remove-button:hover {
  background: rgba(255, 255, 255, 0.4);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .combobox-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* Focus state */
.combobox-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Error state */
.combobox-input.error {
  border-color: var(--text-error, #e53935);
}
`});function oE(){let e="journalit-account-weight-bar-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=HQ,document.head.appendChild(t)}function k$(){let e=document.getElementById("journalit-account-weight-bar-styles");e&&e.remove()}function iE(){document.getElementById("journalit-account-weight-bar-styles")||oE()}var HQ,sE=te(()=>{HQ=`
/* Account Type Weight Bar Styles */

/* Main container for the weight visualization */
.account-weight-bar-container {
  width: 100%;
  margin: 20px 0;
  padding: 0 10px;
}

/* Weight Bar Styles */
.account-weight-bar {
  display: flex;
  width: 100%;
  height: 12px;
  background-color: transparent;
  border-radius: 0;
  overflow: visible;
  margin-bottom: 12px;
  gap: 5px;
  padding: 0;
}

/* Individual weight segment */
.account-weight-segment {
  height: 100%;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  min-width: 3px; /* Ensure very small segments are still visible */
  border-radius: 4px;
}

/* Hover effects for weight segments */
.account-weight-segment:hover {
  opacity: 0.8 !important;
  transform: scaleY(1.1) !important;
  z-index: 2;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

/* Active/focus states for accessibility */
.account-weight-segment:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
}

/* Weight Bar Tooltip Styles */
.account-weight-tooltip {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  padding: 0;
  max-width: 280px;
  min-width: 220px;
  font-size: 14px;
  line-height: 1.4;
  z-index: 1000;
  backdrop-filter: blur(8px);
}

.weight-tooltip-content {
  padding: 12px 16px;
}

.tooltip-header {
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
}

.tooltip-metrics {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.tooltip-metric {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  line-height: 1.3;
}

.tooltip-metric .metric-label {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  margin-right: 12px;
}

.tooltip-metric .metric-value {
  color: var(--text-normal);
  font-weight: 600;
  text-align: right;
  flex: 1;
}

.tooltip-metric .metric-value.positive {
  color: var(--text-success);
}

.tooltip-metric .metric-value.negative {
  color: var(--text-error);
}

/* Legend Styles */
.account-weight-legend-container {
  width: 100%;
  margin-top: 0px;
  padding-top: 0px;
}

.account-weight-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 16px;
  padding: 0;
  align-items: center;
  justify-content: flex-start;
}

.account-weight-legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  line-height: 1.3;
  color: var(--text-normal);
  transition: opacity 0.2s ease;
  cursor: default;
  width: 100%;
  max-width: 200px; /* Prevent items from becoming too wide */
}

.account-weight-legend-item:hover {
  opacity: 0.8;
}

.legend-dot {
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.account-weight-legend-item:hover .legend-dot {
  transform: scale(1.1);
}

.legend-text {
  display: flex;
  flex-direction: row;
  gap: 6px;
  align-items: center;
  min-width: 0; /* Allow text to shrink */
  flex: 1;
}

.legend-type-name {
  font-weight: 500;
  color: var(--text-normal);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.legend-percentage {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Responsive Design */

/* Mobile screens - adjust text size and container padding */
@media (max-width: 599px) {
  .account-weight-legend-item {
    font-size: 12px;
  }
  
  .legend-type-name {
    font-size: 12px;
  }
  
  .legend-percentage {
    font-size: 11px;
  }
  
  .account-weight-bar-container {
    padding: 0;
  }
  
  .account-weight-bar {
    height: 10px; /* Slightly smaller on mobile */
  }
}

/* Very small mobile screens - adjust layout */
@media (max-width: 400px) {
  .account-weight-legend {
    gap: 6px 12px;
  }
  
  .legend-text {
    flex-direction: row;
    gap: 4px;
    align-items: center;
    width: 100%;
  }
}

/* Dark theme adjustments */
.theme-dark .account-weight-tooltip {
  background-color: var(--background-primary);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.theme-dark .legend-dot {
  border-color: rgba(255, 255, 255, 0.1);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

/* Light theme adjustments */
.theme-light .account-weight-tooltip {
  background-color: rgba(255, 255, 255, 0.95);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
}

.theme-light .legend-dot {
  border-color: rgba(0, 0, 0, 0.15);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Animation for initial load */
.account-weight-bar .account-weight-segment {
  animation: segment-grow 0.6s ease-out;
  animation-fill-mode: both;
}

@keyframes segment-grow {
  from {
    width: 0%;
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Stagger animation for segments */
.account-weight-segment:nth-child(1) { animation-delay: 0.1s; }
.account-weight-segment:nth-child(2) { animation-delay: 0.2s; }
.account-weight-segment:nth-child(3) { animation-delay: 0.3s; }
.account-weight-segment:nth-child(4) { animation-delay: 0.4s; }
.account-weight-segment:nth-child(5) { animation-delay: 0.5s; }
.account-weight-segment:nth-child(6) { animation-delay: 0.6s; }
.account-weight-segment:nth-child(7) { animation-delay: 0.7s; }
.account-weight-segment:nth-child(8) { animation-delay: 0.8s; }
.account-weight-segment:nth-child(9) { animation-delay: 0.9s; }
.account-weight-segment:nth-child(10) { animation-delay: 1.0s; }

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  .account-weight-segment,
  .legend-dot {
    animation: none !important;
    transition: none !important;
  }
  
  .account-weight-segment:hover {
    transform: none !important;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .account-weight-bar {
    border: 2px solid var(--text-normal);
  }
  
  .account-weight-segment {
    border-right: 2px solid var(--background-primary);
  }
  
  .legend-dot {
    border: 2px solid var(--text-normal);
  }
}

/* Focus management for keyboard navigation */
.account-weight-bar:focus-within .account-weight-segment:focus {
  outline: 3px solid var(--interactive-accent);
  outline-offset: 2px;
  z-index: 10;
}
`});function GQ(){if(!lE)try{Mw=document.createElement("style"),Mw.textContent=VQ,Mw.setAttribute("data-journalit-style","account-page"),document.head.appendChild(Mw),lE=!0}catch(e){console.error("[Journalit] Error injecting account page styles:",e)}}function Eu(){lE||GQ()}var VQ,lE,Mw,C$=te(()=>{VQ=`
/* Account Page View Container 
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-account-page-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-account-page-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

.journalit-account-page-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Account Page Header */
.account-page-header {
  padding: 16px 20px;
  margin: 0 0 20px 0;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.account-page-header h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.account-page-header p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Account Page Content */
.account-page-wrapper {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

.account-page-placeholder {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-muted);
}

.account-page-placeholder p {
  margin: 8px 0;
  font-size: 14px;
}

/* Error State */
.account-page-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 40px 20px;
  text-align: center;
}

.account-page-error h3 {
  margin: 0 0 12px 0;
  font-size: 20px;
  color: var(--text-normal);
}

.account-page-error p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Loading State */
.account-page-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Page Content Area */
.account-page-content {
  flex: 1 1 0; /* CRITICAL: Force height constraint - matches TradeLog fix */
  overflow-y: auto;
  overflow-x: hidden;
  padding: 20px;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  max-height: 100%; /* Prevent expansion beyond parent - matches TradeLog fix */
  height: 0; /* Force flex to control height - matches TradeLog fix */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}

/* Account Info Section */
.account-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
}

.account-info p {
  margin: 0;
  font-size: 14px;
  color: var(--text-muted);
}

/* Account Metrics */
.account-metrics {
  margin: 24px 0;
}

.account-metrics h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.metric-card {
  display: flex;
  flex-direction: column;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
}

.metric-label {
  font-size: 16px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.metric-value {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-normal);
}

.metric-value.positive {
  color: var(--text-success);
}

.metric-value.negative {
  color: var(--text-error);
}

/* Account Trades */
.account-trades {
  margin: 24px 0;
}

.account-trades h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.trades-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.trade-item {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border-hover);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px 12px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-primary-alt);
}

.trade-instrument {
  font-weight: 700;
  font-size: 18px;
  color: var(--text-normal);
  letter-spacing: -0.5px;
}

.trade-item .trade-direction {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
}

.trade-item .trade-direction.long {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.trade-item .trade-direction.short {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.trade-pnl {
  font-weight: 700;
  font-size: 18px;
  letter-spacing: -0.5px;
}

.trade-pnl.positive {
  color: var(--text-success);
}

.trade-pnl.negative {
  color: var(--text-error);
}

.trade-details {
  padding: 16px 20px 20px 20px;
  display: grid;
  gap: 12px;
}


.trade-setups,
.trade-tags {
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Header Component */
.account-header-main {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.header-buttons {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-shrink: 0;
}

.edit-account-btn,
.add-event-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.edit-account-btn:hover,
.add-event-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.add-event-btn {
  background-color: #2563eb;
  border-color: #2563eb;
}

.add-event-btn:hover {
  background-color: #2563eb;
  opacity: 0.8;
}

.account-info-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.info-label {
  font-weight: 500;
  color: var(--text-muted);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.info-value {
  color: var(--text-normal);
  font-size: 1.1rem;
  font-weight: 600;
}

.edit-modal-placeholder {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 24px;
  z-index: 1000;
  box-shadow: var(--shadow-l);
}

/* Account Metrics Component */
.metrics-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 8px;
}

.metrics-subtitle {
  color: var(--text-muted);
  font-size: 14px;
}

.metric-value.neutral {
  color: var(--text-normal);
}

/* Account Balance Section */
.account-balance-section {
  margin: 32px 0;
}

.balance-section-header {
  margin-bottom: 16px;
}

.balance-section-header h3 {
  margin: 0 0 4px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.balance-section-subtitle {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

.balance-chart-container {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 16px 0;
}

.balance-chart-loading {
  height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
}

.balance-section-footer {
  margin-top: 8px;
}

.balance-info {
  margin: 0;
  color: var(--text-muted);
  font-size: 16px;
  font-style: italic;
}

/* Linked Trades Section */
.trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.trades-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 24px 0;
  gap: 20px;
}

.trades-header-line {
  flex: 1;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--background-modifier-border), transparent);
}

.trades-header-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 16px;
  background: var(--background-primary);
}

.trade-item {
  cursor: pointer;
}

.trade-item:hover {
  border-color: var(--interactive-accent);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-1px);
}

.trade-item.no-path {
  cursor: default;
  opacity: 0.6;
}

.trade-item.no-path:hover {
  transform: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  border-color: var(--background-modifier-border-hover);
}

.trade-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.trade-prices, .trade-dates {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-price, .trade-size, .trade-date {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.trade-setups, .trade-mistakes, .trade-tags {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-setups:last-child, .trade-mistakes:last-child, .trade-tags:last-child {
  border-bottom: none;
}

.setup-label, .mistake-label, .tags-label {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  min-width: 80px;
  flex-shrink: 0;
}

.setup-tags, .mistake-tags, .tag-list {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  flex: 1;
}

.setup-tag, .mistake-tag, .trade-tag {
  padding: 4px 10px;
  border-radius: 16px;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.25px;
  transition: all 0.2s ease;
}

.setup-tag {
  background: rgba(var(--color-green-rgb), 0.1);
  color: var(--text-success);
  border: 1px solid rgba(var(--color-green-rgb), 0.2);
}

.mistake-tag {
  background: rgba(var(--color-red-rgb), 0.1);
  color: var(--text-error);
  border: 1px solid rgba(var(--color-red-rgb), 0.2);
}

.trade-tag {
  background: var(--background-modifier-border);
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border-hover);
}

.trade-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0 0 0;
  margin-top: 8px;
  font-size: 16px;
  font-weight: 500;
}

.review-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.review-status.reviewed {
  color: var(--text-success);
}

.review-status.reviewed::before {
  content: "\u2713";
  font-size: 14px;
}

.review-status.not-reviewed {
  color: var(--text-warning);
}

.review-status.not-reviewed::before {
  content: "\u25CB";
  font-size: 14px;
}

.trade-costs {
  color: var(--text-muted);
  font-weight: 500;
}

/* Trade Status - Open Trades */
.status-open {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 16px;
  font-weight: 600;
  text-transform: uppercase;
  background: rgba(33, 150, 243, 0.15);
  color: rgb(33, 150, 243);
}

/* Future Enhancements Placeholder */
.future-enhancements-placeholder {
  margin: 32px 0;
  padding: 24px;
  background: var(--background-secondary);
  border: 2px dashed var(--background-modifier-border);
  border-radius: 8px;
  text-align: center;
}

.future-enhancements-placeholder h3 {
  margin: 0 0 16px 0;
  color: var(--text-muted);
}

.future-enhancements-placeholder ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.future-enhancements-placeholder li {
  margin: 8px 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Edit Account Modal */
.edit-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.edit-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.edit-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.edit-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.edit-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.edit-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.edit-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.edit-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.edit-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.edit-account-form .setting-item-control {
  margin-top: 0;
}

.edit-account-form input,
.edit-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.edit-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.edit-account-form input:focus,
.edit-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.edit-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.edit-account-buttons {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.edit-account-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.edit-account-buttons .save-account-button {
  min-width: 100px;
}

.edit-account-buttons .cancel-button {
  min-width: 70px;
}

/* Create Account Modal - Same styling as Edit Account Modal */
.create-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.create-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.create-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.create-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.create-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.create-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.create-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.create-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.create-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.create-account-form .setting-item-control {
  margin-top: 0;
}

.create-account-form input,
.create-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.create-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.create-account-form input:focus,
.create-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.create-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.create-account-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.create-account-buttons .create-account-button {
  min-width: 100px;
}

.create-account-buttons .cancel-button {
  min-width: 70px;
}

/* Modal Button Container for Confirmation Modals */
.modal-button-container {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
}

.modal-button-container button {
  padding: 8px 16px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
}

.modal-button-container button:hover {
  background: var(--background-modifier-hover);
}

.modal-button-container button.mod-cta {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: var(--interactive-accent);
}

.modal-button-container button.mod-cta:hover {
  background: var(--interactive-accent-hover);
}

.modal-button-container button.mod-warning {
  background: var(--color-red);
  color: var(--text-on-accent);
  border-color: var(--color-red);
}

.modal-button-container button.mod-warning:hover {
  background: var(--color-red);
  opacity: 0.8;
}

/* Add Event Modal */
.add-event-modal-container {
  max-width: 600px;
  width: 100%;
}

.add-event-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.add-event-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.add-event-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.add-event-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.add-event-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.add-event-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.add-event-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.add-event-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.add-event-form .setting-item-control {
  margin-top: 0;
}

.add-event-form input,
.add-event-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.add-event-form select {
  height: 32px;
  padding: 5px 6px;
}

.add-event-form input:focus,
.add-event-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.add-event-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.add-event-buttons {
  display: flex;
  gap: 8px;
  justify-content: space-between;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.add-event-buttons .button-group-left {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .add-event-button {
  min-width: 100px;
}

.add-event-buttons .cancel-button {
  min-width: 70px;
}

/* Deposits & Withdrawals Section */
.deposits-withdrawals-section {
  margin: 32px 0;
}

.section-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 32px 0 24px 0;
  gap: 16px;
}

.section-header-line {
  flex: 1;
  height: 1px;
  background-color: var(--background-modifier-border);
  min-width: 20px;
}

.section-header-title {
  flex-shrink: 0;
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 8px;
}

.empty-transactions {
  text-align: center;
  padding: 20px;
}

.empty-state-action {
  margin-top: 16px;
}

.add-first-transaction-btn {
  background-color: #2563eb;
  color: white;
  border-color: #2563eb;
}

.transactions-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Transaction Items */
.transaction-item {
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  transition: background-color 0.2s ease;
}

.transaction-item:hover {
  background: var(--background-modifier-hover);
}

.transaction-item.clickable {
  cursor: pointer;
}

.transaction-item.clickable:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.transaction-item.deposit {
  border-left: 4px solid #2563eb;
}

.transaction-item.withdrawal {
  border-left: 4px solid #eab308;
}

.transaction-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.transaction-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.transaction-type {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 500;
  text-transform: uppercase;
}

.transaction-type.deposit {
  background: rgba(37, 99, 235, 0.15);
  color: #1d4ed8;
  font-weight: 600;
}

.transaction-type.withdrawal {
  background: rgba(234, 179, 8, 0.15);
  color: #ca8a04;
  font-weight: 600;
}

.transaction-date {
  font-size: 16px;
  color: var(--text-muted);
}

.transaction-amount {
  font-weight: 600;
  font-size: 16px;
}

.transaction-amount.positive {
  color: #2563eb;
}

.transaction-amount.negative {
  color: #eab308;
}

.transaction-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.transaction-description {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.description-label {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.description-text {
  font-size: 16px;
  color: var(--text-normal);
}

.transaction-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.balance-after {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.transaction-actions {
  display: flex;
  gap: 4px;
  align-items: center;
}

.edit-transaction-btn,
.delete-transaction-btn {
  padding: 4px 8px;
  min-width: auto;
  height: auto;
}

.edit-transaction-btn {
  background-color: var(--interactive-accent);
  color: white;
  border-color: var(--interactive-accent);
}

.edit-transaction-btn:hover {
  background-color: var(--interactive-accent-hover);
}

.delete-transaction-btn {
  background-color: var(--color-red);
  color: white;
  border-color: var(--color-red);
}

.delete-transaction-btn:hover {
  background-color: var(--color-red);
  opacity: 0.8;
}

.transaction-description {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Warning text for modals */
.warning {
  color: var(--text-warning);
  font-style: italic;
}

/* Account Risk Metrics Section */
.account-risk-metrics-section {
  margin: 32px 0;
}

.risk-metrics-container {
  display: flex;
  gap: 24px;
  margin-top: 24px;
  flex-wrap: wrap;
  justify-content: space-between;
}

.risk-metric-box {
  flex: 1;
  min-width: 300px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 20px;
}

.risk-metric-box.not-set {
  opacity: 0.6;
}

.risk-metric-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  gap: 12px;
}

.header-left {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.title-with-badge {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.risk-metric-title {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.risk-metric-percentage {
  font-size: 24px;
  font-weight: 700;
  color: var(--text-normal);
  text-align: right;
}

.risk-metric-percentage.not-set {
  color: var(--text-muted);
  font-weight: 500;
  font-size: 16px;
}

/* Status Badges (following trade direction badge pattern) */
.risk-status-badge {
  padding: 4px 8px;
  border-radius: 16px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.risk-status-badge.in-progress {
  border-color: #f59e0b;
  color: #f59e0b;
  background: rgba(245, 158, 11, 0.1);
}

.risk-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.risk-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

/* Horizontal Progress Bar */
.horizontal-bar-container {
  margin-bottom: 16px;
}

.horizontal-bar-track {
  width: 100%;
  height: 12px;
  background-color: var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.horizontal-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

/* Drawdown Bar Colors */
.horizontal-bar-fill.safe {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.horizontal-bar-fill.warning {
  background: linear-gradient(90deg, #eab308 0%, #ca8a04 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.horizontal-bar-fill.critical {
  background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
}

/* Profit Target Bar Colors */
.horizontal-bar-fill.progress {
  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.horizontal-bar-fill.complete {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

/* Risk Metric Details */
.risk-metric-details {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 12px;
  font-size: 16px;
}

.detail-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.detail-row:last-child {
  margin-bottom: 0;
}

.detail-label {
  color: var(--text-muted);
  font-weight: 500;
}

.detail-value {
  color: var(--text-normal);
  font-weight: 600;
}

.detail-value.no-limit,
.detail-value.no-target {
  color: var(--text-muted);
  font-style: italic;
  text-align: center;
  width: 100%;
}

/* Responsive Design */
@media (max-width: 768px) {
  .account-page-header {
    margin: 0 0 16px 0;
    padding: 12px 16px;
  }
  
  .account-page-header h2 {
    font-size: 1.3rem;
  }
  
  /* Risk Metrics Mobile Styles */
  .risk-metrics-container {
    flex-direction: column;
    gap: 16px;
  }
  
  .risk-metric-box {
    min-width: 0;
    width: 100%;
  }
  
  .risk-metric-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .header-left {
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: 4px;
  }
  
  .title-with-badge {
    gap: 8px;
  }
  
  .risk-metric-percentage {
    text-align: left;
    font-size: 20px;
  }
  
  .account-page-content {
    padding: 16px;
  }
  
  .account-header-main {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .edit-account-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .account-info {
    grid-template-columns: 1fr;
    gap: 12px;
  }
  
  .metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
  }
  
  .trade-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .trades-header-centered {
    margin: 24px 0 16px 0;
    gap: 12px;
  }
  
  .trades-header-title {
    font-size: 1rem;
    padding: 0 6px;
  }
  
  .trade-info,
  .trade-dates {
    flex-direction: column;
    gap: 8px;
  }
  
  /* Edit Modal Responsive */
  .edit-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .edit-account-form {
    max-height: 60vh;
    gap: 6px;
  }
  
  .edit-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .edit-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .edit-account-buttons {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .edit-account-buttons .button-group-right {
    flex-direction: column;
    gap: 8px;
    width: 100%;
  }
  
  .edit-account-buttons .save-account-button,
  .edit-account-buttons .cancel-button,
  .edit-account-buttons .delete-account-button {
    min-width: auto;
    width: 100%;
  }
  
  /* Create Modal Responsive - Same as Edit Modal */
  .create-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .create-account-form {
    max-height: 60vh;
    gap: 6px;
  }
  
  .create-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .create-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .create-account-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .create-account-buttons .create-account-button,
  .create-account-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

/* Account Dashboard Settings Modal - Account Type Management */
.account-dashboard-settings-modal-container .available-account-types {
  margin-top: 8px;
}

.account-dashboard-settings-modal-container .account-types-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

.account-dashboard-settings-modal-container .account-type-badge-container {
  position: relative;
  display: inline-block;
}

.account-dashboard-settings-modal-container .account-type-badge {
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
  position: relative;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-badge:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary-alt);
}

.account-dashboard-settings-modal-container .account-type-delete-btn {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--color-red);
  border: 1px solid var(--background-primary);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  font-weight: bold;
  line-height: 1;
  z-index: 10;
  font-family: system-ui, -apple-system, sans-serif;
}

.account-dashboard-settings-modal-container .account-type-delete-btn:hover {
  background: var(--color-red-hover, #dc2626);
  transform: scale(1.1);
}

.account-dashboard-settings-modal-container .account-type-delete-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.account-dashboard-settings-modal-container .add-account-type-section {
  display: flex;
  align-items: center;
  gap: 8px;
}

.account-dashboard-settings-modal-container .add-account-type-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 6px;
  background: var(--interactive-accent);
  border: 1px solid transparent;
  border-radius: 6px;
  color: var(--text-on-accent);
  cursor: pointer;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .add-account-type-btn:hover {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-input {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  min-width: 200px;
}

.account-dashboard-settings-modal-container .account-type-name-input {
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  outline: none;
  transition: border-color 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-name-input:focus {
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .add-account-type-buttons {
  display: flex;
  gap: 6px;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn,
.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  padding: 4px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  flex: 1;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: transparent;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:hover:not(:disabled) {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  background: var(--background-primary);
  color: var(--text-normal);
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn:hover:not(:disabled) {
  background: var(--background-secondary);
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .no-account-types-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: flex-start;
}

.account-dashboard-settings-modal-container .no-account-types {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Delete Confirmation Modal */
.account-type-delete-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(2px);
}

.account-type-delete-modal {
  background: var(--background-primary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 24px;
  max-width: 500px;
  width: 90vw;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.account-type-delete-modal h3 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
}

.delete-modal-content {
  margin-bottom: 20px;
}

.delete-warning {
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 6px;
  margin-bottom: 16px;
}

.delete-warning p {
  margin: 0;
  color: var(--text-normal);
  font-size: 14px;
}

.impact-analysis h4 {
  margin: 0 0 12px 0;
  color: var(--text-normal);
  font-size: 14px;
  font-weight: 600;
}

.impact-analysis h5 {
  margin: 12px 0 8px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.impact-item {
  padding: 8px 12px;
  border-radius: 4px;
  margin-bottom: 8px;
  font-size: 16px;
  font-weight: 500;
}

.impact-item.impact-critical {
  background: rgba(239, 68, 68, 0.1);
  color: var(--color-red);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.impact-item.impact-safe {
  background: rgba(34, 197, 94, 0.1);
  color: var(--color-green, #22c55e);
  border: 1px solid rgba(34, 197, 94, 0.2);
}

.affected-accounts ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: disc;
}

.affected-accounts li {
  margin: 4px 0;
  color: var(--text-normal);
  font-weight: normal;
}

.migration-notice {
  margin-top: 12px;
  padding: 8px 12px;
  background: var(--background-secondary-alt);
  border-radius: 4px;
  font-size: 16px;
  color: var(--text-muted);
  border-left: 3px solid var(--color-accent);
}

.settings-cleanup {
  margin-top: 16px;
}

.settings-cleanup ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: none;
}

.settings-cleanup li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.delete-modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end; 
  padding-top: 16px;
  border-top: 1px solid var(--border-color);
}

.delete-modal-actions .button {
  min-width: 100px;
}

/* Account Migration Modal Overlay (higher z-index than delete modal) */
.account-migration-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001; /* Higher than delete modal (10000) */
  backdrop-filter: blur(2px);
}

/* Account Migration Modal Specific Styles */
.account-migration-modal {
  max-width: 600px;
}

.migration-warning {
  padding: 16px;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.2);
  border-radius: 6px;
  margin-bottom: 20px;
}

.migration-warning p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  font-size: 14px;
}

.migration-warning p:last-child {
  margin-bottom: 0;
}

.affected-accounts-list {
  margin: 8px 0 0 20px;
  padding: 0;
  list-style-type: disc;
}

.affected-accounts-list li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.migration-options h4 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 600;
}

.migration-option-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.migration-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px;
  border: 2px solid var(--border-color);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.migration-option:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option input[type="radio"] {
  margin: 0;
  margin-top: 2px;
}

.migration-option input[type="radio"]:checked + .migration-option-content {
  color: var(--color-accent);
}

.migration-option.checked {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.migration-option-title {
  font-weight: 600;
  font-size: 14px;
  color: var(--text-normal);
}

.migration-option-desc {
  font-size: 16px;
  color: var(--text-muted);
  line-height: 1.4;
}

.target-type-select {
  margin-top: 12px;
  padding: 12px;
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px solid var(--border-color);
}

.target-type-select label {
  display: block;
  margin-bottom: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
}

.target-type-select select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}

.target-type-select select:focus {
  outline: none;
  border-color: var(--color-accent);
}

.delete-modal-actions .delete-confirm-button {
  background: var(--color-red) !important;
  color: white !important;
  border-color: var(--color-red) !important;
}

.delete-modal-actions .delete-confirm-button:hover:not(:disabled) {
  background: var(--color-red-hover, #dc2626) !important;
  border-color: var(--color-red-hover, #dc2626) !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .account-dashboard-settings-modal-container .account-types-container {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-input {
    min-width: 100%;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-buttons {
    width: 100%;
  }
  
  .account-type-delete-modal {
    margin: 20px;
    width: calc(100vw - 40px);
    max-width: none;
  }
  
  .delete-modal-actions {
    flex-direction: column;
  }
  
  .delete-modal-actions .button {
    width: 100%;
  }
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .edit-account-form input,
  .edit-account-form select,
  .create-account-form input,
  .create-account-form select,
  .add-event-form input,
  .add-event-form select,
  .account-dashboard-settings-modal-container .account-type-name-input {
    font-size: 18px !important;
  }
}
`,lE=!1,Mw=null});function dE(){let e=document.getElementById(cE);e&&e.remove();let t=document.createElement("style");t.id=cE,t.textContent=YQ,document.head.appendChild(t)}function uE(){let e=document.getElementById(cE);e&&e.remove()}var cE,YQ,pE=te(()=>{ca();cE="onboarding-wizard-modal-styles",YQ=`
  .onboarding-wizard-modal {
    position: relative;
    padding: 16px;
    max-width: 500px;
    margin: 0 auto;
    height: fit-content;
    display: flex;
    flex-direction: column;
  }

  .modal-header {
    margin-bottom: 16px;
  }

  .modal-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: visible;
    padding-bottom: 8px; /* Reserve space for skip button */
  }

  .onboarding-slide {
    text-align: center;
  }

  .onboarding-slide h2 {
    margin: 0 0 12px 0;
    font-size: 20px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .onboarding-slide p {
    margin: 0 0 20px 0;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .slide-placeholder {
    padding: 20px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
    margin: 20px 0;
  }

  .slide-placeholder p {
    font-style: italic;
    color: var(--text-muted);
  }

  /* Welcome slide styles */
  .welcome-slide {
    text-align: center;
    padding: 20px 0;
  }

  .welcome-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .welcome-subtitle {
    font-size: 16px;
    color: var(--text-muted);
    margin-bottom: 32px;
    font-weight: 500;
  }

  .welcome-features {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 32px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .feature {
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }

  .feature-icon {
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .feature-text h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .feature-text p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .welcome-tagline {
    font-size: 14px;
    color: var(--interactive-accent);
    font-weight: 500;
    margin-top: 24px;
  }

  .welcome-trust-indicators {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 20px;
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-normal);
  }

  .trust-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .welcome-preview-section {
    margin: 32px 0 24px 0;
  }

  .welcome-preview-section h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .insights-preview {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .insight-preview-card {
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    text-align: left;
  }

  .insight-preview-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }

  .insight-preview-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .insight-preview-header strong {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-preview-content {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    line-height: 1.3;
    padding-left: 22px;
  }

  /* Goal selection styles */
  .goal-slide {
    text-align: center;
  }

  .goal-options {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 24px 0;
    text-align: left;
  }

  .goal-option {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .goal-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .goal-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .goal-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .goal-option.selected .goal-radio {
    border-color: var(--interactive-accent);
  }

  .goal-radio-inner {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .goal-radio-inner.selected {
    background: var(--interactive-accent);
  }

  .goal-content {
    flex: 1;
  }

  .goal-content h3 {
    margin: 0 0 6px 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .goal-content p {
    margin: 0 0 8px 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .goal-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-on-accent);
    background: var(--interactive-accent);
    padding: 2px 8px;
    border-radius: 12px;
  }

  .goal-selection-info {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 14px;
    color: var(--text-normal);
  }

  /* Segmentation slide styles */
  .segmentation-slide {
    text-align: center;
  }

  .segmentation-questions {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 16px 0 0px 0;
    text-align: left;
  }

  .segmentation-question h3 {
    margin: 0 0 8px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .multi-select-options {
    display: flex;
    flex-wrap: nowrap;
    gap: 6px;
    justify-content: center;
    overflow-x: auto;
  }

  .multi-select-option {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    flex-shrink: 0;
  }

  .multi-select-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .multi-select-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
    color: var(--interactive-accent);
  }

  .option-checkbox {
    width: 16px;
    height: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    background: var(--background-primary);
  }

  .multi-select-option.selected .option-checkbox {
    border-color: var(--interactive-accent);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .radio-options {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .radio-option {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .radio-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .radio-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .option-radio {
    width: 16px;
    height: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .radio-option.selected .option-radio {
    border-color: var(--interactive-accent);
  }

  .radio-inner {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .radio-inner.selected {
    background: var(--interactive-accent);
  }

  .option-content {
    flex: 1;
  }

  .option-label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-normal);
    margin-bottom: 2px;
  }

  .option-description {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  /* First action slide styles */
  .first-action-slide {
    text-align: center;
  }

  .first-action-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .first-action-content {
    margin: 24px 0;
  }

  .first-action-preview {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .first-action-preview h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .sample-trade-preview {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .preview-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .preview-row:last-child {
    border-bottom: none;
  }

  .preview-label {
    font-weight: 500;
    color: var(--text-muted);
  }

  .preview-value {
    color: var(--text-normal);
  }

  .create-sample-button {
    margin: 20px 0;
  }

  .first-action-note {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 12px;
  }

  .first-action-success {
    text-align: center;
    margin: 24px 0;
  }

  .success-checkmark {
    font-size: 48px;
    color: var(--color-green);
    margin-bottom: 16px;
  }

  .first-action-success h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .success-actions {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-action {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .action-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .sample-trade-path {
    margin-top: 16px;
    padding: 8px 12px;
    background: var(--background-modifier-border);
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  }

  .sample-trade-path small {
    color: var(--text-muted);
    font-size: 11px;
  }

  .trade-insights {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
    text-align: left;
  }

  .insight-card {
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .insight-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }

  .insight-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .insight-header strong {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-detail {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  /* Authentication slide styles */
  .authentication-slide {
    text-align: center;
  }

  .auth-component-wrapper {
    margin: 16px 0;
    padding: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
  }

  .auth-success {
    text-align: center;
    margin: 24px 0;
  }

  .auth-success h2 {
    margin: 0 0 12px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .auth-success-info {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-feature {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  /* FTP credentials slide styles */
  .ftp-credentials-slide {
    text-align: center;
  }

  .ftp-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .ftp-security-note {
    margin: 16px 0;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-green);
  }

  .security-highlight {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .security-icon {
    font-size: 16px;
    color: var(--color-green);
    flex-shrink: 0;
  }

  .ftp-generate-section {
    margin: 24px 0;
  }

  .ftp-info {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .ftp-info h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .ftp-benefits {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ftp-benefit {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .generate-ftp-button {
    margin: 20px 0;
  }

  .ftp-credentials-display {
    text-align: center;
    margin: 24px 0;
  }

  .ftp-credentials-display h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .credentials-container {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .credential-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .credential-row:last-child {
    border-bottom: none;
  }

  .credential-label {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 80px;
  }

  .credential-value-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    justify-content: flex-end;
  }

  .credential-value {
    background: var(--background-modifier-border);
    padding: 4px 8px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
    color: var(--text-normal);
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .ftp-setup-note {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-modifier-border);
    border-radius: 6px;
  }

  .ftp-setup-note p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  /* Completion slide styles */
  .completion-slide {
    text-align: center;
  }

  .completion-celebration {
    font-size: 64px;
    margin-bottom: 16px;
    animation: bounce 1s ease-in-out;
  }

  @keyframes bounce {
    0%, 20%, 60%, 100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-10px);
    }
    80% {
      transform: translateY(-5px);
    }
  }

  .completion-summary {
    margin: 24px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .completion-summary h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .accomplishments {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .accomplishment {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .accomplishment-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .accomplishment-status {
    margin-left: auto;
    color: var(--color-green);
    font-weight: 600;
  }

  .telemetry-section {
    margin: 32px 0;
    text-align: center;
  }

  .telemetry-section h3 {
    margin: 0 0 8px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .telemetry-section p {
    margin: 0 0 16px 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  .telemetry-option {
    text-align: left;
    max-width: 400px;
    margin: 0 auto;
  }

  .telemetry-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    cursor: pointer;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-secondary);
    transition: border-color 0.2s ease;
  }

  .telemetry-checkbox:hover {
    border-color: var(--interactive-accent-hover);
  }

  .telemetry-checkbox input[type="checkbox"] {
    margin: 0;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .telemetry-label {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .telemetry-label strong {
    font-size: 13px;
    color: var(--text-normal);
  }

  .telemetry-label small {
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  .completion-actions {
    margin: 32px 0 0 0;
  }

  .start-journaling-button {
    margin-bottom: 20px;
    padding: 16px 32px !important;
    font-size: 18px !important;
    font-weight: 600 !important;
    min-width: 240px !important;
    background: linear-gradient(135deg, var(--interactive-accent), var(--interactive-accent-hover)) !important;
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 4px 12px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.3) !important;
    transform: scale(1);
    transition: all 0.3s ease !important;
  }

  .start-journaling-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.4) !important;
    background: linear-gradient(135deg, var(--interactive-accent-hover), var(--interactive-accent)) !important;
  }

  .start-journaling-button:active {
    transform: scale(0.98);
  }

  .completion-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    flex-wrap: wrap;
  }

  .completion-link {
    color: var(--interactive-accent);
    text-decoration: none;
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
  }

  .completion-link:hover {
    background: var(--interactive-accent-hover);
    color: var(--text-on-accent);
  }

  .wizard-progress-container {
    margin-bottom: 16px;
  }

  .wizard-steps {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .wizard-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
  }

  .wizard-step-circle {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--background-modifier-border);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  .wizard-step.current .wizard-step-circle {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .wizard-step.completed .wizard-step-circle {
    background: var(--color-green);
    color: white;
  }

  .wizard-step-label {
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    max-width: 110px;

    /* keep every label exactly two lines high */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    line-height: 1.2;
    min-height: 2.4em;
  }

  .wizard-progress-track {
    height: 4px;
    background: var(--background-modifier-border);
    border-radius: 2px;
    overflow: hidden;
  }

  .wizard-progress-fill {
    height: 100%;
    background: var(--interactive-accent);
    transition: width 0.3s ease;
  }

  .modal-error {
    margin: 16px 0;
    padding: 8px 12px;
    background: var(--background-modifier-error);
    border: 1px solid var(--text-error);
    border-radius: 4px;
    color: var(--text-on-accent, #ffffff);
    font-size: 13px;
    font-weight: 500;
    text-align: center;
  }

  .modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 0px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .modal-actions button {
    min-width: 90px;
  }

  .modal-footer {
    margin-top: 0px;
    padding-top: 0px;
    border-top: none;
  }

  .modal-footer-text {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.3;
    text-align: center;
  }

  /* Skip-link: small, subtle, bottom-right */
  .skip-link {
    position: absolute;
    bottom: 16px;
    right: 20px;
    background: none;
    border: none;
    font-size: 12px;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
    z-index: 10; /* Ensure it stays above other content */
  }
  
  .skip-link:hover {
    color: var(--interactive-accent);
    background: var(--background-modifier-hover);
    text-decoration: none;
  }
  
  .skip-link:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
  }
  
  .skip-link:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  @media (max-width: 480px) {
    .onboarding-wizard-modal {
      padding: 16px;
      max-width: 100%;
    }
    
    .modal-actions {
      flex-direction: column;
    }
    
    .modal-actions button {
      width: 100%;
    }

    .wizard-step-label {
      display: none;
    }
    
    .skip-link {
      position: static;
      margin-top: 16px;
      text-align: center;
      display: block;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
    }
  }
`;re.onboardingWizardModal={inject:dE,remove:uE}});function T$(){Aw(),v$(),Iw()}var Yn=te(()=>{WD();gv();Ew();HD();u$();p$();GD();JD();ud();y$();XD();wv();Sv();kv();aE();sE();C$();pE()});var Zl,sr,ec=te(()=>{Zl=_(B());kv();sr=({message:e="Loading...",size:t="medium",fullscreen:r=!1,overlay:n=!1})=>{(0,Zl.useEffect)(()=>{Nm()},[]);let a=t==="small"?16:t==="large"?32:24,o=Zl.default.createElement("div",{className:`journalit-loading-spinner ${t}`,style:{"--spinner-size":`${a}px`}},Zl.default.createElement("div",{className:"journalit-spinner-icon"}),e&&Zl.default.createElement("span",{className:"loading-message"},e));return n?Zl.default.createElement("div",{className:"journalit-loading-overlay"},Zl.default.createElement("div",{className:"journalit-loading-overlay-content"},o)):r?Zl.default.createElement("div",{className:"journalit-loading-fullscreen"},o):o}});var ua,Cv,mE,E$,ko,Fw=te(()=>{ua=_(B());Jl();Cv=e=>{if(!e)return"";if(typeof e=="string")return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},mE=e=>{if(!e)return"";if(typeof e=="string")return/^\d{1,2}:\d{2}$/.test(e)?e:"";let t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${t}:${r}`},E$=(e,t)=>{try{if(!e)return null;let[r,n,a]=e.split("-").map(Number),o=new Date(r,n-1,a);if(t){let[i,s]=t.split(":").map(Number);o.setHours(i,s)}return o}catch(r){return null}},ko=({label:e,value:t,onChange:r,error:n,helperText:a,disabled:o=!1,className:i,includeTime:s=!1,timeOnly:l=!1,minDate:c,maxDate:d,required:u=!1,...p})=>{let m=(0,ua.useId)(),h=`date-${m}`,f=`time-${m}`,[b,v]=(0,ua.useState)(!1),[y,g]=(0,ua.useState)(""),[w,C]=(0,ua.useState)(""),k=(0,ua.useMemo)(()=>b?y:Cv(t),[b,y,t]),x=(0,ua.useMemo)(()=>b?w:mE(t),[b,w,t]),S=(0,ua.useCallback)(A=>{if(b?g(A):(v(!0),g(A),C(mE(t))),A){let L=b?w:mE(t),N=E$(A,L);N&&r&&r(N)}else r&&r(void 0)},[b,w,t,r,l]),T=(0,ua.useCallback)(A=>{if(b||(v(!0),g(Cv(t))),C(A),l)A&&r?r(A):r&&!A&&r(void 0);else{let L=b?y:Cv(t);if(L&&A){let N=E$(L,A);N&&r&&r(N)}}},[b,y,t,r,l]),P=(0,ua.useCallback)(()=>{v(!1),g(""),C("")},[]),M=c?Cv(c):void 0,D=d?Cv(d):void 0;return ua.default.createElement("div",{className:"date-picker-container",style:{position:"relative"}},!l&&ua.default.createElement(Xt,{id:h,label:e,type:"date",value:k,onChange:S,onBlur:P,error:n,helperText:a,disabled:o,className:i,min:M,max:D,required:u,...p}),(s||l)&&ua.default.createElement(Xt,{id:f,label:l?e:void 0,type:"time",value:x,onChange:T,onBlur:P,error:l?n:void 0,helperText:l?a:void 0,disabled:o,className:l?i:"time-input","aria-label":l?void 0:"Time",style:l?{}:{marginTop:"8px"},required:l?u:!1,...l?p:{}}))};ko.displayName="DatePicker"});var et,dl,KQ,JQ,oi,jw=te(()=>{et=_(B()),dl={COMBOBOX_CONTAINER:"combobox-container",INPUT_CONTAINER:"input-container",INPUT:"combobox-input",DROPDOWN:"combobox-dropdown",OPTION:"combobox-option",OPTION_HIGHLIGHTED:"highlighted",ADD_OPTION:"combobox-add-option",SELECTED_ITEM:"selected-item",REMOVE_BUTTON:"remove-button"},KQ=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),JQ=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),oi=({options:e,value:t,onChange:r,allowCreate:n=!1,isMulti:a=!1,label:o,placeholder:i="Select or type...",error:s,helperText:l,optionType:c,onSaveOption:d,required:u=!1})=>{let p=(0,et.useId)(),m=`combobox-${p}`,h=`combobox-list-${p}`,f=`helper-${p}`,b=`error-${p}`,[v,y]=(0,et.useState)(()=>a?"":t||""),[g,w]=(0,et.useState)(!1),[C,k]=(0,et.useState)(-1),x=(0,et.useRef)(null),S=(0,et.useRef)(null),T=(0,et.useRef)(!1),P=(0,et.useRef)(!1),M=a?Array.isArray(t)?[...t]:[]:[],D=(0,et.useMemo)(()=>!a&&!g&&t?t:v,[a,g,t,v]),A=(0,et.useCallback)(R=>{y(R.target.value),w(!0),k(-1)},[]),L=R=>{let X=(R.startsWith("__add__")?R.slice(7):R).trim();if(X!==""){if(a){let G=Array.isArray(t)?[...t]:[];if(!G.includes(X)){let H=[...G,X];r(H),d&&R.startsWith("__add__")&&d(X),(R.startsWith("__add__")||e.includes(R))&&y("")}w(!0),S.current&&setTimeout(()=>{S.current&&S.current.focus()},0)}else r(X),d&&R.startsWith("__add__")&&d(X),y(X),w(!1);k(-1)}};(0,et.useEffect)(()=>{let R=q=>{var H,Y,V;let X=q.target,G=(H=X==null?void 0:X.closest)==null?void 0:H.call(X,'[role="option"]');if(G&&((Y=x.current)!=null&&Y.contains(X))){T.current=!0;let Q=(V=G.textContent)==null?void 0:V.trim();if(!Q)return;let Z=G.hasAttribute("data-add-option")?`__add__${v}`:Q,se=Z.startsWith("__add__")?Z:Q;L(se),setTimeout(()=>{T.current=!1,a?(w(!0),S.current&&(S.current.focus(),y(""))):w(!1)},50)}};return document.addEventListener("mousedown",R,!0),()=>{document.removeEventListener("mousedown",R,!0)}},[a,v,L]);let N=(0,et.useCallback)(R=>{if(!a)return;P.current=!0;let X=(Array.isArray(t)?[...t]:[]).filter(G=>G!==R);r(X),setTimeout(()=>{S.current&&S.current.focus(),P.current=!1},50)},[a,r]);(0,et.useLayoutEffect)(()=>{if(!g)return;let R=q=>{var V,Q,Z;if(P.current)return;let X=q.target,G=(V=X==null?void 0:X.closest)==null?void 0:V.call(X,'[role="option"]'),H=(Q=X==null?void 0:X.closest)==null?void 0:Q.call(X,'[data-remove-button="true"]');if(!((Z=x.current)==null?void 0:Z.contains(X))){w(!1);return}if(G){q.stopPropagation();return}if(H){q.preventDefault(),q.stopPropagation(),P.current=!0;let ie=(H.getAttribute("aria-label")||"").replace("Remove ","");if(ie){let qe=(Array.isArray(t)?[...t]:[]).filter(ht=>ht!==ie);r(qe),setTimeout(()=>{S.current&&S.current.focus(),P.current=!1},50)}}};return document.addEventListener("mousedown",R,!0),()=>{document.removeEventListener("mousedown",R,!0)}},[g,r]),(0,et.useEffect)(()=>{if(!g)return;let R=q=>{q.key==="Escape"&&w(!1)};return document.addEventListener("keydown",R,!0),()=>{document.removeEventListener("keydown",R,!0)}},[g]),(0,et.useEffect)(()=>{if(!g)return;let R=()=>{w(!1)};return window.addEventListener("blur",R),()=>{window.removeEventListener("blur",R)}},[g]);let E=(0,et.useMemo)(()=>{let R=a?Array.isArray(t)?t:[]:[];return e.filter(q=>q.toLowerCase().includes(v.toLowerCase())).filter(q=>!a||!R.includes(q))},[e,v,a,t]),I=(0,et.useMemo)(()=>n&&v.trim()!==""&&!e.find(R=>R.toLowerCase()===v.toLowerCase()),[n,v,e]),O=(0,et.useCallback)(R=>{let q=E.length+(I?1:0);switch(R.key){case"ArrowDown":R.preventDefault(),w(!0),k(X=>(X+1)%q);break;case"ArrowUp":R.preventDefault(),w(!0),k(X=>(X-1+q)%q);break;case"Enter":R.preventDefault(),g?C>=0&&C<E.length?L(E[C]):I&&C===E.length?L(`__add__${v}`):n&&v.trim()!==""&&L(`__add__${v}`):w(!0);break;case"Tab":if(v.trim()!==""&&E.length>0){let X=E.find(G=>G.toLowerCase().startsWith(v.toLowerCase()));X?(R.preventDefault(),L(X)):L(E[0])}else a||w(!1);break;case"Escape":w(!1);break}},[E,I,g,C,n,v,a,L]),j=et.default.useMemo(()=>E.map((R,q)=>et.default.createElement("li",{id:`option-${q}`,key:R,role:"option","aria-selected":C===q,className:`${dl.OPTION} ${C===q?dl.OPTION_HIGHLIGHTED:""}`,style:KQ(C===q),onMouseEnter:()=>k(q)},R)),[E,C]),$=et.default.useMemo(()=>I?et.default.createElement("li",{id:`option-${E.length}`,role:"option","aria-selected":C===E.length,"data-add-option":"true",className:`${dl.ADD_OPTION} ${C===E.length?dl.OPTION_HIGHLIGHTED:""}`,style:JQ(C===E.length),onMouseEnter:()=>k(E.length)},'Add "',v,'"'):null,[I,v,E.length,C]),F=et.default.useMemo(()=>a?et.default.createElement("div",null,(Array.isArray(t)?t:[]).map(R=>et.default.createElement("span",{key:R,className:dl.SELECTED_ITEM},R,et.default.createElement("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),!P.current&&N(R)},onMouseDown:q=>{q.preventDefault(),q.stopPropagation(),!P.current&&N(R)},"aria-label":`Remove ${R}`,"data-remove-button":"true",className:dl.REMOVE_BUTTON},"\xD7")))):null,[a,t,N]),z=et.default.useCallback(()=>{w(!0),a||y("")},[a]),W=et.default.useCallback(R=>{var X,G,H;T.current||P.current||R.relatedTarget&&((G=(X=R.relatedTarget)==null?void 0:X.hasAttribute)!=null&&G.call(X,"data-remove-button"))||(H=x.current)!=null&&H.contains(R.relatedTarget)||setTimeout(()=>{!T.current&&!P.current&&w(!1)},100)},[]),U=et.default.useCallback(R=>{R.preventDefault(),R.stopPropagation(),w(!0),S.current&&S.current.focus()},[]),K=et.default.useCallback(R=>{g&&R.preventDefault()},[g]);return et.default.createElement("div",{ref:x,"data-combobox-type":a?"multi":"single","data-is-open":g?"true":"false",className:dl.COMBOBOX_CONTAINER,style:{zIndex:g?9999:10}},o&&et.default.createElement("label",{htmlFor:m},o,u&&et.default.createElement("span",{className:"required-indicator"},"*")),F,et.default.createElement("div",{className:dl.INPUT_CONTAINER},et.default.createElement("input",{ref:S,id:m,type:"text",value:D,onChange:A,onFocus:z,onBlur:W,onMouseDown:K,onClick:U,onKeyDown:O,placeholder:a&&M.length>0?"":i,"aria-expanded":g,"aria-autocomplete":"list","aria-controls":g?h:void 0,"aria-activedescendant":C>=0?`option-${C}`:void 0,"aria-invalid":!!s,"aria-describedby":s?b:l?f:void 0,role:"combobox",className:dl.INPUT}),g&&(E.length>0||I)&&et.default.createElement("ul",{id:h,role:"listbox","data-dropdown-visible":"true",className:dl.DROPDOWN},j,$)),s&&et.default.createElement("div",{id:b,role:"alert",className:"errorMessage"},s),!s&&l&&et.default.createElement("div",{id:f},l))};oi.displayName="ComboBox"});var Ri,fE,gE=te(()=>{Ri=_(B()),fE=({options:e,value:t,onChange:r,placeholderIcon:n,className:a="",title:o="Select an option"})=>{let[i,s]=(0,Ri.useState)(!1),l=(0,Ri.useRef)(null),c=e.find(u=>u.value===t);(0,Ri.useEffect)(()=>{let u=p=>{l.current&&!l.current.contains(p.target)&&s(!1)};return i&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[i]);let d=u=>{r(u.value),s(!1)};return Ri.default.createElement("div",{ref:l,className:`icon-select-container ${a}`,title:o},Ri.default.createElement("button",{type:"button",className:"icon-select-trigger",onClick:()=>s(!i),"aria-haspopup":"listbox","aria-expanded":i},c?c.icon:n),i&&Ri.default.createElement("ul",{className:"icon-select-menu",role:"listbox"},e.map(u=>Ri.default.createElement("li",{key:u.value||"null-option",className:`icon-select-option ${u.value===t?"selected":""}`,onClick:()=>d(u),role:"option","aria-selected":u.value===t,title:u.label||String(u.value)},u.icon," "))),Ri.default.createElement("style",null,`
        .icon-select-container {
          position: relative;
          display: inline-block;
          width: 40px;
          height: 32px;
        }

        .icon-select-trigger {
          width: 100%;
          height: 100%;
          padding: 0;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .icon-select-trigger:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-menu {
          position: absolute;
          top: calc(100% + 2px);
          left: 0;
          width: 40px;
          background-color: var(--background-primary);
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          list-style: none;
          padding: 4px 0;
          margin: 0;
        }

        .icon-select-option {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 6px 0;
          cursor: pointer;
          height: 28px;
        }

        .icon-select-option:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-option.selected {
          background-color: var(--background-secondary);
        }
        
        /* SVG centering styles */
        .icon-select-trigger svg,
        .icon-select-option svg {
          display: block;
          margin: 0 auto;
        }
      `))}});var A$=te(()=>{});var Wi=te(()=>{_i();Jl();rd();Fw();Sw();jw();gE();A$()});var ii,O$,F$=te(()=>{ii=_(B()),O$=({data:e,onChange:t})=>ii.default.createElement("div",{className:"field"},ii.default.createElement("div",{className:"missed-trade-toggle",style:{marginBottom:"8px",padding:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",backgroundColor:e.isMissedTrade?"rgba(var(--color-orange-rgb, 255, 165, 0), 0.1)":"var(--background-secondary)"}},ii.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},ii.default.createElement("div",{className:"toggle-container",style:{position:"relative",width:"36px",height:"20px"}},ii.default.createElement("input",{type:"checkbox",id:"is-missed-trade",checked:e.isMissedTrade||!1,onChange:r=>t("isMissedTrade",r.target.checked),className:"toggle-checkbox",style:{opacity:0,width:0,height:0}}),ii.default.createElement("label",{htmlFor:"is-missed-trade",className:"toggle-switch",style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:e.isMissedTrade?"var(--interactive-accent)":"var(--background-modifier-border)",transition:".3s",borderRadius:"20px"}},ii.default.createElement("span",{style:{position:"absolute",content:'""',height:"16px",width:"16px",left:"2px",bottom:"2px",backgroundColor:"var(--background-primary)",transition:".3s",borderRadius:"50%",transform:e.isMissedTrade?"translateX(16px)":"translateX(0px)"}}))),ii.default.createElement("label",{htmlFor:"is-missed-trade",style:{fontWeight:"500",cursor:"pointer"}},"Is this a missed trade?")),ii.default.createElement("p",{style:{margin:"8px 0 0 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}},e.isMissedTrade?"PNL and Account fields are now optional.":"Enable this to create a missed trade note instead of a regular trade."),e.isMissedTrade&&ii.default.createElement("div",{className:"field",style:{marginTop:"12px"}},ii.default.createElement("label",{className:"label"},"Why did you miss this trade?"),ii.default.createElement("textarea",{value:e.missedReason||"",onChange:r=>t("missedReason",r.target.value),placeholder:"Describe why you missed this trade opportunity...",rows:3,className:"textarea",style:{width:"100%",padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}}))))});var hE,pd,Lm=te(()=>{hE=_(B()),pd=({title:e,children:t,description:r})=>hE.default.createElement("div",{className:"formSection"},hE.default.createElement("div",{className:"sectionContent"},t))});var ZQ,vE,yE,_w,Pv,eZ,j$,z$,bE,Au=te(()=>{cd();Ea();wm();ZQ=e=>{let t=e.tradeStatus;if(t==="OPEN")return!0;if(t==="CLOSED"||e.useDirectPnLInput===!0||e.isMissedTrade===!0)return!1;let r=e.exits&&e.exits.length>0&&e.exits.some(a=>a.price!==void 0&&a.price!==null&&a.price!==0||a.size!==void 0&&a.size!==null&&a.size!==0),n=e.exitPrice!==void 0&&e.exitPrice!==null&&e.exitPrice!==0;return!r&&!n},vE=e=>{let t={},r=e.useDirectPnLInput===!0,n=e.isMissedTrade===!0,a=ZQ(e);if(!r&&!n)if(!e.entries||e.entries.length===0)t.entriesExits="At least one entry is required.";else{let o=[],i=!1;e.entries.forEach((s,l)=>{let c={};s.time||(c.time="Entry time is required.",i=!0),(s.price===void 0||s.price===null)&&(c.price="Entry price is required.",i=!0),(s.size===void 0||s.size===null||s.size<=0)&&(c.size="Entry size must be greater than zero.",i=!0),o[l]=c}),i&&(t.entries=o)}if(!r&&!n)if(!e.exits||e.exits.length===0)a||(t.entriesExits?t.entriesExits+=" At least one exit is required for closed trades.":t.entriesExits="At least one exit is required for closed trades.");else{let o=e.exits.filter(s=>(s.price===void 0||s.price===null||s.price===0)&&(s.size===void 0||s.size===null||s.size===0));if(!(e.exits.filter(s=>s.price!==void 0&&s.price!==null&&s.price!==0||s.size!==void 0&&s.size!==null&&s.size!==0).length===0&&a)){let s=[],l=!1;e.exits.forEach((c,d)=>{if((c.price===void 0||c.price===null||c.price===0)&&(c.size===void 0||c.size===null||c.size===0)&&a){s[d]={};return}let p={};c.time||(p.time="Exit time is required.",l=!0),(c.price===void 0||c.price===null)&&(p.price="Exit price is required.",l=!0),(c.size===void 0||c.size===null||c.size<=0)&&(p.size="Exit size must be greater than zero.",l=!0),s[d]=p}),l&&(t.exits=s)}}if(!r&&!n&&e.entries&&e.entries.length>0&&e.exits&&e.exits.length>0){let o=e.exits.filter(i=>i.price!==void 0&&i.price!==null&&i.price!==0&&i.size!==void 0&&i.size!==null&&i.size!==0);if(!(o.length===0&&a)){let i=e.entries.reduce((c,d)=>c+(d.size||0),0);o.reduce((c,d)=>c+(d.size||0),0)>i&&(t.entriesExits?t.entriesExits+=" Total exit size cannot exceed total entry size.":t.entriesExits="Total exit size cannot exceed total entry size.");let l=e.entries&&e.entries.length>0?e.entries[0].time:void 0;l&&o.some(c=>c.time&&c.time<l)&&(t.entriesExits?t.entriesExits+=" Exits cannot occur before the first entry.":t.entriesExits="Exits cannot occur before the first entry.")}}if(r&&!n&&(e.directPnL===void 0||e.directPnL===null)&&(t.directPnL="Please enter a profit/loss value."),!r&&!n?(e.entryTime||(t.entryTime="Please select an entry time."),a||(e.exitTime||(t.exitTime="Please select an exit time."),(e.exitPrice===void 0||e.exitPrice===null)&&(t.exitPrice="Please enter an exit price.")),(e.entryPrice===void 0||e.entryPrice===null)&&(t.entryPrice="Please enter an entry price."),(e.positionSize===void 0||e.positionSize===null)&&(t.positionSize="Please enter a position size.")):e.entryTime||(t.entryTime="Please select an entry time."),e.direction||(t.direction="Please select a direction."),e.assetType||(t.assetType="Please select an asset type."),e.instrument?/^[A-Z0-9]+$/i.test(e.instrument)||(t.instrument="Enter a valid ticker symbol (letters & numbers only)."):t.instrument="Please select a Ticker.",!n&&(!e.accountIds||e.accountIds.length===0)&&(!e.account||e.account.length===0)&&(t.accountIds="Please select at least one account."),!a&&e.entryTime&&e.exitTime&&e.entryTime>e.exitTime&&(t.exitTime="Exit time must be after entry time"),!r&&!n&&(e.positionSize===void 0||e.positionSize===null||e.positionSize<=0)&&(t.positionSize="Position size must be greater than zero"),e.assetType)switch(e.assetType){case"stock":break;case"options":e.expirationDate||(t.expirationDate="Please select an expiration date."),e.strikePrice||(t.strikePrice="Please enter a strike price."),e.optionType||(t.optionType="Please select an option type (call or put)."),e.contractSize!==void 0&&e.contractSize<=0&&(t.contractSize="Contract size must be greater than zero.");break;case"futures":(e.dollarPerPoint===void 0||e.dollarPerPoint<.01)&&(t.dollarPerPoint="Please enter Dollars per point (min 0.01).");break;case"forex":e.lotSize!==void 0&&e.lotSize<0&&(t.lotSize="Lot size cannot be negative.");break;case"crypto":break;case"cfd":e.leverageRatio!==void 0&&e.leverageRatio<=0&&(t.leverageRatio="Leverage ratio must be greater than zero.");break}return e.commission!==void 0&&e.commission!==null&&typeof e.commission!="number"&&(t.commission="Commission must be a number."),e.swap!==void 0&&e.swap!==null&&typeof e.swap!="number"&&(t.swap="Invalid swap amount."),e.fees!==void 0&&e.fees!==null&&typeof e.fees!="number"&&(t.fees="Fees must be a number."),t},yE=(e,t,r)=>{let n={};return!e||!t||t.length===0||t.forEach(a=>{let o=e[a.id],i=r?r.getFieldOptions(a.id):void 0,s=hw(o,a,i);s&&(n[a.id]=s)}),n},_w=e=>Object.keys(e).length>0,Pv=e=>{var r,n;if(ct({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}))return 0;if(e.useDirectPnLInput&&e.directPnL!==void 0){let a=e.directPnL;return e.commission!==void 0&&(e.commission<0?a+=e.commission:a-=e.commission),e.swap!==void 0&&(e.swap<0?a+=e.swap:a-=e.swap),e.fees!==void 0&&(e.fees<0?a+=e.fees:a-=e.fees),a}if(!((r=e.entries)!=null&&r.length)||!((n=e.exits)!=null&&n.length)||!e.direction)return eZ(e);let t=0;return e.exits&&e.entries&&e.exits.forEach(a=>{if(a.price===void 0||a.size===void 0)return;let o=0,i=0;if(e.entries&&e.entries.forEach(d=>{d.price===void 0||d.size===void 0||(o+=d.price*d.size,i+=d.size)}),i===0)return;let s=o/i,l=0,c=e.direction==="long"?a.price-s:s-a.price;if(l=c*a.size,e.assetType)switch(e.assetType){case"options":e.contractSize&&(l=c*a.size*e.contractSize);break;case"futures":e.dollarPerPoint&&(l=c*a.size*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(l=c/e.tickSize*e.tickValue*a.size));break;case"forex":e.lotSize&&e.lotSize>0?l=c*a.size*e.lotSize:e.pipValue&&e.pipValue>0&&(l=c*1e4*e.pipValue*a.size);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(l=c*a.size);break}t+=l}),e.commission!==void 0&&(e.commission<0?t+=e.commission:t-=e.commission),e.swap!==void 0&&(e.swap<0?t+=e.swap:t-=e.swap),e.fees!==void 0&&(e.fees<0?t+=e.fees:t-=e.fees),t},eZ=e=>{if(e.entryPrice===void 0||e.exitPrice===void 0||e.positionSize===void 0||!e.direction)return 0;let t=0,r=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice;if(t=r*e.positionSize,e.assetType)switch(e.assetType){case"options":e.contractSize&&(t=r*e.positionSize*e.contractSize);break;case"futures":e.dollarPerPoint&&(t=r*e.positionSize*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(t=r/e.tickSize*e.tickValue*e.positionSize));break;case"forex":e.lotSize&&e.lotSize>0?t=r*e.positionSize*e.lotSize:e.pipValue&&e.pipValue>0&&(t=r*1e4*e.pipValue*e.positionSize);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(t=r*e.positionSize);break}return e.commission!==void 0&&(e.commission<0?t+=e.commission:t-=e.commission),e.swap!==void 0&&(e.swap<0?t+=e.swap:t-=e.swap),e.fees!==void 0&&(e.fees<0?t+=e.fees:t-=e.fees),t},j$=e=>{if(ct({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits})||e.useDirectPnLInput||e.entryPrice===void 0||e.exitPrice===void 0||e.entryPrice===0||!e.direction)return 0;let r=(e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice)/e.entryPrice*100;return e.assetType==="cfd"&&e.leverageRatio&&e.leverageRatio>0&&(r=r*e.leverageRatio),r},z$=e=>{let t=[];if(e.commission&&e.commission>0&&t.push(`Commission: $${e.commission.toFixed(2)}`),e.swap!==void 0&&e.swap!==null&&e.swap!==0){let r=e.swap>0?"Swap Cost":"Swap Credit";t.push(`${r}: $${Math.abs(e.swap).toFixed(2)}`)}return e.fees&&e.fees>0&&t.push(`Fees: $${e.fees.toFixed(2)}`),t.length>0?t.join(", "):"No costs"},bE=e=>{let t=e.commission||0,r=e.swap||0,n=e.fees||0;return t+r+n}});var Iu=te(()=>{So()});var md,_$,Co,Ae,Ct=te(()=>{md=_(B());ym();Zt();_$=(0,md.createContext)(void 0),Co=({children:e})=>{var a,o;let t=Ee(),r=((o=(a=t==null?void 0:t.settings)==null?void 0:a.general)==null?void 0:o.currency)||"USD";(0,md.useEffect)(()=>{let i=s=>{!t||t.settings};return window.addEventListener("journalit-currency-changed",i),()=>{window.removeEventListener("journalit-currency-changed",i)}},[]);let n={currency:r};return md.default.createElement(_$.Provider,{value:n},e)},Ae=()=>{let e=(0,md.useContext)(_$);if(e===void 0)throw new Error("useCurrency must be used within a CurrencyProvider");return e}});var Dv,B$,$$=te(()=>{Dv=_(B());Wi();B$=({data:e,errors:t,onChange:r})=>Dv.default.createElement(Dv.default.Fragment,null,Dv.default.createElement("div",{className:"field"},Dv.default.createElement(Xt,{label:"Exchange",placeholder:"e.g., NYSE, NASDAQ",value:e.exchange||"",onChange:n=>r("exchange",n),error:t.exchange})))});function Bw(e){switch(e){case"forex":return 5;case"crypto":return 8;case"futures":return 4;case"options":return 4;case"stock":return 2;case"cfd":return 4;default:return 4}}function R$(e){switch(e){case"forex":return 4;case"crypto":return 8;case"futures":return 0;case"options":return 0;case"stock":return 2;case"cfd":return 2;default:return 2}}var $w=te(()=>{cd()});var Ia,W$,U$=te(()=>{Ia=_(B());Wi();$w();W$=({data:e,errors:t,onChange:r})=>{let n=Bw(e.assetType);return Ia.default.createElement(Ia.default.Fragment,null,Ia.default.createElement("div",{className:"field"},Ia.default.createElement(ko,{label:"Expiration Date",value:e.expirationDate,onChange:a=>r("expirationDate",a),error:t.expirationDate,required:!0})),Ia.default.createElement("div",{className:"field"},Ia.default.createElement(Mt,{label:"Strike Price",value:e.strikePrice,onChange:a=>r("strikePrice",a),error:t.strikePrice,min:0,precision:n,allowDecimal:!0,required:!0})),Ia.default.createElement("div",{className:"field"},Ia.default.createElement("label",{className:"label",id:"optionType-label"},"Option Type",Ia.default.createElement("span",{className:"required-indicator"},"*")),Ia.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"optionType-label","aria-required":"true"},Ia.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","call"),"aria-checked":e.optionType==="call",role:"radio"},"Call"),Ia.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","put"),"aria-checked":e.optionType==="put",role:"radio"},"Put")),t.optionType&&Ia.default.createElement("div",{className:"errorMessage",role:"alert"},t.optionType)),Ia.default.createElement("div",{className:"field"},Ia.default.createElement(Mt,{label:"Contract Size",value:e.contractSize,onChange:a=>r("contractSize",a),error:t.contractSize,min:1,precision:0,allowDecimal:!1})))}});var pl,q$,H$=te(()=>{pl=_(B());Wi();q$=({data:e,errors:t,onChange:r})=>pl.default.createElement(pl.default.Fragment,null,pl.default.createElement("div",{className:"field"},pl.default.createElement(Mt,{label:"Dollars per point",value:e.dollarPerPoint,onChange:n=>r("dollarPerPoint",n),error:t.dollarPerPoint,min:.01,precision:2,allowDecimal:!0,required:!0,placeholder:"ex: 50 for ES1"})),pl.default.createElement("div",{className:"twoColumnLayout"},pl.default.createElement("div",{className:"field"},pl.default.createElement(Mt,{label:"Tick Size",value:e.tickSize,onChange:n=>r("tickSize",n),error:t.tickSize,min:0,precision:4,allowDecimal:!0})),pl.default.createElement("div",{className:"field"},pl.default.createElement(Mt,{label:"Tick Value",value:e.tickValue,onChange:n=>r("tickValue",n),error:t.tickValue,min:0,precision:2,allowDecimal:!0}))))});var Ui,V$,G$=te(()=>{Ui=_(B());Wi();V$=({data:e,errors:t,onChange:r})=>Ui.default.createElement(Ui.default.Fragment,null,Ui.default.createElement("div",{className:"field"},Ui.default.createElement("label",{className:"label",id:"lotSize-label"},"Lot Size"),Ui.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"lotSize-label"},[{value:1e5,label:"Standard (100,000)"},{value:1e4,label:"Mini (10,000)"},{value:1e3,label:"Micro (1,000)"},{value:0,label:"Custom"}].map(n=>Ui.default.createElement("button",{key:n.value,type:"button",className:"asset-type-button",onClick:()=>r("lotSize",n.value),"aria-checked":e.lotSize===n.value,role:"radio"},n.label))),t.lotSize&&Ui.default.createElement("div",{className:"errorMessage",role:"alert"},t.lotSize)),e.lotSize===0&&Ui.default.createElement("div",{className:"field"},Ui.default.createElement(Mt,{label:"Custom Lot Size",value:e.lotSize,onChange:n=>r("lotSize",n),error:t.lotSize,min:1,precision:0,allowDecimal:!1,required:!0})),Ui.default.createElement("div",{className:"field"},Ui.default.createElement(Mt,{label:"Pip Value",value:e.pipValue,onChange:n=>r("pipValue",n),error:t.pipValue,min:0,precision:4,allowDecimal:!0})))});var Ev,Y$,K$=te(()=>{Ev=_(B());Wi();Y$=({data:e,errors:t,onChange:r})=>Ev.default.createElement(Ev.default.Fragment,null,Ev.default.createElement("div",{className:"field"},Ev.default.createElement(Xt,{label:"Exchange",placeholder:"e.g., Binance, Coinbase",value:e.cryptoExchange||"",onChange:n=>r("cryptoExchange",n),error:t.cryptoExchange})))});var Nu,J$,X$=te(()=>{Nu=_(B());Wi();J$=({data:e,errors:t,onChange:r})=>Nu.default.createElement(Nu.default.Fragment,null,Nu.default.createElement("div",{className:"field"},Nu.default.createElement(Mt,{label:"Contract Size",value:e.contractSize,onChange:n=>r("contractSize",n),error:t.contractSize,min:1,precision:0,allowDecimal:!1})),Nu.default.createElement("div",{className:"field"},Nu.default.createElement(Mt,{label:"Leverage Ratio",placeholder:"e.g., 100 for 1:100",value:e.leverageRatio,onChange:n=>r("leverageRatio",n),error:t.leverageRatio,min:1,precision:0,allowDecimal:!1})))});var Q$,Z$,eR=te(()=>{Q$=()=>{let e="journalit-entry-exit-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Entry/Exit Fields styling */
    .entries-section, .exits-section {
      margin-bottom: 16px;
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      background-color: var(--background-primary);
    }

    .section-title {
      margin: 0 0 12px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      color: var(--text-normal);
    }

    .badge {
      display: inline-block;
      background: var(--interactive-accent);
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: 8px;
    }

    .entry-row, .exit-row {
      display: flex;
      align-items: flex-start;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--background-modifier-border);
    }

    .entry-index, .exit-index {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background-secondary);
      border-radius: 50%;
      margin-right: 12px;
      font-size: 12px;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .entry-fields, .exit-fields {
      display: flex;
      flex: 1;
      gap: 12px;
      flex-wrap: wrap;
    }

    .time-field {
      flex: 2;
      min-width: 180px;
    }

    .price-field, .size-field {
      flex: 1;
      min-width: 120px;
    }

    /* Make remove button class more specific to avoid conflicts */
    .entry-row .remove-button,
    .exit-row .remove-button {
      width: 28px;
      height: 28px;
      min-width: 28px;
      padding: 0;
      margin-left: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .add-button {
      margin-top: 8px;
      margin-bottom: 12px;
    }

    .total-size, .remaining-size {
      font-size: 14px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 4px;
      background: var(--background-secondary);
      display: inline-block;
      margin-top: 8px;
    }

    .remaining-size.positive {
      color: var(--text-success);
    }

    .remaining-size.neutral {
      color: var(--text-normal);
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .entry-fields, .exit-fields {
        flex-direction: column;
        gap: 8px;
      }

      .time-field, .price-field, .size-field {
        width: 100%;
        min-width: 0;
      }
    }
  `,document.head.appendChild(t)},Z$=()=>{let t=document.getElementById("journalit-entry-exit-styles");t&&t.remove()}});var Ke,tR,rR=te(()=>{Ke=_(B());eR();Wi();cd();$w();Cu();tR=({data:e,errors:t,onChange:r})=>{var v,y;let n=()=>{let g=[...e.entries||[],{time:new Date,price:0,size:0}];r("entries",g),c(g,e.exits||[])},a=g=>{let w=[...e.entries||[]];w.splice(g,1),r("entries",w),c(w,e.exits||[])},o=()=>{let g=[...e.exits||[],{time:new Date,price:0,size:0}];r("exits",g),c(e.entries||[],g)},i=g=>{let w=[...e.exits||[]];w.splice(g,1),r("exits",w),c(e.entries||[],w)},s=(g,w,C)=>{let k=[...e.entries||[]];k[g]={...k[g],[w]:C},r("entries",k),c(k,e.exits||[])},l=(g,w,C)=>{let k=[...e.exits||[]];k[g]={...k[g],[w]:C},r("exits",k),c(e.entries||[],k)},c=(g,w)=>{if(!g.length||!w.length)return;let C=0,k=0;g.forEach(T=>{T.size!==void 0&&T.price!==void 0&&(C+=T.price*T.size,k+=T.size)});let x=0,S=0;if(w.forEach(T=>{T.size!==void 0&&T.price!==void 0&&(x+=T.price*T.size,S+=T.size)}),k>0){r("entryPrice",C/k),r("positionSize",k);let T=g.reduce((P,M)=>M.time&&(!P||M.time<P)?M.time:P,null);T&&r("entryTime",T)}if(S>0){r("exitPrice",x/S);let T=w.reduce((P,M)=>M.time&&(!P||M.time>P)?M.time:P,null);T&&r("exitTime",T)}},d=async g=>{r("useDirectPnLInput",g);try{let w=br().plugins.plugins.journalit;w&&(w.settings.trade.useDirectPnLInput=g,await w.saveSettings())}catch(w){console.error("Error saving PNL input mode preference:",w)}},u=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},p=(e.entries||[]).reduce((g,w)=>g+(w.size||0),0),m=(e.exits||[]).reduce((g,w)=>g+(w.size||0),0),h=p-m,f=Bw(e.assetType),b=R$(e.assetType);return(0,Ke.useEffect)(()=>(Q$(),()=>{Z$()}),[]),Ke.default.createElement(Ke.default.Fragment,null,Ke.default.createElement("div",{className:"pnl-mode-toggle",style:{marginBottom:"20px",padding:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px"}},Ke.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},Ke.default.createElement("div",{className:"toggle-container",style:{position:"relative",width:"36px",height:"20px"}},Ke.default.createElement("input",{type:"checkbox",id:"use-direct-pnl",checked:e.useDirectPnLInput||!1,onChange:g=>d(g.target.checked),className:"toggle-checkbox",style:{opacity:0,width:0,height:0}}),Ke.default.createElement("label",{htmlFor:"use-direct-pnl",className:"toggle-switch",style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:e.useDirectPnLInput?"var(--interactive-accent)":"var(--background-modifier-border)",transition:".3s",borderRadius:"20px"}},Ke.default.createElement("span",{style:{position:"absolute",content:'""',height:"16px",width:"16px",left:"2px",bottom:"2px",backgroundColor:"var(--background-primary)",transition:".3s",borderRadius:"50%",transform:e.useDirectPnLInput?"translateX(16px)":"translateX(0px)"}}))),Ke.default.createElement("label",{htmlFor:"use-direct-pnl",style:{fontWeight:"500",cursor:"pointer"}},"Enter PNL directly instead of prices")),Ke.default.createElement("p",{style:{margin:"8px 0 0 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}},e.useDirectPnLInput?"Enter your total profit/loss directly. Commission and fees will still be subtracted.":"Calculate PNL from entry/exit prices and position sizes.")),e.useDirectPnLInput?Ke.default.createElement("div",{className:"direct-pnl-section"},Ke.default.createElement("h4",{className:"section-title"},"Trade Details"),Ke.default.createElement("div",{className:"field"},Ke.default.createElement(ko,{label:"Entry Date",value:e.entryTime,onChange:g=>r("entryTime",g),error:t.entryTime,includeTime:!0,required:!e.isMissedTrade})),Ke.default.createElement("div",{className:"field",style:{marginTop:"32px"}},Ke.default.createElement(Mt,{label:`${u()} (optional)`,value:e.positionSize,onChange:g=>r("positionSize",g),error:t.positionSize,min:0,precision:b,allowDecimal:!0,required:!1,placeholder:"Enter position size"})),Ke.default.createElement("div",{className:"field",style:{marginTop:"32px"}},Ke.default.createElement(Mt,{label:"Total P&L",value:e.directPnL,onChange:g=>r("directPnL",g),error:t.directPnL,allowDecimal:!0,precision:2,required:!e.isMissedTrade,placeholder:"Enter total profit or loss"}))):Ke.default.createElement(Ke.default.Fragment,null,Ke.default.createElement("div",{className:"entries-section"},Ke.default.createElement("h4",{className:"section-title"},"Entries ",Ke.default.createElement("span",{className:"badge"},((v=e.entries)==null?void 0:v.length)||0)),(e.entries||[]).map((g,w)=>{var C,k,x,S,T,P,M;return Ke.default.createElement("div",{key:`entry-${w}`,className:"entry-row"},Ke.default.createElement("div",{className:"entry-index"},w+1),Ke.default.createElement("div",{className:"entry-fields"},Ke.default.createElement(ko,{label:"Time",value:g.time,onChange:D=>s(w,"time",D),error:(k=(C=t.entries)==null?void 0:C[w])==null?void 0:k.time,includeTime:!0,required:!e.isMissedTrade,className:"time-field"}),Ke.default.createElement(Mt,{label:"Price",value:g.price,onChange:D=>s(w,"price",D),error:(S=(x=t.entries)==null?void 0:x[w])==null?void 0:S.price,min:0,precision:f,allowDecimal:!0,required:!e.isMissedTrade,className:"price-field"}),Ke.default.createElement(Mt,{label:"Size",value:g.size,onChange:D=>s(w,"size",D),error:(P=(T=t.entries)==null?void 0:T[w])==null?void 0:P.size,min:0,precision:b,required:!e.isMissedTrade,className:"size-field"})),(((M=e.entries)==null?void 0:M.length)||0)>1&&Ke.default.createElement($e,{variant:"outline",className:"remove-button",onClick:()=>a(w),title:"Remove Entry"},"-"))}),Ke.default.createElement($e,{variant:"outline",className:"add-button",onClick:n,title:"Add Entry"},"+ Add Entry"),Ke.default.createElement("div",{className:"total-size"},"Total Entry Size: ",p.toFixed(b))),Ke.default.createElement("div",{className:"exits-section"},Ke.default.createElement("h4",{className:"section-title"},"Exits ",Ke.default.createElement("span",{className:"badge"},((y=e.exits)==null?void 0:y.length)||0)),(e.exits||[]).map((g,w)=>{var C,k,x,S,T,P,M;return Ke.default.createElement("div",{key:`exit-${w}`,className:"exit-row"},Ke.default.createElement("div",{className:"exit-index"},w+1),Ke.default.createElement("div",{className:"exit-fields"},Ke.default.createElement(ko,{label:"Time",value:g.time,onChange:D=>l(w,"time",D),error:(k=(C=t.exits)==null?void 0:C[w])==null?void 0:k.time,includeTime:!0,required:!e.isMissedTrade,className:"time-field"}),Ke.default.createElement(Mt,{label:"Price",value:g.price,onChange:D=>l(w,"price",D),error:(S=(x=t.exits)==null?void 0:x[w])==null?void 0:S.price,min:0,precision:f,allowDecimal:!0,required:!e.isMissedTrade,className:"price-field"}),Ke.default.createElement(Mt,{label:"Size",value:g.size,onChange:D=>l(w,"size",D),error:(P=(T=t.exits)==null?void 0:T[w])==null?void 0:P.size,min:0,precision:b,required:!e.isMissedTrade,className:"size-field"})),(((M=e.exits)==null?void 0:M.length)||0)>1&&Ke.default.createElement($e,{variant:"outline",className:"remove-button",onClick:()=>i(w),title:"Remove Exit"},"-"))}),Ke.default.createElement($e,{variant:"outline",className:"add-button",onClick:o,title:"Add Exit"},"+ Add Exit"),Ke.default.createElement("div",{className:`remaining-size ${h>0?"positive":"neutral"}`},"Remaining Position: ",h.toFixed(b)," ",h>0?"(Open)":"(Closed)"))),!e.useDirectPnLInput&&t.entriesExits&&Ke.default.createElement("div",{className:"errorMessage",role:"alert"},t.entriesExits))}});var je,nR,aR,xE=te(()=>{je=_(B()),nR=require("obsidian");Wi();Lm();cd();Au();ud();Iu();Ct();$$();U$();H$();G$();K$();X$();rR();aR=({data:e,errors:t,onChange:r,instruments:n=[]})=>{let{currency:a}=Ae(),[o,i]=(0,je.useState)([]),[s,l]=(0,je.useState)({}),[c,d]=(0,je.useState)({}),[u,p]=(0,je.useState)([]),[m,h]=(0,je.useState)(!1);(0,je.useEffect)(()=>{let T=br().plugins.plugins.journalit,P=T&&T.optionsService?T.optionsService:new Hn(T),M=async()=>{var L;try{h(!0);let N=T==null?void 0:T.tradeService;if(!N){console.warn("TradeService not available, skipping account loading"),h(!1);return}let E=await N.getUniqueAccounts(),I=Object.keys(((L=T.settings.account)==null?void 0:L.accountMetadata)||{}),j=[...new Set([...E,...I])],$={},F={};j.forEach(U=>{$[U]=U,F[U]=U}),i(j),l($),d(F);let z=e.assetType?P.getInstrumentsForAssetType(e.assetType):[],W=e.instrument&&e.assetType&&!z.includes(e.instrument)?[...z,e.instrument]:[...z];e.instrument&&e.assetType&&z.includes(e.instrument),p(W)}catch(N){console.error("Failed to load options:",N),i([]),p([])}finally{h(!1)}};M();let D=()=>{M()},A=()=>{setTimeout(()=>{try{let N=e.assetType?P.getInstrumentsForAssetType(e.assetType):[];JSON.stringify(N)!==JSON.stringify(u)&&p(N)}catch(N){console.error("Error updating instrument options:",N)}},300)};return document.addEventListener("journalit-options-changed",A,{capture:!1}),document.addEventListener("journalit:account-created",D),document.addEventListener("journalit:account-updated",D),document.addEventListener("journalit:account-deleted",D),()=>{document.removeEventListener("journalit-options-changed",A,{capture:!1}),document.removeEventListener("journalit:account-created",D),document.removeEventListener("journalit:account-updated",D),document.removeEventListener("journalit:account-deleted",D)}},[e.assetType,e.instrument]);let f=T=>!T||!T.length?[]:T.map(P=>s[P]||P),b=T=>!T||!T.length?[]:T.map(P=>c[P]||P),v=async T=>{try{let P=br().plugins.plugins.journalit,M=P?P.optionsService:new Hn(P);if(!e.assetType){console.error("Cannot add instrument: No asset type selected"),new nR.Notice("Asset type is required when adding an instrument");return}await M.addOption("instrument",T,e.assetType)&&M.notifyOptionsChanged()}catch(P){console.error("Failed to save custom instrument option:",P)}};(0,je.useEffect)(()=>{if(!e.instrument||!e.assetType)return;let T=br().plugins.plugins.journalit,P=T?T.optionsService:new Hn(T);if(!P.isInstrumentValidForAssetType(e.instrument,e.assetType)){r("instrument","");return}if(e.assetType==="futures"){let D=P.getFuturesDataForInstrument(e.instrument);D?(D.dollarPerPoint!==void 0&&D.dollarPerPoint!==0?r("dollarPerPoint",D.dollarPerPoint):r("dollarPerPoint",void 0),D.tickSize!==void 0&&r("tickSize",D.tickSize),D.tickValue!==void 0&&r("tickValue",D.tickValue)):(r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0))}},[e.instrument,e.assetType]),(0,je.useEffect)(()=>{if(e.assetType!=="futures"||!e.instrument||e.dollarPerPoint===void 0)return;let T=br().plugins.plugins.journalit,P=T?T.optionsService:new Hn(T),M=setTimeout(async()=>{try{await P.setFuturesDataForInstrument(e.instrument,{dollarPerPoint:e.dollarPerPoint,tickSize:e.tickSize,tickValue:e.tickValue})}catch(D){console.error("Failed to save futures data for instrument:",D)}},1e3);return()=>clearTimeout(M)},[e.instrument,e.dollarPerPoint,e.tickSize,e.tickValue]);let[y,g]=(0,je.useState)(0),[w,C]=(0,je.useState)(0);(0,je.useEffect)(()=>{let T=e.backendTradeId!==void 0&&e.backendTradeId!==null,P=e.originalPnl!==void 0||e.pnl!==void 0;if(T&&P){let M=e.originalPnl!==void 0?e.originalPnl:e.pnl;g(M||0)}else g(Pv(e));C(j$(e))},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.commission,e.swap,e.fees,e.directPnL,e.useDirectPnLInput,e.backendTradeId,e.originalPnl,e.pnl]);let k=e.assetType==="forex"||e.assetType==="cfd",x=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},S=()=>{switch(e.assetType){case"stock":return"Ticker";case"options":return"Option Symbol";case"futures":return"Future Symbol";case"forex":return"Forex Pair";case"crypto":return"Crypto Symbol";case"cfd":return"CFD Symbol";default:return"Ticker"}};return je.default.createElement(pd,{title:"Trade Details"},je.default.createElement("div",{className:"field"},m?je.default.createElement("div",{className:"loading-accounts",style:{padding:"8px 12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)",backgroundColor:"var(--background-primary)"}},je.default.createElement("div",{style:{marginBottom:"4px"}},"Account"),"Loading accounts..."):je.default.createElement(oi,{label:"Account",options:o,value:Array.isArray(e.account)?e.account:[],onChange:T=>{let P=Array.isArray(T)?[...T]:T?[T]:[],M=f(P);if(r("account",P),r("accountIds",P),P.length===1){let D=s[P[0]];D&&/^\d+$/.test(D)?r("accountId",D):r("accountId",void 0)}else r("accountId",void 0)},error:t.accountIds,allowCreate:!1,isMulti:!0,optionType:"account",required:!e.isMissedTrade,placeholder:"Select accounts"}),!m&&o.length===0&&je.default.createElement("div",{className:"error-message",style:{fontSize:"12px",color:"#e53935",marginTop:"4px"}},"No accounts found. Please create an account in the Accounts tab.")),je.default.createElement("div",{className:"field"},je.default.createElement("label",{className:"label",id:"assetType-label"},"Asset Type",je.default.createElement("span",{className:"required-indicator"},"*")),je.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"assetType-label","aria-required":"true"},["stock","options","futures","forex","crypto","cfd"].map(T=>je.default.createElement("button",{key:T,type:"button",className:"asset-type-button",onClick:()=>r("assetType",T),"aria-checked":e.assetType===T,role:"radio"},T==="cfd"?"CFD":T.charAt(0).toUpperCase()+T.slice(1)))),t.assetType&&je.default.createElement("div",{className:"errorMessage",role:"alert"},t.assetType)),je.default.createElement("div",{className:"field"},je.default.createElement(oi,{label:S(),options:u,value:e.instrument||"",onChange:T=>r("instrument",T),error:t.instrument,allowCreate:!0,isMulti:!1,optionType:"instrument",onSaveOption:v,required:!0})),e.assetType&&je.default.createElement("div",{className:"asset-specific-fields"},e.assetType==="stock"&&je.default.createElement(B$,{data:e,errors:t,onChange:r}),e.assetType==="options"&&je.default.createElement(W$,{data:e,errors:t,onChange:r}),e.assetType==="futures"&&je.default.createElement(q$,{data:e,errors:t,onChange:r}),e.assetType==="forex"&&je.default.createElement(V$,{data:e,errors:t,onChange:r}),e.assetType==="crypto"&&je.default.createElement(Y$,{data:e,errors:t,onChange:r}),e.assetType==="cfd"&&je.default.createElement(J$,{data:e,errors:t,onChange:r})),e.assetType!=="options"&&je.default.createElement("div",{className:"field"},je.default.createElement("label",{className:"label",id:"direction-label"},"Direction",je.default.createElement("span",{className:"required-indicator"},"*")),je.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"direction-label","aria-required":"true"},je.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","long"),"aria-checked":e.direction==="long",role:"radio"},"Long"),je.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","short"),"aria-checked":e.direction==="short",role:"radio"},"Short")),t.direction&&je.default.createElement("div",{className:"errorMessage",role:"alert"},t.direction)),je.default.createElement("div",{className:"field"},je.default.createElement(tR,{data:e,errors:t,onChange:r})),je.default.createElement("div",{className:"trading-costs-section"},je.default.createElement("h4",{className:"section-title"},"Trading Costs"),je.default.createElement("div",{className:`cost-fields ${k?"three-column":"two-column"}`},je.default.createElement("div",{className:"field"},je.default.createElement(Mt,{label:"Commission",value:e.commission,onChange:T=>r("commission",T),error:t.commission,precision:2,allowDecimal:!0,placeholder:"Broker commission"})),k&&je.default.createElement("div",{className:"field"},je.default.createElement(Mt,{label:"Swap",value:e.swap,onChange:T=>r("swap",T),error:t.swap,precision:2,allowDecimal:!0,placeholder:"Overnight financing"})),je.default.createElement("div",{className:"field"},je.default.createElement(Mt,{label:"Other Fees",value:e.fees,onChange:T=>r("fees",T),error:t.fees,precision:2,allowDecimal:!0,placeholder:"Platform/regulatory fees"})))),e.entryPrice!==void 0&&e.exitPrice!==void 0&&e.positionSize!==void 0&&e.direction!==void 0&&je.default.createElement("div",{className:"calculatedValue"},je.default.createElement("span",{className:"calculatedLabel"},"Profit/Loss",e.commission||e.swap||e.fees?" (incl. costs)":""),je.default.createElement("span",{className:`calculatedAmount ${y>0?"positive":y<0?"negative":"neutral"}`},ue(y,!0,a)),!e.useDirectPnLInput&&je.default.createElement("span",{className:"calculatedLabel"},"(",w.toFixed(2),"%)"),e.commission||e.swap||e.fees?je.default.createElement("span",{className:"calculatedLabel"},"Total Costs: ",ue((e.commission||0)+(e.swap||0)+(e.fees||0),!0,a)):null))}});var Rw,wE,oR=te(()=>{Rw=_(B());F$();xE();wE=({data:e,errors:t,onChange:r,instruments:n})=>Rw.default.createElement("div",{className:"trade-form-basic-tab"},Rw.default.createElement(O$,{data:e,onChange:r}),Rw.default.createElement(aR,{data:e,errors:t,onChange:r,instruments:n}))});var tn,iR,SE=te(()=>{tn=_(B());Wi();Lm();Cu();Iu();iR=({data:e,errors:t,onChange:r,accounts:n=[],setups:a=[],mistakes:o=[]})=>{let[i,s]=(0,tn.useState)(0),l=(0,tn.useMemo)(()=>{let b=br().plugins.plugins.journalit;return b&&b.optionsService?b.optionsService:new Hn(b)},[]),c=(0,tn.useMemo)(()=>{try{return l.getOptions("tag")}catch(b){return console.error("Failed to load custom tag options:",b),[]}},[l,i]),d=(0,tn.useMemo)(()=>{try{return l.getOptions("setup")}catch(b){return console.error("Failed to load setup options:",b),[]}},[l,i]),u=(0,tn.useMemo)(()=>{try{return l.getOptions("mistake")}catch(b){return console.error("Failed to load mistake options:",b),[]}},[l,i]),p=(0,tn.useCallback)(()=>{s(b=>b+1)},[]);(0,tn.useEffect)(()=>(document.addEventListener("journalit-options-changed",p),()=>{document.removeEventListener("journalit-options-changed",p)}),[p]);let m=async b=>{try{let v=br().plugins.plugins.journalit,y=v?v.optionsService:new Hn(v);await y.addOption("tag",b)&&y.notifyOptionsChanged()}catch(v){console.error("Failed to save custom tag option:",v)}},h=async b=>{try{let v=br().plugins.plugins.journalit,y=v?v.optionsService:new Hn(v);await y.addOption("setup",b)&&y.notifyOptionsChanged()}catch(v){console.error("Failed to save custom setup option:",v)}},f=async b=>{try{let v=br().plugins.plugins.journalit,y=v?v.optionsService:new Hn(v);await y.addOption("mistake",b)&&y.notifyOptionsChanged()}catch(v){console.error("Failed to save custom mistake option:",v)}};return tn.default.createElement(pd,{title:"Analysis & Thesis"},tn.default.createElement("div",{className:"field"},tn.default.createElement(oi,{label:"Setup",options:d,value:Array.isArray(e.setup)?e.setup:[],onChange:b=>{let v=Array.isArray(b)?b:[];r("setup",v)},allowCreate:!0,isMulti:!0,optionType:"setup",onSaveOption:h})),tn.default.createElement("div",{className:"field"},tn.default.createElement(oi,{label:"Mistake",options:u,value:Array.isArray(e.mistake)?e.mistake:[],onChange:b=>{let v=Array.isArray(b)?b:[];r("mistake",v)},allowCreate:!0,isMulti:!0,optionType:"mistake",onSaveOption:f})),tn.default.createElement("div",{className:"field"},tn.default.createElement(oi,{label:"Custom Tags",options:c,value:Array.isArray(e.ctags)?e.ctags:[],onChange:b=>{let v=Array.isArray(b)?b:[];r("ctags",v)},isMulti:!0,allowCreate:!0,placeholder:"Type a custom tag and press Enter",onSaveOption:m,optionType:"tag"})),tn.default.createElement("div",{className:"field"},tn.default.createElement(Xt,{label:"Trade Thesis",placeholder:"Enter your thesis for this trade...",value:e.thesis||"",onChange:b=>r("thesis",b),className:"thesisField",multiline:!0})))}});var ml,kE,$r,tc=te(()=>{ml=require("obsidian");Cu();kE=class{constructor(t){this.app=t||br()}async saveImage(t,r,n,a){try{let o=t!=null&&t.name?t.name.replace(/[^a-zA-Z0-9.-]/g,"_"):"unnamed_file",i=o.substring(o.lastIndexOf(".")||o.length),s=Date.now(),l;if(a){let{year:d,month:u,weekOfMonth:p}=a,m=`${r}/${d}/${u}/${p}`,h=`${n}-${s}${i}`;l=`${m}/${h}`,await this.app.vault.adapter.mkdir((0,ml.normalizePath)(m))}else{let d=`${n}-${s}${i}`;l=`${r}/${d}`,await this.app.vault.adapter.mkdir((0,ml.normalizePath)(r))}let c=await t.arrayBuffer();return await this.app.vault.createBinary((0,ml.normalizePath)(l),c),l}catch(o){throw console.error("Error saving image:",o),o}}async deleteImage(t,r=!0){try{if(!t){console.warn("No image path provided for deletion");return}let n=this.app.vault.getAbstractFileByPath(t);if(!n){console.warn(`Image file not found: ${t}`);return}if(await this.app.vault.delete(n),r){let a=t.substring(0,t.lastIndexOf("/"));await this.deleteEmptyFolder(a)}}catch(n){if(n&&typeof n=="object"&&"code"in n&&n.code==="ENOENT"){console.log(`Image file already deleted or doesn't exist: ${t}`);return}throw console.error(`Error deleting image ${t}:`,n),n}}async deleteEmptyFolder(t,r="!"){try{if(t.startsWith(r)&&t.split("/").length<=1||!await this.app.vault.adapter.exists(t))return;let a=await this.app.vault.adapter.list(t);if(a.files.length===0&&a.folders.length===0){let o=this.app.vault.getAbstractFileByPath(t);if(o){await this.app.vault.delete(o);let i=t.substring(0,t.lastIndexOf("/"));i&&i.length>0&&!i.startsWith(r)&&await this.deleteEmptyFolder(i,r)}}}catch(n){console.error(`Error deleting empty folder ${t}:`,n)}}resolveMediaPath(t){if(!t)return"";try{let r=this.getResourceUrl(t);if(r&&r!==t&&!r.includes("app://obsidian.md"))return r;let n="",a="",o=t.split("/"),i=o.findIndex(s=>s==="media"||s==="attachments");if(i>=0&&i<o.length-1&&(o[i]==="attachments"&&o.length>i+5?(n=o.slice(i+1,o.length-1).join("/"),a=o[o.length-1]):i<o.length-2&&(n=o[i+1],a=o[o.length-1])),n&&a){let s=[t.startsWith("!")?t.substring(1):t,t,`attachments/${n}/${a}`,`${this.app.vault.getName()}/attachments/${n}/${a}`,`${this.app.vault.getName()}/${o.slice(1).join("/")}`,`Journalit/${o.slice(o.indexOf("Journalit")+1).join("/")}`,`${this.app.vault.getName()}/media/${n}/${a}`,`media/${n}/${a}`];for(let l of s){let c=this.app.vault.getAbstractFileByPath(l);if(c&&c instanceof ml.TFile)return this.app.vault.getResourcePath(c)}}return r}catch(r){return console.error("Error resolving media path:",r,t),this.getResourceUrl(t)}}getResourceUrl(t){if(!t)return"";try{if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;let r=this.app,n=r.vault.getAbstractFileByPath(t);if(n&&n instanceof ml.TFile)return r.vault.getResourcePath(n);if(t.startsWith("!")){let i=t.substring(1);if(n=r.vault.getAbstractFileByPath(i),n&&n instanceof ml.TFile)return r.vault.getResourcePath(n)}let a=/\/media\/([^/]+)\//,o=t.match(a);if(o){let i=o[1],s=/(20\d{2})\/(\d{2})\/(W\d+)\//,l=t.match(s);if(l){let c=l[1],d=l[2],u=l[3],p=[`${c}/${d}/${u}/media/${i}${t.substring(t.lastIndexOf("/"))}`];for(let m of p)if(n=r.vault.getAbstractFileByPath(m),n&&n instanceof ml.TFile)return r.vault.getResourcePath(n)}}try{let i=r.vault.getName();if(i){let s=[t.startsWith("!")?`${i}/${t.substring(1)}`:`${i}/${t}`,`${i}/${t}`];for(let l of s)if(n=r.vault.getAbstractFileByPath(l),n&&n instanceof ml.TFile)return r.vault.getResourcePath(n)}}catch(i){}return t.startsWith("!")?`app://obsidian.md/${t.substring(1)}`:`app://obsidian.md/${t}`}catch(r){return console.error("Error getting resource URL:",r),t||""}}getImagesFromDataTransfer(t){try{return!t.files||t.files.length===0?[]:Array.from(t.files).filter(a=>a.type.startsWith("image/")||a.name.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i))}catch(r){return console.error("Error extracting images from drop event:",r),[]}}},$r=new kE});var Av,Kn,CE=te(()=>{Av=require("obsidian"),Kn=class{static isClipboardSupported(){return typeof navigator!="undefined"&&!!navigator.clipboard&&!!navigator.clipboard.read}static async extractClipboardImages(){if(!this.isClipboardSupported())return{success:!1,files:[],error:"Clipboard API not supported in this environment"};try{let t=await navigator.clipboard.read();if(!t||t.length===0)return{success:!1,files:[],error:"No items in clipboard"};let r=[];for(let n of t)for(let a of this.SUPPORTED_FORMATS)if(n.types.includes(a))try{let o=await n.getType(a);if(o.size>this.MAX_FILE_SIZE){new Av.Notice(`Image too large (${(o.size/1024/1024).toFixed(1)}MB). Maximum size is 10MB.`);continue}let i=new File([o],this.generateFileName(a),{type:a,lastModified:Date.now()});r.push(i)}catch(o){console.error(`Failed to extract ${a} from clipboard:`,o)}return r.length===0?{success:!1,files:[],error:"No images found in clipboard"}:{success:!0,files:r}}catch(t){return console.error("Failed to read clipboard:",t),t.name==="NotAllowedError"||t.message.includes("permission")?{success:!1,files:[],error:"Permission denied. Please allow clipboard access.",permissionDenied:!0}:{success:!1,files:[],error:`Failed to access clipboard: ${t.message}`}}}static generateContextualFileName(t,r,n=0){var s,l,c,d,u;let a=Date.now(),o=this.getExtensionFromFormat(r);switch(t.contextType){case"trade":if((s=t.contextData)!=null&&s.ticker&&((l=t.contextData)!=null&&l.tradeNumber)){let m=n>0?`-${n}`:"";return`${t.contextData.ticker}-clipboard-T${t.contextData.tradeNumber}${m}-${a}${o}`}break;case"drc":if((c=t.contextData)!=null&&c.sectionName){let m=n>0?`-${n}`:"";return`drc-${t.contextData.sectionName}-clipboard${m}-${a}${o}`}break;case"weekly":if((d=t.contextData)!=null&&d.weekNumber){let m=n>0?`-${n}`:"";return`weekly-W${t.contextData.weekNumber}-clipboard${m}-${a}${o}`}break;case"account":if((u=t.contextData)!=null&&u.accountId){let m=n>0?`-${n}`:"";return`account-${t.contextData.accountId}-clipboard${m}-${a}${o}`}break;case"generic":default:return`clipboard-image${n>0?`-${n}`:""}-${a}${o}`}return`clipboard-image${n>0?`-${n}`:""}-${a}${o}`}static generateFileName(t){let r=Date.now(),n=this.getExtensionFromFormat(t);return`clipboard-image-${r}${n}`}static getExtensionFromFormat(t){switch(t){case"image/png":return".png";case"image/jpeg":return".jpg";case"image/gif":return".gif";case"image/bmp":return".bmp";case"image/webp":return".webp";default:return".png"}}static findImageUploadContext(t){if(!t)return null;let r=t.closest(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata");if(!r)return null;if(r.classList.contains("trade-form-metadata"))return{contextType:"trade",multiple:!0};if(r.classList.contains("shared-forecast-image")){let n=r.closest("[data-section-name]");if(n)return{contextType:"drc",contextData:{sectionName:n.getAttribute("data-section-name")||void 0},multiple:!1}}return{contextType:"generic",multiple:!0}}static showPasteResult(t,r=0){if(t.success&&r>0){let n=r===1?"Image pasted successfully":`${r} images pasted successfully`;new Av.Notice(n)}else!t.success&&t.error&&(t.permissionDenied?new Av.Notice("Clipboard access denied. Please allow clipboard permissions for paste functionality."):new Av.Notice(`Paste failed: ${t.error}`))}static createContextualFiles(t,r){return t.map((n,a)=>{let o=this.generateContextualFileName(r,n.type,a);return new File([n],o,{type:n.type,lastModified:n.lastModified})})}};Kn.MAX_FILE_SIZE=10*1024*1024,Kn.SUPPORTED_FORMATS=["image/png","image/jpeg","image/gif","image/bmp","image/webp"]});var TE,Ww,rc,PE=te(()=>{TE=require("obsidian");CE();Ww=class Ww{constructor(){this.handlers=[];this.enabled=!1;this.globalPasteListener=null;this.lastMousePosition={x:0,y:0};this.mouseMoveListener=null}static getInstance(){return this.instance||(this.instance=new Ww),this.instance}initialize(){this.enabled||(this.enabled=!0,this.globalPasteListener=t=>{this.handleGlobalPaste(t)},this.mouseMoveListener=t=>{this.lastMousePosition={x:t.clientX,y:t.clientY}},document.addEventListener("paste",this.globalPasteListener,!0),document.addEventListener("mousemove",this.mouseMoveListener,!0))}cleanup(){this.enabled&&(this.enabled=!1,this.globalPasteListener&&(document.removeEventListener("paste",this.globalPasteListener,!0),this.globalPasteListener=null),this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener,!0),this.mouseMoveListener=null),this.handlers=[])}registerHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t.id),this.handlers.push(t)}unregisterHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t)}async handleGlobalPaste(t){if(!Kn.isClipboardSupported())return;let r=document.activeElement;if(this.isTextInput(r)&&!this.isImageUploadArea(r))return;let n=this.findHandlerForContext(r);if(!n){try{let a=await Kn.extractClipboardImages();a.success&&a.files.length>0&&(this.handlers.some(i=>{let s=i.element.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(i.element).visibility!=="hidden"&&window.getComputedStyle(i.element).display!=="none"})||new TE.Notice("No image upload area found. Focus on an image upload area to paste images."))}catch(a){}return}t.preventDefault(),t.stopPropagation();try{let a=await Kn.extractClipboardImages();if(!a.success){a.error&&!a.error.includes("No images found")&&Kn.showPasteResult(a);return}let o=Kn.createContextualFiles(a.files,n.context),i=n.acceptsMultiple?o:[o[0]];await n.handlePaste(i),Kn.showPasteResult(a,i.length),this.dispatchPasteEvent({files:i,context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!0})}catch(a){console.error("Global paste handler error:",a),this.dispatchPasteEvent({files:[],context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!1,error:a.message}),new TE.Notice(`Paste failed: ${a.message}`)}}findHandlerForContext(t){if(t){for(let i of this.handlers)if(i.element.contains(t)||i.element===t)return i;let o=this.findNearbyImageUploadArea(t);if(o)return this.handlers.find(i=>i.element===o||i.element.contains(o))||null}let r=this.findHandlerUnderMouse();if(r)return r;let n=this.handlers.filter(o=>{let i=o.element,s=i.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(i).visibility!=="hidden"&&window.getComputedStyle(i).display!=="none"});if(n.length===1)return n[0];let a=this.findHoveredHandler();return a||null}isTextInput(t){var a;if(!t)return!1;let r=t.tagName.toLowerCase(),n=(a=t.type)==null?void 0:a.toLowerCase();return r==="input"&&["text","email","password","search","url"].includes(n)||r==="textarea"||t.hasAttribute("contenteditable")||t.classList.contains("cm-editor")}isImageUploadArea(t){return t?!!(t.closest(".journalit-image-upload")||t.closest(".shared-forecast-image")||t.closest(".trade-form-metadata")||t.closest("[data-image-upload]")):!1}findHandlerUnderMouse(){let t=document.elementsFromPoint(this.lastMousePosition.x,this.lastMousePosition.y);for(let r of t)for(let n of this.handlers)if(n.element===r||n.element.contains(r))return n;return null}findHoveredHandler(){for(let t of this.handlers){let n=t.element.getBoundingClientRect();if(n.width>0&&n.height>0&&this.lastMousePosition.x>=n.left&&this.lastMousePosition.x<=n.right&&this.lastMousePosition.y>=n.top&&this.lastMousePosition.y<=n.bottom)return t}return null}findNearbyImageUploadArea(t){if(!t)return null;let r=t.closest(".trade-form, .drc-note, .weekly-review, .account-note, .modal-content, .workspace-leaf-content");return r?r.querySelector(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata"):null}dispatchPasteEvent(t){let r=new CustomEvent("journalit:paste",{detail:t,bubbles:!0,cancelable:!1});document.dispatchEvent(r)}static createImageUploaderHandler(t,r,n,a=!0){return{id:`image-uploader-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,element:t,context:r,handlePaste:n,acceptsMultiple:a}}static isPasteSupported(){return Kn.isClipboardSupported()}getDebugInfo(){return{enabled:this.enabled,handlerCount:this.handlers.length,handlers:this.handlers.map(t=>({id:t.id,contextType:t.context.contextType,acceptsMultiple:t.acceptsMultiple}))}}};Ww.instance=null;rc=Ww});var bt,fd,DE=te(()=>{bt=_(B());ll();tc();CE();PE();fd=({onImageUploaded:e,onMultipleImagesUploaded:t,onError:r,label:n="Upload Image",enableDragDrop:a=!0,draggingOverClass:o="dragging-over",inputId:i,saveImageFunction:s,multiple:l=!0,enablePaste:c=!1,pasteContext:d,className:u="",style:p})=>{let m=(0,bt.useRef)(`image-upload-${Math.random().toString(36).substring(2,11)}`),h=i||m.current,[f,b]=(0,bt.useState)(!1),v=(0,bt.useRef)(0),y=(0,bt.useRef)(null),[g,w]=(0,bt.useState)(!1),[C,k]=(0,bt.useState)(!1),x=(0,bt.useRef)(new Set),S=(0,bt.useRef)(s),T=(0,bt.useRef)(e),P=(0,bt.useRef)(t),M=(0,bt.useRef)(r),D=(0,bt.useRef)(void 0);(0,bt.useEffect)(()=>{S.current=s,T.current=e,P.current=t,M.current=r},[s,e,t,r]),(0,bt.useEffect)(()=>()=>{x.current.forEach(z=>{URL.revokeObjectURL(z)}),x.current.clear()},[]);let A=(0,bt.useCallback)(async()=>{if(!(!c||g)){w(!0);try{let z=await Kn.extractClipboardImages();if(!z.success){z.error&&!z.error.includes("No images found")&&Kn.showPasteResult(z);return}let W=d||{contextType:"generic",multiple:l},U=Kn.createContextualFiles(z.files,W),K=[],R=l?U:[U[0]];for(let q of R)try{let X;S.current?(X=await S.current(q),K.push(X)):(console.warn("No saveImageFunction provided, using placeholder implementation"),X=L(q),K.push(X))}catch(X){console.error(`Failed to process pasted image ${q.name}:`,X),M.current&&X instanceof Error&&M.current(X)}l&&K.length>1&&P.current?P.current(K):K.length>0&&T.current&&T.current(K[0]),Kn.showPasteResult(z,K.length)}catch(z){console.error("Failed to handle paste:",z),M.current&&z instanceof Error&&M.current(z)}finally{w(!1)}}},[c,g,d,l]);(0,bt.useEffect)(()=>{D.current=A},[A]),(0,bt.useEffect)(()=>{if(!c||!y.current||!Kn.isClipboardSupported())return;if(k(!0),(d==null?void 0:d.contextType)==="trade"){let W=d||{contextType:"generic",multiple:l},U=rc.createImageUploaderHandler(y.current,W,async K=>{let R=[];for(let q of K)try{let X;S.current?(X=await S.current(q),R.push(X)):(console.warn("No saveImageFunction provided, using placeholder implementation"),X=L(q),R.push(X))}catch(X){console.error(`Failed to process pasted image ${q.name}:`,X),M.current&&X instanceof Error&&M.current(X)}l&&R.length>1&&P.current?P.current(R):R.length>0&&T.current&&T.current(R[0])},l);return rc.getInstance().registerHandler(U),()=>{rc.getInstance().unregisterHandler(U.id)}}else{let W=K=>{var R;K.preventDefault(),K.stopPropagation(),(R=D.current)==null||R.call(D)},U=y.current;return U.addEventListener("paste",W),()=>{U.removeEventListener("paste",W)}}},[c,d,l]);let L=z=>{let W=URL.createObjectURL(z);return x.current.add(W),W},N=async z=>{try{let W=z.target.files;if(!W||W.length===0)return;let U=[],K=l?W:[W[0]];for(let R=0;R<K.length;R++){let q=K[R],X;if(s)try{X=await s(q),U.push(X)}catch(G){console.error(`Failed to process image ${q.name}:`,G),r&&G instanceof Error&&r(G)}else console.warn("No saveImageFunction provided, using placeholder implementation"),X=L(q),U.push(X)}l&&U.length>1&&t?t(U):U.length>0&&e(U[0]),z.target.value=""}catch(W){console.error("Failed to process images:",W),r&&W instanceof Error&&r(W)}},E=z=>{a&&(z.preventDefault(),z.stopPropagation(),v.current++,z.dataTransfer.types.includes("Files")&&b(!0))},I=z=>{a&&(z.preventDefault(),z.stopPropagation(),v.current--,v.current<=0&&(v.current=0,b(!1)))},O=z=>{a&&(z.preventDefault(),z.stopPropagation())},j=async z=>{if(a&&(z.preventDefault(),z.stopPropagation(),v.current=0,b(!1),z.dataTransfer.files&&z.dataTransfer.files.length>0)){let W=$r.getImagesFromDataTransfer(z.dataTransfer);if(W.length>0){let U=[],K=l?W:[W[0]];for(let R of K)try{let q;s?(q=await s(R),U.push(q)):(console.warn("No saveImageFunction provided, using placeholder implementation"),q=L(R),U.push(q))}catch(q){console.error(`Failed to process dropped image ${R.name}:`,q),r&&q instanceof Error&&r(q)}l&&U.length>1&&t?t(U):U.length>0&&e(U[0])}}},$=()=>{let z=document.getElementById(h);z&&z.click()},F=["journalit-image-upload",u,f?o:""].filter(Boolean).join(" ");return bt.default.createElement("div",{ref:y,className:`journalit-image-upload-wrapper ${u}`,style:p,tabIndex:c?0:-1},bt.default.createElement("div",{className:"journalit-image-upload-layout"},bt.default.createElement("div",{className:`journalit-image-upload-file-area ${f?o:""} ${!c||!C?"full-width":""}`,onClick:$,onDragEnter:E,onDragLeave:I,onDragOver:O,onDrop:j},bt.default.createElement("label",{className:"journalit-image-upload-label"},n)),c&&C&&bt.default.createElement("button",{type:"button",className:`journalit-image-upload-paste-area ${g?"pasting":""}`,onClick:z=>{z.preventDefault(),z.stopPropagation(),A()},disabled:g,title:"Paste image from clipboard (Ctrl+V)"},g?bt.default.createElement(bt.default.Fragment,null,bt.default.createElement("span",{className:"journalit-spinner"}),bt.default.createElement("span",{className:"paste-text"},"Pasting...")):bt.default.createElement(bt.default.Fragment,null,bt.default.createElement(Jh,{className:"paste-icon",size:18}),bt.default.createElement("span",{className:"paste-text"},"Paste")))),bt.default.createElement("input",{id:h,type:"file",accept:"image/*",multiple:l,onChange:N,className:"journalit-image-upload-input"}))}});var To,sR,nc,Mm=te(()=>{To=_(B()),sR=_(Yl()),nc=({isOpen:e,children:t,portalId:r="journalit-fullscreen-portal",onClose:n,title:a="Image Preview",className:o=""})=>{let[i,s]=(0,To.useState)(null),l=(0,To.useRef)(null),c=(0,To.useRef)(e);if(c.current=e,(0,To.useEffect)(()=>{if(!e)return;let u=document.getElementById(r);u||(u=document.createElement("div"),u.id=r,u.style.position="fixed",u.style.top="0",u.style.left="0",u.style.width="0",u.style.height="0",u.style.zIndex="4000",u.style.pointerEvents="none",document.body.appendChild(u)),s(u),l.current=u;let p=m=>{m.key==="Escape"&&(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),n())};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),!c.current&&u&&u.parentNode&&setTimeout(()=>{let m=document.getElementById(r);if(m&&m.parentNode&&m.childNodes.length===0)try{m.parentNode.removeChild(m)}catch(h){console.error(`[FullscreenPortal] Error removing portal element ${r}:`,h)}},0)}},[e,r,n]),!e||!i)return null;let d=["journalit-fullscreen-overlay",o].filter(Boolean).join(" ");return sR.default.createPortal(To.default.createElement("div",{className:d,onClick:n,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto"}},To.default.createElement("div",{className:"journalit-fullscreen-overlay-ui"},To.default.createElement("div",{className:"journalit-fullscreen-title",onClick:u=>u.stopPropagation()},a),To.default.createElement("button",{className:"journalit-fullscreen-close-btn",onClick:u=>{u.stopPropagation(),n()},"aria-label":"Close fullscreen"},"\xD7")),To.default.createElement("div",{className:"journalit-fullscreen-content-wrapper",style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",pointerEvents:"none"}},To.default.createElement("div",{onClick:u=>u.stopPropagation(),style:{pointerEvents:"auto"}},t))),i)}});var ur,gd,Iv=te(()=>{ur=_(B());tc();gd=({imagePath:e,alt:t="Image",useResolveMediaPath:r=!1,navigationContext:n,onClose:a})=>{let[o,i]=(0,ur.useState)({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}}),s=(0,ur.useRef)(null),l=(0,ur.useRef)(null),c=r?$r.resolveMediaPath(e):$r.getResourceUrl(e);(0,ur.useEffect)(()=>{i({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}})},[e]);let d=(0,ur.useCallback)(g=>{g.preventDefault(),g.stopPropagation(),!o.isPanning&&i(w=>({...w,isZoomed:!w.isZoomed,panOffset:{x:0,y:0},isPanning:!1}))},[o.isPanning]),u=(0,ur.useCallback)(g=>{o.isZoomed&&(g.preventDefault(),g.stopPropagation(),i(w=>({...w,isPanning:!0,lastMousePos:{x:g.clientX,y:g.clientY}})))},[o.isZoomed]),p=(0,ur.useCallback)(()=>{i(g=>({...g,isPanning:!1}))},[]),m=(0,ur.useCallback)(g=>{if(!n)return;let{images:w,currentIndex:C,onNavigate:k}=n,x=C;g==="prev"?x=C===0?w.length-1:C-1:x=C===w.length-1?0:C+1,k(x)},[n]);(0,ur.useEffect)(()=>{let g=w=>{w.key==="ArrowLeft"?(w.preventDefault(),w.stopPropagation(),m("prev")):w.key==="ArrowRight"&&(w.preventDefault(),w.stopPropagation(),m("next"))};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[m]);let h=(0,ur.useCallback)(g=>{i(w=>{if(!w.isPanning||!w.isZoomed)return w;let C=g.clientX-w.lastMousePos.x,k=g.clientY-w.lastMousePos.y,x=.8,S=C*x,T=k*x;return{...w,panOffset:{x:w.panOffset.x+S,y:w.panOffset.y+T},lastMousePos:{x:g.clientX,y:g.clientY}}})},[]),f=(0,ur.useCallback)(()=>{i(g=>({...g,isPanning:!1}))},[]);(0,ur.useEffect)(()=>{if(o.isPanning)return document.addEventListener("mousemove",h),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)}},[o.isPanning,h,f]);let b=o.isZoomed?2:1,v=`scale(${b}) translate(${o.panOffset.x/b}px, ${o.panOffset.y/b}px)`,y="zoom-in";return o.isZoomed&&(y=o.isPanning?"grabbing":"grab"),ur.default.createElement("div",{className:"journalit-fullscreen-viewer",ref:l},n&&n.images.length>1&&ur.default.createElement(ur.default.Fragment,null,ur.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-prev",onClick:()=>m("prev"),"aria-label":"Previous image",type:"button"},"\u2039"),ur.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-next",onClick:()=>m("next"),"aria-label":"Next image",type:"button"},"\u203A")),ur.default.createElement("div",{className:"journalit-fullscreen-image-wrapper"},ur.default.createElement("img",{ref:s,src:c,alt:t,className:"journalit-fullscreen-zoomable-image",onClick:d,onMouseDown:u,onMouseUp:p,onMouseLeave:p,style:{transform:v,cursor:y,transition:o.isPanning?"none":"transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",willChange:o.isPanning?"transform":"auto"}})),ur.default.createElement("div",{className:"journalit-fullscreen-zoom-indicator"},o.isZoomed?"Click to zoom out":"Click to zoom in"),n&&n.images.length>1&&ur.default.createElement("div",{className:"journalit-fullscreen-nav-indicator"},n.currentIndex+1," / ",n.images.length))}});var In,Nv,Uw=te(()=>{In=_(B());tc();Mm();Iv();Nv=({imagePath:e,alt:t="Image",enableFullscreen:r=!0,description:n="Image Preview",showDeleteButton:a=!1,onDelete:o,onError:i,width:s,height:l,fullscreenPortalId:c="journalit-fullscreen-portal",fullscreenClassName:d="",className:u="",style:p,useResolveMediaPath:m=!1})=>{let[h,f]=(0,In.useState)({isFullscreen:!1,holdTimerId:null,hasError:!1}),b=(0,In.useRef)(null),v=500;(0,In.useEffect)(()=>()=>{b.current!==null&&window.clearTimeout(b.current)},[]);let y=m?$r.resolveMediaPath(e):$r.getResourceUrl(e),g=()=>{f(P=>({...P,hasError:!0})),i&&i()},w=()=>{r&&f(P=>({...P,isFullscreen:!0}))},C=()=>{f(P=>({...P,isFullscreen:!1}))},k=()=>{r&&(b.current!==null&&(window.clearTimeout(b.current),b.current=null),b.current=window.setTimeout(()=>{w()},v))},x=()=>{b.current!==null&&(window.clearTimeout(b.current),b.current=null)},S=P=>{P.preventDefault(),P.stopPropagation(),o&&o(P)},T=["journalit-image-viewer",u].filter(Boolean).join(" ");return In.default.createElement(In.default.Fragment,null,In.default.createElement("div",{className:T,style:p},In.default.createElement("div",{className:"journalit-image-container"},h.hasError?In.default.createElement("div",{className:"journalit-image-error"},"Unable to load image. The file might be missing or inaccessible."):In.default.createElement(In.default.Fragment,null,In.default.createElement("img",{src:y,alt:t,className:"journalit-image",onError:g,onMouseDown:k,onMouseUp:x,onMouseLeave:x,onTouchStart:k,onTouchEnd:x,onTouchCancel:x,onClick:()=>{x(),w()},style:{cursor:r?"zoom-in":"default",width:s,height:l},title:r?"Click to view fullscreen":t}),r&&In.default.createElement("div",{className:"journalit-image-zoom-indicator"},"Click or hold to enlarge")),a&&In.default.createElement("button",{className:"journalit-image-delete-button",onClick:S,type:"button"},"Delete Image"))),In.default.createElement(nc,{isOpen:h.isFullscreen,onClose:C,title:n,portalId:c,className:d},In.default.createElement(gd,{imagePath:e,alt:t,useResolveMediaPath:m,onClose:C})))}});var Qa,lR,cR=te(()=>{Qa=_(B());tc();lR=({src:e,alt:t,className:r="",placeholderClassName:n="",style:a,useResolveMediaPath:o=!1,loadingPlaceholder:i,errorPlaceholder:s,rootMargin:l="50px",threshold:c=.1})=>{let[d,u]=(0,Qa.useState)(!1),[p,m]=(0,Qa.useState)(!1),[h,f]=(0,Qa.useState)(!1),b=(0,Qa.useRef)(null);(0,Qa.useEffect)(()=>{let w=b.current;if(!w)return;let C=new IntersectionObserver(k=>{let[x]=k;x.isIntersecting&&(u(!0),C.disconnect())},{rootMargin:l,threshold:c});return C.observe(w),()=>C.disconnect()},[l,c]);let v=d?o?$r.resolveMediaPath(e):$r.getResourceUrl(e):"",y=()=>{m(!0),f(!1)},g=()=>{f(!0),m(!1)};return Qa.default.createElement("div",{ref:b,className:`lazy-image-container ${r}`,style:{position:"relative",overflow:"hidden",...a}},(!d||!p)&&!h&&Qa.default.createElement("div",{className:`lazy-image-placeholder ${n}`},i||Qa.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-border)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:"12px"}},"Loading...")),h&&Qa.default.createElement("div",{className:`lazy-image-error ${n}`},s||Qa.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-error)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-error)",fontSize:"12px"}},"Failed to load image")),d&&!h&&Qa.default.createElement("img",{src:v,alt:t,onLoad:y,onError:g,style:{position:"absolute",top:0,left:0,opacity:p?1:0,transition:"opacity 0.3s ease",width:"100%",height:"100%",objectFit:"cover"},className:"lazy-image-loaded"}))}});var pr,ac,dR,EE=te(()=>{pr=_(B());Uw();cR();Mm();Iv();ac=({images:e,altPrefix:t="Image",showThumbnails:r=!0,showCounter:n=!0,enableDelete:a=!1,onDeleteImage:o,enableFullscreen:i=!0,className:s="",style:l,useResolveMediaPath:c=!1})=>{let[d,u]=(0,pr.useState)(0),[p,m]=(0,pr.useState)(!1),[h,f]=(0,pr.useState)(!1);(0,pr.useEffect)(()=>{e&&e.length>0&&d>=e.length&&u(Math.max(0,e.length-1))},[e,d]);let b=D=>{D.preventDefault(),D.stopPropagation(),!(e.length<=1)&&u(A=>A===e.length-1?0:A+1)},v=D=>{D.preventDefault(),D.stopPropagation(),!(e.length<=1)&&u(A=>A===0?e.length-1:A-1)},y=(D,A)=>{A.preventDefault(),A.stopPropagation(),D>=0&&D<e.length&&u(D)},g=(D,A)=>{A&&(A.preventDefault(),A.stopPropagation()),o&&e[D]&&o(D,e[D])},w=()=>{m(!0)},C=()=>{i&&f(!0)},k=()=>{f(!1)},S={images:e,currentIndex:d,onNavigate:D=>{D>=0&&D<e.length&&u(D)},altPrefix:t,useResolveMediaPath:c},T=["journalit-image-carousel",s].filter(Boolean).join(" ");if(!e||e.length===0)return pr.default.createElement("div",{className:T,style:l},pr.default.createElement("div",{className:"journalit-carousel-main"},pr.default.createElement("div",{className:"journalit-carousel-image-container"},pr.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"}},"No images to display"))));let P=e[d],M=`${t} ${d+1}`;return pr.default.createElement("div",{className:T,style:l},pr.default.createElement("div",{className:"journalit-carousel-main"},e.length>1&&pr.default.createElement("button",{className:"journalit-carousel-button",onClick:v,"aria-label":"Previous image",type:"button"},"<"),pr.default.createElement("div",{className:"journalit-carousel-image-container"},pr.default.createElement(Nv,{imagePath:P,alt:M,enableFullscreen:!1,description:`${t} ${d+1} of ${e.length}`,showDeleteButton:a,onDelete:D=>g(d,D),onError:w,useResolveMediaPath:c}),i&&pr.default.createElement("div",{className:"journalit-carousel-fullscreen-trigger",onClick:C,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",cursor:"zoom-in",zIndex:5},title:"Click to view fullscreen"})),e.length>1&&pr.default.createElement("button",{className:"journalit-carousel-button",onClick:b,"aria-label":"Next image",type:"button"},">")),n&&e.length>1&&pr.default.createElement("div",{className:"journalit-carousel-counter"},d+1," / ",e.length),r&&e.length>1&&pr.default.createElement("div",{className:"journalit-carousel-thumbnails"},e.map((D,A)=>pr.default.createElement(dR,{key:`thumb-${A}`,imagePath:D,index:A,isActive:A===d,altPrefix:t,useResolveMediaPath:c,onClick:L=>y(A,L)}))),pr.default.createElement(nc,{isOpen:h,onClose:k,title:`${t} ${d+1} of ${e.length}`,portalId:"journalit-carousel-fullscreen-portal"},pr.default.createElement(gd,{imagePath:P,alt:M,useResolveMediaPath:c,navigationContext:S,onClose:k})))},dR=pr.default.memo(({imagePath:e,index:t,isActive:r,altPrefix:n,useResolveMediaPath:a,onClick:o})=>pr.default.createElement("div",{className:`journalit-carousel-thumbnail ${r?"active":""}`,onClick:o,title:`${n} ${t+1}`,style:{cursor:"pointer",border:r?"2px solid var(--interactive-accent)":"2px solid transparent",borderRadius:"4px",overflow:"hidden"}},pr.default.createElement(lR,{src:e,alt:`Thumbnail ${t+1}`,useResolveMediaPath:a,style:{width:"60px",height:"60px"},rootMargin:"100px",threshold:.1})));dR.displayName="LazyThumbnail"});var uR=te(()=>{});var qw=te(()=>{DE();Uw();EE();Mm();uR()});var hd,pR,AE=te(()=>{hd=_(B());Lm();qw();pR=({data:e,onChange:t,availableTags:r,onAddImage:n,onDeleteImage:a})=>{let o=(0,hd.useMemo)(()=>({contextType:"trade",contextData:{ticker:e.instrument||"unknown"},multiple:!0}),[e.instrument]),i=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[];if(!u.includes(d)){let p=[...u,d];t("images",p)}}catch(u){console.error("Failed to process uploaded image:",u)}},s=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[],p=d.filter(m=>!u.includes(m));if(p.length>0){let m=[...u,...p];t("images",m)}}catch(u){console.error("Failed to process multiple uploaded images:",u)}},l=async(d,u)=>{let m=[...e.images||[]].filter(h=>h!==u);if(t("images",m),a)try{await a(u)}catch(h){console.error(`Failed to delete image ${u}:`,h)}};return hd.default.createElement(pd,{title:"Attachments"},n&&hd.default.createElement("div",{className:"field"},hd.default.createElement("label",{className:"label"},"Attachments"),hd.default.createElement(fd,{onImageUploaded:i,onMultipleImagesUploaded:s,label:"Upload Image",enableDragDrop:!0,saveImageFunction:async d=>{if(!n)throw new Error("Image upload not available");return await n(d)},enablePaste:!0,pasteContext:o}),e.images&&e.images.length>0&&hd.default.createElement(ac,{images:e.images,altPrefix:"Trade Image",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:l,enableFullscreen:!0})))}});var Hw,IE,mR=te(()=>{Hw=_(B());SE();AE();IE=({data:e,errors:t,onChange:r,accounts:n,setups:a,mistakes:o,availableTags:i,onAddImage:s,onDeleteImage:l})=>Hw.default.createElement("div",{className:"trade-form-details-tab"},Hw.default.createElement(iR,{data:e,errors:t,onChange:r,accounts:n,setups:a,mistakes:o}),Hw.default.createElement(pR,{data:e,onChange:r,availableTags:i,onAddImage:s,onDeleteImage:l}))});var fn,tZ,fR,gR=te(()=>{fn=_(B());Jl();Sw();rd();Fw();jw();Zt();wm();tZ=({field:e,value:t,onChange:r,error:n})=>{let a=Ee(),{id:o,label:i,type:s,validation:l,options:c,placeholder:d,helperText:u,allowCreateOptions:p}=e,m=(0,fn.useMemo)(()=>{if(s!=="dropdown"&&s!=="multiselect")return c||[];let b=c||[],v=a==null?void 0:a.customFieldsService;if(!v)return b;let g=v.getFieldOptions(o).map(C=>({value:C,label:C})),w=[...b];return g.forEach(C=>{w.some(k=>k.value===C.value)||w.push(C)}),w},[o,s,c,a==null?void 0:a.customFieldsService]),h=async b=>{let v=a==null?void 0:a.customFieldsService;if(!(!v||!p))try{await v.addFieldOption(o,b)}catch(y){console.error("Failed to save custom field option:",y)}},f=(0,fn.useMemo)(()=>({label:i,value:t!=null?t:s==="multiselect"?[]:s==="number"?0:"",onChange:r,placeholder:d,error:n,required:(l==null?void 0:l.required)||!1}),[i,t,s,r,d,n,l==null?void 0:l.required]);switch(s){case"text":return fn.default.createElement(Xt,{...f,multiline:!1,type:"text"});case"number":return fn.default.createElement(Mt,{...f,allowDecimal:!0,precision:2,min:l==null?void 0:l.min,max:l==null?void 0:l.max});case"dropdown":return p?fn.default.createElement(oi,{...f,options:m.map(b=>b.value),isMulti:!1,allowCreate:!0,onSaveOption:h}):fn.default.createElement(la,{...f,options:m});case"multiselect":return fn.default.createElement(oi,{...f,options:m.map(b=>b.value),isMulti:!0,allowCreate:p||!1,onSaveOption:p?h:void 0});case"date":return fn.default.createElement(ko,{...f,includeTime:!1});case"datetime":return fn.default.createElement(ko,{...f,includeTime:!0});case"time":return fn.default.createElement(ko,{...f,timeOnly:!0});default:return fn.default.createElement("div",{className:"custom-field-error"},fn.default.createElement("p",null,"Unsupported field type: ",s))}},fR=({fields:e,values:t,onChange:r,errors:n={}})=>!e||e.length===0?fn.default.createElement("div",{className:"custom-fields-empty"},fn.default.createElement("p",null,"No custom fields configured."),fn.default.createElement("p",null,"Go to Settings \u2192 Customization \u2192 Custom Trade Fields to add custom fields.")):fn.default.createElement("div",{className:"custom-fields-list"},e.map(a=>fn.default.createElement("div",{key:a.id,className:"custom-field-wrapper"},fn.default.createElement(tZ,{field:a,value:t[a.id],onChange:o=>r(a.id,o),error:n[a.id]}))))});var fl,NE,hR=te(()=>{fl=_(B());gR();Lm();Su();NE=({data:e,errors:t,onChange:r,customFieldValues:n,onCustomFieldChange:a})=>{let o=Ee(),{service:i,status:s}=Cs("CustomFieldsService"),[l,c]=(0,fl.useState)([]);return(0,fl.useEffect)(()=>{(async()=>{try{if(i&&s==="ready"){let m=i.getFields();c(m)}}catch(m){console.error("Failed to load custom fields:",m)}})();let u=o==null?void 0:o.app,p=m=>{m&&m.fields&&c(m.fields)};return u&&u.workspace.on("journalit-custom-fields-changed",p),()=>{u&&u.workspace.off("journalit-custom-fields-changed",p)}},[o,i,s]),fl.default.createElement("div",{className:"trade-form-advanced-tab"},fl.default.createElement(pd,{title:"Custom Fields"},fl.default.createElement("p",{className:"sectionDescription"},"Custom fields defined in your plugin settings. These fields will be saved to your trade's frontmatter."),l.length===0&&fl.default.createElement("p",{style:{fontStyle:"italic",color:"var(--text-muted)"}},"No custom fields defined. Create custom fields in the plugin settings under Customization."),fl.default.createElement(fR,{fields:l,values:n,onChange:a,errors:t.customFields||{}})))}});var vR=te(()=>{oR();mR();hR()});function yR(e){var t,r,n,a,o,i,s,l;if((r=(t=e==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.tradingDayCutoffTime)return e.settings.trade.tradingDayCutoffTime;try{if((o=(a=(n=window.journalitPlugin)==null?void 0:n.settings)==null?void 0:a.trade)!=null&&o.tradingDayCutoffTime)return window.journalitPlugin.settings.trade.tradingDayCutoffTime;let c=window.JournalitPlugin;return(l=(s=(i=c==null?void 0:c.instance)==null?void 0:i.settings)==null?void 0:s.trade)!=null&&l.tradingDayCutoffTime?c.instance.settings.trade.tradingDayCutoffTime:"00:00"}catch(c){return console.warn("Error getting trading day cutoff time, using default (00:00)",c),"00:00"}}function bR(e){try{let[t,r]=e.split(":"),n=parseInt(t,10),a=parseInt(r,10);return isNaN(n)||isNaN(a)||n<0||n>23||a<0||a>59?(console.warn(`Invalid cutoff time format: ${e}, using 00:00`),{hours:0,minutes:0}):{hours:n,minutes:a}}catch(t){return console.warn(`Error parsing cutoff time: ${e}, using 00:00`,t),{hours:0,minutes:0}}}function xt(e,t){let r=yR(t),{hours:n,minutes:a}=bR(r),o=new Date(e);return(o.getHours()<n||o.getHours()===n&&o.getMinutes()<a)&&o.setDate(o.getDate()-1),o.setHours(0,0,0,0),o}function xR(e,t,r){let n=xt(e,r),a=xt(t,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()&&n.getDate()===a.getDate()}function Vw(e,t){let r=yR(t),{hours:n,minutes:a}=bR(r),o=xt(e,t),i=new Date(o);i.setHours(n,a,0,0);let s=new Date(i);return s.setDate(s.getDate()+1),{start:i,end:s}}function oc(e,t){let r=xt(e,t),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0");return`${n}-${a}-${o}`}var Za=te(()=>{});var gn,Om,LE,wR=te(()=>{gn=_(B());ud();Om=require("obsidian");Iu();tc();cd();Au();Dw();Su();Za();LE=({initialData:e={},isEditMode:t=!1,onSubmit:r,onCancel:n})=>{let a=Ee(),[o,i]=(0,gn.useState)(()=>{if(t&&e){let I={...e};(!I.entries||!Array.isArray(I.entries))&&(I.entries=[]),(!I.exits||!Array.isArray(I.exits))&&(I.exits=[]),I.images||(I.images=[]),I.tags||(I.tags=[]),I.ctags||(I.ctags=[]),I.setup||(I.setup=[]),I.mistake||(I.mistake=[]),I.account||(I.account=[]),I.setupIds||(I.setupIds=[]),I.mistakeIds||(I.mistakeIds=[]),I.accountIds||(I.accountIds=[]),I.isMissedTrade===void 0&&(I.type==="missed-trade"||I.filePath&&I.filePath.includes("-M")&&I.filePath.endsWith(".md")?I.isMissedTrade=!0:I.isMissedTrade=!1);let O=I.backendTradeId!==void 0&&I.backendTradeId!==null,j=I.entryPrice!==void 0&&I.entryPrice!==null&&I.entryPrice>0&&I.exitPrice!==void 0&&I.exitPrice!==null&&I.exitPrice>0;return O?I.useDirectPnLInput=!0:I.useDirectPnLInput=!j,I.useDirectPnLInput&&I.directPnL===void 0&&I.pnl!==void 0&&(I.directPnL=I.pnl),I}let E={...{...zB}};e&&(Object.keys(e).forEach(I=>{let O=I,j=e[O];Array.isArray(j)?E[O]=[...j]:E[O]=j}),!E.images&&e.images&&(E.images=[...e.images]));try{let I=br().plugins.plugins.journalit;I&&I.settings.trade.useDirectPnLInput!==void 0&&(E.useDirectPnLInput=I.settings.trade.useDirectPnLInput)}catch(I){console.error("Error loading PNL input mode preference:",I)}try{let I=br().plugins.plugins.journalit;I&&I.settings.trade.lastAssetType&&!E.assetType&&(E.assetType=I.settings.trade.lastAssetType)}catch(I){console.error("Error accessing last asset type from settings:",I)}return E}),[s,l]=(0,gn.useState)({}),[c,d]=(0,gn.useState)({}),[u,p]=(0,gn.useState)(!1),[m,h]=(0,gn.useState)([]),f=(0,gn.useRef)(null),b=(0,gn.useRef)(!1),[v,y]=(0,gn.useState)(!1),g=(0,gn.useMemo)(()=>o$(()=>{let N=vE(o);if(a!=null&&a.customFieldsService&&o.customFields){let E=a.customFieldsService.getFields(),I=yE(o.customFields,E,a.customFieldsService);Object.keys(I).length>0&&(N.customFields=I)}l(N)},300),[o,a==null?void 0:a.customFieldsService]);(0,gn.useEffect)(()=>(u&&g(),()=>{g.cancel()}),[o,u,g]);let w=async()=>{try{if(v||x.current.length===0)return;y(!0);let N=[...x.current];for(let E of N)await $r.deleteImage(E,!0);h([])}catch(N){console.error("Failed to cleanup temporary images:",N)}},C=async N=>{try{if(!N)return;let E=m.includes(N);i(I=>{console.log("[DEBUG deleteImageFile] BEFORE - formData.images:",I.images,"deleting:",N);let O=Array.isArray(I.images)?[...I.images]:[];return{...I,images:O.filter(j=>j!==N)}});try{await $r.deleteImage(N,!0),E&&h(I=>I.filter(O=>O!==N))}catch(I){console.log(`Image file deletion failed (may already be deleted): ${N}`,I)}}catch(E){console.error(`Failed to delete image file ${N}:`,E)}},k=(N,E)=>{i(I=>{let O={...I,[N]:E},j=N.toString().endsWith("Ids");return N==="account"&&!j?O.accountIds=Array.isArray(E)?[...E]:[]:N==="accountIds"&&!j?O.account=Array.isArray(E)?[...E]:[]:N==="setup"&&!j?O.setupIds=Array.isArray(E)?[...E]:[]:N==="setupIds"&&!j?O.setup=Array.isArray(E)?[...E]:[]:N==="mistake"&&!j?O.mistakeIds=Array.isArray(E)?[...E]:[]:N==="mistakeIds"&&!j?O.mistake=Array.isArray(E)?[...E]:[]:N==="optionType"&&O.assetType==="options"?E==="call"?O.direction="long":E==="put"&&(O.direction="short"):N==="assetType"&&E==="options"&&O.optionType&&(O.optionType==="call"?O.direction="long":O.optionType==="put"&&(O.direction="short")),O})},x=(0,gn.useRef)([]),S=(0,gn.useRef)(null);(0,gn.useEffect)(()=>{x.current=m},[m]);let T=async N=>{try{let E=br().plugins.plugins.journalit,I=E?E.tradeService:null;if(!I)throw new Error("Could not access TradeService");let O=o.entryTime?new Date(o.entryTime):new Date,j=o.instrument||"UNKNOWN",$=xt(O,E),F=o.isMissedTrade||!1,{year:z,month:W,weekOfMonth:U,formattedDate:K}=await I.getTradePathComponents($),R=await I.sanitizeTickerForFilename(j),q;if(S.current)q=S.current;else if(e&&e.entryTime){let Y=e.filePath||"";if(Y){let V=Y.match(/[TM](\d+)\.md$/);V?q=V[1]:F&&(E!=null&&E.missedTradeService)?q=await E.missedTradeService.getMissedTradeNumberForDay(R,$):q=await I.getTradeNumberForDay(R,$),S.current=q}else F&&(E!=null&&E.missedTradeService)?q=await E.missedTradeService.getMissedTradeNumberForDay(R,$):q=await I.getTradeNumberForDay(R,$),S.current=q}else F&&(E!=null&&E.missedTradeService)?q=await E.missedTradeService.getMissedTradeNumberForDay(R,$):q=await I.getTradeNumberForDay(R,$),S.current=q;let X=F?"M":"T",G=`!Journalit/${z}/${W}/${U}/media/${R}-${K}-${X}${q}`;try{let Y=br();await Y.vault.adapter.mkdir((0,Om.normalizePath)("!Journalit")),await Y.vault.adapter.mkdir((0,Om.normalizePath)(`!Journalit/${z}`)),await Y.vault.adapter.mkdir((0,Om.normalizePath)(`!Journalit/${z}/${W}`)),await Y.vault.adapter.mkdir((0,Om.normalizePath)(`!Journalit/${z}/${W}/${U}`)),await Y.vault.adapter.mkdir((0,Om.normalizePath)(G))}catch(Y){}let H=await $r.saveImage(N,G,`${R}-${X}${q}`);return h(Y=>[...Y,H]),H}catch(E){throw console.error("Failed to upload image:",E),new Error(`Failed to upload image: ${E.message}`)}};(0,gn.useEffect)(()=>{let N=E=>{E.detail&&E.detail.path&&h(I=>I.includes(E.detail.path)?I:[...I,E.detail.path])};return document.addEventListener("jouranlit:image-saved",N),()=>{document.removeEventListener("jouranlit:image-saved",N)}},[]);let P=N=>{N.preventDefault(),p(!0);let E=vE(o);if(a!=null&&a.customFieldsService&&o.customFields){let O=a.customFieldsService.getFields(),j=yE(o.customFields,O);Object.keys(j).length>0&&(E.customFields=j)}l(E),d(E);let I={...o};if(t&&e.entryTime){let O=new Date(e.entryTime),j=new Date(o.entryTime||new Date);if(j.setFullYear(O.getFullYear()),j.setMonth(O.getMonth()),j.setDate(O.getDate()),I.entryTime=j,e.exitTime){let $=new Date(e.exitTime),F=new Date(o.exitTime||new Date);F.setFullYear($.getFullYear()),F.setMonth($.getMonth()),F.setDate($.getDate()),I.exitTime=F}e.filePath&&(I.filePath=e.filePath),i(I)}if(!I.assetType&&o.assetType&&(I.assetType=o.assetType),o.useDirectPnLInput!==void 0&&(I.useDirectPnLInput=o.useDirectPnLInput),o.directPnL!==void 0&&(I.directPnL=o.directPnL),o.isMissedTrade!==void 0&&(I.isMissedTrade=o.isMissedTrade),o.missedReason!==void 0&&(I.missedReason=o.missedReason),!_w(E)&&r)M(I),console.log("[DEBUG handleSubmit] Submitting images array:",(I||o).images),r(I||o),h([]),y(!0),d({}),l({}),p(!1);else{let O=Object.keys(E);if(O.length>0){let $={form:`Please complete all required fields: ${O.map(z=>{let W=z.replace(/([A-Z])/g," $1").toLowerCase();return W==="form"?E[z]:`${W}: ${E[z]}`}).join("; ")}`};l(z=>({...z,...$}));let F=document.querySelector(".formContainer");F&&(F.scrollTop=0)}}},M=async N=>{try{let E=br().plugins.plugins.journalit,I=E?E.optionsService:new Hn(E);N.instrument&&await I.addOption("instrument",N.instrument),N.account&&N.account.length>0&&await I.addOptions("account",N.account),N.setup&&N.setup.length>0&&await I.addOptions("setup",N.setup),N.mistake&&N.mistake.length>0&&await I.addOptions("mistake",N.mistake),N.ctags&&N.ctags.length>0&&await I.addOptions("tag",N.ctags)}catch(E){console.error("Failed to save custom options:",E)}};(0,gn.useEffect)(()=>()=>{w()},[]);let D=()=>{w(),n&&n()},[A,L]=(0,gn.useState)(!1);return{formData:o,errors:s,formRef:f,handleFieldChange:k,handleAddImage:T,deleteImageFile:C,handleSubmit:P,handleCancel:D,isSubmitting:A,setIsSubmitting:L,formSubmitted:u,cleanupPerformed:v}}});var SR=te(()=>{wR()});var Gw,ME,kR=te(()=>{Gw=_(B());Wi();Au();ME=({onCancel:e,isSubmitting:t,errors:r,isEditMode:n,hasEntryTime:a})=>{let o=()=>n?"Update Trade":a?"Save Changes":"Add Trade";return Gw.default.createElement("div",{className:"formActions"},e&&Gw.default.createElement($e,{variant:"outline",onClick:e,disabled:t,className:"cancelButton"},"Cancel"),Gw.default.createElement($e,{type:"submit",variant:"primary",loading:t,disabled:_w(r),className:"submitButton"},o()))}});var CR=te(()=>{kR()});var Rr,TR,PR=te(()=>{Rr=_(B());Sv();vR();SR();CR();TR=({initialData:e={},isSubmitting:t=!1,isEditMode:r=!1,onSubmit:n,onCancel:a})=>{let{formData:o,errors:i,formRef:s,handleFieldChange:l,handleAddImage:c,deleteImageFile:d,handleSubmit:u,handleCancel:p}=LE({initialData:e,isEditMode:r,onSubmit:n,onCancel:a}),[m,h]=(0,Rr.useState)("basic"),[f,b]=(0,Rr.useState)(()=>r&&o.customFields?o.customFields:{});(0,Rr.useMemo)(()=>(Du(),!0),[]);let v=[],y=[],g=[],w=[],C=[],k=(A,L)=>{let N={...f,[A]:L};b(N),l("customFields",N)};Rr.default.useEffect(()=>{if(o.customFields){let A=JSON.stringify(f),L=JSON.stringify(o.customFields);A!==L&&b(o.customFields)}},[o.customFields,f]);let x=A=>{A!==m&&h(A)},S=Rr.default.useMemo(()=>{let A=["instrument","direction","assetType","entries","exits","entriesExits","entryTime","entryPrice","positionSize","exitTime","exitPrice","setupIds","accountIds"],L=["commission","fees","exchange","strikePrice","optionType","contractSize","dollarPerPoint","tickSize","tickValue","lotSize","pipValue","cryptoExchange","leverageRatio"],N=["customFields"],E=A.filter(j=>{let $=i[j];return $&&$!==""}),I=L.filter(j=>{let $=i[j];return $&&$!==""}),O=N.filter(j=>{let $=i[j];return $&&$!==""});return{basic:E.length,details:I.length,advanced:O.length}},[i]),T={display:"flex",borderBottom:"1px solid var(--background-modifier-border)",marginBottom:"20px",justifyContent:"center",width:"100%",paddingTop:"10px",paddingBottom:"0",position:"sticky",top:0,backgroundColor:"var(--background-primary)",zIndex:100,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},P=A=>({padding:"8px 16px",cursor:"pointer",borderTop:"none",borderRight:"none",borderLeft:"none",borderBottom:A?"2px solid var(--text-accent)":"2px solid transparent",color:A?"var(--text-normal)":"var(--text-muted)",fontWeight:A?600:500,marginRight:"8px",position:"relative",bottom:"-1px",background:"transparent",borderRadius:"0",fontSize:"14px",transition:"all 0.15s ease"}),M=[{id:"basic",label:"Basic",errorCount:S.basic},{id:"details",label:"Details",errorCount:S.details},{id:"advanced",label:"Advanced",errorCount:S.advanced}],D=()=>{switch(m){case"basic":return Rr.default.createElement(wE,{data:o,errors:i,onChange:l,instruments:w});case"details":return Rr.default.createElement(IE,{data:o,errors:i,onChange:l,accounts:v,setups:y,mistakes:g,availableTags:C,onAddImage:c,onDeleteImage:d});case"advanced":return Rr.default.createElement(NE,{data:o,errors:i,onChange:l,customFieldValues:f,onCustomFieldChange:k});default:return null}};return Rr.default.createElement("form",{ref:s,className:"formContainer",style:{gap:"8px",position:"relative"},onSubmit:u},i.form&&Rr.default.createElement("div",{className:"errorSummary"},i.form),(S.basic>0||S.details>0||S.advanced>0)&&Rr.default.createElement("div",{className:"errorSummary",style:{marginBottom:"16px"}},Rr.default.createElement("strong",null,"Please fix the following errors:"),Rr.default.createElement("ul",{style:{margin:"8px 0 0 20px",padding:0}},S.basic>0&&Rr.default.createElement("li",null,"Basic tab has ",S.basic," error",S.basic>1?"s":""),S.details>0&&Rr.default.createElement("li",null,"Details tab has ",S.details," error",S.details>1?"s":""),S.advanced>0&&Rr.default.createElement("li",null,"Advanced tab has ",S.advanced," error",S.advanced>1?"s":""))),Rr.default.createElement("nav",{style:T},M.map(A=>Rr.default.createElement("button",{key:A.id,type:"button",style:P(m===A.id),onClick:()=>x(A.id)},A.label,A.errorCount>0&&Rr.default.createElement("span",{style:{marginLeft:"6px",backgroundColor:"var(--text-error)",color:"white",borderRadius:"10px",fontSize:"10px",fontWeight:"bold",padding:"2px 6px",minWidth:"16px",height:"16px",display:"inline-flex",alignItems:"center",justifyContent:"center"}},A.errorCount)))),D(),Rr.default.createElement(ME,{onCancel:p,isSubmitting:t,errors:i,isEditMode:r,hasEntryTime:!!e.entryTime}))}});var DR=te(()=>{PR();Lm();Au();cd();$w();xE();SE();AE()});function Yw(){let e=document.createElement("style");e.id="trade-form-styles",e.textContent=rZ,document.head.appendChild(e)}function Kw(){let e=document.head.querySelector("#trade-form-styles");e&&e.remove()}var rZ,OE=te(()=>{rZ=`
  /* Trade Form Custom Styles */
  /* Ensure proper overflow handling in container */
  .trade-form-view-container {
    --interactive-accent-rgb: 83, 141, 226;
    --color-error-rgb: 229, 57, 53;
    height: 100% !important;
    overflow-y: auto !important;
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
  .trade-form-view-container .formContainer {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap between all form elements */
    max-width: 800px !important;
    margin: 0 auto !important;
    padding: 16px 20px !important;
    width: 100% !important;
    flex: 1 1 auto !important; /* Allow container to grow/shrink */
    min-height: min-content !important; /* Ensure it's at least as tall as content */
    box-sizing: border-box !important; /* Ensure padding is included in width */
  }
  .trade-form-view-container .formSection {
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important; /* Remove all section margins */
    position: relative !important;
  }
  
  /* Remove all spacing between sections */
  .trade-form-view-container .formSection + .formSection {
    padding: 0 !important;
    margin: 0 !important;
  }
  .trade-form-view-container .sectionTitle {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: none !important; /* Hide the original section title */
  }
  .trade-form-view-container .minimizedSectionTitle {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    margin-bottom: 8px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
  }
  .trade-form-view-container .sectionDescription {
    font-size: 16px !important;
    color: var(--text-muted) !important;
    margin-bottom: 16px !important;
    display: none !important; /* Hide the section description */
  }
  .trade-form-view-container .formTitle {
    font-size: 20px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
  }
  .trade-form-view-container .sectionContent {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap matching form container */
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .trade-form-view-container .field {
    margin: 0 !important; /* Remove all field margins */
    padding: 0 !important; /* Remove all field padding */
  }
  .trade-form-view-container input,
  .trade-form-view-container textarea {
    box-sizing: border-box !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    width: 100% !important;
    font-size: 16px !important;
  }

  /* Placeholder styling for inputs */
  .trade-form-view-container input::placeholder,
  .trade-form-view-container textarea::placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }
  /* Specific styles for select elements to fix text cutoff */
  .trade-form-view-container select,
  .trade-form-view-container .obsidian-select {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 30px 8px 12px !important; /* Extra right padding for dropdown arrow */
    width: 100% !important;
    font-size: 16px !important;
    min-height: 38px !important; /* Ensure minimum height */
    line-height: 1.5 !important; /* Improve text rendering */
    text-overflow: ellipsis !important; /* Show ellipsis for long text */
  }

  /* Style for select with no value selected (to show grey placeholder) */
  .trade-form-view-container select:invalid,
  .trade-form-view-container select:not([value]),
  .trade-form-view-container select[value=""] {
    color: var(--text-muted) !important;
    opacity: 0.7 !important; /* Match input placeholder opacity */
  }

  /* Make sure selected values display normally */
  .trade-form-view-container select[data-has-value="true"] {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }

  /* Make sure all option values display normally */
  .trade-form-view-container select option:not([value=""]):not(:disabled),
  .trade-form-view-container select option:not(.select-placeholder),
  .trade-form-view-container select option:checked {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }
  /* Fix for date input fields to prevent text from overlapping with calendar icon */
  .trade-form-view-container input[type="date"] {
    padding-left: 35px !important; /* Move text to the right to make room for the calendar icon */
    padding-right: 15px !important;
    min-width: 150px !important; /* Ensure minimum width for date inputs */
  }
  /* Fix for time input fields to move clock icon to the left */
  .trade-form-view-container input[type="time"] {
    padding-left: 35px !important; /* Move text to the right to make room for the clock icon */
    padding-right: 15px !important;
    min-width: 110px !important; /* Ensure minimum width for time inputs */
  }
  /* Target the calendar picker indicator to move it to the left */
  .trade-form-view-container input[type="date"]::-webkit-calendar-picker-indicator,
  .trade-form-view-container input[type="time"]::-webkit-calendar-picker-indicator {
    position: absolute !important;
    left: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    z-index: 2 !important; /* Ensure the icon appears above other elements */
  }
  /* Alternative method using appearance property */
  .trade-form-view-container input[type="date"],
  .trade-form-view-container input[type="time"] {
    position: relative !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    background-image: var(--calendar-icon, initial) !important;
    background-repeat: no-repeat !important;
    background-position: 10px center !important;
  }
  /* Provide calendar icon as background */
  .trade-form-view-container input[type="date"] {
    /* Default icon will be provided by the browser */
  }
  /* Provide clock icon as background */
  .trade-form-view-container input[type="time"] {
    /* Default icon will be provided by the browser */
  }
  /* Support for Firefox */
  @-moz-document url-prefix() {
    .trade-form-view-container input[type="date"],
    .trade-form-view-container input[type="time"] {
      position: relative !important;
      background-position: 10px center !important;
    }
  }
  /* Ensure proper scrolling for the entire container */
  body {
    overflow: hidden !important; /* Prevent double scrollbars */
  }
  /* Ensure proper scrolling for main container */
  .trade-form-view-container {
    overflow-y: auto !important; /* Enable vertical scrolling */
    max-height: 100vh !important; /* Limit to viewport height */
  }
  
  /* Eliminate double scrollbars when the trade form is rendered inside an Obsidian modal */
  .modal .trade-form-view-container,
  .modal-content .trade-form-view-container {
    height: auto !important;
    max-height: none !important;
    overflow: visible !important; /* Let the modal handle scrolling */
  }
  /* React root element should expand properly */
  #trade-form-root {
    height: 100% !important;
    min-height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 auto !important;
  }
  /* Form container needs to expand fully */
  .formContainer {
    display: flex !important;
    flex-direction: column !important;
    min-height: min-content !important;
    height: auto !important; /* Prevent inner container from managing its own scrolling */
    flex: 1 1 auto !important;
    overflow: visible !important; /* Avoid nested scrollbars inside modal */
  }
  /* Removing extra gap between form title and first section */
  .trade-form-view-container .formHeader {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  /* Reduce the spacing between form elements */
  .trade-form-view-container > div, 
  .trade-form-view-container > form > div {
    margin-bottom: 0 !important;
  }

  /* Fix the gap at the top of the form */
  .trade-form-view-container .formHeader + div,
  .trade-form-view-container .formHeader + .formSection {
    margin-top: 0 !important;
  }

  /* Fix the specific gap between form title and first section */
  .trade-form-view-container .formTitle + .formSection,
  .trade-form-view-container .formHeader + .formSection,
  .trade-form-view-container .errorSummary + .formSection {
    margin-top: 12px !important;
  }
  /* ComboBox specific styles - attribute-based selectors for Obsidian compatibility */
  .trade-form-view-container .combobox-container,
  .trade-form-view-container [data-combobox-type] {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    /* Use higher z-index when dropdown is open to ensure it stays above other elements */
    z-index: 10 !important;
  }

  /* Increase z-index when dropdown is open to ensure it stays above other elements */
  .trade-form-view-container [data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Style for input container to properly position dropdown */
  .trade-form-view-container [data-combobox-type] > .input-container {
    position: relative !important;
    margin: 0 !important;
    padding: 0 !important;
    /* Ensure it's above other elements but below the dropdown */
    z-index: 1 !important;
  }

  /* Styling for selected items in multi-select */
  .trade-form-view-container .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    margin: 0 4px 4px 0 !important;
    padding: 4px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
    gap: 6px !important;
  }

  .trade-form-view-container .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    background: rgba(255, 255, 255, 0.2) !important; /* Add visible background */
    border: none !important;
    color: white !important;
    font-size: 16px !important;
    line-height: 1 !important;
    cursor: pointer !important;
    border-radius: 50% !important; /* Make it round */
    margin-left: 4px !important;
    position: relative !important; /* Create stacking context */
    z-index: 5 !important; /* Ensure it's above other elements */
    transition: background-color 0.2s !important;
  }

  .trade-form-view-container .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  .trade-form-view-container [data-combobox-type] > div:nth-child(2) {
    position: relative !important;
    width: 100% !important;
  }
  /* Add dropdown caret to the input container */
  .trade-form-view-container [data-combobox-type] .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }
  /* Rotate caret when dropdown is open */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] .input-container::after {
    transform: translateY(-50%) rotate(180deg) !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"] {
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }
  /* When dropdown is open, change input border radius */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"]:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3) !important;
    outline: none !important;
  }
  /* Dropdown list styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 38px !important; /* Position exactly at the bottom of input by using a fixed value */
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important; /* Remove top border to create seamless connection */
    border-radius: 0 0 4px 4px !important; /* Only round the bottom corners */
    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
    z-index: 9999 !important; /* Higher z-index to ensure dropdown stays above other elements */
    list-style: none !important;
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    animation: dropdown-fade-in 150ms ease-out !important;
    pointer-events: auto !important; /* Ensure clicks on the dropdown are detected */
  }
  /* Dropdown option styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
  }
  /* Hover and highlighted state for options */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li:hover,
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }
  /* Multi-select tags container */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-bottom: 4px !important;
  }
  /* Individual tag styling */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span {
    display: inline-flex !important;
    align-items: center !important;
    padding: 2px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
  }
  /* Remove button in tags */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button {
    background: none !important;
    border: none !important;
    color: white !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 1 !important;
    padding: 0 4px !important;
    margin-left: 4px !important;
    /* Enhanced pointer events to ensure clicks are registered */
    pointer-events: auto !important;
    /* Make the button visually stand out more */
    opacity: 0.8 !important;
    transition: opacity 0.2s !important;
  }
  /* Add hover effects to make it clear it's clickable */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button:hover {
    opacity: 1 !important;
  }
  /* Special styling for "Add new" option */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
  }
  /* Animation for dropdown appearance */
  @keyframes dropdown-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  /* Fix for option visibility in dropdowns */
  .trade-form-view-container select option {
    padding: 8px 12px !important;
    font-size: 16px !important;
    line-height: 1.5 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    font-style: italic !important; 
  }
  .trade-form-view-container input:focus,
  .trade-form-view-container select:focus,
  .trade-form-view-container textarea:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    outline: none !important;
  }
  .trade-form-view-container .label {
    display: block !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    margin-bottom: 4px !important;
    color: var(--text-normal) !important;
  }
  .trade-form-view-container .errorMessage {
    font-size: 11px !important;
    color: #e53935 !important;
    margin-top: 2px !important;
    padding-left: 1px !important;
  }
  .trade-form-view-container button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 16px !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-weight: 500 !important;
    font-size: 16px !important;
  }
  .trade-form-view-container button.primary {
    background-color: var(--interactive-accent) !important;
    color: #ffffff !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }
  .trade-form-view-container button.outline {
    background-color: transparent !important;
    color: var(--interactive-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.outline:hover:not(:disabled) {
    background-color: rgba(var(--interactive-accent-rgb), 0.1) !important;
  }
  /* Style for default values like 0.00 to make them look like placeholders */
  .trade-form-view-container input.default-value {
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  /* When a default value input is focused, reset the text style */
  .trade-form-view-container input.default-value:focus {
    color: var(--text-normal) !important;
    font-style: normal !important;
  }
  .trade-form-view-container .formActions {
    display: flex !important;
    justify-content: space-between !important;
    gap: 16px !important;
    margin-top: 4px !important; /* Small top margin */
    margin-bottom: 16px !important; /* Reduced bottom margin */
    padding: 0 !important;
  }
  .trade-form-view-container .twoColumnLayout {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important; /* Match other gaps */
    margin: 0 !important;
    padding: 0 !important;
  }
  /* Date picker container styling */
  .trade-form-view-container .date-picker-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }
  @media (max-width: 600px) {
    .trade-form-view-container .twoColumnLayout {
      grid-template-columns: 1fr !important;
    }
  }
  .trade-form-view-container .calculatedValue {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 12px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
    margin: 0 !important; /* Remove all margins to maintain consistent spacing */
    width: 100% !important;
  }
  .trade-form-view-container .calculatedLabel {
    font-size: 12px !important;
    color: var(--text-muted) !important;
  }
  .trade-form-view-container .calculatedAmount {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
  .trade-form-view-container .positive {
    color: #43a047 !important;
  }
  .trade-form-view-container .negative {
    color: #e53935 !important;
  }
  .trade-form-view-container .neutral {
    color: var(--text-normal) !important;
  }

  /* Asset Type Button Styles - Pill Style */
  .trade-form-view-container .asset-type-container {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    grid-template-rows: repeat(2, 1fr) !important;
    gap: 8px !important;
    width: 100% !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .asset-type-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  .trade-form-view-container .asset-type-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    color: white !important;
    font-weight: 500 !important;
  }

  .trade-form-view-container .asset-type-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Asset-specific fields styling for consistent spacing */
  .trade-form-view-container .asset-specific-fields {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Match the gap used in form container and section content */
    width: 100% !important;
    margin-bottom: 12px !important; /* Match other section spacing */
  }

  /* Direction Button Styles - Using the same pill style as Asset Type buttons */
  .trade-form-view-container .direction-container {
    display: flex !important;
    width: 100% !important;
    gap: 8px !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .direction-button {
    flex: 1 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  /* Remove border-right as we're now using individual pills */
  /* .trade-form-view-container .direction-button:not(:last-child) {
    border-right: 1px solid var(--background-modifier-border) !important;
  } */

  .trade-form-view-container .direction-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    color: white !important;
  }

  .trade-form-view-container .direction-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Required field indicator */
  .trade-form-view-container .required-indicator {
    color: #e53935 !important;
    margin-left: 4px !important;
    font-weight: bold !important;
  }

  .trade-form-view-container .thesisField {
    min-height: 100px !important;
  }
  .trade-form-view-container .tagContainer {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-top: 4px !important;
  }
  .trade-form-view-container .tag {
    display: inline-flex !important;
    align-items: center !important;
    padding: 4px 8px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 2px !important;
    font-size: 12px !important;
    gap: 4px !important;
  }
  .trade-form-view-container .removeTag {
    cursor: pointer !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background-color: rgba(0, 0, 0, 0.1) !important;
  }
  .trade-form-view-container .errorSummary {
    background-color: rgba(229, 57, 53, 0.05) !important;
    border: 1px solid rgba(229, 57, 53, 0.5) !important;
    color: #e53935 !important;
    padding: 10px 12px !important;
    border-radius: 4px !important;
    margin-bottom: 16px !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    font-weight: 400 !important;
    box-shadow: none !important;
  }

  @keyframes errorPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
  }

  /* Drag and drop styles */
  .trade-form-view-container .formContainer.is-dragging-over {
    position: relative !important;
  }

  .trade-form-view-container .drag-overlay {
    position: fixed !important; /* Fixed to viewport instead of absolute */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.4) !important; /* Reduced opacity */
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    z-index: 9999 !important;
    animation: fade-in 0.2s ease-out !important;
  }

  .trade-form-view-container .drag-message-container {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important; /* Center in viewport */
    z-index: 10000 !important;
  }

  .trade-form-view-container .drag-message {
    font-size: 22px !important;
    font-weight: 400 !important; /* Lighter weight */
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif) !important;
    color: var(--interactive-accent) !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.7) !important; /* Reduced opacity */
    padding: 14px 28px !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08) !important; /* More subtle shadow */
    letter-spacing: 0.5px !important;
    border: 1px solid rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.5) !important; /* Semi-transparent border */
    white-space: nowrap !important;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .trade-form-view-container input,
    .trade-form-view-container textarea,
    .trade-form-view-container select,
    .trade-form-view-container .obsidian-select {
      font-size: 18px !important;
    }
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
`});var AR={};Zs(AR,{TradeFormModal:()=>Jn});var jm,Fm,ER,Jn,nZ,vd=te(()=>{jm=_(B()),Fm=require("obsidian"),ER=_(vo());DR();Yn();OE();Ct();Jn=class extends Fm.Modal{constructor(r){super(r.app);this.container=null;this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),Nm(),nE(),Yw();try{let o=document.activeElement;o&&typeof o.blur=="function"&&o.blur()}catch(o){}let n=this.modalEl;n&&(n.style.maxHeight="90vh"),r.createEl("h2",{text:this.props.isEditMode?"Edit Trade":"Add Trade",cls:"modal-title"});let a=r.createDiv({cls:"trade-form-modal-scroll"});a.style.maxHeight="var(--modal-content-height)",a.style.overflowY="auto",this.container=a.createDiv({cls:"trade-form-modal-container trade-form-view-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),Kw();let{contentEl:r}=this;r.empty()}renderComponent(){this.container&&(this.root=(0,ER.createRoot)(this.container),this.root.render(jm.default.createElement(Co,null,jm.default.createElement(nZ,{app:this.props.app,plugin:this.props.plugin,isEditMode:!!this.props.isEditMode,initialData:this.props.initialData||{},filePath:this.props.filePath||"",onModalClose:()=>this.close()}))))}},nZ=({plugin:e,isEditMode:t,initialData:r,filePath:n,onModalClose:a})=>{let[o,i]=(0,jm.useState)(!1),s=async()=>{try{return e.missedTradeService?e.missedTradeService:await e.serviceManager.getMissedTradeService()}catch(d){throw new Error("Missed trade service is not initialized. Please wait a moment and try again.")}};return jm.default.createElement(TR,{initialData:r||{},isSubmitting:o,isEditMode:t,onSubmit:async d=>{try{i(!0);let u="",p=d.isMissedTrade===!0,m={entryTime:d.entryTime,exitTime:d.exitTime,entryPrice:d.entryPrice,exitPrice:d.exitPrice,positionSize:d.positionSize,direction:d.direction,entries:d.entries||[],exits:d.exits||[],setupIds:d.setupIds||[],mistakeIds:d.mistakeIds||[],accountIds:d.accountIds||[],thesis:d.thesis,images:d.images,instrument:d.instrument,assetType:d.assetType,setup:d.setup,mistake:d.mistake,account:d.account,tags:d.tags,dollarPerPoint:d.dollarPerPoint,tickSize:d.tickSize,tickValue:d.tickValue,expirationDate:d.assetType==="options"&&d.expirationDate?new Date(d.expirationDate):void 0,strikePrice:d.strikePrice,optionType:d.optionType,contractSize:d.contractSize,exchange:d.exchange,lotSize:d.lotSize,pipValue:d.pipValue,cryptoExchange:d.cryptoExchange,leverageRatio:d.leverageRatio,commission:d.commission,fees:d.fees,useDirectPnLInput:d.useDirectPnLInput,directPnL:d.directPnL,isMissedTrade:d.isMissedTrade,missedReason:d.missedReason,customFields:d.customFields};t&&(m.originalPnl=r==null?void 0:r.pnl),t?(p?u=await(await s()).updateMissedTrade(m,n||""):u=await e.tradeService.updateTrade(m,n||""),new Fm.Notice(`${p?"Missed trade":"Trade"} updated: ${u}`)):(p?u=await(await s()).createMissedTrade(m):u=await e.tradeService.createTrade(m),new Fm.Notice(`${p?"Missed trade":"Trade"} created: ${u}`));try{d.assetType&&(e.settings.trade.lastAssetType=d.assetType,await e.saveSettings())}catch(h){console.error("Error saving asset type preference:",h)}a()}catch(u){console.error(`Failed to ${t?"update":"create"} trade:`,u),new Fm.Notice(`Failed to ${t?"update":"create"} trade: ${(u==null?void 0:u.message)||"Unknown error"}`),i(!1)}},onCancel:()=>{a()}})}});function n0(e,t=200){typeof window!="undefined"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>{try{e()}catch(r){console.error("Error in idle scheduled function:",r)}}):setTimeout(()=>{try{e()}catch(r){console.error("Error in scheduled function:",r)}},t)}function Bv(e,t=100){return new Promise(r=>{if(e.length===0){r();return}let n=0;function a(){if(n>=e.length){r();return}try{let o=e[n++];o(),n<e.length?setTimeout(a,t):r()}catch(o){console.error(`Error in scheduled operation at index ${n-1}:`,o),setTimeout(a,t)}}a()})}var a0=te(()=>{});var FE,o0,WR=te(()=>{FE=require("obsidian");a0();o0=class{constructor(t,r,n={}){this.indexes=new Map;this.indexConfigs=new Map;this.filePathMap=new Map;this.buildingIndexes=new Set;this.processedFiles=new Set;this.isDirty=!1;this.persistIndexes=!0;this.isInitialized=!1;this.pendingFileChanges=[];this.BASE_FOLDER=".journalit";this.INDEX_FOLDER="indexes";var a;this.app=t,this.dataExtractor=r,this.persistIndexes=(a=n.persistIndexes)!=null?a:!0,this.boundHandleFileChange=this.handleFileChange.bind(this),this.app.vault.on("create",this.boundHandleFileChange),this.app.vault.on("modify",this.boundHandleFileChange),this.app.vault.on("delete",this.boundHandleFileChange),this.app.vault.on("rename",this.boundHandleFileChange)}async initialize(){if(!this.isInitialized)try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t),this.persistIndexes&&await this.loadIndexes(),this.isInitialized=!0;for(let r of this.pendingFileChanges)this.handleFileChange(r);this.pendingFileChanges=[],this.persistIndexes&&setInterval(()=>this.saveIndexes(),5*60*1e3)}catch(t){console.error("Failed to initialize index manager:",t)}}registerIndex(t){this.indexConfigs.set(t.name,t),this.indexes.has(t.name)||this.indexes.set(t.name,[]),this.buildingIndexes.has(t.name)||this.buildIndex(t.name)}getIndex(t){return this.indexes.get(t)||[]}queryIndex(t,r={},n={}){let a=this.indexes.get(t);if(!a)return[];let o=a.filter(i=>Object.entries(r).every(([s,l])=>Array.isArray(i.values[s])?Array.isArray(l)?l.some(c=>i.values[s].includes(c)):i.values[s].includes(l):i.values[s]===l));if(n.sort){let{field:i,direction:s}=n.sort;o.sort((l,c)=>{let d=l.values[i],u=c.values[i];if(d===u)return 0;if(d===void 0)return s==="asc"?-1:1;if(u===void 0)return s==="asc"?1:-1;let p=d<u?-1:1;return s==="asc"?p:-p})}return n.offset!==void 0&&n.offset>0&&(o=o.slice(n.offset)),n.limit!==void 0&&n.limit>0&&(o=o.slice(0,n.limit)),o}getUniqueValues(t,r){let n=this.indexes.get(t);if(!n)return[];let a=new Set;for(let o of n){let i=o.values[r];Array.isArray(i)?i.forEach(s=>a.add(s)):i!=null&&a.add(i)}return Array.from(a)}async buildIndex(t){if(!this.buildingIndexes.has(t)){this.buildingIndexes.add(t);try{let r=this.indexConfigs.get(t);if(!r){console.error(`No config found for index: ${t}`),this.buildingIndexes.delete(t);return}let n=this.app.vault.getFiles(),a=r.fileFilter?n.filter(r.fileFilter):n.filter(s=>s.extension==="md"),o=20,i=[];for(let s=0;s<a.length;s+=o){let l=a.slice(s,s+o);i.push(l)}this.indexes.set(t,[]);for(let s of i){let l=s.map(c=>async()=>{if(!this.processedFiles.has(c.path))try{await this.indexFile(c,t),this.processedFiles.add(c.path)}catch(d){console.error(`Error indexing file ${c.path}:`,d)}});for(let c=0;c<l.length;c++)await l[c](),c%5===0&&c>0&&await new Promise(d=>setTimeout(d,10))}this.isDirty=!0}catch(r){console.error(`Error building index ${t}:`,r)}finally{this.buildingIndexes.delete(t),this.persistIndexes&&this.saveIndexes()}}}async indexFile(t,r){let n=this.indexConfigs.get(r);if(n&&!(n.fileFilter&&!n.fileFilter(t)))try{let a=await this.dataExtractor(t);if(!a)return;let o={};for(let d of n.fields)n.valueExtractor?o[d]=n.valueExtractor(a,d):n.includeNested?o[d]=this.getNestedValue(a,d):o[d]=a[d];let i={data:a,file:t,values:o},s=this.indexes.get(r)||[],l=-1;this.filePathMap.has(t.path)||this.filePathMap.set(t.path,new Map);let c=this.filePathMap.get(t.path);if(c.has(r)&&(l=c.get(r)),l>=0&&l<s.length)s[l]=i;else{let d=s.length;s.push(i),c.set(r,d)}this.indexes.set(r,s),this.isDirty=!0}catch(a){console.error(`Error indexing file ${t.path} for index ${r}:`,a)}}removeFileFromIndexes(t){if(!this.filePathMap.has(t))return;let r=this.filePathMap.get(t);for(let[n,a]of r.entries()){let o=this.indexes.get(n);if(o&&a>=0&&a<o.length){let i=o.length-1;if(a!==i){let s=o[i];o[a]=s;let l=s.file.path;if(this.filePathMap.has(l)){let c=this.filePathMap.get(l);c.has(n)&&c.set(n,a)}}o.pop(),this.isDirty=!0}}this.filePathMap.delete(t),this.processedFiles.delete(t)}handleFileChange(t){if(!(!("path"in t)||t.path.includes(`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`))){if(!this.isInitialized){this.pendingFileChanges.push(t);return}n0(async()=>{try{if(t instanceof FE.TFile){if(t.extension!=="md")return;for(let r of this.indexConfigs.keys())this.buildingIndexes.has(r)||await this.indexFile(t,r)}else this.removeFileFromIndexes(t.path);this.isDirty&&this.persistIndexes&&setTimeout(()=>this.saveIndexes(),2e3)}catch(r){console.error(`Error handling file change for ${t.path}:`,r)}})}}getNestedValue(t,r){return r.split(".").reduce((n,a)=>n&&n[a]!==void 0?n[a]:void 0,t)}async saveIndexes(){if(!(!this.isDirty||!this.persistIndexes))try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t);for(let[r,n]of this.indexes.entries()){let a={name:r,entries:n.map(i=>({path:i.file.path,values:i.values}))},o=`${t}/${r}.json`;await this.app.vault.adapter.write(o,JSON.stringify(a))}this.isDirty=!1}catch(t){console.error("Failed to save indexes:",t)}}async loadIndexes(){try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;if(!await this.app.vault.adapter.exists(t))return;let{files:r}=await this.app.vault.adapter.list(t);for(let n of r)try{let a=await this.app.vault.adapter.read(n),o=JSON.parse(a);if(!o.name||!Array.isArray(o.entries)){console.warn(`Invalid index file format: ${n}`);continue}let i=o.name;this.indexes.set(i,[]);for(let s=0;s<o.entries.length;s++){let l=o.entries[s],c=l.path,d=this.app.vault.getAbstractFileByPath(c);if(!d||!(d instanceof FE.TFile))continue;let u={data:null,file:d,values:l.values},p=this.indexes.get(i);p.push(u),this.filePathMap.has(c)||this.filePathMap.set(c,new Map),this.filePathMap.get(c).set(i,p.length-1),this.processedFiles.add(c)}}catch(a){console.error(`Failed to load index file ${n}:`,a)}}catch(t){console.error("Failed to load indexes:",t)}}unload(){this.app.vault.off("create",this.boundHandleFileChange),this.app.vault.off("modify",this.boundHandleFileChange),this.app.vault.off("delete",this.boundHandleFileChange),this.app.vault.off("rename",this.boundHandleFileChange),this.persistIndexes&&this.isDirty&&this.saveIndexes(),this.indexes.clear(),this.indexConfigs.clear(),this.filePathMap.clear(),this.processedFiles.clear(),this.pendingFileChanges=[]}}});var UR={};Zs(UR,{CustomDataService:()=>si});var bd,si,Lu=te(()=>{WR();Ss();bd=class bd{constructor(t,r={}){this.app=t;this.indexManager=null;this.config={folder:r.folder||"",extension:r.extension||".md",cacheTTL:r.cacheTTL||bd.DEFAULT_CACHE_TTL,persistCache:r.persistCache!==void 0?r.persistCache:!0,namespace:r.namespace||"default",enableIndexing:r.enableIndexing!==void 0?r.enableIndexing:!0,indexes:r.indexes||[]},this.cache=new Map,this.isCacheInvalidated=!1,this.boundHandleFileChange=this.handleFileChange.bind(this),this.config.enableIndexing&&this.setupIndexing(),this.initializeService()}setupIndexing(){if(bd.sharedIndexManager?this.indexManager=bd.sharedIndexManager:(this.indexManager=new o0(this.app,async t=>{try{return await this.readFrontmatter(t)}catch(r){return console.error(`Error extracting data from ${t.path}:`,r),null}}),bd.sharedIndexManager=this.indexManager,this.indexManager.initialize()),this.config.indexes.length>0)for(let t of this.config.indexes)this.indexManager.registerIndex(t)}async initializeService(){await this.loadPersistentCache(),this.app.vault.on("create",this.boundHandleFileChange),this.app.vault.on("modify",this.boundHandleFileChange),this.app.vault.on("delete",this.boundHandleFileChange),this.app.vault.on("rename",this.boundHandleFileChange)}getNamespacedKey(t){return`${this.config.namespace}:${t}`}async query(t,r,n={},a){let{useCache:o=!0,cacheTTL:i=this.config.cacheTTL,offlineCapable:s=!0,useIndexes:l=!0}=n,c=this.getNamespacedKey(r);try{if(o&&!this.isCacheInvalidated){let u=this.getCached(c,i);if(u!==null)return u}if(l&&this.indexManager&&a)try{let u=this.indexManager.queryIndex(a.indexName,a.filters||{},{sort:a.sort,limit:a.limit,offset:a.offset});if(u.length>0){let p=u.filter(h=>h.data!==null&&h.data!==void 0),m;return p.length===u.length?(m=u.map(h=>h.data||null).filter(Boolean),m.length===1&&!Array.isArray(t)&&(m=m[0])):m=(await Promise.all(u.map(async f=>{try{return await this.readFrontmatter(f.file)}catch(b){return console.error(`Error loading data from file ${f.file.path}:`,b),null}}))).filter(Boolean),o&&(this.setCache(c,m),this.isCacheInvalidated=!1),m}}catch(u){console.warn(`Error using index for query ${r}:`,u)}let d=await t();return o&&(this.setCache(c,d),this.isCacheInvalidated=!1),d}catch(d){if(s&&o){let u=this.getCached(c,1/0);if(u!==null)return u}throw this.handleError(d)}}getCached(t,r){let n=this.cache.get(t);if(!n)return null;let{data:a,timestamp:o}=n;return Date.now()-o>r?(this.cache.delete(t),null):a}setCache(t,r){let n={data:r,timestamp:Date.now()};this.cache.set(t,n),this.config.persistCache&&this.savePersistentCache()}getCacheFilePath(){return`.journalit/cache/${this.config.namespace}-cache.json`}async loadPersistentCache(){try{let t=this.getCacheFilePath();if(await this.app.vault.adapter.exists(t)){let n=await this.app.vault.adapter.read(t);try{let a=JSON.parse(n);Object.entries(a).forEach(([o,i])=>{this.cache.set(o,i)})}catch(a){console.warn(`Failed to parse cache data for namespace ${this.config.namespace}:`,a instanceof Error?a.message:"Invalid JSON")}}}catch(t){let r=t instanceof Error?t.message:String(t);console.warn(`Failed to load persistent cache for namespace ${this.config.namespace}:`,r)}}async savePersistentCache(){try{let t=this.getCacheFilePath();await this.app.vault.adapter.mkdir(".journalit/cache");let r=Array.from(this.cache.entries()).filter(([a])=>a.startsWith(`${this.config.namespace}:`)),n=Object.fromEntries(r);await this.app.vault.adapter.write(t,JSON.stringify(n))}catch(t){console.warn(`Failed to save persistent cache for namespace ${this.config.namespace}:`,t instanceof Error?t.message:"Unknown error")}}async handleFileChange(t){if(!("path"in t)||t.path.includes("journalit/cache")||this.config.folder&&!t.path.startsWith(this.config.folder)||this.config.extension&&!t.path.endsWith(this.config.extension))return;let r=t.path.split("/"),n=r[r.length-1],a="";if(t.path.includes("/trades/")?a="trade:":t.path.includes("/Accounts/")?a="account:":t.path.includes("/DRC/")?a="drc:":t.path.includes("/Weekly/")&&(a="weekly:"),a){let o=this.config.namespace==="accountPage"&&a==="trade:";(this.config.namespace==="default"||a.startsWith(this.config.namespace)||this.config.namespace===a.replace(":","")||o)&&(await this.clearCacheWithPrefix(a),o&&(await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),await this.clearCacheWithPrefix("allEnhancedAccounts")))}else this.config.namespace==="default"&&(this.isCacheInvalidated=!0,await this.clearCache())}handleError(t){return t instanceof Error?t:new Error("An unknown error occurred")}async clearCache(){this.isCacheInvalidated=!0;let t=`${this.config.namespace}:`;for(let r of this.cache.keys())r.startsWith(t)&&this.cache.delete(r);if(this.config.persistCache)try{let r=this.getCacheFilePath();await this.app.vault.adapter.write(r,JSON.stringify({}))}catch(r){console.warn(`Failed to clear persistent cache for namespace ${this.config.namespace}:`,r instanceof Error?r.message:"Unknown error")}}async clearCacheKey(t){let r=this.getNamespacedKey(t);this.cache.delete(r)&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheWithPrefix(t){let r=this.getNamespacedKey(t),n=!1;for(let a of this.cache.keys())a.startsWith(r)&&(this.cache.delete(a),n=!0);n&&this.config.persistCache&&await this.savePersistentCache()}invalidateCache(){this.isCacheInvalidated=!0}getFiles(){return this.app.vault.getFiles().filter(r=>!(this.config.folder&&!r.path.startsWith(this.config.folder)||this.config.extension&&!r.path.endsWith(this.config.extension)))}registerIndex(t){if(!this.indexManager){console.warn("Index manager not initialized. Enable indexing in service config.");return}this.indexManager.registerIndex(t)}queryIndex(t,r={},n={}){return this.indexManager?this.indexManager.queryIndex(t,r,n):[]}getUniqueIndexValues(t,r){return this.indexManager?this.indexManager.getUniqueValues(t,r):[]}isIndexingEnabled(){return this.config.enableIndexing&&this.indexManager!==null}async readFrontmatter(t){try{let r=this.app.metadataCache.getFileCache(t);if(r!=null&&r.frontmatter)return JSON.parse(JSON.stringify(r.frontmatter));let a=(await this.app.vault.read(t)).match(/^---\n([\s\S]*?)\n---/);if(!a)return{};try{return this.parseYamlFrontmatter(a[1])}catch(o){return console.warn(`Failed to parse frontmatter with advanced parser for ${t.path}:`,o),this.simpleYamlParse(a[1])}}catch(r){return console.error(`Failed to parse frontmatter for ${t.path}:`,r),{}}}parseYamlFrontmatter(t){let r={},n=null,a=null,o=!1,i=[],s=null,l=0,c=t.split(`
`);for(let d=0;d<c.length;d++){let u=c[d];if(!u.trim())continue;let p=u.search(/\S|$/);if(p===0&&u.includes(":")){o&&n&&(r[n]=i,o=!1,i=[]);let[m,h]=this.parseKeyValue(u);if(n=m,h==="")if(d+1<c.length){let f=c[d+1];f.search(/\S|$/)>p||f.trim().startsWith("-")?(o=!1,a=null):(r[m]="",n=null)}else r[m]="",n=null;else if(h==="|"){let f="",b=-1;for(let v=d+1;v<c.length;v++){let y=c[v],g=y.search(/\S|$/);if(g===0&&y.trim()!=="")break;b===-1&&y.trim()!==""&&(b=g),(y.trim()!==""||f!=="")&&(f!==""&&(f+=`
`),f+=y.substring(b)),d=v}r[m]=f.trimEnd(),n=null}else h.startsWith("[")&&h.endsWith("]")?(r[m]=h.slice(1,-1).split(",").map(f=>f.trim()).filter(Boolean),n=null):(h==='""'||h==="''"?r[m]="":r[m]=h,n=null)}else if(u.trim().startsWith("-")&&n){let m=u.indexOf("-");o=!0,l=m;let h=u.substring(m+1).trim();if(!h)s={},i.push(s);else if(h.includes(":")){s={},i.push(s);let[f,b]=this.parseKeyValue(h);s&&(s[f]=b)}else i.push(h),s=null}else if(s&&u.trim().includes(":")&&u.search(/\S|$/)>l){let[m,h]=this.parseKeyValue(u);s[m.trim()]=h}else if(u.includes(":")&&n){let[m,h]=this.parseKeyValue(u);(typeof r[n]!="object"||r[n]===null)&&(r[n]={}),r[n][m.trim()]=h}}return o&&n&&(r[n]=i),r}parseKeyValue(t){let r=t.indexOf(":");if(r===-1)return[t.trim(),""];let n=t.slice(0,r).trim(),a=t.slice(r+1).trim();return[n,a]}simpleYamlParse(t){let r={};return t.split(`
`).forEach(n=>{if(!n.trim())return;let a=n.indexOf(":");if(a===-1)return;let o=n.slice(0,a).trim(),i=n.slice(a+1).trim();if(i.startsWith("[")&&i.endsWith("]"))r[o]=i.slice(1,-1).split(",").map(s=>s.trim()).filter(Boolean);else if(n.startsWith("  ")&&o.startsWith("  ")){let s=Object.keys(r).pop();s&&!Array.isArray(r[s])&&(typeof r[s]!="object"&&(r[s]={}),r[s][o.trim()]=i)}else r[o]=i}),r}async updateFrontmatter(t,r){try{let n=await this.app.vault.read(t);if(!n.match(/^---\n([\s\S]*?)\n---/)){let d=`---
${this.generateFrontmatter(r)}
---

${n}`;await this.app.vault.modify(t,d),await Wt(this.app,t);return}let i={...await this.readFrontmatter(t),...r},s=this.generateFrontmatter(i),l=n.replace(/^---\n[\s\S]*?\n---/,`---
${s}
---`);await this.app.vault.modify(t,l),await Wt(this.app,t)}catch(n){throw console.error(`Failed to update frontmatter for ${t.path}:`,n),new Error(`Failed to update frontmatter: ${n instanceof Error?n.message:String(n)}`)}}generateFrontmatter(t){let r=[];for(let[n,a]of Object.entries(t))if(a!=null)if(Array.isArray(a)&&(a.length===0||typeof a[0]!="object")){if(a.length===0)r.push(`${n}: []`);else{let o=a.map(i=>typeof i=="string"?JSON.stringify(i):String(i)).join(", ");r.push(`${n}: [${o}]`)}continue}else if(Array.isArray(a)&&typeof a[0]=="object"){let o=`${n}:`;a.forEach(i=>{o+=`
  - `;let s=Object.entries(i);if(s.length>0){let[l,c]=s[0],d=typeof c=="string"?JSON.stringify(c):c;o+=`${l}: ${d}`;for(let u=1;u<s.length;u++){let[p,m]=s[u],h=typeof m=="string"?JSON.stringify(m):m;o+=`
    ${p}: ${h}`}}}),r.push(o);continue}else if(typeof a=="object"&&a!==null){let o=Object.entries(a).map(([i,s])=>{let l=typeof s=="string"?JSON.stringify(s):s;return`  ${i}: ${l}`}).join(`
`);r.push(`${n}:
${o}`);continue}else{if(n==="thesis"&&typeof a=="string"){r.push(`${n}: ${a}`);continue}if(n==="tradeStatus"&&typeof a=="string"){r.push(`${n}: ${a}`);continue}if(typeof a=="string"&&a.includes(`
`)){let o=a.split(`
`),i=`${n}: |`;o.forEach(s=>{i+=`
  `+s}),r.push(i);continue}if(typeof a=="string"){r.push(`${n}: ${JSON.stringify(a)}`);continue}if(a===""){r.push(`${n}: ""`);continue}r.push(`${n}: ${a}`)}return r.join(`
`)}};bd.DEFAULT_CACHE_TTL=5*60*1e3,bd.sharedIndexManager=null;si=bd});function _E(){var e,t,r,n;if(typeof window!="undefined")try{let a=window.journalitPlugin||((t=(e=app==null?void 0:app.plugins)==null?void 0:e.plugins)==null?void 0:t.journalit);if((n=(r=a==null?void 0:a.settings)==null?void 0:r.backendIntegration)!=null&&n.serverUrl)return a.settings.backendIntegration.serverUrl}catch(a){}return HR}var zE,HR,Le,sc=te(()=>{zE=require("obsidian"),HR="http://91.99.99.169";Le=class{static setAuthToken(t){this.authToken=t}static getAuthToken(){return this.authToken}static requiresAuth(t){return["/api/v1/trades","/api/v1/mt-accounts","/api/v1/obsidian/status","/api/v1/obsidian/register-vault","/api/v1/ftp-users","/api/v1/sync/ftp","/api/v1/telemetry/preferences"].some(n=>t.includes(n))}static getHeaders(t={}){let r={"Content-Type":"application/json","Accept-Language":"en-US",...t};return this.authToken&&this.requiresAuth(t["x-endpoint"]||"")&&(r.Authorization=`Bearer ${this.authToken}`),delete r["x-endpoint"],r}static async makeRequest(t,r={},n="API call",a=0){if(r.method==="GET"||!r.method){let l=this.getCachedResponse(t);if(l!==null)return l}let o={...r.headers,"x-endpoint":t},i=this.getHeaders(o),s={...r,headers:i};return new Promise((l,c)=>{let d={url:t,options:s,context:n,resolve:l,reject:c,retryCount:0,priority:a};this.requestQueue.push(d),this.requestQueue.sort((u,p)=>p.priority-u.priority),this.isProcessingQueue||this.processQueue()})}static async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){let r=Date.now()-this.lastRequestTime;r<this.RATE_LIMIT_DELAY_MS&&await new Promise(a=>setTimeout(a,this.RATE_LIMIT_DELAY_MS-r));let n=this.requestQueue.shift();n&&(this.activeRequests++,this.lastRequestTime=Date.now(),this.executeRequest(n).finally(()=>{this.activeRequests--,this.requestQueue.length>0&&this.processQueue()}))}this.isProcessingQueue=!1}}static async executeRequest(t){var r,n;try{let a=await fetch(t.url,t.options);if(!a.ok){if((a.status===429||a.status>=500)&&t.retryCount<this.MAX_RETRY_ATTEMPTS){await this.retryRequest(t);return}throw new Error(`API Error: ${a.status} ${a.statusText}`)}let o=await a.json();(t.options.method==="GET"||!t.options.method)&&this.setCachedResponse(t.url,o),t.resolve(o)}catch(a){if((r=a.message)!=null&&r.includes("API Error: 400")&&t.context.toLowerCase().includes("verify authentication code")||(n=a.message)!=null&&n.includes("API Error: 429")&&t.context.toLowerCase().includes("verification code")){console.warn(`Auth verification failed (${t.context}):`,a),t.resolve(null);return}t.retryCount<this.MAX_RETRY_ATTEMPTS&&(a.name==="TypeError"||a.message.includes("fetch"))?await this.retryRequest(t):(this.handleError(a,t.context),t.resolve(null))}}static async retryRequest(t){t.retryCount++;let r=this.RETRY_DELAY_BASE_MS*Math.pow(2,t.retryCount-1);await new Promise(n=>setTimeout(n,r)),t.priority+=10,this.requestQueue.unshift(t),this.isProcessingQueue||this.processQueue()}static getCachedResponse(t){let r=this.responseCache.get(t);return r?Date.now()-r.timestamp>this.CACHE_TTL_MS?(this.responseCache.delete(t),null):r.data:null}static setCachedResponse(t,r){if(this.responseCache.set(t,{data:r,timestamp:Date.now()}),this.responseCache.size>100){let n=Array.from(this.responseCache.entries()).sort((a,o)=>a[1].timestamp-o[1].timestamp);for(let a=0;a<20;a++)this.responseCache.delete(n[a][0])}}static handleError(t,r){var a,o;let n=r.toLowerCase();return((a=t.message)!=null&&a.includes("API Error: 401")||(o=t.message)!=null&&o.includes("API Error: 400"))&&(n.includes("vault registration")||n.includes("telemetry"))?(console.warn(`Expected startup API error suppressed (${r}):`,t),null):(t.name==="TypeError"||t.message.includes("fetch")?(new zE.Notice("\u26A0\uFE0F Cannot connect to trading server. Check your internet connection.",5e3),console.warn(`Trading sync offline (${r}):`,t)):(new zE.Notice(`\u274C Trading sync error: ${t.message}`,8e3),console.error(`Trading sync error (${r}):`,t)),null)}static async checkHealth(){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),n=await fetch(`${_E()}/api/v1/health`,{method:"GET",signal:t.signal});return clearTimeout(r),n.ok}catch(t){return!1}}static buildUrl(t,r){let n=new URL(`${_E()}${t}`);return r&&Object.entries(r).forEach(([a,o])=>{o!=null&&n.searchParams.append(a,String(o))}),n.toString()}static clearQueue(){this.requestQueue.forEach(t=>{t.reject(new Error("Request queue cleared"))}),this.requestQueue=[],this.isProcessingQueue=!1}static getQueueStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,cacheSize:this.responseCache.size}}static clearCache(){this.responseCache.clear()}static invalidateCache(t){let r=typeof t=="string"?new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")):t,n=0;for(let[a]of this.responseCache)r.test(a)&&(this.responseCache.delete(a),n++);n>0}};Le.requestQueue=[],Le.activeRequests=0,Le.MAX_CONCURRENT_REQUESTS=3,Le.RATE_LIMIT_DELAY_MS=200,Le.lastRequestTime=0,Le.isProcessingQueue=!1,Le.MAX_RETRY_ATTEMPTS=3,Le.RETRY_DELAY_BASE_MS=1e3,Le.responseCache=new Map,Le.CACHE_TTL_MS=5*60*1e3,Le.authToken=null});function s0(e="email-auth-modal-styles"){if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* === EmailAuthModal base styles ==================== */
    .email-auth-modal { padding: 20px; max-width: 400px; margin: 0 auto; }
    .email-auth-modal h3 { margin: 0 0 16px; font-size: 18px; font-weight: 600; color: var(--text-normal); }
    .modal-description { margin: 0 0 20px; color: var(--text-muted); line-height: 1.4; }
    .modal-field { margin-bottom: 16px; }
    .modal-field label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-normal); }
    .modal-input { width: 100%; padding: 8px 12px; border: 1px solid var(--background-modifier-border); border-radius: 4px; background: var(--background-primary); color: var(--text-normal); font-size: 16px; }
    .modal-input:focus { outline: none; border-color: var(--interactive-accent); box-shadow: 0 0 0 2px var(--interactive-accent-hover); }
    .modal-input:disabled { opacity: 0.6; cursor: not-allowed; }
    .code-input { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 16px; letter-spacing: 2px; text-align: center; }
    .modal-error { margin: 8px 0; padding: 8px 12px; background: var(--background-modifier-error); border: 1px solid var(--text-error); border-radius: 4px; color: var(--text-on-accent, #fff); font-size: 13px; font-weight: 500; text-align: center; }
    .modal-actions { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
    .modal-actions button { flex: 1 1 auto; min-width: 90px; white-space: nowrap; }
    .modal-footer { margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--background-modifier-border); }
    .modal-footer-text { margin: 0; font-size: 12px; color: var(--text-muted); line-height: 1.3; }
    @media (max-width: 600px) {
      .modal-input { font-size: 18px !important; }
    }
    @media (max-width: 480px) {
      .modal-actions { flex-direction: column; }
      .modal-actions button { width: 100%; }
    }
  `,document.head.appendChild(t)}var BE=te(()=>{});var Be,Vm,$E,l0,RE=te(()=>{Be=_(B()),Vm=require("obsidian");yo();ec();sc();BE();$E=({onSuccess:e,onCancel:t,isAuthenticated:r=!1,currentUserEmail:n})=>{let[a,o]=(0,Be.useState)("email"),[i,s]=(0,Be.useState)(""),[l,c]=(0,Be.useState)(""),[d,u]=(0,Be.useState)(!1),[p,m]=(0,Be.useState)(null),[h,f]=(0,Be.useState)(null),[b,v]=(0,Be.useState)(0);(0,Be.useEffect)(()=>{if(h&&a==="code"){let x=setInterval(()=>{let S=Math.floor((Date.now()-h)/1e3),T=Math.max(0,60-S);v(T),T===0&&clearInterval(x)},1e3);return()=>clearInterval(x)}},[h,a]);let y=async()=>{if(!i.trim()){m("Please enter a valid email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.trim())){m("Please enter a valid email address");return}u(!0),m(null);try{let S=await Le.makeRequest(Le.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim()})},"Send verification code",10);if((S==null?void 0:S.status)==="success")o("code"),f(Date.now()),v(60),new Vm.Notice("Verification code sent! Check your email.");else throw new Error((S==null?void 0:S.message)||"Failed to send verification code")}catch(S){console.error("Error sending verification code:",S);let T=S instanceof Error&&S.message.includes("Too Many Requests")?"You have requested too many codes. Please wait 30 minutes and try again.":S instanceof Error?S.message:"Failed to send verification code";m(T)}finally{u(!1)}},g=async()=>{if(!l.trim()){m("Please enter the verification code");return}if(!/^\d{6}$/.test(l.trim())){m("Verification code should be 6 digits");return}u(!0),m(null);try{let x=await Le.makeRequest(Le.buildUrl("/auth/beta/verify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim(),code:l.trim()})},"Verify authentication code",10);if((x==null?void 0:x.status)==="success"&&x.token&&x.user)await e(x.token,x.user),new Vm.Notice("Successfully logged in!");else throw new Error((x==null?void 0:x.message)||"Invalid verification code")}catch(x){console.error("Error verifying code:",x),m(x instanceof Error?x.message:"Failed to verify code")}finally{u(!1)}},w=async()=>{u(!0),m(null);try{let x=await Le.makeRequest(Le.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim()})},"Resend verification code",10);if((x==null?void 0:x.status)==="success")f(Date.now()),v(60),c(""),new Vm.Notice("New verification code sent! Check your email.");else throw new Error((x==null?void 0:x.message)||"Failed to resend verification code")}catch(x){console.error("Error resending verification code:",x),m(x instanceof Error?x.message:"Failed to resend verification code")}finally{u(!1)}},C=()=>{o("email"),c(""),m(null),f(null),v(0)},k=(x,S)=>{x.key==="Enter"&&!d&&S()};return Be.default.createElement("div",{className:"email-auth-modal"},r?Be.default.createElement(Be.default.Fragment,null,Be.default.createElement("h3",null,"Already Logged In"),Be.default.createElement("p",{className:"modal-description"},"You are already logged in",n?` as ${n}`:"","."),Be.default.createElement("div",{className:"modal-actions"},Be.default.createElement(De,{onClick:t,variant:"primary"},"Close"))):Be.default.createElement(Be.default.Fragment,null,Be.default.createElement("h3",null,"Sign In to Journalit"),a==="email"&&Be.default.createElement(Be.default.Fragment,null,Be.default.createElement("p",{className:"modal-description"},"Enter your email address to receive a verification code for access to the private beta."),Be.default.createElement("div",{className:"modal-field"},Be.default.createElement("label",{htmlFor:"email-input"},"Email Address"),Be.default.createElement("input",{id:"email-input",type:"email",value:i,onChange:x=>{s(x.target.value),m(null)},onKeyPress:x=>k(x,y),placeholder:"your.email@example.com",className:"modal-input",disabled:d,autoFocus:!0})),p&&Be.default.createElement("div",{className:"modal-error"},p),Be.default.createElement("div",{className:"modal-actions"},Be.default.createElement(De,{onClick:y,disabled:d||!i.trim(),variant:"primary"},Be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Be.default.createElement(sr,{size:"small",message:""}),d?"Sending...":"Send Verification Code")))),a==="code"&&Be.default.createElement(Be.default.Fragment,null,Be.default.createElement("p",{className:"modal-description"},"We've sent a 6-digit verification code to ",Be.default.createElement("strong",null,i),". Please enter it below to complete your sign-in."),Be.default.createElement("div",{className:"modal-field"},Be.default.createElement("label",{htmlFor:"code-input"},"Verification Code"),Be.default.createElement("input",{id:"code-input",type:"text",value:l,onChange:x=>{let S=x.target.value.replace(/\D/g,"").slice(0,6);c(S),m(null)},onKeyPress:x=>k(x,g),placeholder:"123456",className:"modal-input code-input",disabled:d,autoFocus:!0,maxLength:6})),p&&Be.default.createElement("div",{className:"modal-error"},p),Be.default.createElement("div",{className:"modal-actions"},Be.default.createElement(De,{onClick:g,disabled:d||l.length!==6,variant:"primary"},Be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Be.default.createElement(sr,{size:"small",message:""}),d?"Verifying...":"Verify & Sign In")),b===0&&Be.default.createElement(De,{onClick:w,disabled:d,variant:"secondary"},"Resend Code"),Be.default.createElement(De,{onClick:C,disabled:d,variant:"secondary"},"Back"))),Be.default.createElement("div",{className:"modal-footer"},Be.default.createElement("p",{className:"modal-footer-text"},"Having trouble? The verification code expires in 15 minutes.",a==="code"&&b>0&&Be.default.createElement(Be.default.Fragment,null," You can request a new code in ",b," seconds."),a==="code"&&b===0&&Be.default.createElement(Be.default.Fragment,null," You can now resend the code using the button above."),a==="email"&&Be.default.createElement(Be.default.Fragment,null," Enter your email to receive a verification code.")))))},l0=class extends Vm.Modal{constructor(t,r,n){super(t),this.onSuccess=r,this.onCancel=n}async onOpen(){let{contentEl:t}=this;t.empty(),s0();let r=t.createDiv(),{createRoot:n}=vo();n(r).render(Be.default.createElement($E,{onSuccess:async(o,i)=>{await this.onSuccess(o,i),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}onClose(){let{contentEl:t}=this;t.empty()}}});var JR={};Zs(JR,{accountLinkModalStyles:()=>KR,injectAccountLinkModalStyles:()=>GE,removeAccountLinkModalStyles:()=>YE});function GE(){if(document.getElementById(VE))return;let e=document.createElement("style");e.id=VE,e.textContent=KR,document.head.appendChild(e)}function YE(){let e=document.getElementById(VE);e&&e.remove()}var VE,KR,KE=te(()=>{VE="journalit-account-link-modal-styles",KR=`
  .account-link-modal {
    padding: 16px;
    font-family: var(--font-text);
    color: var(--text-normal);
    min-width: 450px;
  }

  .account-link-modal h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
  }

  .account-link-modal .account-info {
    background-color: var(--background-secondary);
    padding: 12px 16px;
    border-radius: 6px;
    margin-bottom: 20px;
    border: 1px solid var(--background-modifier-border);
  }

  .account-link-modal .account-info p {
    margin: 4px 0;
    font-size: 0.9rem;
  }

  .account-link-modal .account-info strong {
    font-weight: 600;
    margin-right: 8px;
    color: var(--text-muted);
  }

  .account-link-modal .modal-field {
    margin-bottom: 16px;
  }

  .account-link-modal .section-label {
    display: block;
    margin-bottom: 12px;
    font-weight: 500;
    font-size: 0.95rem;
    color: var(--text-normal);
  }

  .account-link-modal .link-option-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .account-link-modal .link-option {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.1s ease;
  }

  .account-link-modal .link-option:hover {
    background-color: var(--background-modifier-hover);
  }

  .account-link-modal .link-option input[type="radio"] {
    margin-right: 10px;
    cursor: pointer;
  }

  .account-link-modal .link-option span {
    flex: 1;
    font-size: 0.9rem;
  }

  .account-link-modal .custom-name-input,
  .account-link-modal .existing-account-select {
    margin-left: 32px;
    margin-top: 8px;
    margin-bottom: 12px;
  }

  .account-link-modal .modal-input,
  .account-link-modal .modal-select {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 0.9rem;
    min-height: 36px;
  }

  .account-link-modal .modal-input:focus,
  .account-link-modal .modal-select:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
    outline: none;
  }

  .account-link-modal .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
  }
`});var $t,QE,v0=te(()=>{$t=[{id:"welcome",title:"Welcome to Journalit",description:"Your journey to better trading begins here"},{id:"goal",title:"What's your goal?",description:"Help us personalize your experience"},{id:"segmentation",title:"Tell us about your trading",description:"Personalize your experience"},{id:"first-action",title:"Create your first trade",description:"Experience the core value immediately"},{id:"authentication",title:"Connect account",description:"Enable advanced features and sync",isOptional:!0,shouldShow:e=>e==="automation"},{id:"ftp-credentials",title:"Setup MT sync",description:"Automatic trade report collection",isOptional:!0,shouldShow:e=>e==="automation"},{id:"completion",title:"You're all set!",description:"Start your trading journey"}],QE=[{id:"create_trade",title:"Create your first Trade note",description:"Document your first trade to get started",completed:!1},{id:"generate_setup",title:"Add at least one Setup",description:"Define your trading strategies",completed:!1},{id:"tag_trade_outcome",title:"Tag a trade as Winner/Loser",description:"Track your trade performance",completed:!1,dependsOn:["create_trade"]},{id:"enable_mt5_sync",title:"Turn on MT5 Auto-Sync (beta free)",description:"Automate your trade data collection",completed:!1,isOptional:!0}]});var sW=de(rA=>{"use strict";Object.defineProperty(rA,Symbol.toStringTag,{value:"Module"});function gZ(e){return e==="__proto__"}rA.isUnsafeProperty=gZ});var aA=de(nA=>{"use strict";Object.defineProperty(nA,Symbol.toStringTag,{value:"Module"});function hZ(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}nA.isDeepKey=hZ});var iA=de(oA=>{"use strict";Object.defineProperty(oA,Symbol.toStringTag,{value:"Module"});function vZ(e){var t;return typeof e=="string"||typeof e=="symbol"?e:Object.is((t=e==null?void 0:e.valueOf)==null?void 0:t.call(e),-0)?"-0":String(e)}oA.toKey=vZ});var P0=de(sA=>{"use strict";Object.defineProperty(sA,Symbol.toStringTag,{value:"Module"});function yZ(e){let t=[],r=e.length;if(r===0)return t;let n=0,a="",o="",i=!1;for(e.charCodeAt(0)===46&&(t.push(""),n++);n<r;){let s=e[n];o?s==="\\"&&n+1<r?(n++,a+=e[n]):s===o?o="":a+=s:i?s==='"'||s==="'"?o=s:s==="]"?(i=!1,t.push(a),a=""):a+=s:s==="["?(i=!0,a&&(t.push(a),a="")):s==="."?a&&(t.push(a),a=""):a+=s,n++}return a&&t.push(a),t}sA.toPath=yZ});var D0=de(cA=>{"use strict";Object.defineProperty(cA,Symbol.toStringTag,{value:"Module"});var lA=sW(),bZ=aA(),xZ=iA(),wZ=P0();function lW(e,t,r){if(e==null)return r;switch(typeof t){case"string":{if(lA.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?bZ.isDeepKey(t)?lW(e,wZ.toPath(t),r):r:n}case"number":case"symbol":{typeof t=="number"&&(t=xZ.toKey(t));let n=e[t];return n===void 0?r:n}default:{if(Array.isArray(t))return SZ(e,t,r);if(Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t),lA.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?r:n}}}function SZ(e,t,r){if(t.length===0)return r;let n=e;for(let a=0;a<t.length;a++){if(n==null||lA.isUnsafeProperty(t[a]))return r;n=n[t[a]]}return n===void 0?r:n}cA.get=lW});var Qm=de((QMe,cW)=>{cW.exports=D0().get});var uW=de(Gt=>{"use strict";var dA=Symbol.for("react.element"),uA=Symbol.for("react.portal"),E0=Symbol.for("react.fragment"),A0=Symbol.for("react.strict_mode"),I0=Symbol.for("react.profiler"),N0=Symbol.for("react.provider"),L0=Symbol.for("react.context"),kZ=Symbol.for("react.server_context"),M0=Symbol.for("react.forward_ref"),O0=Symbol.for("react.suspense"),F0=Symbol.for("react.suspense_list"),j0=Symbol.for("react.memo"),z0=Symbol.for("react.lazy"),CZ=Symbol.for("react.offscreen"),dW;dW=Symbol.for("react.module.reference");function Yi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case dA:switch(e=e.type,e){case E0:case I0:case A0:case O0:case F0:return e;default:switch(e=e&&e.$$typeof,e){case kZ:case L0:case M0:case z0:case j0:case N0:return e;default:return t}}case uA:return t}}}Gt.ContextConsumer=L0;Gt.ContextProvider=N0;Gt.Element=dA;Gt.ForwardRef=M0;Gt.Fragment=E0;Gt.Lazy=z0;Gt.Memo=j0;Gt.Portal=uA;Gt.Profiler=I0;Gt.StrictMode=A0;Gt.Suspense=O0;Gt.SuspenseList=F0;Gt.isAsyncMode=function(){return!1};Gt.isConcurrentMode=function(){return!1};Gt.isContextConsumer=function(e){return Yi(e)===L0};Gt.isContextProvider=function(e){return Yi(e)===N0};Gt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===dA};Gt.isForwardRef=function(e){return Yi(e)===M0};Gt.isFragment=function(e){return Yi(e)===E0};Gt.isLazy=function(e){return Yi(e)===z0};Gt.isMemo=function(e){return Yi(e)===j0};Gt.isPortal=function(e){return Yi(e)===uA};Gt.isProfiler=function(e){return Yi(e)===I0};Gt.isStrictMode=function(e){return Yi(e)===A0};Gt.isSuspense=function(e){return Yi(e)===O0};Gt.isSuspenseList=function(e){return Yi(e)===F0};Gt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===E0||e===I0||e===A0||e===O0||e===F0||e===CZ||typeof e=="object"&&e!==null&&(e.$$typeof===z0||e.$$typeof===j0||e.$$typeof===N0||e.$$typeof===L0||e.$$typeof===M0||e.$$typeof===dW||e.getModuleId!==void 0)};Gt.typeOf=Yi});var mW=de((eOe,pW)=>{"use strict";pW.exports=uW()});var qW=de(KA=>{"use strict";Object.defineProperty(KA,Symbol.toStringTag,{value:"Module"});function tee(e,t){let r=new Map;for(let n=0;n<e.length;n++){let a=e[n],o=t(a);r.has(o)||r.set(o,a)}return Array.from(r.values())}KA.uniqBy=tee});var XA=de(JA=>{"use strict";Object.defineProperty(JA,Symbol.toStringTag,{value:"Module"});function ree(e){return e}JA.identity=ree});var HW=de(QA=>{"use strict";Object.defineProperty(QA,Symbol.toStringTag,{value:"Module"});function nee(e){return Number.isSafeInteger(e)&&e>=0}QA.isLength=nee});var K0=de(ZA=>{"use strict";Object.defineProperty(ZA,Symbol.toStringTag,{value:"Module"});var aee=HW();function oee(e){return e!=null&&typeof e!="function"&&aee.isLength(e.length)}ZA.isArrayLike=oee});var VW=de(eI=>{"use strict";Object.defineProperty(eI,Symbol.toStringTag,{value:"Module"});function iee(e){return typeof e=="object"&&e!==null}eI.isObjectLike=iee});var GW=de(tI=>{"use strict";Object.defineProperty(tI,Symbol.toStringTag,{value:"Module"});var see=K0(),lee=VW();function cee(e){return lee.isObjectLike(e)&&see.isArrayLike(e)}tI.isArrayLikeObject=cee});var YW=de(rI=>{"use strict";Object.defineProperty(rI,Symbol.toStringTag,{value:"Module"});var dee=D0();function uee(e){return function(t){return dee.get(t,e)}}rI.property=uee});var aI=de(nI=>{"use strict";Object.defineProperty(nI,Symbol.toStringTag,{value:"Module"});function pee(e){return e!==null&&(typeof e=="object"||typeof e=="function")}nI.isObject=pee});var iI=de(oI=>{"use strict";Object.defineProperty(oI,Symbol.toStringTag,{value:"Module"});function mee(e){return e==null||typeof e!="object"&&typeof e!="function"}oI.isPrimitive=mee});var J0=de(sI=>{"use strict";Object.defineProperty(sI,Symbol.toStringTag,{value:"Module"});function fee(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}sI.eq=fee});var QW=de(X0=>{"use strict";Object.defineProperty(X0,Symbol.toStringTag,{value:"Module"});var gee=Q0(),hee=aI(),vee=iI(),KW=J0();function yee(e,t,r){return typeof r!="function"?gee.isMatch(e,t):lI(e,t,function n(a,o,i,s,l,c){let d=r(a,o,i,s,l,c);return d!==void 0?!!d:lI(a,o,n,c)},new Map)}function lI(e,t,r,n){if(t===e)return!0;switch(typeof t){case"object":return bee(e,t,r,n);case"function":return Object.keys(t).length>0?lI(e,{...t},r,n):KW.eq(e,t);default:return hee.isObject(e)?typeof t=="string"?t==="":!0:KW.eq(e,t)}}function bee(e,t,r,n){if(t==null)return!0;if(Array.isArray(t))return JW(e,t,r,n);if(t instanceof Map)return xee(e,t,r,n);if(t instanceof Set)return XW(e,t,r,n);let a=Object.keys(t);if(e==null)return a.length===0;if(a.length===0)return!0;if(n&&n.has(t))return n.get(t)===e;n&&n.set(t,e);try{for(let o=0;o<a.length;o++){let i=a[o];if(!vee.isPrimitive(e)&&!(i in e)||t[i]===void 0&&e[i]!==void 0||t[i]===null&&e[i]!==null||!r(e[i],t[i],i,e,t,n))return!1}return!0}finally{n&&n.delete(t)}}function xee(e,t,r,n){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[a,o]of t.entries()){let i=e.get(a);if(r(i,o,a,e,t,n)===!1)return!1}return!0}function JW(e,t,r,n){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let a=new Set;for(let o=0;o<t.length;o++){let i=t[o],s=!1;for(let l=0;l<e.length;l++){if(a.has(l))continue;let c=e[l],d=!1;if(r(c,i,o,e,t,n)&&(d=!0),d){a.add(l),s=!0;break}}if(!s)return!1}return!0}function XW(e,t,r,n){return t.size===0?!0:e instanceof Set?JW([...e],[...t],r,n):!1}X0.isMatchWith=yee;X0.isSetMatch=XW});var Q0=de(cI=>{"use strict";Object.defineProperty(cI,Symbol.toStringTag,{value:"Module"});var wee=QW();function See(e,t){return wee.isMatchWith(e,t,()=>{})}cI.isMatch=See});var uI=de(dI=>{"use strict";Object.defineProperty(dI,Symbol.toStringTag,{value:"Module"});function kee(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}dI.getSymbols=kee});var Z0=de(pI=>{"use strict";Object.defineProperty(pI,Symbol.toStringTag,{value:"Module"});function Cee(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}pI.getTag=Cee});var eS=de(rr=>{"use strict";Object.defineProperty(rr,Symbol.toStringTag,{value:"Module"});var Tee="[object RegExp]",Pee="[object String]",Dee="[object Number]",Eee="[object Boolean]",Aee="[object Arguments]",Iee="[object Symbol]",Nee="[object Date]",Lee="[object Map]",Mee="[object Set]",Oee="[object Array]",Fee="[object Function]",jee="[object ArrayBuffer]",zee="[object Object]",_ee="[object Error]",Bee="[object DataView]",$ee="[object Uint8Array]",Ree="[object Uint8ClampedArray]",Wee="[object Uint16Array]",Uee="[object Uint32Array]",qee="[object BigUint64Array]",Hee="[object Int8Array]",Vee="[object Int16Array]",Gee="[object Int32Array]",Yee="[object BigInt64Array]",Kee="[object Float32Array]",Jee="[object Float64Array]";rr.argumentsTag=Aee;rr.arrayBufferTag=jee;rr.arrayTag=Oee;rr.bigInt64ArrayTag=Yee;rr.bigUint64ArrayTag=qee;rr.booleanTag=Eee;rr.dataViewTag=Bee;rr.dateTag=Nee;rr.errorTag=_ee;rr.float32ArrayTag=Kee;rr.float64ArrayTag=Jee;rr.functionTag=Fee;rr.int16ArrayTag=Vee;rr.int32ArrayTag=Gee;rr.int8ArrayTag=Hee;rr.mapTag=Lee;rr.numberTag=Dee;rr.objectTag=zee;rr.regexpTag=Tee;rr.setTag=Mee;rr.stringTag=Pee;rr.symbolTag=Iee;rr.uint16ArrayTag=Wee;rr.uint32ArrayTag=Uee;rr.uint8ArrayTag=$ee;rr.uint8ClampedArrayTag=Ree});var ZW=de(mI=>{"use strict";Object.defineProperty(mI,Symbol.toStringTag,{value:"Module"});function Xee(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}mI.isTypedArray=Xee});var fI=de(sy=>{"use strict";Object.defineProperty(sy,Symbol.toStringTag,{value:"Module"});var Qee=uI(),Zee=Z0(),Yr=eS(),ete=iI(),tte=ZW();function rte(e,t){return Bu(e,void 0,e,new Map,t)}function Bu(e,t,r,n=new Map,a=void 0){let o=a==null?void 0:a(e,t,r,n);if(o!=null)return o;if(ete.isPrimitive(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){let i=new Array(e.length);n.set(e,i);for(let s=0;s<e.length;s++)i[s]=Bu(e[s],s,r,n,a);return Object.hasOwn(e,"index")&&(i.index=e.index),Object.hasOwn(e,"input")&&(i.input=e.input),i}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let i=new RegExp(e.source,e.flags);return i.lastIndex=e.lastIndex,i}if(e instanceof Map){let i=new Map;n.set(e,i);for(let[s,l]of e)i.set(s,Bu(l,s,r,n,a));return i}if(e instanceof Set){let i=new Set;n.set(e,i);for(let s of e)i.add(Bu(s,void 0,r,n,a));return i}if(typeof Buffer!="undefined"&&Buffer.isBuffer(e))return e.subarray();if(tte.isTypedArray(e)){let i=new(Object.getPrototypeOf(e)).constructor(e.length);n.set(e,i);for(let s=0;s<e.length;s++)i[s]=Bu(e[s],s,r,n,a);return i}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer!="undefined"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let i=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,i),pf(i,e,r,n,a),i}if(typeof File!="undefined"&&e instanceof File){let i=new File([e],e.name,{type:e.type});return n.set(e,i),pf(i,e,r,n,a),i}if(e instanceof Blob){let i=new Blob([e],{type:e.type});return n.set(e,i),pf(i,e,r,n,a),i}if(e instanceof Error){let i=new e.constructor;return n.set(e,i),i.message=e.message,i.name=e.name,i.stack=e.stack,i.cause=e.cause,pf(i,e,r,n,a),i}if(typeof e=="object"&&nte(e)){let i=Object.create(Object.getPrototypeOf(e));return n.set(e,i),pf(i,e,r,n,a),i}return e}function pf(e,t,r=e,n,a){let o=[...Object.keys(t),...Qee.getSymbols(t)];for(let i=0;i<o.length;i++){let s=o[i],l=Object.getOwnPropertyDescriptor(e,s);(l==null||l.writable)&&(e[s]=Bu(t[s],s,r,n,a))}}function nte(e){switch(Zee.getTag(e)){case Yr.argumentsTag:case Yr.arrayTag:case Yr.arrayBufferTag:case Yr.dataViewTag:case Yr.booleanTag:case Yr.dateTag:case Yr.float32ArrayTag:case Yr.float64ArrayTag:case Yr.int8ArrayTag:case Yr.int16ArrayTag:case Yr.int32ArrayTag:case Yr.mapTag:case Yr.numberTag:case Yr.objectTag:case Yr.regexpTag:case Yr.setTag:case Yr.stringTag:case Yr.symbolTag:case Yr.uint8ArrayTag:case Yr.uint8ClampedArrayTag:case Yr.uint16ArrayTag:case Yr.uint32ArrayTag:return!0;default:return!1}}sy.cloneDeepWith=rte;sy.cloneDeepWithImpl=Bu;sy.copyProperties=pf});var e5=de(gI=>{"use strict";Object.defineProperty(gI,Symbol.toStringTag,{value:"Module"});var ate=fI();function ote(e){return ate.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}gI.cloneDeep=ote});var t5=de(hI=>{"use strict";Object.defineProperty(hI,Symbol.toStringTag,{value:"Module"});var ite=Q0(),ste=e5();function lte(e){return e=ste.cloneDeep(e),t=>ite.isMatch(t,e)}hI.matches=lte});var r5=de(yI=>{"use strict";Object.defineProperty(yI,Symbol.toStringTag,{value:"Module"});var vI=fI(),tS=eS();function cte(e,t){return vI.cloneDeepWith(e,(r,n,a,o)=>{let i=t==null?void 0:t(r,n,a,o);if(i!=null)return i;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case tS.numberTag:case tS.stringTag:case tS.booleanTag:{let s=new e.constructor(e==null?void 0:e.valueOf());return vI.copyProperties(s,e),s}case tS.argumentsTag:{let s={};return vI.copyProperties(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s}default:return}})}yI.cloneDeepWith=cte});var n5=de(bI=>{"use strict";Object.defineProperty(bI,Symbol.toStringTag,{value:"Module"});var dte=r5();function ute(e){return dte.cloneDeepWith(e)}bI.cloneDeep=ute});var wI=de(xI=>{"use strict";Object.defineProperty(xI,Symbol.toStringTag,{value:"Module"});var pte=/^(?:0|[1-9]\d*)$/;function mte(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return pte.test(e)}}xI.isIndex=mte});var a5=de(SI=>{"use strict";Object.defineProperty(SI,Symbol.toStringTag,{value:"Module"});var fte=Z0();function gte(e){return e!==null&&typeof e=="object"&&fte.getTag(e)==="[object Arguments]"}SI.isArguments=gte});var o5=de(kI=>{"use strict";Object.defineProperty(kI,Symbol.toStringTag,{value:"Module"});var hte=aA(),vte=wI(),yte=a5(),bte=P0();function xte(e,t){let r;if(Array.isArray(t)?r=t:typeof t=="string"&&hte.isDeepKey(t)&&(e==null?void 0:e[t])==null?r=bte.toPath(t):r=[t],r.length===0)return!1;let n=e;for(let a=0;a<r.length;a++){let o=r[a];if((n==null||!Object.hasOwn(n,o))&&!((Array.isArray(n)||yte.isArguments(n))&&vte.isIndex(o)&&o<n.length))return!1;n=n[o]}return!0}kI.has=xte});var i5=de(CI=>{"use strict";Object.defineProperty(CI,Symbol.toStringTag,{value:"Module"});var wte=Q0(),Ste=iA(),kte=n5(),Cte=D0(),Tte=o5();function Pte(e,t){switch(typeof e){case"object":{Object.is(e==null?void 0:e.valueOf(),-0)&&(e="-0");break}case"number":{e=Ste.toKey(e);break}}return t=kte.cloneDeep(t),function(r){let n=Cte.get(r,e);return n===void 0?Tte.has(r,e):t===void 0?n===void 0:wte.isMatch(n,t)}}CI.matchesProperty=Pte});var s5=de(TI=>{"use strict";Object.defineProperty(TI,Symbol.toStringTag,{value:"Module"});var Dte=XA(),Ete=YW(),Ate=t5(),Ite=i5();function Nte(e){if(e==null)return Dte.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&e.length===2?Ite.matchesProperty(e[0],e[1]):Ate.matches(e);case"string":case"symbol":case"number":return Ete.property(e)}}TI.iteratee=Nte});var l5=de(PI=>{"use strict";Object.defineProperty(PI,Symbol.toStringTag,{value:"Module"});var Lte=qW(),Mte=XA(),Ote=GW(),Fte=s5();function jte(e,t=Mte.identity){return Ote.isArrayLikeObject(e)?Lte.uniqBy(Array.from(e),Fte.iteratee(t)):[]}PI.uniqBy=jte});var d5=de((j2e,c5)=>{c5.exports=l5().uniqBy});var m5=de(p5=>{"use strict";var mf=B();function zte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _te=typeof Object.is=="function"?Object.is:zte,Bte=mf.useState,$te=mf.useEffect,Rte=mf.useLayoutEffect,Wte=mf.useDebugValue;function Ute(e,t){var r=t(),n=Bte({inst:{value:r,getSnapshot:t}}),a=n[0].inst,o=n[1];return Rte(function(){a.value=r,a.getSnapshot=t,EI(a)&&o({inst:a})},[e,r,t]),$te(function(){return EI(a)&&o({inst:a}),e(function(){EI(a)&&o({inst:a})})},[e]),Wte(r),r}function EI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_te(e,r)}catch(n){return!0}}function qte(e,t){return t()}var Hte=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?qte:Ute;p5.useSyncExternalStore=mf.useSyncExternalStore!==void 0?mf.useSyncExternalStore:Hte});var g5=de((B2e,f5)=>{"use strict";f5.exports=m5()});var v5=de(h5=>{"use strict";var rS=B(),Vte=g5();function Gte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yte=typeof Object.is=="function"?Object.is:Gte,Kte=Vte.useSyncExternalStore,Jte=rS.useRef,Xte=rS.useEffect,Qte=rS.useMemo,Zte=rS.useDebugValue;h5.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var o=Jte(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=Qte(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),a!==void 0&&i.hasValue){var h=i.value;if(a(h,m))return u=h}return u=m}if(h=u,Yte(d,m))return h;var f=n(m);return a!==void 0&&a(h,f)?(d=m,h):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,a]);var s=Kte(e,o[0],o[1]);return Xte(function(){i.hasValue=!0,i.value=s},[s]),Zte(s),s}});var b5=de((R2e,y5)=>{"use strict";y5.exports=v5()});var P5=de(II=>{"use strict";Object.defineProperty(II,Symbol.toStringTag,{value:"Module"});function T5(e){return typeof e=="symbol"?1:e===null?2:e===void 0?3:e!==e?4:0}var mre=(e,t,r)=>{if(e!==t){let n=T5(e),a=T5(t);if(n===a&&n===0){if(e<t)return r==="desc"?1:-1;if(e>t)return r==="desc"?-1:1}return r==="desc"?a-n:n-a}return 0};II.compareValues=mre});var LI=de(NI=>{"use strict";Object.defineProperty(NI,Symbol.toStringTag,{value:"Module"});function fre(e){return typeof e=="symbol"||e instanceof Symbol}NI.isSymbol=fre});var D5=de(MI=>{"use strict";Object.defineProperty(MI,Symbol.toStringTag,{value:"Module"});var gre=LI(),hre=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vre=/^\w*$/;function yre(e,t){return Array.isArray(e)?!1:typeof e=="number"||typeof e=="boolean"||e==null||gre.isSymbol(e)?!0:typeof e=="string"&&(vre.test(e)||!hre.test(e))||t!=null&&Object.hasOwn(t,e)}MI.isKey=yre});var E5=de(OI=>{"use strict";Object.defineProperty(OI,Symbol.toStringTag,{value:"Module"});var bre=P5(),xre=D5(),wre=P0();function Sre(e,t,r,n){if(e==null)return[];r=n?void 0:r,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=t==null?[null]:[t]),t.length===0&&(t=[null]),Array.isArray(r)||(r=r==null?[]:[r]),r=r.map(l=>String(l));let a=(l,c)=>{let d=l;for(let u=0;u<c.length&&d!=null;++u)d=d[c[u]];return d},o=(l,c)=>c==null||l==null?c:typeof l=="object"&&"key"in l?Object.hasOwn(c,l.key)?c[l.key]:a(c,l.path):typeof l=="function"?l(c):Array.isArray(l)?a(c,l):typeof c=="object"?c[l]:c,i=t.map(l=>(Array.isArray(l)&&l.length===1&&(l=l[0]),l==null||typeof l=="function"||Array.isArray(l)||xre.isKey(l)?l:{key:l,path:wre.toPath(l)}));return e.map(l=>({original:l,criteria:i.map(c=>o(c,l))})).slice().sort((l,c)=>{for(let d=0;d<i.length;d++){let u=bre.compareValues(l.criteria[d],c.criteria[d],r[d]);if(u!==0)return u}return 0}).map(l=>l.original)}OI.orderBy=Sre});var A5=de(FI=>{"use strict";Object.defineProperty(FI,Symbol.toStringTag,{value:"Module"});function kre(e,t=1){let r=[],n=Math.floor(t),a=(o,i)=>{for(let s=0;s<o.length;s++){let l=o[s];Array.isArray(l)&&i<n?a(l,i+1):r.push(l)}};return a(e,0),r}FI.flatten=kre});var zI=de(jI=>{"use strict";Object.defineProperty(jI,Symbol.toStringTag,{value:"Module"});var Cre=wI(),Tre=K0(),Pre=aI(),Dre=J0();function Ere(e,t,r){return Pre.isObject(r)&&(typeof t=="number"&&Tre.isArrayLike(r)&&Cre.isIndex(t)&&t<r.length||typeof t=="string"&&t in r)?Dre.eq(r[t],e):!1}jI.isIterateeCall=Ere});var N5=de(_I=>{"use strict";Object.defineProperty(_I,Symbol.toStringTag,{value:"Module"});var Are=E5(),Ire=A5(),I5=zI();function Nre(e,...t){let r=t.length;return r>1&&I5.isIterateeCall(e,t[0],t[1])?t=[]:r>2&&I5.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),Are.orderBy(e,Ire.flatten(t),["asc"])}_I.sortBy=Nre});var cy=de((nje,L5)=>{L5.exports=N5().sortBy});var v3=de(mN=>{"use strict";Object.defineProperty(mN,Symbol.toStringTag,{value:"Module"});function Pae(e){if(!e||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}mN.isPlainObject=Pae});var w3=de(fN=>{"use strict";Object.defineProperty(fN,Symbol.toStringTag,{value:"Module"});var y3=v3(),b3=uI(),x3=Z0(),Yt=eS(),Dae=J0();function Eae(e,t,r){return xy(e,t,void 0,void 0,void 0,void 0,r)}function xy(e,t,r,n,a,o,i){let s=i(e,t,r,n,a,o);if(s!==void 0)return s;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return wy(e,t,o,i)}return wy(e,t,o,i)}function wy(e,t,r,n){if(Object.is(e,t))return!0;let a=x3.getTag(e),o=x3.getTag(t);if(a===Yt.argumentsTag&&(a=Yt.objectTag),o===Yt.argumentsTag&&(o=Yt.objectTag),a!==o)return!1;switch(a){case Yt.stringTag:return e.toString()===t.toString();case Yt.numberTag:{let l=e.valueOf(),c=t.valueOf();return Dae.eq(l,c)}case Yt.booleanTag:case Yt.dateTag:case Yt.symbolTag:return Object.is(e.valueOf(),t.valueOf());case Yt.regexpTag:return e.source===t.source&&e.flags===t.flags;case Yt.functionTag:return e===t}r=r!=null?r:new Map;let i=r.get(e),s=r.get(t);if(i!=null&&s!=null)return i===t;r.set(e,t),r.set(t,e);try{switch(a){case Yt.mapTag:{if(e.size!==t.size)return!1;for(let[l,c]of e.entries())if(!t.has(l)||!xy(c,t.get(l),l,e,t,r,n))return!1;return!0}case Yt.setTag:{if(e.size!==t.size)return!1;let l=Array.from(e.values()),c=Array.from(t.values());for(let d=0;d<l.length;d++){let u=l[d],p=c.findIndex(m=>xy(u,m,void 0,e,t,r,n));if(p===-1)return!1;c.splice(p,1)}return!0}case Yt.arrayTag:case Yt.uint8ArrayTag:case Yt.uint8ClampedArrayTag:case Yt.uint16ArrayTag:case Yt.uint32ArrayTag:case Yt.bigUint64ArrayTag:case Yt.int8ArrayTag:case Yt.int16ArrayTag:case Yt.int32ArrayTag:case Yt.bigInt64ArrayTag:case Yt.float32ArrayTag:case Yt.float64ArrayTag:{if(typeof Buffer!="undefined"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let l=0;l<e.length;l++)if(!xy(e[l],t[l],l,e,t,r,n))return!1;return!0}case Yt.arrayBufferTag:return e.byteLength!==t.byteLength?!1:wy(new Uint8Array(e),new Uint8Array(t),r,n);case Yt.dataViewTag:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:wy(new Uint8Array(e),new Uint8Array(t),r,n);case Yt.errorTag:return e.name===t.name&&e.message===t.message;case Yt.objectTag:{if(!(wy(e.constructor,t.constructor,r,n)||y3.isPlainObject(e)&&y3.isPlainObject(t)))return!1;let c=[...Object.keys(e),...b3.getSymbols(e)],d=[...Object.keys(t),...b3.getSymbols(t)];if(c.length!==d.length)return!1;for(let u=0;u<c.length;u++){let p=c[u],m=e[p];if(!Object.hasOwn(t,p))return!1;let h=t[p];if(!xy(m,h,p,e,t,r,n))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}fN.isEqualWith=Eae});var S3=de(gN=>{"use strict";Object.defineProperty(gN,Symbol.toStringTag,{value:"Module"});function Aae(){}gN.noop=Aae});var k3=de(hN=>{"use strict";Object.defineProperty(hN,Symbol.toStringTag,{value:"Module"});var Iae=w3(),Nae=S3();function Lae(e,t){return Iae.isEqualWith(e,t,Nae.noop)}hN.isEqual=Lae});var T3=de((Hze,C3)=>{C3.exports=k3().isEqual});var H3=de(wN=>{"use strict";Object.defineProperty(wN,Symbol.toStringTag,{value:"Module"});var toe=LI();function roe(e){return toe.isSymbol(e)?NaN:Number(e)}wN.toNumber=roe});var V3=de(SN=>{"use strict";Object.defineProperty(SN,Symbol.toStringTag,{value:"Module"});var noe=H3();function aoe(e){return e?(e=noe.toNumber(e),e===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e===e?e:0):e===0?e:0}SN.toFinite=aoe});var G3=de(CN=>{"use strict";Object.defineProperty(CN,Symbol.toStringTag,{value:"Module"});var ooe=zI(),kN=V3();function ioe(e,t,r){r&&typeof r!="number"&&ooe.isIterateeCall(e,t,r)&&(t=r=void 0),e=kN.toFinite(e),t===void 0?(t=e,e=0):t=kN.toFinite(t),r=r===void 0?e<t?1:-1:kN.toFinite(r);let n=Math.max(Math.ceil((t-e)/(r||1)),0),a=new Array(n);for(let o=0;o<n;o++)a[o]=e,e+=r;return a}CN.range=ioe});var K3=de((k_e,Y3)=>{Y3.exports=G3().range});var iL=de((wU,Ck)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,a="[DecimalError] ",o=a+"Invalid argument: ",i=a+"Exponent out of range: ",s=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d,u=1e7,p=7,m=9007199254740991,h=s(m/p),f={};f.absoluteValue=f.abs=function(){var E=new this.constructor(this);return E.s&&(E.s=1),E},f.comparedTo=f.cmp=function(E){var I,O,j,$,F=this;if(E=new F.constructor(E),F.s!==E.s)return F.s||-E.s;if(F.e!==E.e)return F.e>E.e^F.s<0?1:-1;for(j=F.d.length,$=E.d.length,I=0,O=j<$?j:$;I<O;++I)if(F.d[I]!==E.d[I])return F.d[I]>E.d[I]^F.s<0?1:-1;return j===$?0:j>$^F.s<0?1:-1},f.decimalPlaces=f.dp=function(){var E=this,I=E.d.length-1,O=(I-E.e)*p;if(I=E.d[I],I)for(;I%10==0;I/=10)O--;return O<0?0:O},f.dividedBy=f.div=function(E){return g(this,new this.constructor(E))},f.dividedToIntegerBy=f.idiv=function(E){var I=this,O=I.constructor;return P(g(I,new O(E),0,1),O.precision)},f.equals=f.eq=function(E){return!this.cmp(E)},f.exponent=function(){return C(this)},f.greaterThan=f.gt=function(E){return this.cmp(E)>0},f.greaterThanOrEqualTo=f.gte=function(E){return this.cmp(E)>=0},f.isInteger=f.isint=function(){return this.e>this.d.length-2},f.isNegative=f.isneg=function(){return this.s<0},f.isPositive=f.ispos=function(){return this.s>0},f.isZero=function(){return this.s===0},f.lessThan=f.lt=function(E){return this.cmp(E)<0},f.lessThanOrEqualTo=f.lte=function(E){return this.cmp(E)<1},f.logarithm=f.log=function(E){var I,O=this,j=O.constructor,$=j.precision,F=$+5;if(E===void 0)E=new j(10);else if(E=new j(E),E.s<1||E.eq(d))throw Error(a+"NaN");if(O.s<1)throw Error(a+(O.s?"NaN":"-Infinity"));return O.eq(d)?new j(0):(n=!1,I=g(S(O,F),S(E,F),F),n=!0,P(I,$))},f.minus=f.sub=function(E){var I=this;return E=new I.constructor(E),I.s==E.s?M(I,E):b(I,(E.s=-E.s,E))},f.modulo=f.mod=function(E){var I,O=this,j=O.constructor,$=j.precision;if(E=new j(E),!E.s)throw Error(a+"NaN");return O.s?(n=!1,I=g(O,E,0,1).times(E),n=!0,O.minus(I)):P(new j(O),$)},f.naturalExponential=f.exp=function(){return w(this)},f.naturalLogarithm=f.ln=function(){return S(this)},f.negated=f.neg=function(){var E=new this.constructor(this);return E.s=-E.s||0,E},f.plus=f.add=function(E){var I=this;return E=new I.constructor(E),I.s==E.s?b(I,E):M(I,(E.s=-E.s,E))},f.precision=f.sd=function(E){var I,O,j,$=this;if(E!==void 0&&E!==!!E&&E!==1&&E!==0)throw Error(o+E);if(I=C($)+1,j=$.d.length-1,O=j*p+1,j=$.d[j],j){for(;j%10==0;j/=10)O--;for(j=$.d[0];j>=10;j/=10)O++}return E&&I>O?I:O},f.squareRoot=f.sqrt=function(){var E,I,O,j,$,F,z,W=this,U=W.constructor;if(W.s<1){if(!W.s)return new U(0);throw Error(a+"NaN")}for(E=C(W),n=!1,$=Math.sqrt(+W),$==0||$==1/0?(I=y(W.d),(I.length+E)%2==0&&(I+="0"),$=Math.sqrt(I),E=s((E+1)/2)-(E<0||E%2),$==1/0?I="5e"+E:(I=$.toExponential(),I=I.slice(0,I.indexOf("e")+1)+E),j=new U(I)):j=new U($.toString()),O=U.precision,$=z=O+3;;)if(F=j,j=F.plus(g(W,F,z+2)).times(.5),y(F.d).slice(0,z)===(I=y(j.d)).slice(0,z)){if(I=I.slice(z-3,z+1),$==z&&I=="4999"){if(P(F,O+1,0),F.times(F).eq(W)){j=F;break}}else if(I!="9999")break;z+=4}return n=!0,P(j,O)},f.times=f.mul=function(E){var I,O,j,$,F,z,W,U,K,R=this,q=R.constructor,X=R.d,G=(E=new q(E)).d;if(!R.s||!E.s)return new q(0);for(E.s*=R.s,O=R.e+E.e,U=X.length,K=G.length,U<K&&(F=X,X=G,G=F,z=U,U=K,K=z),F=[],z=U+K,j=z;j--;)F.push(0);for(j=K;--j>=0;){for(I=0,$=U+j;$>j;)W=F[$]+G[j]*X[$-j-1]+I,F[$--]=W%u|0,I=W/u|0;F[$]=(F[$]+I)%u|0}for(;!F[--z];)F.pop();return I?++O:F.shift(),E.d=F,E.e=O,n?P(E,q.precision):E},f.toDecimalPlaces=f.todp=function(E,I){var O=this,j=O.constructor;return O=new j(O),E===void 0?O:(v(E,0,t),I===void 0?I=j.rounding:v(I,0,8),P(O,E+C(O)+1,I))},f.toExponential=function(E,I){var O,j=this,$=j.constructor;return E===void 0?O=D(j,!0):(v(E,0,t),I===void 0?I=$.rounding:v(I,0,8),j=P(new $(j),E+1,I),O=D(j,!0,E+1)),O},f.toFixed=function(E,I){var O,j,$=this,F=$.constructor;return E===void 0?D($):(v(E,0,t),I===void 0?I=F.rounding:v(I,0,8),j=P(new F($),E+C($)+1,I),O=D(j.abs(),!1,E+C(j)+1),$.isneg()&&!$.isZero()?"-"+O:O)},f.toInteger=f.toint=function(){var E=this,I=E.constructor;return P(new I(E),C(E)+1,I.rounding)},f.toNumber=function(){return+this},f.toPower=f.pow=function(E){var I,O,j,$,F,z,W=this,U=W.constructor,K=12,R=+(E=new U(E));if(!E.s)return new U(d);if(W=new U(W),!W.s){if(E.s<1)throw Error(a+"Infinity");return W}if(W.eq(d))return W;if(j=U.precision,E.eq(d))return P(W,j);if(I=E.e,O=E.d.length-1,z=I>=O,F=W.s,z){if((O=R<0?-R:R)<=m){for($=new U(d),I=Math.ceil(j/p+4),n=!1;O%2&&($=$.times(W),A($.d,I)),O=s(O/2),O!==0;)W=W.times(W),A(W.d,I);return n=!0,E.s<0?new U(d).div($):P($,j)}}else if(F<0)throw Error(a+"NaN");return F=F<0&&E.d[Math.max(I,O)]&1?-1:1,W.s=1,n=!1,$=E.times(S(W,j+K)),n=!0,$=w($),$.s=F,$},f.toPrecision=function(E,I){var O,j,$=this,F=$.constructor;return E===void 0?(O=C($),j=D($,O<=F.toExpNeg||O>=F.toExpPos)):(v(E,1,t),I===void 0?I=F.rounding:v(I,0,8),$=P(new F($),E,I),O=C($),j=D($,E<=O||O<=F.toExpNeg,E)),j},f.toSignificantDigits=f.tosd=function(E,I){var O=this,j=O.constructor;return E===void 0?(E=j.precision,I=j.rounding):(v(E,1,t),I===void 0?I=j.rounding:v(I,0,8)),P(new j(O),E,I)},f.toString=f.valueOf=f.val=f.toJSON=function(){var E=this,I=C(E),O=E.constructor;return D(E,I<=O.toExpNeg||I>=O.toExpPos)};function b(E,I){var O,j,$,F,z,W,U,K,R=E.constructor,q=R.precision;if(!E.s||!I.s)return I.s||(I=new R(E)),n?P(I,q):I;if(U=E.d,K=I.d,z=E.e,$=I.e,U=U.slice(),F=z-$,F){for(F<0?(j=U,F=-F,W=K.length):(j=K,$=z,W=U.length),z=Math.ceil(q/p),W=z>W?z+1:W+1,F>W&&(F=W,j.length=1),j.reverse();F--;)j.push(0);j.reverse()}for(W=U.length,F=K.length,W-F<0&&(F=W,j=K,K=U,U=j),O=0;F;)O=(U[--F]=U[F]+K[F]+O)/u|0,U[F]%=u;for(O&&(U.unshift(O),++$),W=U.length;U[--W]==0;)U.pop();return I.d=U,I.e=$,n?P(I,q):I}function v(E,I,O){if(E!==~~E||E<I||E>O)throw Error(o+E)}function y(E){var I,O,j,$=E.length-1,F="",z=E[0];if($>0){for(F+=z,I=1;I<$;I++)j=E[I]+"",O=p-j.length,O&&(F+=x(O)),F+=j;z=E[I],j=z+"",O=p-j.length,O&&(F+=x(O))}else if(z===0)return"0";for(;z%10===0;)z/=10;return F+z}var g=function(){function E(j,$){var F,z=0,W=j.length;for(j=j.slice();W--;)F=j[W]*$+z,j[W]=F%u|0,z=F/u|0;return z&&j.unshift(z),j}function I(j,$,F,z){var W,U;if(F!=z)U=F>z?1:-1;else for(W=U=0;W<F;W++)if(j[W]!=$[W]){U=j[W]>$[W]?1:-1;break}return U}function O(j,$,F){for(var z=0;F--;)j[F]-=z,z=j[F]<$[F]?1:0,j[F]=z*u+j[F]-$[F];for(;!j[0]&&j.length>1;)j.shift()}return function(j,$,F,z){var W,U,K,R,q,X,G,H,Y,V,Q,Z,se,ie,Se,qe,ht,ft,it=j.constructor,Tn=j.s==$.s?1:-1,hr=j.d,kt=$.d;if(!j.s)return new it(j);if(!$.s)throw Error(a+"Division by zero");for(U=j.e-$.e,ht=kt.length,Se=hr.length,G=new it(Tn),H=G.d=[],K=0;kt[K]==(hr[K]||0);)++K;if(kt[K]>(hr[K]||0)&&--U,F==null?Z=F=it.precision:z?Z=F+(C(j)-C($))+1:Z=F,Z<0)return new it(0);if(Z=Z/p+2|0,K=0,ht==1)for(R=0,kt=kt[0],Z++;(K<Se||R)&&Z--;K++)se=R*u+(hr[K]||0),H[K]=se/kt|0,R=se%kt|0;else{for(R=u/(kt[0]+1)|0,R>1&&(kt=E(kt,R),hr=E(hr,R),ht=kt.length,Se=hr.length),ie=ht,Y=hr.slice(0,ht),V=Y.length;V<ht;)Y[V++]=0;ft=kt.slice(),ft.unshift(0),qe=kt[0],kt[1]>=u/2&&++qe;do R=0,W=I(kt,Y,ht,V),W<0?(Q=Y[0],ht!=V&&(Q=Q*u+(Y[1]||0)),R=Q/qe|0,R>1?(R>=u&&(R=u-1),q=E(kt,R),X=q.length,V=Y.length,W=I(q,Y,X,V),W==1&&(R--,O(q,ht<X?ft:kt,X))):(R==0&&(W=R=1),q=kt.slice()),X=q.length,X<V&&q.unshift(0),O(Y,q,V),W==-1&&(V=Y.length,W=I(kt,Y,ht,V),W<1&&(R++,O(Y,ht<V?ft:kt,V))),V=Y.length):W===0&&(R++,Y=[0]),H[K++]=R,W&&Y[0]?Y[V++]=hr[ie]||0:(Y=[hr[ie]],V=1);while((ie++<Se||Y[0]!==void 0)&&Z--)}return H[0]||H.shift(),G.e=U,P(G,z?F+C(G)+1:F)}}();function w(E,I){var O,j,$,F,z,W,U=0,K=0,R=E.constructor,q=R.precision;if(C(E)>16)throw Error(i+C(E));if(!E.s)return new R(d);for(I==null?(n=!1,W=q):W=I,z=new R(.03125);E.abs().gte(.1);)E=E.times(z),K+=5;for(j=Math.log(l(2,K))/Math.LN10*2+5|0,W+=j,O=$=F=new R(d),R.precision=W;;){if($=P($.times(E),W),O=O.times(++U),z=F.plus(g($,O,W)),y(z.d).slice(0,W)===y(F.d).slice(0,W)){for(;K--;)F=P(F.times(F),W);return R.precision=q,I==null?(n=!0,P(F,q)):F}F=z}}function C(E){for(var I=E.e*p,O=E.d[0];O>=10;O/=10)I++;return I}function k(E,I,O){if(I>E.LN10.sd())throw n=!0,O&&(E.precision=O),Error(a+"LN10 precision limit exceeded");return P(new E(E.LN10),I)}function x(E){for(var I="";E--;)I+="0";return I}function S(E,I){var O,j,$,F,z,W,U,K,R,q=1,X=10,G=E,H=G.d,Y=G.constructor,V=Y.precision;if(G.s<1)throw Error(a+(G.s?"NaN":"-Infinity"));if(G.eq(d))return new Y(0);if(I==null?(n=!1,K=V):K=I,G.eq(10))return I==null&&(n=!0),k(Y,K);if(K+=X,Y.precision=K,O=y(H),j=O.charAt(0),F=C(G),Math.abs(F)<15e14){for(;j<7&&j!=1||j==1&&O.charAt(1)>3;)G=G.times(E),O=y(G.d),j=O.charAt(0),q++;F=C(G),j>1?(G=new Y("0."+O),F++):G=new Y(j+"."+O.slice(1))}else return U=k(Y,K+2,V).times(F+""),G=S(new Y(j+"."+O.slice(1)),K-X).plus(U),Y.precision=V,I==null?(n=!0,P(G,V)):G;for(W=z=G=g(G.minus(d),G.plus(d),K),R=P(G.times(G),K),$=3;;){if(z=P(z.times(R),K),U=W.plus(g(z,new Y($),K)),y(U.d).slice(0,K)===y(W.d).slice(0,K))return W=W.times(2),F!==0&&(W=W.plus(k(Y,K+2,V).times(F+""))),W=g(W,new Y(q),K),Y.precision=V,I==null?(n=!0,P(W,V)):W;W=U,$+=2}}function T(E,I){var O,j,$;for((O=I.indexOf("."))>-1&&(I=I.replace(".","")),(j=I.search(/e/i))>0?(O<0&&(O=j),O+=+I.slice(j+1),I=I.substring(0,j)):O<0&&(O=I.length),j=0;I.charCodeAt(j)===48;)++j;for($=I.length;I.charCodeAt($-1)===48;)--$;if(I=I.slice(j,$),I){if($-=j,O=O-j-1,E.e=s(O/p),E.d=[],j=(O+1)%p,O<0&&(j+=p),j<$){for(j&&E.d.push(+I.slice(0,j)),$-=p;j<$;)E.d.push(+I.slice(j,j+=p));I=I.slice(j),j=p-I.length}else j-=$;for(;j--;)I+="0";if(E.d.push(+I),n&&(E.e>h||E.e<-h))throw Error(i+O)}else E.s=0,E.e=0,E.d=[0];return E}function P(E,I,O){var j,$,F,z,W,U,K,R,q=E.d;for(z=1,F=q[0];F>=10;F/=10)z++;if(j=I-z,j<0)j+=p,$=I,K=q[R=0];else{if(R=Math.ceil((j+1)/p),F=q.length,R>=F)return E;for(K=F=q[R],z=1;F>=10;F/=10)z++;j%=p,$=j-p+z}if(O!==void 0&&(F=l(10,z-$-1),W=K/F%10|0,U=I<0||q[R+1]!==void 0||K%F,U=O<4?(W||U)&&(O==0||O==(E.s<0?3:2)):W>5||W==5&&(O==4||U||O==6&&(j>0?$>0?K/l(10,z-$):0:q[R-1])%10&1||O==(E.s<0?8:7))),I<1||!q[0])return U?(F=C(E),q.length=1,I=I-F-1,q[0]=l(10,(p-I%p)%p),E.e=s(-I/p)||0):(q.length=1,q[0]=E.e=E.s=0),E;if(j==0?(q.length=R,F=1,R--):(q.length=R+1,F=l(10,p-j),q[R]=$>0?(K/l(10,z-$)%l(10,$)|0)*F:0),U)for(;;)if(R==0){(q[0]+=F)==u&&(q[0]=1,++E.e);break}else{if(q[R]+=F,q[R]!=u)break;q[R--]=0,F=1}for(j=q.length;q[--j]===0;)q.pop();if(n&&(E.e>h||E.e<-h))throw Error(i+C(E));return E}function M(E,I){var O,j,$,F,z,W,U,K,R,q,X=E.constructor,G=X.precision;if(!E.s||!I.s)return I.s?I.s=-I.s:I=new X(E),n?P(I,G):I;if(U=E.d,q=I.d,j=I.e,K=E.e,U=U.slice(),z=K-j,z){for(R=z<0,R?(O=U,z=-z,W=q.length):(O=q,j=K,W=U.length),$=Math.max(Math.ceil(G/p),W)+2,z>$&&(z=$,O.length=1),O.reverse(),$=z;$--;)O.push(0);O.reverse()}else{for($=U.length,W=q.length,R=$<W,R&&(W=$),$=0;$<W;$++)if(U[$]!=q[$]){R=U[$]<q[$];break}z=0}for(R&&(O=U,U=q,q=O,I.s=-I.s),W=U.length,$=q.length-W;$>0;--$)U[W++]=0;for($=q.length;$>z;){if(U[--$]<q[$]){for(F=$;F&&U[--F]===0;)U[F]=u-1;--U[F],U[$]+=u}U[$]-=q[$]}for(;U[--W]===0;)U.pop();for(;U[0]===0;U.shift())--j;return U[0]?(I.d=U,I.e=j,n?P(I,G):I):new X(0)}function D(E,I,O){var j,$=C(E),F=y(E.d),z=F.length;return I?(O&&(j=O-z)>0?F=F.charAt(0)+"."+F.slice(1)+x(j):z>1&&(F=F.charAt(0)+"."+F.slice(1)),F=F+($<0?"e":"e+")+$):$<0?(F="0."+x(-$-1)+F,O&&(j=O-z)>0&&(F+=x(j))):$>=z?(F+=x($+1-z),O&&(j=O-$-1)>0&&(F=F+"."+x(j))):((j=$+1)<z&&(F=F.slice(0,j)+"."+F.slice(j)),O&&(j=O-z)>0&&($+1===z&&(F+="."),F+=x(j))),E.s<0?"-"+F:F}function A(E,I){if(E.length>I)return E.length=I,!0}function L(E){var I,O,j;function $(F){var z=this;if(!(z instanceof $))return new $(F);if(z.constructor=$,F instanceof $){z.s=F.s,z.e=F.e,z.d=(F=F.d)?F.slice():F;return}if(typeof F=="number"){if(F*0!==0)throw Error(o+F);if(F>0)z.s=1;else if(F<0)F=-F,z.s=-1;else{z.s=0,z.e=0,z.d=[0];return}if(F===~~F&&F<1e7){z.e=0,z.d=[F];return}return T(z,F.toString())}else if(typeof F!="string")throw Error(o+F);if(F.charCodeAt(0)===45?(F=F.slice(1),z.s=-1):z.s=1,c.test(F))T(z,F);else throw Error(o+F)}if($.prototype=f,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.clone=L,$.config=$.set=N,E===void 0&&(E={}),E)for(j=["precision","rounding","toExpNeg","toExpPos","LN10"],I=0;I<j.length;)E.hasOwnProperty(O=j[I++])||(E[O]=this[O]);return $.config(E),$}function N(E){if(!E||typeof E!="object")throw Error(a+"Object expected");var I,O,j,$=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(I=0;I<$.length;I+=3)if((j=E[O=$[I]])!==void 0)if(s(j)===j&&j>=$[I+1]&&j<=$[I+2])this[O]=j;else throw Error(o+O+": "+j);if((j=E[O="LN10"])!==void 0)if(j==Math.LN10)this[O]=new this(j);else throw Error(o+O+": "+j);return this}r=L(r),r.default=r.Decimal=r,d=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof Ck!="undefined"&&Ck.exports?Ck.exports=r:(e||(e=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(wU)});var E8=de((R3e,mM)=>{"use strict";var tce=Object.prototype.hasOwnProperty,ao="~";function Ky(){}Object.create&&(Ky.prototype=Object.create(null),new Ky().__proto__||(ao=!1));function rce(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function D8(e,t,r,n,a){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new rce(r,n||e,a),i=ao?ao+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],o]:e._events[i].push(o):(e._events[i]=o,e._eventsCount++),e}function oC(e,t){--e._eventsCount===0?e._events=new Ky:delete e._events[t]}function Fa(){this._events=new Ky,this._eventsCount=0}Fa.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)tce.call(r,n)&&t.push(ao?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Fa.prototype.listeners=function(t){var r=ao?ao+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,o=n.length,i=new Array(o);a<o;a++)i[a]=n[a].fn;return i};Fa.prototype.listenerCount=function(t){var r=ao?ao+t:t,n=this._events[r];return n?n.fn?1:n.length:0};Fa.prototype.emit=function(t,r,n,a,o,i){var s=ao?ao+t:t;if(!this._events[s])return!1;var l=this._events[s],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,a),!0;case 5:return l.fn.call(l.context,r,n,a,o),!0;case 6:return l.fn.call(l.context,r,n,a,o,i),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var p=l.length,m;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,a);break;default:if(!d)for(m=1,d=new Array(c-1);m<c;m++)d[m-1]=arguments[m];l[u].fn.apply(l[u].context,d)}}return!0};Fa.prototype.on=function(t,r,n){return D8(this,t,r,n,!1)};Fa.prototype.once=function(t,r,n){return D8(this,t,r,n,!0)};Fa.prototype.removeListener=function(t,r,n,a){var o=ao?ao+t:t;if(!this._events[o])return this;if(!r)return oC(this,o),this;var i=this._events[o];if(i.fn)i.fn===r&&(!a||i.once)&&(!n||i.context===n)&&oC(this,o);else{for(var s=0,l=[],c=i.length;s<c;s++)(i[s].fn!==r||a&&!i[s].once||n&&i[s].context!==n)&&l.push(i[s]);l.length?this._events[o]=l.length===1?l[0]:l:oC(this,o)}return this};Fa.prototype.removeAllListeners=function(t){var r;return t?(r=ao?ao+t:t,this._events[r]&&oC(this,r)):(this._events=new Ky,this._eventsCount=0),this};Fa.prototype.off=Fa.prototype.removeListener;Fa.prototype.addListener=Fa.prototype.on;Fa.prefixed=ao;Fa.EventEmitter=Fa;typeof mM!="undefined"&&(mM.exports=Fa)});var V8=de(hM=>{"use strict";Object.defineProperty(hM,Symbol.toStringTag,{value:"Module"});function fce(e,t,{signal:r,edges:n}={}){let a,o=null,i=n!=null&&n.includes("leading"),s=n==null||n.includes("trailing"),l=()=>{o!==null&&(e.apply(a,o),a=void 0,o=null)},c=()=>{s&&l(),m()},d=null,u=()=>{d!=null&&clearTimeout(d),d=setTimeout(()=>{d=null,c()},t)},p=()=>{d!==null&&(clearTimeout(d),d=null)},m=()=>{p(),a=void 0,o=null},h=()=>{p(),l()},f=function(...b){if(r!=null&&r.aborted)return;a=this,o=b;let v=d==null;u(),i&&v&&l()};return f.schedule=u,f.cancel=m,f.flush=h,r==null||r.addEventListener("abort",m,{once:!0}),f}hM.debounce=fce});var G8=de(vM=>{"use strict";Object.defineProperty(vM,Symbol.toStringTag,{value:"Module"});var gce=V8();function hce(e,t=0,r={}){typeof r!="object"&&(r={});let{leading:n=!1,trailing:a=!0,maxWait:o}=r,i=Array(2);n&&(i[0]="leading"),a&&(i[1]="trailing");let s,l=null,c=gce.debounce(function(...p){s=e.apply(this,p),l=null},t,{edges:i}),d=function(...p){return o!=null&&(l===null&&(l=Date.now()),Date.now()-l>=o)?(s=e.apply(this,p),l=Date.now(),c.cancel(),c.schedule(),s):(c.apply(this,p),s)},u=()=>(c.flush(),s);return d.cancel=c.cancel,d.flush=u,d}vM.debounce=hce});var Y8=de(yM=>{"use strict";Object.defineProperty(yM,Symbol.toStringTag,{value:"Module"});var vce=G8();function yce(e,t=0,r={}){typeof r!="object"&&(r={});let{leading:n=!0,trailing:a=!0}=r;return vce.debounce(e,t,{leading:n,trailing:a,maxWait:t})}yM.throttle=yce});var J8=de((D6e,K8)=>{K8.exports=Y8().throttle});var fq=de(CM=>{"use strict";Object.defineProperty(CM,Symbol.toStringTag,{value:"Module"});function tde(e){return e[e.length-1]}CM.last=tde});var gq=de(TM=>{"use strict";Object.defineProperty(TM,Symbol.toStringTag,{value:"Module"});function rde(e){return Array.isArray(e)?e:Array.from(e)}TM.toArray=rde});var hq=de(PM=>{"use strict";Object.defineProperty(PM,Symbol.toStringTag,{value:"Module"});var nde=fq(),ade=gq(),ode=K0();function ide(e){if(ode.isArrayLike(e))return nde.last(ade.toArray(e))}PM.last=ide});var yq=de((tUe,vq)=>{vq.exports=hq().last});var zq=de(EM=>{"use strict";Object.defineProperty(EM,Symbol.toStringTag,{value:"Module"});function kde(e){var r;if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){let n=e[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))!=null&&r.writable)?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}EM.isPlainObject=kde});var Bq=de((TUe,_q)=>{_q.exports=zq().isPlainObject});var AV=de(EV=>{"use strict";var sb=B();function jme(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zme=typeof Object.is=="function"?Object.is:jme,_me=sb.useSyncExternalStore,Bme=sb.useRef,$me=sb.useEffect,Rme=sb.useMemo,Wme=sb.useDebugValue;EV.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var o=Bme(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=Rme(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),a!==void 0&&i.hasValue){var h=i.value;if(a(h,m))return u=h}return u=m}if(h=u,zme(d,m))return h;var f=n(m);return a!==void 0&&a(h,f)?(d=m,h):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,a]);var s=_me(e,o[0],o[1]);return $me(function(){i.hasValue=!0,i.value=s},[s]),Wme(s),s}});var NV=de((nGe,IV)=>{"use strict";IV.exports=AV()});var iT=de((oT,zY)=>{(function(e,t){typeof oT=="object"&&typeof zY!="undefined"?t(oT):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e["fast-equals"]={}))})(oT,function(e){"use strict";function t(R){return function(X,G,H,Y,V,Q,Z){return R(X,G,Z)}}function r(R){return function(X,G,H,Y){if(!X||!G||typeof X!="object"||typeof G!="object")return R(X,G,H,Y);var V=Y.get(X),Q=Y.get(G);if(V&&Q)return V===G&&Q===X;Y.set(X,G),Y.set(G,X);var Z=R(X,G,H,Y);return Y.delete(X),Y.delete(G),Z}}function n(R,q){var X={};for(var G in R)X[G]=R[G];for(var G in q)X[G]=q[G];return X}function a(R){return R.constructor===Object||R.constructor==null}function o(R){return typeof R.then=="function"}function i(R,q){return R===q||R!==R&&q!==q}var s="[object Arguments]",l="[object Boolean]",c="[object Date]",d="[object RegExp]",u="[object Map]",p="[object Number]",m="[object Object]",h="[object Set]",f="[object String]",b=Object.prototype.toString;function v(R){var q=R.areArraysEqual,X=R.areDatesEqual,G=R.areMapsEqual,H=R.areObjectsEqual,Y=R.areRegExpsEqual,V=R.areSetsEqual,Q=R.createIsNestedEqual,Z=Q(se);function se(ie,Se,qe){if(ie===Se)return!0;if(!ie||!Se||typeof ie!="object"||typeof Se!="object")return ie!==ie&&Se!==Se;if(a(ie)&&a(Se))return H(ie,Se,Z,qe);var ht=Array.isArray(ie),ft=Array.isArray(Se);if(ht||ft)return ht===ft&&q(ie,Se,Z,qe);var it=b.call(ie);return it!==b.call(Se)?!1:it===c?X(ie,Se,Z,qe):it===d?Y(ie,Se,Z,qe):it===u?G(ie,Se,Z,qe):it===h?V(ie,Se,Z,qe):it===m||it===s?o(ie)||o(Se)?!1:H(ie,Se,Z,qe):it===l||it===p||it===f?i(ie.valueOf(),Se.valueOf()):!1}return se}function y(R,q,X,G){var H=R.length;if(q.length!==H)return!1;for(;H-- >0;)if(!X(R[H],q[H],H,H,R,q,G))return!1;return!0}var g=r(y);function w(R,q){return i(R.valueOf(),q.valueOf())}function C(R,q,X,G){var H=R.size===q.size;if(!H)return!1;if(!R.size)return!0;var Y={},V=0;return R.forEach(function(Q,Z){if(H){var se=!1,ie=0;q.forEach(function(Se,qe){!se&&!Y[ie]&&(se=X(Z,qe,V,ie,R,q,G)&&X(Q,Se,Z,qe,R,q,G))&&(Y[ie]=!0),ie++}),V++,H=se}}),H}var k=r(C),x="_owner",S=Object.prototype.hasOwnProperty;function T(R,q,X,G){var H=Object.keys(R),Y=H.length;if(Object.keys(q).length!==Y)return!1;for(var V;Y-- >0;){if(V=H[Y],V===x){var Q=!!R.$$typeof,Z=!!q.$$typeof;if((Q||Z)&&Q!==Z)return!1}if(!S.call(q,V)||!X(R[V],q[V],V,V,R,q,G))return!1}return!0}var P=r(T);function M(R,q){return R.source===q.source&&R.flags===q.flags}function D(R,q,X,G){var H=R.size===q.size;if(!H)return!1;if(!R.size)return!0;var Y={};return R.forEach(function(V,Q){if(H){var Z=!1,se=0;q.forEach(function(ie,Se){!Z&&!Y[se]&&(Z=X(V,ie,Q,Se,R,q,G))&&(Y[se]=!0),se++}),H=Z}}),H}var A=r(D),L=Object.freeze({areArraysEqual:y,areDatesEqual:w,areMapsEqual:C,areObjectsEqual:T,areRegExpsEqual:M,areSetsEqual:D,createIsNestedEqual:t}),N=Object.freeze({areArraysEqual:g,areDatesEqual:w,areMapsEqual:k,areObjectsEqual:P,areRegExpsEqual:M,areSetsEqual:A,createIsNestedEqual:t}),E=v(L);function I(R,q){return E(R,q,void 0)}var O=v(n(L,{createIsNestedEqual:function(){return i}}));function j(R,q){return O(R,q,void 0)}var $=v(N);function F(R,q){return $(R,q,new WeakMap)}var z=v(n(N,{createIsNestedEqual:function(){return i}}));function W(R,q){return z(R,q,new WeakMap)}function U(R){return v(n(L,R(L)))}function K(R){var q=v(n(N,R(N)));return function(X,G,H){return H===void 0&&(H=new WeakMap),q(X,G,H)}}e.circularDeepEqual=F,e.circularShallowEqual=W,e.createCustomCircularEqual=K,e.createCustomEqual=U,e.deepEqual=I,e.sameValueZeroEqual=i,e.shallowEqual=j,Object.defineProperty(e,"__esModule",{value:!0})})});var sT=de((DQe,NO)=>{function BY(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=BY(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function _Y(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=BY(e))&&(n&&(n+=" "),n+=t);return n}NO.exports=_Y,NO.exports.clsx=_Y});var RY=de((EQe,$Y)=>{$Y.exports=function(t,r,n){return t===r?!0:t.className===r.className&&n(t.style,r.style)&&t.width===r.width&&t.autoSize===r.autoSize&&t.cols===r.cols&&t.draggableCancel===r.draggableCancel&&t.draggableHandle===r.draggableHandle&&n(t.verticalCompact,r.verticalCompact)&&n(t.compactType,r.compactType)&&n(t.layout,r.layout)&&n(t.margin,r.margin)&&n(t.containerPadding,r.containerPadding)&&t.rowHeight===r.rowHeight&&t.maxRows===r.maxRows&&t.isBounded===r.isBounded&&t.isDraggable===r.isDraggable&&t.isResizable===r.isResizable&&t.allowOverlap===r.allowOverlap&&t.preventCollision===r.preventCollision&&t.useCSSTransforms===r.useCSSTransforms&&t.transformScale===r.transformScale&&t.isDroppable===r.isDroppable&&n(t.resizeHandles,r.resizeHandles)&&n(t.resizeHandle,r.resizeHandle)&&t.onLayoutChange===r.onLayoutChange&&t.onDragStart===r.onDragStart&&t.onDrag===r.onDrag&&t.onDragStop===r.onDragStop&&t.onResizeStart===r.onResizeStart&&t.onResize===r.onResize&&t.onResizeStop===r.onResizeStop&&t.onDrop===r.onDrop&&n(t.droppingItem,r.droppingItem)&&n(t.innerRef,r.innerRef)}});var Ip=de(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.bottom=OO;Nt.childrenEqual=Ehe;Nt.cloneLayout=UY;Nt.cloneLayoutItem=Ap;Nt.collides=cT;Nt.compact=HY;Nt.compactItem=VY;Nt.compactType=Rhe;Nt.correctBounds=GY;Nt.fastPositionEqual=Ahe;Nt.fastRGLPropsEqual=void 0;Nt.getAllCollisions=YY;Nt.getFirstCollision=Ep;Nt.getLayoutItem=FO;Nt.getStatics=jO;Nt.modifyLayout=qY;Nt.moveElement=Ab;Nt.moveElementAwayFromCollision=MO;Nt.noop=void 0;Nt.perc=Nhe;Nt.resizeItemInDirection=zhe;Nt.setTopLeft=Bhe;Nt.setTransform=_he;Nt.sortLayoutItems=WO;Nt.sortLayoutItemsByColRow=ZY;Nt.sortLayoutItemsByRowCol=QY;Nt.synchronizeLayoutWithChildren=$he;Nt.validateLayout=eK;Nt.withLayoutItem=Dhe;var WY=iT(),Eb=Che(B());function Che(e){return e&&e.__esModule?e:{default:e}}var The=!0,Phe=!1;function OO(e){let t=0,r;for(let n=0,a=e.length;n<a;n++)r=e[n].y+e[n].h,r>t&&(t=r);return t}function UY(e){let t=Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=Ap(e[r]);return t}function qY(e,t){let r=Array(e.length);for(let n=0,a=e.length;n<a;n++)t.i===e[n].i?r[n]=t:r[n]=e[n];return r}function Dhe(e,t,r){let n=FO(e,t);return n?(n=r(Ap(n)),e=qY(e,n),[e,n]):[e,null]}function Ap(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:!!e.moved,static:!!e.static,isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}function Ehe(e,t){return(0,WY.deepEqual)(Eb.default.Children.map(e,r=>r==null?void 0:r.key),Eb.default.Children.map(t,r=>r==null?void 0:r.key))&&(0,WY.deepEqual)(Eb.default.Children.map(e,r=>r==null?void 0:r.props["data-grid"]),Eb.default.Children.map(t,r=>r==null?void 0:r.props["data-grid"]))}var AQe=Nt.fastRGLPropsEqual=RY();function Ahe(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function cT(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function HY(e,t,r,n){let a=jO(e),o=WO(e,t),i=Array(e.length);for(let s=0,l=o.length;s<l;s++){let c=Ap(o[s]);c.static||(c=VY(a,c,t,r,o,n),a.push(c)),i[e.indexOf(o[s])]=c,c.moved=!1}return i}var Ihe={x:"w",y:"h"};function LO(e,t,r,n){let a=Ihe[n];t[n]+=1;let o=e.map(i=>i.i).indexOf(t.i);for(let i=o+1;i<e.length;i++){let s=e[i];if(!s.static){if(s.y>t.y+t.h)break;cT(t,s)&&LO(e,s,r+t[a],n)}}t[n]=r}function VY(e,t,r,n,a,o){let i=r==="vertical",s=r==="horizontal";if(i)for(t.y=Math.min(OO(e),t.y);t.y>0&&!Ep(e,t);)t.y--;else if(s)for(;t.x>0&&!Ep(e,t);)t.x--;let l;for(;(l=Ep(e,t))&&!(r===null&&o);)if(s?LO(a,t,l.x+l.w,"x"):LO(a,t,l.y+l.h,"y"),s&&t.x+t.w>n)for(t.x=n-t.w,t.y++;t.x>0&&!Ep(e,t);)t.x--;return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function GY(e,t){let r=jO(e);for(let n=0,a=e.length;n<a;n++){let o=e[n];if(o.x+o.w>t.cols&&(o.x=t.cols-o.w),o.x<0&&(o.x=0,o.w=t.cols),!o.static)r.push(o);else for(;Ep(r,o);)o.y++}return e}function FO(e,t){for(let r=0,n=e.length;r<n;r++)if(e[r].i===t)return e[r]}function Ep(e,t){for(let r=0,n=e.length;r<n;r++)if(cT(e[r],t))return e[r]}function YY(e,t){return e.filter(r=>cT(r,t))}function jO(e){return e.filter(t=>t.static)}function Ab(e,t,r,n,a,o,i,s,l){if(t.static&&t.isDraggable!==!0||t.y===n&&t.x===r)return e;lT(`Moving element ${t.i} to [${String(r)},${String(n)}] from [${t.x},${t.y}]`);let c=t.x,d=t.y;typeof r=="number"&&(t.x=r),typeof n=="number"&&(t.y=n),t.moved=!0;let u=WO(e,i);(i==="vertical"&&typeof n=="number"?d>=n:i==="horizontal"&&typeof r=="number"?c>=r:!1)&&(u=u.reverse());let m=YY(u,t),h=m.length>0;if(h&&l)return UY(e);if(h&&o)return lT(`Collision prevented on ${t.i}, reverting.`),t.x=c,t.y=d,t.moved=!1,e;for(let f=0,b=m.length;f<b;f++){let v=m[f];lT(`Resolving collision between ${t.i} at [${t.x},${t.y}] and ${v.i} at [${v.x},${v.y}]`),!v.moved&&(v.static?e=MO(e,v,t,a,i,s):e=MO(e,t,v,a,i,s))}return e}function MO(e,t,r,n,a,o){let i=a==="horizontal",s=a==="vertical",l=t.static;if(n){n=!1;let u={x:i?Math.max(t.x-r.w,0):r.x,y:s?Math.max(t.y-r.h,0):r.y,w:r.w,h:r.h,i:"-1"},p=Ep(e,u),m=p&&p.y+p.h>t.y,h=p&&t.x+t.w>p.x;if(p){if(m&&s)return Ab(e,r,void 0,t.y+1,n,l,a,o);if(m&&a==null)return t.y=r.y,r.y=r.y+r.h,e;if(h&&i)return Ab(e,t,r.x,void 0,n,l,a,o)}else return lT(`Doing reverse collision on ${r.i} up to [${u.x},${u.y}].`),Ab(e,r,i?u.x:void 0,s?u.y:void 0,n,l,a,o)}let c=i?r.x+1:void 0,d=s?r.y+1:void 0;return c==null&&d==null?e:Ab(e,r,i?r.x+1:void 0,s?r.y+1:void 0,n,l,a,o)}function Nhe(e){return e*100+"%"}var KY=(e,t,r,n)=>e+r>n?t:r,JY=(e,t,r)=>e<0?t:r,XY=e=>Math.max(0,e),zO=e=>Math.max(0,e),_O=(e,t,r)=>{let{left:n,height:a,width:o}=t,i=e.top-(a-e.height);return{left:n,width:o,height:JY(i,e.height,a),top:zO(i)}},BO=(e,t,r)=>{let{top:n,left:a,height:o,width:i}=t;return{top:n,height:o,width:KY(e.left,e.width,i,r),left:XY(a)}},$O=(e,t,r)=>{let{top:n,height:a,width:o}=t,i=e.left-(o-e.width);return{height:a,width:i<0?e.width:KY(e.left,e.width,o,r),top:zO(n),left:XY(i)}},RO=(e,t,r)=>{let{top:n,left:a,height:o,width:i}=t;return{width:i,left:a,height:JY(n,e.height,o),top:zO(n)}},Lhe=function(){return _O(arguments.length<=0?void 0:arguments[0],BO(...arguments),arguments.length<=2?void 0:arguments[2])},Mhe=function(){return _O(arguments.length<=0?void 0:arguments[0],$O(...arguments),arguments.length<=2?void 0:arguments[2])},Ohe=function(){return RO(arguments.length<=0?void 0:arguments[0],BO(...arguments),arguments.length<=2?void 0:arguments[2])},Fhe=function(){return RO(arguments.length<=0?void 0:arguments[0],$O(...arguments),arguments.length<=2?void 0:arguments[2])},jhe={n:_O,ne:Lhe,e:BO,se:Ohe,s:RO,sw:Fhe,w:$O,nw:Mhe};function zhe(e,t,r,n){let a=jhe[e];return a?a(t,{...t,...r},n):r}function _he(e){let{top:t,left:r,width:n,height:a}=e,o=`translate(${r}px,${t}px)`;return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:`${n}px`,height:`${a}px`,position:"absolute"}}function Bhe(e){let{top:t,left:r,width:n,height:a}=e;return{top:`${t}px`,left:`${r}px`,width:`${n}px`,height:`${a}px`,position:"absolute"}}function WO(e,t){return t==="horizontal"?ZY(e):t==="vertical"?QY(e):e}function QY(e){return e.slice(0).sort(function(t,r){return t.y>r.y||t.y===r.y&&t.x>r.x?1:t.y===r.y&&t.x===r.x?0:-1})}function ZY(e){return e.slice(0).sort(function(t,r){return t.x>r.x||t.x===r.x&&t.y>r.y?1:-1})}function $he(e,t,r,n,a){e=e||[];let o=[];Eb.default.Children.forEach(t,s=>{if((s==null?void 0:s.key)==null)return;let l=FO(e,String(s.key)),c=s.props["data-grid"];l&&c==null?o.push(Ap(l)):c?(The||eK([c],"ReactGridLayout.children"),o.push(Ap({...c,i:s.key}))):o.push(Ap({w:1,h:1,x:0,y:OO(o),i:String(s.key)}))});let i=GY(o,{cols:r});return a?i:HY(i,n,r)}function eK(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout",r=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(let n=0,a=e.length;n<a;n++){let o=e[n];for(let i=0;i<r.length;i++){let s=r[i],l=o[s];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${t}[${n}].${s} must be a number! Received: ${l} (${typeof l})`)}if(typeof o.i!="undefined"&&typeof o.i!="string")throw new Error(`ReactGridLayout: ${t}[${n}].i must be a string! Received: ${o.i} (${typeof o.i})`)}}function Rhe(e){let{verticalCompact:t,compactType:r}=e||{};return t===!1?null:r}function lT(){Phe&&console.log(...arguments)}var Whe=()=>{};Nt.noop=Whe});var uT=de(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});qd.calcGridColWidth=dT;qd.calcGridItemPosition=Uhe;qd.calcGridItemWHPx=UO;qd.calcWH=Hhe;qd.calcXY=qhe;qd.clamp=Np;function dT(e){let{margin:t,containerPadding:r,containerWidth:n,cols:a}=e;return(n-t[0]*(a-1)-r[0]*2)/a}function UO(e,t,r){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*r):e}function Uhe(e,t,r,n,a,o){let{margin:i,containerPadding:s,rowHeight:l}=e,c=dT(e),d={};return o&&o.resizing?(d.width=Math.round(o.resizing.width),d.height=Math.round(o.resizing.height)):(d.width=UO(n,c,i[0]),d.height=UO(a,l,i[1])),o&&o.dragging?(d.top=Math.round(o.dragging.top),d.left=Math.round(o.dragging.left)):o&&o.resizing&&typeof o.resizing.top=="number"&&typeof o.resizing.left=="number"?(d.top=Math.round(o.resizing.top),d.left=Math.round(o.resizing.left)):(d.top=Math.round((l+i[1])*r+s[1]),d.left=Math.round((c+i[0])*t+s[0])),d}function qhe(e,t,r,n,a){let{margin:o,containerPadding:i,cols:s,rowHeight:l,maxRows:c}=e,d=dT(e),u=Math.round((r-i[0])/(d+o[0])),p=Math.round((t-i[1])/(l+o[1]));return u=Np(u,0,s-n),p=Np(p,0,c-a),{x:u,y:p}}function Hhe(e,t,r,n,a,o){let{margin:i,maxRows:s,cols:l,rowHeight:c}=e,d=dT(e),u=Math.round((t+i[0])/(d+i[0])),p=Math.round((r+i[1])/(c+i[1])),m=Np(u,0,l-n),h=Np(p,0,s-a);return["sw","w","nw"].indexOf(o)!==-1&&(m=Np(u,0,l)),["nw","n","ne"].indexOf(o)!==-1&&(h=Np(p,0,s)),{w:m,h}}function Np(e,t,r){return Math.max(Math.min(e,r),t)}});var rK=de((LQe,tK)=>{"use strict";var Vhe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";tK.exports=Vhe});var iK=de((MQe,oK)=>{"use strict";var Ghe=rK();function nK(){}function aK(){}aK.resetWarningCache=nK;oK.exports=function(){function e(n,a,o,i,s,l){if(l!==Ghe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:aK,resetWarningCache:nK};return r.PropTypes=r,r}});var Tc=de((jQe,sK)=>{sK.exports=iK()();var OQe,FQe});var dK=de((zQe,qO)=>{function cK(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=cK(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function lK(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=cK(e))&&(n&&(n+=" "),n+=t);return n}qO.exports=lK,qO.exports.clsx=lK});var Ib=de(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});Lp.dontSetMe=Qhe;Lp.findInArray=Yhe;Lp.int=Xhe;Lp.isFunction=Khe;Lp.isNum=Jhe;function Yhe(e,t){for(let r=0,n=e.length;r<n;r++)if(t.apply(t,[e[r],r,e]))return e[r]}function Khe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function Jhe(e){return typeof e=="number"&&!isNaN(e)}function Xhe(e){return parseInt(e,10)}function Qhe(e,t,r){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(r," - do not set this, set it on the child."))}});var mK=de(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});Mp.browserPrefixToKey=pK;Mp.browserPrefixToStyle=Zhe;Mp.default=void 0;Mp.getPrefix=uK;var HO=["Moz","Webkit","O","ms"];function uK(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";let r=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!r||t in r)return"";for(let n=0;n<HO.length;n++)if(pK(t,HO[n])in r)return HO[n];return""}function pK(e,t){return t?"".concat(t).concat(eve(e)):e}function Zhe(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function eve(e){let t="",r=!0;for(let n=0;n<e.length;n++)r?(t+=e[n].toUpperCase(),r=!1):e[n]==="-"?r=!0:t+=e[n];return t}var BQe=Mp.default=uK()});var mT=de(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.addClassName=vK;wn.addEvent=nve;wn.addUserSelectStyles=fve;wn.createCSSTransform=dve;wn.createSVGTransform=uve;wn.getTouch=pve;wn.getTouchIdentifier=mve;wn.getTranslation=VO;wn.innerHeight=sve;wn.innerWidth=lve;wn.matchesSelector=hK;wn.matchesSelectorAndParentsTo=rve;wn.offsetXYFromParent=cve;wn.outerHeight=ove;wn.outerWidth=ive;wn.removeClassName=yK;wn.removeEvent=ave;wn.removeUserSelectStyles=gve;var ki=Ib(),fK=tve(mK());function gK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(gK=function(n){return n?r:t})(e)}function tve(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=gK(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}var pT="";function hK(e,t){return pT||(pT=(0,ki.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,ki.isFunction)(e[r])})),(0,ki.isFunction)(e[pT])?e[pT](t):!1}function rve(e,t,r){let n=e;do{if(hK(n,t))return!0;if(n===r)return!1;n=n.parentNode}while(n);return!1}function nve(e,t,r,n){if(!e)return;let a={capture:!0,...n};e.addEventListener?e.addEventListener(t,r,a):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}function ave(e,t,r,n){if(!e)return;let a={capture:!0,...n};e.removeEventListener?e.removeEventListener(t,r,a):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null}function ove(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,ki.int)(r.borderTopWidth),t+=(0,ki.int)(r.borderBottomWidth),t}function ive(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,ki.int)(r.borderLeftWidth),t+=(0,ki.int)(r.borderRightWidth),t}function sve(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,ki.int)(r.paddingTop),t-=(0,ki.int)(r.paddingBottom),t}function lve(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,ki.int)(r.paddingLeft),t-=(0,ki.int)(r.paddingRight),t}function cve(e,t,r){let a=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),o=(e.clientX+t.scrollLeft-a.left)/r,i=(e.clientY+t.scrollTop-a.top)/r;return{x:o,y:i}}function dve(e,t){let r=VO(e,t,"px");return{[(0,fK.browserPrefixToKey)("transform",fK.default)]:r}}function uve(e,t){return VO(e,t,"")}function VO(e,t,r){let{x:n,y:a}=e,o="translate(".concat(n).concat(r,",").concat(a).concat(r,")");if(t){let i="".concat(typeof t.x=="string"?t.x:t.x+r),s="".concat(typeof t.y=="string"?t.y:t.y+r);o="translate(".concat(i,", ").concat(s,")")+o}return o}function pve(e,t){return e.targetTouches&&(0,ki.findInArray)(e.targetTouches,r=>t===r.identifier)||e.changedTouches&&(0,ki.findInArray)(e.changedTouches,r=>t===r.identifier)}function mve(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function fve(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&vK(e.body,"react-draggable-transparent-selection")}function gve(e){if(e)try{if(e.body&&yK(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{let t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch(t){}}function vK(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function yK(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}});var YO=de(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.canDragX=yve;Pc.canDragY=bve;Pc.createCoreData=wve;Pc.createDraggableData=Sve;Pc.getBoundPosition=hve;Pc.getControlPosition=xve;Pc.snapToGrid=vve;var Ci=Ib(),kg=mT();function hve(e,t,r){if(!e.props.bounds)return[t,r];let{bounds:n}=e.props;n=typeof n=="string"?n:kve(n);let a=GO(e);if(typeof n=="string"){let{ownerDocument:o}=a,i=o.defaultView,s;if(n==="parent"?s=a.parentNode:s=o.querySelector(n),!(s instanceof i.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');let l=s,c=i.getComputedStyle(a),d=i.getComputedStyle(l);n={left:-a.offsetLeft+(0,Ci.int)(d.paddingLeft)+(0,Ci.int)(c.marginLeft),top:-a.offsetTop+(0,Ci.int)(d.paddingTop)+(0,Ci.int)(c.marginTop),right:(0,kg.innerWidth)(l)-(0,kg.outerWidth)(a)-a.offsetLeft+(0,Ci.int)(d.paddingRight)-(0,Ci.int)(c.marginRight),bottom:(0,kg.innerHeight)(l)-(0,kg.outerHeight)(a)-a.offsetTop+(0,Ci.int)(d.paddingBottom)-(0,Ci.int)(c.marginBottom)}}return(0,Ci.isNum)(n.right)&&(t=Math.min(t,n.right)),(0,Ci.isNum)(n.bottom)&&(r=Math.min(r,n.bottom)),(0,Ci.isNum)(n.left)&&(t=Math.max(t,n.left)),(0,Ci.isNum)(n.top)&&(r=Math.max(r,n.top)),[t,r]}function vve(e,t,r){let n=Math.round(t/e[0])*e[0],a=Math.round(r/e[1])*e[1];return[n,a]}function yve(e){return e.props.axis==="both"||e.props.axis==="x"}function bve(e){return e.props.axis==="both"||e.props.axis==="y"}function xve(e,t,r){let n=typeof t=="number"?(0,kg.getTouch)(e,t):null;if(typeof t=="number"&&!n)return null;let a=GO(r),o=r.props.offsetParent||a.offsetParent||a.ownerDocument.body;return(0,kg.offsetXYFromParent)(n||e,o,r.props.scale)}function wve(e,t,r){let n=!(0,Ci.isNum)(e.lastX),a=GO(e);return n?{node:a,deltaX:0,deltaY:0,lastX:t,lastY:r,x:t,y:r}:{node:a,deltaX:t-e.lastX,deltaY:r-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:r}}function Sve(e,t){let r=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/r,y:e.state.y+t.deltaY/r,deltaX:t.deltaX/r,deltaY:t.deltaY/r,lastX:e.state.x,lastY:e.state.y}}function kve(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function GO(e){let t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}});var JO=de(KO=>{"use strict";Object.defineProperty(KO,"__esModule",{value:!0});KO.default=Cve;function Cve(){}});var xK=de(fT=>{"use strict";Object.defineProperty(fT,"__esModule",{value:!0});fT.default=void 0;var XO=Pve(B()),$o=ZO(Tc()),Tve=ZO(Yl()),Ra=mT(),Hd=YO(),QO=Ib(),Nb=ZO(JO());function ZO(e){return e&&e.__esModule?e:{default:e}}function bK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(bK=function(n){return n?r:t})(e)}function Pve(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=bK(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function lo(e,t,r){return t=Dve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dve(e){var t=Eve(e,"string");return typeof t=="symbol"?t:String(t)}function Eve(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hs={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Vd=Hs.mouse,Cg=class extends XO.Component{constructor(){super(...arguments),lo(this,"dragging",!1),lo(this,"lastX",NaN),lo(this,"lastY",NaN),lo(this,"touchIdentifier",null),lo(this,"mounted",!1),lo(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;let r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:n}=r;if(this.props.disabled||!(t.target instanceof n.defaultView.Node)||this.props.handle&&!(0,Ra.matchesSelectorAndParentsTo)(t.target,this.props.handle,r)||this.props.cancel&&(0,Ra.matchesSelectorAndParentsTo)(t.target,this.props.cancel,r))return;t.type==="touchstart"&&t.preventDefault();let a=(0,Ra.getTouchIdentifier)(t);this.touchIdentifier=a;let o=(0,Hd.getControlPosition)(t,a,this);if(o==null)return;let{x:i,y:s}=o,l=(0,Hd.createCoreData)(this,i,s);(0,Nb.default)("DraggableCore: handleDragStart: %j",l),(0,Nb.default)("calling",this.props.onStart),!(this.props.onStart(t,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,Ra.addUserSelectStyles)(n),this.dragging=!0,this.lastX=i,this.lastY=s,(0,Ra.addEvent)(n,Vd.move,this.handleDrag),(0,Ra.addEvent)(n,Vd.stop,this.handleDragStop))}),lo(this,"handleDrag",t=>{let r=(0,Hd.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:a}=r;if(Array.isArray(this.props.grid)){let s=n-this.lastX,l=a-this.lastY;if([s,l]=(0,Hd.snapToGrid)(this.props.grid,s,l),!s&&!l)return;n=this.lastX+s,a=this.lastY+l}let o=(0,Hd.createCoreData)(this,n,a);if((0,Nb.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(t,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(s){let l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=n,this.lastY=a}),lo(this,"handleDragStop",t=>{if(!this.dragging)return;let r=(0,Hd.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:a}=r;if(Array.isArray(this.props.grid)){let l=n-this.lastX||0,c=a-this.lastY||0;[l,c]=(0,Hd.snapToGrid)(this.props.grid,l,c),n=this.lastX+l,a=this.lastY+c}let o=(0,Hd.createCoreData)(this,n,a);if(this.props.onStop(t,o)===!1||this.mounted===!1)return!1;let s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,Ra.removeUserSelectStyles)(s.ownerDocument),(0,Nb.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,Nb.default)("DraggableCore: Removing handlers"),(0,Ra.removeEvent)(s.ownerDocument,Vd.move,this.handleDrag),(0,Ra.removeEvent)(s.ownerDocument,Vd.stop,this.handleDragStop))}),lo(this,"onMouseDown",t=>(Vd=Hs.mouse,this.handleDragStart(t))),lo(this,"onMouseUp",t=>(Vd=Hs.mouse,this.handleDragStop(t))),lo(this,"onTouchStart",t=>(Vd=Hs.touch,this.handleDragStart(t))),lo(this,"onTouchEnd",t=>(Vd=Hs.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;let t=this.findDOMNode();t&&(0,Ra.addEvent)(t,Hs.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;let t=this.findDOMNode();if(t){let{ownerDocument:r}=t;(0,Ra.removeEvent)(r,Hs.mouse.move,this.handleDrag),(0,Ra.removeEvent)(r,Hs.touch.move,this.handleDrag),(0,Ra.removeEvent)(r,Hs.mouse.stop,this.handleDragStop),(0,Ra.removeEvent)(r,Hs.touch.stop,this.handleDragStop),(0,Ra.removeEvent)(t,Hs.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Ra.removeUserSelectStyles)(r)}}findDOMNode(){var t,r;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current:Tve.default.findDOMNode(this)}render(){return XO.cloneElement(XO.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};fT.default=Cg;lo(Cg,"displayName","DraggableCore");lo(Cg,"propTypes",{allowAnyClick:$o.default.bool,children:$o.default.node.isRequired,disabled:$o.default.bool,enableUserSelectHack:$o.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:$o.default.arrayOf($o.default.number),handle:$o.default.string,cancel:$o.default.string,nodeRef:$o.default.object,onStart:$o.default.func,onDrag:$o.default.func,onStop:$o.default.func,onMouseDown:$o.default.func,scale:$o.default.number,className:QO.dontSetMe,style:QO.dontSetMe,transform:QO.dontSetMe});lo(Cg,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})});var kK=de(Mb=>{"use strict";Object.defineProperty(Mb,"__esModule",{value:!0});Object.defineProperty(Mb,"DraggableCore",{enumerable:!0,get:function(){return vT.default}});Mb.default=void 0;var gT=Nve(B()),Sr=Lb(Tc()),Ave=Lb(Yl()),Ive=Lb(dK()),wK=mT(),Tg=YO(),eF=Ib(),vT=Lb(xK()),hT=Lb(JO());function Lb(e){return e&&e.__esModule?e:{default:e}}function SK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(SK=function(n){return n?r:t})(e)}function Nve(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=SK(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function tF(){return tF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tF.apply(this,arguments)}function Pg(e,t,r){return t=Lve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lve(e){var t=Mve(e,"string");return typeof t=="symbol"?t:String(t)}function Mve(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dg=class extends gT.Component{static getDerivedStateFromProps(t,r){let{position:n}=t,{prevPropsPosition:a}=r;return n&&(!a||n.x!==a.x||n.y!==a.y)?((0,hT.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:a}),{x:n.x,y:n.y,prevPropsPosition:{...n}}):null}constructor(t){super(t),Pg(this,"onDragStart",(r,n)=>{if((0,hT.default)("Draggable: onDragStart: %j",n),this.props.onStart(r,(0,Tg.createDraggableData)(this,n))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),Pg(this,"onDrag",(r,n)=>{if(!this.state.dragging)return!1;(0,hT.default)("Draggable: onDrag: %j",n);let a=(0,Tg.createDraggableData)(this,n),o={x:a.x,y:a.y,slackX:0,slackY:0};if(this.props.bounds){let{x:s,y:l}=o;o.x+=this.state.slackX,o.y+=this.state.slackY;let[c,d]=(0,Tg.getBoundPosition)(this,o.x,o.y);o.x=c,o.y=d,o.slackX=this.state.slackX+(s-o.x),o.slackY=this.state.slackY+(l-o.y),a.x=o.x,a.y=o.y,a.deltaX=o.x-this.state.x,a.deltaY=o.y-this.state.y}if(this.props.onDrag(r,a)===!1)return!1;this.setState(o)}),Pg(this,"onDragStop",(r,n)=>{if(!this.state.dragging||this.props.onStop(r,(0,Tg.createDraggableData)(this,n))===!1)return!1;(0,hT.default)("Draggable: onDragStop: %j",n);let o={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){let{x:s,y:l}=this.props.position;o.x=s,o.y=l}this.setState(o)}),this.state={dragging:!1,dragged:!1,x:t.position?t.position.x:t.defaultPosition.x,y:t.position?t.position.y:t.defaultPosition.y,prevPropsPosition:{...t.position},slackX:0,slackY:0,isElementSVG:!1},t.position&&!(t.onDrag||t.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var t,r;return(t=(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current)!==null&&t!==void 0?t:Ave.default.findDOMNode(this)}render(){let{axis:t,bounds:r,children:n,defaultPosition:a,defaultClassName:o,defaultClassNameDragging:i,defaultClassNameDragged:s,position:l,positionOffset:c,scale:d,...u}=this.props,p={},m=null,f=!!!l||this.state.dragging,b=l||a,v={x:(0,Tg.canDragX)(this)&&f?this.state.x:b.x,y:(0,Tg.canDragY)(this)&&f?this.state.y:b.y};this.state.isElementSVG?m=(0,wK.createSVGTransform)(v,c):p=(0,wK.createCSSTransform)(v,c);let y=(0,Ive.default)(n.props.className||"",o,{[i]:this.state.dragging,[s]:this.state.dragged});return gT.createElement(vT.default,tF({},u,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),gT.cloneElement(gT.Children.only(n),{className:y,style:{...n.props.style,...p},transform:m}))}};Mb.default=Dg;Pg(Dg,"displayName","Draggable");Pg(Dg,"propTypes",{...vT.default.propTypes,axis:Sr.default.oneOf(["both","x","y","none"]),bounds:Sr.default.oneOfType([Sr.default.shape({left:Sr.default.number,right:Sr.default.number,top:Sr.default.number,bottom:Sr.default.number}),Sr.default.string,Sr.default.oneOf([!1])]),defaultClassName:Sr.default.string,defaultClassNameDragging:Sr.default.string,defaultClassNameDragged:Sr.default.string,defaultPosition:Sr.default.shape({x:Sr.default.number,y:Sr.default.number}),positionOffset:Sr.default.shape({x:Sr.default.oneOfType([Sr.default.number,Sr.default.string]),y:Sr.default.oneOfType([Sr.default.number,Sr.default.string])}),position:Sr.default.shape({x:Sr.default.number,y:Sr.default.number}),className:eF.dontSetMe,style:eF.dontSetMe,transform:eF.dontSetMe});Pg(Dg,"defaultProps",{...vT.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})});var bT=de((VQe,yT)=>{"use strict";var{default:CK,DraggableCore:Ove}=kK();yT.exports=CK;yT.exports.default=CK;yT.exports.DraggableCore=Ove});var DK=de(rF=>{"use strict";rF.__esModule=!0;rF.cloneElement=$ve;var Fve=jve(B());function jve(e){return e&&e.__esModule?e:{default:e}}function TK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TK(Object(r),!0).forEach(function(n){zve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zve(e,t,r){return t=_ve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ve(e){var t=Bve(e,"string");return typeof t=="symbol"?t:String(t)}function Bve(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $ve(e,t){return t.style&&e.props.style&&(t.style=PK(PK({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),Fve.default.cloneElement(e,t)}});var nF=de(xT=>{"use strict";xT.__esModule=!0;xT.resizableProps=void 0;var lt=Rve(Tc()),YQe=bT();function Rve(e){return e&&e.__esModule?e:{default:e}}var Wve={axis:lt.default.oneOf(["both","x","y","none"]),className:lt.default.string,children:lt.default.element.isRequired,draggableOpts:lt.default.shape({allowAnyClick:lt.default.bool,cancel:lt.default.string,children:lt.default.node,disabled:lt.default.bool,enableUserSelectHack:lt.default.bool,offsetParent:lt.default.node,grid:lt.default.arrayOf(lt.default.number),handle:lt.default.string,nodeRef:lt.default.object,onStart:lt.default.func,onDrag:lt.default.func,onStop:lt.default.func,onMouseDown:lt.default.func,scale:lt.default.number}),height:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(a.axis==="both"||a.axis==="y"){var o;return(o=lt.default.number).isRequired.apply(o,r)}return lt.default.number.apply(lt.default,r)},handle:lt.default.oneOfType([lt.default.node,lt.default.func]),handleSize:lt.default.arrayOf(lt.default.number),lockAspectRatio:lt.default.bool,maxConstraints:lt.default.arrayOf(lt.default.number),minConstraints:lt.default.arrayOf(lt.default.number),onResizeStop:lt.default.func,onResizeStart:lt.default.func,onResize:lt.default.func,resizeHandles:lt.default.arrayOf(lt.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:lt.default.number,width:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(a.axis==="both"||a.axis==="x"){var o;return(o=lt.default.number).isRequired.apply(o,r)}return lt.default.number.apply(lt.default,r)}};xT.resizableProps=Wve});var lF=de(wT=>{"use strict";wT.__esModule=!0;wT.default=void 0;var Ob=Gve(B()),Uve=bT(),qve=DK(),Hve=nF(),Vve=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function AK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(AK=function(a){return a?r:t})(e)}function Gve(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=AK(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function oF(){return oF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oF.apply(this,arguments)}function Yve(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,o;for(o=0;o<n.length;o++)a=n[o],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function EK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EK(Object(r),!0).forEach(function(n){Kve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kve(e,t,r){return t=Jve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jve(e){var t=Xve(e,"string");return typeof t=="symbol"?t:String(t)}function Xve(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qve(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,iF(e,t)}function iF(e,t){return iF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},iF(e,t)}var sF=function(e){Qve(t,e);function t(){for(var n,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var r=t.prototype;return r.componentWillUnmount=function(){this.resetData()},r.resetData=function(){this.lastHandleRect=this.slack=null},r.runConstraints=function(a,o){var i=this.props,s=i.minConstraints,l=i.maxConstraints,c=i.lockAspectRatio;if(!s&&!l&&!c)return[a,o];if(c){var d=this.props.width/this.props.height,u=a-this.props.width,p=o-this.props.height;Math.abs(u)>Math.abs(p*d)?o=a/d:a=o*d}var m=a,h=o,f=this.slack||[0,0],b=f[0],v=f[1];return a+=b,o+=v,s&&(a=Math.max(s[0],a),o=Math.max(s[1],o)),l&&(a=Math.min(l[0],a),o=Math.min(l[1],o)),this.slack=[b+(m-a),v+(h-o)],[a,o]},r.resizeHandler=function(a,o){var i=this;return function(s,l){var c=l.node,d=l.deltaX,u=l.deltaY;a==="onResizeStart"&&i.resetData();var p=(i.props.axis==="both"||i.props.axis==="x")&&o!=="n"&&o!=="s",m=(i.props.axis==="both"||i.props.axis==="y")&&o!=="e"&&o!=="w";if(!(!p&&!m)){var h=o[0],f=o[o.length-1],b=c.getBoundingClientRect();if(i.lastHandleRect!=null){if(f==="w"){var v=b.left-i.lastHandleRect.left;d+=v}if(h==="n"){var y=b.top-i.lastHandleRect.top;u+=y}}i.lastHandleRect=b,f==="w"&&(d=-d),h==="n"&&(u=-u);var g=i.props.width+(p?d/i.props.transformScale:0),w=i.props.height+(m?u/i.props.transformScale:0),C=i.runConstraints(g,w);g=C[0],w=C[1];var k=g!==i.props.width||w!==i.props.height,x=typeof i.props[a]=="function"?i.props[a]:null,S=a==="onResize"&&!k;x&&!S&&(s.persist==null||s.persist(),x(s,{node:c,size:{width:g,height:w},handle:o})),a==="onResizeStop"&&i.resetData()}}},r.renderResizeHandle=function(a,o){var i=this.props.handle;if(!i)return Ob.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+a,ref:o});if(typeof i=="function")return i(a,o);var s=typeof i.type=="string",l=aF({ref:o},s?{}:{handleAxis:a});return Ob.cloneElement(i,l)},r.render=function(){var a=this,o=this.props,i=o.children,s=o.className,l=o.draggableOpts,c=o.width,d=o.height,u=o.handle,p=o.handleSize,m=o.lockAspectRatio,h=o.axis,f=o.minConstraints,b=o.maxConstraints,v=o.onResize,y=o.onResizeStop,g=o.onResizeStart,w=o.resizeHandles,C=o.transformScale,k=Yve(o,Vve);return(0,qve.cloneElement)(i,aF(aF({},k),{},{className:(s?s+" ":"")+"react-resizable",children:[].concat(i.props.children,w.map(function(x){var S,T=(S=a.handleRefs[x])!=null?S:a.handleRefs[x]=Ob.createRef();return Ob.createElement(Uve.DraggableCore,oF({},l,{nodeRef:T,key:"resizableHandle-"+x,onStop:a.resizeHandler("onResizeStop",x),onStart:a.resizeHandler("onResizeStart",x),onDrag:a.resizeHandler("onResize",x)}),a.renderResizeHandle(x,T))}))}))},t}(Ob.Component);wT.default=sF;sF.propTypes=Hve.resizableProps;sF.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}});var OK=de(kT=>{"use strict";kT.__esModule=!0;kT.default=void 0;var cF=nye(B()),Zve=NK(Tc()),eye=NK(lF()),tye=nF(),rye=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function NK(e){return e&&e.__esModule?e:{default:e}}function LK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(LK=function(a){return a?r:t})(e)}function nye(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=LK(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function dF(){return dF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dF.apply(this,arguments)}function IK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ST(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IK(Object(r),!0).forEach(function(n){aye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aye(e,t,r){return t=oye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oye(e){var t=iye(e,"string");return typeof t=="symbol"?t:String(t)}function iye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sye(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,o;for(o=0;o<n.length;o++)a=n[o],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function lye(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,uF(e,t)}function uF(e,t){return uF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},uF(e,t)}var MK=function(e){lye(t,e);function t(){for(var n,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(s,l){var c=l.size;n.props.onResize?(s.persist==null||s.persist(),n.setState(c,function(){return n.props.onResize&&n.props.onResize(s,l)})):n.setState(c)},n}t.getDerivedStateFromProps=function(a,o){return o.propsWidth!==a.width||o.propsHeight!==a.height?{width:a.width,height:a.height,propsWidth:a.width,propsHeight:a.height}:null};var r=t.prototype;return r.render=function(){var a=this.props,o=a.handle,i=a.handleSize,s=a.onResize,l=a.onResizeStart,c=a.onResizeStop,d=a.draggableOpts,u=a.minConstraints,p=a.maxConstraints,m=a.lockAspectRatio,h=a.axis,f=a.width,b=a.height,v=a.resizeHandles,y=a.style,g=a.transformScale,w=sye(a,rye);return cF.createElement(eye.default,{axis:h,draggableOpts:d,handle:o,handleSize:i,height:this.state.height,lockAspectRatio:m,maxConstraints:p,minConstraints:u,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:v,transformScale:g,width:this.state.width},cF.createElement("div",dF({},w,{style:ST(ST({},y),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},t}(cF.Component);kT.default=MK;MK.propTypes=ST(ST({},tye.resizableProps),{},{children:Zve.default.element})});var FK=de((QQe,CT)=>{"use strict";CT.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};CT.exports.Resizable=lF().default;CT.exports.ResizableBox=OK().default});var pF=de(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.resizeHandleType=Gd.resizeHandleAxesType=Gd.default=void 0;var ut=jK(Tc()),cye=jK(B());function jK(e){return e&&e.__esModule?e:{default:e}}var dye=Gd.resizeHandleAxesType=ut.default.arrayOf(ut.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),uye=Gd.resizeHandleType=ut.default.oneOfType([ut.default.node,ut.default.func]),ZQe=Gd.default={className:ut.default.string,style:ut.default.object,width:ut.default.number,autoSize:ut.default.bool,cols:ut.default.number,draggableCancel:ut.default.string,draggableHandle:ut.default.string,verticalCompact:function(e){e.verticalCompact},compactType:ut.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;t!==void 0&&Ip().validateLayout(t,"layout")},margin:ut.default.arrayOf(ut.default.number),containerPadding:ut.default.arrayOf(ut.default.number),rowHeight:ut.default.number,maxRows:ut.default.number,isBounded:ut.default.bool,isDraggable:ut.default.bool,isResizable:ut.default.bool,allowOverlap:ut.default.bool,preventCollision:ut.default.bool,useCSSTransforms:ut.default.bool,transformScale:ut.default.number,isDroppable:ut.default.bool,resizeHandles:dye,resizeHandle:uye,onLayoutChange:ut.default.func,onDragStart:ut.default.func,onDrag:ut.default.func,onDragStop:ut.default.func,onResizeStart:ut.default.func,onResize:ut.default.func,onResizeStop:ut.default.func,onDrop:ut.default.func,droppingItem:ut.default.shape({i:ut.default.string.isRequired,w:ut.default.number.isRequired,h:ut.default.number.isRequired}),children:function(e,t){let r=e[t],n={};cye.default.Children.forEach(r,function(a){if((a==null?void 0:a.key)!=null){if(n[a.key])throw new Error('Duplicate child key "'+a.key+'" found! This will cause problems in ReactGridLayout.');n[a.key]=!0}})},innerRef:ut.default.any}});var BK=de(TT=>{"use strict";Object.defineProperty(TT,"__esModule",{value:!0});TT.default=void 0;var Eg=mF(B()),zK=Yl(),Rt=mF(Tc()),pye=bT(),mye=FK(),Ag=Ip(),ba=uT(),_K=pF(),fye=mF(sT());function mF(e){return e&&e.__esModule?e:{default:e}}function Ll(e,t,r){return t=gye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gye(e){var t=hye(e,"string");return typeof t=="symbol"?t:String(t)}function hye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fb=class extends Eg.default.Component{constructor(){super(...arguments),Ll(this,"state",{resizing:null,dragging:null,className:""}),Ll(this,"elementRef",Eg.default.createRef()),Ll(this,"onDragStart",(t,r)=>{let{node:n}=r,{onDragStart:a,transformScale:o}=this.props;if(!a)return;let i={top:0,left:0},{offsetParent:s}=n;if(!s)return;let l=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=c.left/o,u=l.left/o,p=c.top/o,m=l.top/o;i.left=d-u+s.scrollLeft,i.top=p-m+s.scrollTop,this.setState({dragging:i});let{x:h,y:f}=(0,ba.calcXY)(this.getPositionParams(),i.top,i.left,this.props.w,this.props.h);return a.call(this,this.props.i,h,f,{e:t,node:n,newPosition:i})}),Ll(this,"onDrag",(t,r,n)=>{let{node:a,deltaX:o,deltaY:i}=r,{onDrag:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let l=this.state.dragging.top+i,c=this.state.dragging.left+o,{isBounded:d,i:u,w:p,h:m,containerWidth:h}=this.props,f=this.getPositionParams();if(d){let{offsetParent:g}=a;if(g){let{margin:w,rowHeight:C,containerPadding:k}=this.props,x=g.clientHeight-(0,ba.calcGridItemWHPx)(m,C,w[1]);l=(0,ba.clamp)(l-k[1],0,x);let S=(0,ba.calcGridColWidth)(f),T=h-(0,ba.calcGridItemWHPx)(p,S,w[0]);c=(0,ba.clamp)(c-k[0],0,T)}}let b={top:l,left:c};n?this.setState({dragging:b}):(0,zK.flushSync)(()=>{this.setState({dragging:b})});let{x:v,y}=(0,ba.calcXY)(f,l,c,p,m);return s.call(this,u,v,y,{e:t,node:a,newPosition:b})}),Ll(this,"onDragStop",(t,r)=>{let{node:n}=r,{onDragStop:a}=this.props;if(!a)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");let{w:o,h:i,i:s}=this.props,{left:l,top:c}=this.state.dragging,d={top:c,left:l};this.setState({dragging:null});let{x:u,y:p}=(0,ba.calcXY)(this.getPositionParams(),c,l,o,i);return a.call(this,s,u,p,{e:t,node:n,newPosition:d})}),Ll(this,"onResizeStop",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStop")),Ll(this,"onResizeStart",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStart")),Ll(this,"onResize",(t,r,n)=>this.onResizeHandler(t,r,n,"onResize"))}shouldComponentUpdate(t,r){if(this.props.children!==t.children||this.props.droppingPosition!==t.droppingPosition)return!0;let n=(0,ba.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),a=(0,ba.calcGridItemPosition)(this.getPositionParams(t),t.x,t.y,t.w,t.h,r);return!(0,Ag.fastPositionEqual)(n,a)||this.props.useCSSTransforms!==t.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(t){this.moveDroppingItem(t)}moveDroppingItem(t){let{droppingPosition:r}=this.props;if(!r)return;let n=this.elementRef.current;if(!n)return;let a=t.droppingPosition||{left:0,top:0},{dragging:o}=this.state,i=o&&r.left!==a.left||r.top!==a.top;if(!o)this.onDragStart(r.e,{node:n,deltaX:r.left,deltaY:r.top});else if(i){let s=r.left-o.left,l=r.top-o.top;this.onDrag(r.e,{node:n,deltaX:s,deltaY:l},!0)}}getPositionParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:t.cols,containerPadding:t.containerPadding,containerWidth:t.containerWidth,margin:t.margin,maxRows:t.maxRows,rowHeight:t.rowHeight}}createStyle(t){let{usePercentages:r,containerWidth:n,useCSSTransforms:a}=this.props,o;return a?o=(0,Ag.setTransform)(t):(o=(0,Ag.setTopLeft)(t),r&&(o.left=(0,Ag.perc)(t.left/n),o.width=(0,Ag.perc)(t.width/n))),o}mixinDraggable(t,r){return Eg.default.createElement(pye.DraggableCore,{disabled:!r,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},t)}curryResizeHandler(t,r){return(n,a)=>r(n,a,t)}mixinResizable(t,r,n){let{cols:a,minW:o,minH:i,maxW:s,maxH:l,transformScale:c,resizeHandles:d,resizeHandle:u}=this.props,p=this.getPositionParams(),m=(0,ba.calcGridItemPosition)(p,0,0,a,0).width,h=(0,ba.calcGridItemPosition)(p,0,0,o,i),f=(0,ba.calcGridItemPosition)(p,0,0,s,l),b=[h.width,h.height],v=[Math.min(f.width,m),Math.min(f.height,1/0)];return Eg.default.createElement(mye.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:r.width,height:r.height,minConstraints:b,maxConstraints:v,onResizeStop:this.curryResizeHandler(r,this.onResizeStop),onResizeStart:this.curryResizeHandler(r,this.onResizeStart),onResize:this.curryResizeHandler(r,this.onResize),transformScale:c,resizeHandles:d,handle:u},t)}onResizeHandler(t,r,n,a){let{node:o,size:i,handle:s}=r,l=this.props[a];if(!l)return;let{x:c,y:d,i:u,maxH:p,minH:m,containerWidth:h}=this.props,{minW:f,maxW:b}=this.props,v=i;o&&(v=(0,Ag.resizeItemInDirection)(s,n,i,h),(0,zK.flushSync)(()=>{this.setState({resizing:a==="onResizeStop"?null:v})}));let{w:y,h:g}=(0,ba.calcWH)(this.getPositionParams(),v.width,v.height,c,d,s);y=(0,ba.clamp)(y,Math.max(f,1),b),g=(0,ba.clamp)(g,m,p),l.call(this,u,y,g,{e:t,node:o,size:v,handle:s})}render(){let{x:t,y:r,w:n,h:a,isDraggable:o,isResizable:i,droppingPosition:s,useCSSTransforms:l}=this.props,c=(0,ba.calcGridItemPosition)(this.getPositionParams(),t,r,n,a,this.state),d=Eg.default.Children.only(this.props.children),u=Eg.default.cloneElement(d,{ref:this.elementRef,className:(0,fye.default)("react-grid-item",d.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":o,"react-draggable-dragging":!!this.state.dragging,dropping:!!s,cssTransforms:l}),style:{...this.props.style,...d.props.style,...this.createStyle(c)}});return u=this.mixinResizable(u,c,i),u=this.mixinDraggable(u,o),u}};TT.default=Fb;Ll(Fb,"propTypes",{children:Rt.default.element,cols:Rt.default.number.isRequired,containerWidth:Rt.default.number.isRequired,rowHeight:Rt.default.number.isRequired,margin:Rt.default.array.isRequired,maxRows:Rt.default.number.isRequired,containerPadding:Rt.default.array.isRequired,x:Rt.default.number.isRequired,y:Rt.default.number.isRequired,w:Rt.default.number.isRequired,h:Rt.default.number.isRequired,minW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minWidth not Number");if(r>e.w||r>e.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxWidth not Number");if(r<e.w||r<e.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minHeight not Number");if(r>e.h||r>e.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxHeight not Number");if(r<e.h||r<e.minH)return new Error("maxHeight smaller than item height/minHeight")},i:Rt.default.string.isRequired,resizeHandles:_K.resizeHandleAxesType,resizeHandle:_K.resizeHandleType,onDragStop:Rt.default.func,onDragStart:Rt.default.func,onDrag:Rt.default.func,onResizeStop:Rt.default.func,onResizeStart:Rt.default.func,onResize:Rt.default.func,isDraggable:Rt.default.bool.isRequired,isResizable:Rt.default.bool.isRequired,isBounded:Rt.default.bool.isRequired,static:Rt.default.bool,useCSSTransforms:Rt.default.bool.isRequired,transformScale:Rt.default.number,className:Rt.default.string,handle:Rt.default.string,cancel:Rt.default.string,droppingPosition:Rt.default.shape({e:Rt.default.object.isRequired,left:Rt.default.number.isRequired,top:Rt.default.number.isRequired})});Ll(Fb,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})});var hF=de(PT=>{"use strict";Object.defineProperty(PT,"__esModule",{value:!0});PT.default=void 0;var Op=xye(B()),fF=iT(),vye=gF(sT()),rt=Ip(),yye=uT(),$K=gF(BK()),bye=gF(pF());function gF(e){return e&&e.__esModule?e:{default:e}}function WK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(WK=function(n){return n?r:t})(e)}function xye(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=WK(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function Wa(e,t,r){return t=wye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wye(e){var t=Sye(e,"string");return typeof t=="symbol"?t:String(t)}function Sye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RK="react-grid-layout",UK=!1;try{UK=/firefox/i.test(navigator.userAgent)}catch(e){}var Ig=class extends Op.Component{constructor(){super(...arguments),Wa(this,"state",{activeDrag:null,layout:(0,rt.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,rt.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),Wa(this,"dragEnterCounter",0),Wa(this,"onDragStart",(t,r,n,a)=>{let{e:o,node:i}=a,{layout:s}=this.state,l=(0,rt.getLayoutItem)(s,t);if(!l)return;let c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:t};return this.setState({oldDragItem:(0,rt.cloneLayoutItem)(l),oldLayout:s,activeDrag:c}),this.props.onDragStart(s,l,l,null,o,i)}),Wa(this,"onDrag",(t,r,n,a)=>{let{e:o,node:i}=a,{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,allowOverlap:d,preventCollision:u}=this.props,p=(0,rt.getLayoutItem)(l,t);if(!p)return;let m={w:p.w,h:p.h,x:p.x,y:p.y,placeholder:!0,i:t};l=(0,rt.moveElement)(l,p,r,n,!0,u,(0,rt.compactType)(this.props),c,d),this.props.onDrag(l,s,p,m,o,i),this.setState({layout:d?l:(0,rt.compact)(l,(0,rt.compactType)(this.props),c),activeDrag:m})}),Wa(this,"onDragStop",(t,r,n,a)=>{let{e:o,node:i}=a;if(!this.state.activeDrag)return;let{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,preventCollision:d,allowOverlap:u}=this.props,p=(0,rt.getLayoutItem)(l,t);if(!p)return;l=(0,rt.moveElement)(l,p,r,n,!0,d,(0,rt.compactType)(this.props),c,u);let h=u?l:(0,rt.compact)(l,(0,rt.compactType)(this.props),c);this.props.onDragStop(h,s,p,null,o,i);let{oldLayout:f}=this.state;this.setState({activeDrag:null,layout:h,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(h,f)}),Wa(this,"onResizeStart",(t,r,n,a)=>{let{e:o,node:i}=a,{layout:s}=this.state,l=(0,rt.getLayoutItem)(s,t);l&&(this.setState({oldResizeItem:(0,rt.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(s,l,l,null,o,i))}),Wa(this,"onResize",(t,r,n,a)=>{let{e:o,node:i,size:s,handle:l}=a,{oldResizeItem:c}=this.state,{layout:d}=this.state,{cols:u,preventCollision:p,allowOverlap:m}=this.props,h=!1,f,b,v,[y,g]=(0,rt.withLayoutItem)(d,t,C=>{let k;return b=C.x,v=C.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(b=C.x+(C.w-r),r=C.x!==b&&b<0?C.w:r,b=b<0?0:b),["ne","n","nw"].indexOf(l)!==-1&&(v=C.y+(C.h-n),n=C.y!==v&&v<0?C.h:n,v=v<0?0:v),h=!0),p&&!m&&(k=(0,rt.getAllCollisions)(d,{...C,w:r,h:n,x:b,y:v}).filter(S=>S.i!==C.i).length>0,k&&(v=C.y,n=C.h,b=C.x,r=C.w,h=!1)),C.w=r,C.h=n,C});if(!g)return;f=y,h&&(f=(0,rt.moveElement)(y,g,b,v,!0,this.props.preventCollision,(0,rt.compactType)(this.props),u,m));let w={w:g.w,h:g.h,x:g.x,y:g.y,static:!0,i:t};this.props.onResize(f,c,g,w,o,i),this.setState({layout:m?f:(0,rt.compact)(f,(0,rt.compactType)(this.props),u),activeDrag:w})}),Wa(this,"onResizeStop",(t,r,n,a)=>{let{e:o,node:i}=a,{layout:s,oldResizeItem:l}=this.state,{cols:c,allowOverlap:d}=this.props,u=(0,rt.getLayoutItem)(s,t),p=d?s:(0,rt.compact)(s,(0,rt.compactType)(this.props),c);this.props.onResizeStop(p,l,u,null,o,i);let{oldLayout:m}=this.state;this.setState({activeDrag:null,layout:p,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(p,m)}),Wa(this,"onDragOver",t=>{var y;if(t.preventDefault(),t.stopPropagation(),UK&&!((y=t.nativeEvent.target)!=null&&y.classList.contains(RK)))return!1;let{droppingItem:r,onDropDragOver:n,margin:a,cols:o,rowHeight:i,maxRows:s,width:l,containerPadding:c,transformScale:d}=this.props,u=n==null?void 0:n(t);if(u===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;let p={...r,...u},{layout:m}=this.state,h=t.currentTarget.getBoundingClientRect(),f=t.clientX-h.left,b=t.clientY-h.top,v={left:f/d,top:b/d,e:t};if(this.state.droppingDOMNode){if(this.state.droppingPosition){let{left:g,top:w}=this.state.droppingPosition;(g!=f||w!=b)&&this.setState({droppingPosition:v})}}else{let g={cols:o,margin:a,maxRows:s,rowHeight:i,containerWidth:l,containerPadding:c||a},w=(0,yye.calcXY)(g,b,f,p.w,p.h);this.setState({droppingDOMNode:Op.createElement("div",{key:p.i}),droppingPosition:v,layout:[...m,{...p,x:w.x,y:w.y,static:!1,isDraggable:!0}]})}}),Wa(this,"removeDroppingPlaceholder",()=>{let{droppingItem:t,cols:r}=this.props,{layout:n}=this.state,a=(0,rt.compact)(n.filter(o=>o.i!==t.i),(0,rt.compactType)(this.props),r,this.props.allowOverlap);this.setState({layout:a,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),Wa(this,"onDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),Wa(this,"onDragEnter",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter++}),Wa(this,"onDrop",t=>{t.preventDefault(),t.stopPropagation();let{droppingItem:r}=this.props,{layout:n}=this.state,a=n.find(o=>o.i===r.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,a,t)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(t,r){let n;return r.activeDrag?null:(!(0,fF.deepEqual)(t.layout,r.propsLayout)||t.compactType!==r.compactType?n=t.layout:(0,rt.childrenEqual)(t.children,r.children)||(n=r.layout),n?{layout:(0,rt.synchronizeLayoutWithChildren)(n,t.children,t.cols,(0,rt.compactType)(t),t.allowOverlap),compactType:t.compactType,children:t.children,propsLayout:t.layout}:null)}shouldComponentUpdate(t,r){return this.props.children!==t.children||!(0,rt.fastRGLPropsEqual)(this.props,t,fF.deepEqual)||this.state.activeDrag!==r.activeDrag||this.state.mounted!==r.mounted||this.state.droppingPosition!==r.droppingPosition}componentDidUpdate(t,r){if(!this.state.activeDrag){let n=this.state.layout,a=r.layout;this.onLayoutMaybeChanged(n,a)}}containerHeight(){if(!this.props.autoSize)return;let t=(0,rt.bottom)(this.state.layout),r=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return t*this.props.rowHeight+(t-1)*this.props.margin[1]+r*2+"px"}onLayoutMaybeChanged(t,r){r||(r=this.state.layout),(0,fF.deepEqual)(r,t)||this.props.onLayoutChange(t)}placeholder(){let{activeDrag:t}=this.state;if(!t)return null;let{width:r,cols:n,margin:a,containerPadding:o,rowHeight:i,maxRows:s,useCSSTransforms:l,transformScale:c}=this.props;return Op.createElement($K.default,{w:t.w,h:t.h,x:t.x,y:t.y,i:t.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:r,cols:n,margin:a,containerPadding:o||a,maxRows:s,rowHeight:i,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},Op.createElement("div",null))}processGridItem(t,r){if(!t||!t.key)return;let n=(0,rt.getLayoutItem)(this.state.layout,String(t.key));if(!n)return null;let{width:a,cols:o,margin:i,containerPadding:s,rowHeight:l,maxRows:c,isDraggable:d,isResizable:u,isBounded:p,useCSSTransforms:m,transformScale:h,draggableCancel:f,draggableHandle:b,resizeHandles:v,resizeHandle:y}=this.props,{mounted:g,droppingPosition:w}=this.state,C=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&d,k=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&u,x=n.resizeHandles||v,S=C&&p&&n.isBounded!==!1;return Op.createElement($K.default,{containerWidth:a,cols:o,margin:i,containerPadding:s||i,maxRows:c,rowHeight:l,cancel:f,handle:b,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:C,isResizable:k,isBounded:S,useCSSTransforms:m&&g,usePercentages:!g,transformScale:h,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:r?w:void 0,resizeHandles:x,resizeHandle:y},t)}render(){let{className:t,style:r,isDroppable:n,innerRef:a}=this.props,o=(0,vye.default)(RK,t),i={height:this.containerHeight(),...r};return Op.createElement("div",{ref:a,className:o,style:i,onDrop:n?this.onDrop:rt.noop,onDragLeave:n?this.onDragLeave:rt.noop,onDragEnter:n?this.onDragEnter:rt.noop,onDragOver:n?this.onDragOver:rt.noop},Op.Children.map(this.props.children,s=>this.processGridItem(s)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};PT.default=Ig;Wa(Ig,"displayName","ReactGridLayout");Wa(Ig,"propTypes",bye.default);Wa(Ig,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:rt.noop,onDragStart:rt.noop,onDrag:rt.noop,onDragStop:rt.noop,onResizeStart:rt.noop,onResize:rt.noop,onResizeStop:rt.noop,onDrop:rt.noop,onDropDragOver:rt.noop})});var yF=de(Ng=>{"use strict";Object.defineProperty(Ng,"__esModule",{value:!0});Ng.findOrGenerateResponsiveLayout=Tye;Ng.getBreakpointFromWidth=kye;Ng.getColsFromBreakpoint=Cye;Ng.sortBreakpoints=vF;var DT=Ip();function kye(e,t){let r=vF(e),n=r[0];for(let a=1,o=r.length;a<o;a++){let i=r[a];t>e[i]&&(n=i)}return n}function Cye(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]}function Tye(e,t,r,n,a,o){if(e[r])return(0,DT.cloneLayout)(e[r]);let i=e[n],s=vF(t),l=s.slice(s.indexOf(r));for(let c=0,d=l.length;c<d;c++){let u=l[c];if(e[u]){i=e[u];break}}return i=(0,DT.cloneLayout)(i||[]),(0,DT.compact)((0,DT.correctBounds)(i,{cols:a}),o,a)}function vF(e){return Object.keys(e).sort(function(r,n){return e[r]-e[n]})}});var YK=de(IT=>{"use strict";Object.defineProperty(IT,"__esModule",{value:!0});IT.default=void 0;var qK=Dye(B()),Ro=VK(Tc()),bF=iT(),Lg=Ip(),Fp=yF(),Pye=VK(hF());function VK(e){return e&&e.__esModule?e:{default:e}}function GK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(GK=function(n){return n?r:t})(e)}function Dye(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=GK(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function xF(){return xF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xF.apply(this,arguments)}function AT(e,t,r){return t=Eye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eye(e){var t=Aye(e,"string");return typeof t=="symbol"?t:String(t)}function Aye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HK=e=>Object.prototype.toString.call(e);function ET(e,t){return e==null?null:Array.isArray(e)?e:e[t]}var jb=class extends qK.Component{constructor(){super(...arguments),AT(this,"state",this.generateInitialState()),AT(this,"onLayoutChange",t=>{this.props.onLayoutChange(t,{...this.props.layouts,[this.state.breakpoint]:t})})}generateInitialState(){let{width:t,breakpoints:r,layouts:n,cols:a}=this.props,o=(0,Fp.getBreakpointFromWidth)(r,t),i=(0,Fp.getColsFromBreakpoint)(o,a),s=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Fp.findOrGenerateResponsiveLayout)(n,r,o,o,i,s),breakpoint:o,cols:i}}static getDerivedStateFromProps(t,r){if(!(0,bF.deepEqual)(t.layouts,r.layouts)){let{breakpoint:n,cols:a}=r;return{layout:(0,Fp.findOrGenerateResponsiveLayout)(t.layouts,t.breakpoints,n,n,a,t.compactType),layouts:t.layouts}}return null}componentDidUpdate(t){(this.props.width!=t.width||this.props.breakpoint!==t.breakpoint||!(0,bF.deepEqual)(this.props.breakpoints,t.breakpoints)||!(0,bF.deepEqual)(this.props.cols,t.cols))&&this.onWidthChange(t)}onWidthChange(t){let{breakpoints:r,cols:n,layouts:a,compactType:o}=this.props,i=this.props.breakpoint||(0,Fp.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),s=this.state.breakpoint,l=(0,Fp.getColsFromBreakpoint)(i,n),c={...a};if(s!==i||t.breakpoints!==r||t.cols!==n){s in c||(c[s]=(0,Lg.cloneLayout)(this.state.layout));let p=(0,Fp.findOrGenerateResponsiveLayout)(c,r,i,s,l,o);p=(0,Lg.synchronizeLayoutWithChildren)(p,this.props.children,l,o,this.props.allowOverlap),c[i]=p,this.props.onBreakpointChange(i,l),this.props.onLayoutChange(p,c),this.setState({breakpoint:i,layout:p,cols:l})}let d=ET(this.props.margin,i),u=ET(this.props.containerPadding,i);this.props.onWidthChange(this.props.width,d,l,u)}render(){let{breakpoint:t,breakpoints:r,cols:n,layouts:a,margin:o,containerPadding:i,onBreakpointChange:s,onLayoutChange:l,onWidthChange:c,...d}=this.props;return qK.createElement(Pye.default,xF({},d,{margin:ET(o,this.state.breakpoint),containerPadding:ET(i,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}};IT.default=jb;AT(jb,"propTypes",{breakpoint:Ro.default.string,breakpoints:Ro.default.object,allowOverlap:Ro.default.bool,cols:Ro.default.object,margin:Ro.default.oneOfType([Ro.default.array,Ro.default.object]),containerPadding:Ro.default.oneOfType([Ro.default.array,Ro.default.object]),layouts(e,t){if(HK(e[t])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+HK(e[t]));Object.keys(e[t]).forEach(r=>{if(!(r in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,Lg.validateLayout)(e.layouts[r],"layouts."+r)})},width:Ro.default.number.isRequired,onBreakpointChange:Ro.default.func,onLayoutChange:Ro.default.func,onWidthChange:Ro.default.func});AT(jb,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:Lg.noop,onLayoutChange:Lg.noop,onWidthChange:Lg.noop})});var KK=de((wF,SF)=>{(function(e,t){typeof wF=="object"&&typeof SF!="undefined"?SF.exports=t():typeof define=="function"&&define.amd?define(t):e.ResizeObserver=t()})(wF,function(){"use strict";var e=function(){if(typeof Map!="undefined")return Map;function A(L,N){var E=-1;return L.some(function(I,O){return I[0]===N?(E=O,!0):!1}),E}return function(){function L(){this.__entries__=[]}return Object.defineProperty(L.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),L.prototype.get=function(N){var E=A(this.__entries__,N),I=this.__entries__[E];return I&&I[1]},L.prototype.set=function(N,E){var I=A(this.__entries__,N);~I?this.__entries__[I][1]=E:this.__entries__.push([N,E])},L.prototype.delete=function(N){var E=this.__entries__,I=A(E,N);~I&&E.splice(I,1)},L.prototype.has=function(N){return!!~A(this.__entries__,N)},L.prototype.clear=function(){this.__entries__.splice(0)},L.prototype.forEach=function(N,E){E===void 0&&(E=null);for(var I=0,O=this.__entries__;I<O.length;I++){var j=O[I];N.call(E,j[1],j[0])}},L}()}(),t=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,r=function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()}(),n=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(r):function(A){return setTimeout(function(){return A(Date.now())},1e3/60)}}(),a=2;function o(A,L){var N=!1,E=!1,I=0;function O(){N&&(N=!1,A()),E&&$()}function j(){n(O)}function $(){var F=Date.now();if(N){if(F-I<a)return;E=!0}else N=!0,E=!1,setTimeout(j,L);I=F}return $}var i=20,s=["top","right","bottom","left","width","height","size","weight"],l=typeof MutationObserver!="undefined",c=function(){function A(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=o(this.refresh.bind(this),i)}return A.prototype.addObserver=function(L){~this.observers_.indexOf(L)||this.observers_.push(L),this.connected_||this.connect_()},A.prototype.removeObserver=function(L){var N=this.observers_,E=N.indexOf(L);~E&&N.splice(E,1),!N.length&&this.connected_&&this.disconnect_()},A.prototype.refresh=function(){var L=this.updateObservers_();L&&this.refresh()},A.prototype.updateObservers_=function(){var L=this.observers_.filter(function(N){return N.gatherActive(),N.hasActive()});return L.forEach(function(N){return N.broadcastActive()}),L.length>0},A.prototype.connect_=function(){!t||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},A.prototype.disconnect_=function(){!t||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},A.prototype.onTransitionEnd_=function(L){var N=L.propertyName,E=N===void 0?"":N,I=s.some(function(O){return!!~E.indexOf(O)});I&&this.refresh()},A.getInstance=function(){return this.instance_||(this.instance_=new A),this.instance_},A.instance_=null,A}(),d=function(A,L){for(var N=0,E=Object.keys(L);N<E.length;N++){var I=E[N];Object.defineProperty(A,I,{value:L[I],enumerable:!1,writable:!1,configurable:!0})}return A},u=function(A){var L=A&&A.ownerDocument&&A.ownerDocument.defaultView;return L||r},p=k(0,0,0,0);function m(A){return parseFloat(A)||0}function h(A){for(var L=[],N=1;N<arguments.length;N++)L[N-1]=arguments[N];return L.reduce(function(E,I){var O=A["border-"+I+"-width"];return E+m(O)},0)}function f(A){for(var L=["top","right","bottom","left"],N={},E=0,I=L;E<I.length;E++){var O=I[E],j=A["padding-"+O];N[O]=m(j)}return N}function b(A){var L=A.getBBox();return k(0,0,L.width,L.height)}function v(A){var L=A.clientWidth,N=A.clientHeight;if(!L&&!N)return p;var E=u(A).getComputedStyle(A),I=f(E),O=I.left+I.right,j=I.top+I.bottom,$=m(E.width),F=m(E.height);if(E.boxSizing==="border-box"&&(Math.round($+O)!==L&&($-=h(E,"left","right")+O),Math.round(F+j)!==N&&(F-=h(E,"top","bottom")+j)),!g(A)){var z=Math.round($+O)-L,W=Math.round(F+j)-N;Math.abs(z)!==1&&($-=z),Math.abs(W)!==1&&(F-=W)}return k(I.left,I.top,$,F)}var y=function(){return typeof SVGGraphicsElement!="undefined"?function(A){return A instanceof u(A).SVGGraphicsElement}:function(A){return A instanceof u(A).SVGElement&&typeof A.getBBox=="function"}}();function g(A){return A===u(A).document.documentElement}function w(A){return t?y(A)?b(A):v(A):p}function C(A){var L=A.x,N=A.y,E=A.width,I=A.height,O=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,j=Object.create(O.prototype);return d(j,{x:L,y:N,width:E,height:I,top:N,right:L+E,bottom:I+N,left:L}),j}function k(A,L,N,E){return{x:A,y:L,width:N,height:E}}var x=function(){function A(L){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=k(0,0,0,0),this.target=L}return A.prototype.isActive=function(){var L=w(this.target);return this.contentRect_=L,L.width!==this.broadcastWidth||L.height!==this.broadcastHeight},A.prototype.broadcastRect=function(){var L=this.contentRect_;return this.broadcastWidth=L.width,this.broadcastHeight=L.height,L},A}(),S=function(){function A(L,N){var E=C(N);d(this,{target:L,contentRect:E})}return A}(),T=function(){function A(L,N,E){if(this.activeObservations_=[],this.observations_=new e,typeof L!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=L,this.controller_=N,this.callbackCtx_=E}return A.prototype.observe=function(L){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(L instanceof u(L).Element))throw new TypeError('parameter 1 is not of type "Element".');var N=this.observations_;N.has(L)||(N.set(L,new x(L)),this.controller_.addObserver(this),this.controller_.refresh())}},A.prototype.unobserve=function(L){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(L instanceof u(L).Element))throw new TypeError('parameter 1 is not of type "Element".');var N=this.observations_;N.has(L)&&(N.delete(L),N.size||this.controller_.removeObserver(this))}},A.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},A.prototype.gatherActive=function(){var L=this;this.clearActive(),this.observations_.forEach(function(N){N.isActive()&&L.activeObservations_.push(N)})},A.prototype.broadcastActive=function(){if(this.hasActive()){var L=this.callbackCtx_,N=this.activeObservations_.map(function(E){return new S(E.target,E.broadcastRect())});this.callback_.call(L,N,L),this.clearActive()}},A.prototype.clearActive=function(){this.activeObservations_.splice(0)},A.prototype.hasActive=function(){return this.activeObservations_.length>0},A}(),P=typeof WeakMap!="undefined"?new WeakMap:new e,M=function(){function A(L){if(!(this instanceof A))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var N=c.getInstance(),E=new T(L,N,this);P.set(this,E)}return A}();["observe","unobserve","disconnect"].forEach(function(A){M.prototype[A]=function(){var L;return(L=P.get(this))[A].apply(L,arguments)}});var D=function(){return typeof r.ResizeObserver!="undefined"?r.ResizeObserver:M}();return D})});var XK=de(TF=>{"use strict";Object.defineProperty(TF,"__esModule",{value:!0});TF.default=zye;var NT=Mye(B()),Iye=CF(Tc()),Nye=CF(KK()),Lye=CF(sT());function CF(e){return e&&e.__esModule?e:{default:e}}function JK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(JK=function(n){return n?r:t})(e)}function Mye(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=JK(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function kF(){return kF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kF.apply(this,arguments)}function Mg(e,t,r){return t=Oye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oye(e){var t=Fye(e,"string");return typeof t=="symbol"?t:String(t)}function Fye(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jye="react-grid-layout";function zye(e){var t;return t=class extends NT.Component{constructor(){super(...arguments),Mg(this,"state",{width:1280}),Mg(this,"elementRef",NT.createRef()),Mg(this,"mounted",!1),Mg(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new Nye.default(a=>{if(this.elementRef.current instanceof HTMLElement){let i=a[0].contentRect.width;this.setState({width:i})}});let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){let{measureBeforeMount:n,...a}=this.props;return n&&!this.mounted?NT.createElement("div",{className:(0,Lye.default)(this.props.className,jye),style:this.props.style,ref:this.elementRef}):NT.createElement(e,kF({innerRef:this.elementRef},a,this.state))}},Mg(t,"defaultProps",{measureBeforeMount:!1}),Mg(t,"propTypes",{measureBeforeMount:Iye.default.bool}),t}});var QK=de((sZe,jp)=>{jp.exports=hF().default;jp.exports.utils=Ip();jp.exports.calculateUtils=uT();jp.exports.Responsive=YK().default;jp.exports.Responsive.utils=yF();jp.exports.WidthProvider=XK().default});var us,o7,i7=te(()=>{us=_(B()),o7=({currentStep:e,totalSteps:t,stepLabels:r,className:n=""})=>{let a=Math.max(0,Math.min(100,e/t*100));return us.default.createElement("div",{className:`wizard-progress-container ${n}`,role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":t,"aria-label":`Step ${e} of ${t}`,tabIndex:0},us.default.createElement("div",{className:"wizard-steps"},Array.from({length:t},(o,i)=>{let s=i+1,l=s<e,c=s===e,d=r==null?void 0:r[i];return us.default.createElement("div",{key:s,className:`wizard-step ${l?"completed":""} ${c?"current":""}`,"aria-label":d?`${d}${l?" (completed)":c?" (current)":""}`:`Step ${s}`},us.default.createElement("div",{className:"wizard-step-circle"},l?us.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true"},us.default.createElement("path",{d:"M2 6L5 9L10 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):us.default.createElement("span",{className:"wizard-step-number","aria-hidden":"true"},s)),d&&us.default.createElement("div",{className:"wizard-step-label"},d))})),us.default.createElement("div",{className:"wizard-progress-track","aria-hidden":"true"},us.default.createElement("div",{className:"wizard-progress-fill",style:{width:`${a}%`}})),us.default.createElement("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true"},"Step ",e," of ",t," completed",(r==null?void 0:r[e-1])&&`: ${r[e-1]}`))}});var $g,Yo,Jd=te(()=>{$g=_(B()),Yo=({title:e,subtitle:t,icon:r,className:n="",children:a})=>$g.default.createElement("div",{className:`onboarding-slide ${n}`},r&&$g.default.createElement("div",{className:"step-icon"},r),$g.default.createElement("h2",null,e),t&&$g.default.createElement("p",null,t),$g.default.createElement("div",{className:"step-content"},a))});var Rg,QT,n2=te(()=>{Rg=_(B()),QT=({icon:e,title:t,content:r,isPreview:n=!1,className:a=""})=>{let o=n?"insight-preview-card":"insight-card",i=n?"insight-preview-header":"insight-header",s=n?"insight-preview-icon":"insight-icon",l=n?"insight-preview-content":"insight-detail";return Rg.default.createElement("div",{className:`${o} ${a}`},Rg.default.createElement("div",{className:i},Rg.default.createElement("span",{className:s},e),Rg.default.createElement("strong",null,t)),Rg.default.createElement("div",{className:l},r))}});var Js,a2,s7=te(()=>{Js=_(B());Jd();n2();a2=({className:e=""})=>{let t=[{icon:"\u{1F4CA}",title:"Win Rate Analysis",content:'"Your breakout setups have an 82% win rate vs 67% for pullbacks"'},{icon:"\u23F0",title:"Timing Patterns",content:'"Trades held 2-4 hours show 3x better risk-reward than scalps"'},{icon:"\u{1F9E0}",title:"Psychology Tracking",content:'"You take profits 15% too early when up more than $500"'}],r=["Your data, your device - Complete ownership and control","Works with any broker - MetaTrader sync + manual entry","Fully customizable - Track what matters to you"];return Js.default.createElement(Yo,{title:"Welcome to Journalit",subtitle:"The trading journal that helps you turn insights into profits",className:`welcome-slide ${e}`},Js.default.createElement("div",{className:"welcome-preview-section"},Js.default.createElement("h3",null,"What you'll discover:"),Js.default.createElement("div",{className:"insights-preview"},t.map((n,a)=>Js.default.createElement(QT,{key:a,icon:n.icon,title:n.title,content:n.content,isPreview:!0})))),Js.default.createElement("div",{className:"welcome-trust-indicators"},r.map((n,a)=>Js.default.createElement("div",{key:a,className:"trust-item"},Js.default.createElement("span",{className:"trust-icon"},"\u2705"),Js.default.createElement("span",null,n)))),Js.default.createElement("div",{className:"welcome-tagline"},"Let's get you set up in under 60 seconds"))}});var uo,$b,o2=te(()=>{uo=_(B()),$b=({options:e,selectedValue:t,onSelect:r,className:n="",variant:a="default"})=>{let o=a==="goal"?"goal-options":"radio-options",i=a==="goal"?"goal-option":"radio-option",s=a==="goal"?"goal-radio":"option-radio",l=a==="goal"?"goal-radio-inner":"radio-inner",c=a==="goal"?"goal-content":"option-content";return uo.default.createElement("div",{className:`${o} ${n}`},e.map((d,u)=>uo.default.createElement("div",{key:d.value,className:`${i} ${t===d.value?"selected":""}`,onClick:()=>r(d.value),role:"button",tabIndex:0,autoFocus:u===0,onKeyPress:p=>p.key==="Enter"&&r(d.value)},uo.default.createElement("div",{className:s},uo.default.createElement("div",{className:`${l} ${t===d.value?"selected":""}`})),uo.default.createElement("div",{className:c},a==="goal"?uo.default.createElement(uo.default.Fragment,null,uo.default.createElement("h3",null,d.icon?`${d.icon} ${d.label}`:d.label),d.description&&uo.default.createElement("p",null,d.description),d.badge&&uo.default.createElement("span",{className:"goal-badge"},d.badge)):uo.default.createElement(uo.default.Fragment,null,uo.default.createElement("span",{className:"option-label"},d.label),d.description&&uo.default.createElement("span",{className:"option-description"},d.description))))))}});var Rb,i2,l7=te(()=>{Rb=_(B());Jd();o2();i2=({selectedGoal:e,onGoalSelect:t,className:r=""})=>{let n=[{value:"psychology",label:"Understand My Trading Psychology",description:"Identify emotional patterns and improve decision-making to become a more disciplined trader",badge:"Build better habits",icon:"\u{1F9E0}"},{value:"patterns",label:"Find Performance Patterns",description:"Discover what makes your winning trades different and optimize your strategy for consistent profits",badge:"Most popular",icon:"\u{1F4CA}"},{value:"automation",label:"Automate Everything",description:"Focus on trading while we handle the tracking - automatic data collection and analysis",badge:"Time saver",icon:"\u26A1"}],a=o=>{switch(o){case"psychology":return"Understand My Trading Psychology";case"patterns":return"Find Performance Patterns";case"automation":return"Automate Everything";default:return""}};return Rb.default.createElement(Yo,{title:"What's your trading goal?",subtitle:`Choose the approach that best fits your needs.
You can change this later.`,className:`goal-slide ${r}`},Rb.default.createElement($b,{options:n,selectedValue:e,onSelect:t,variant:"goal"}),e&&Rb.default.createElement("div",{className:"goal-selection-info"},"\u2713 You selected: ",Rb.default.createElement("strong",null,a(e))))}});var Wg,c7,d7=te(()=>{Wg=_(B()),c7=({options:e,selectedValues:t,onSelectionChange:r,className:n=""})=>{let a=o=>{let i=t.includes(o)?t.filter(s=>s!==o):[...t,o];r(i)};return Wg.default.createElement("div",{className:`multi-select-options ${n}`},e.map(o=>{let i=t.includes(o.value);return Wg.default.createElement("div",{key:o.value,className:`multi-select-option ${i?"selected":""}`,onClick:()=>a(o.value),role:"button",tabIndex:0,onKeyPress:s=>s.key==="Enter"&&a(o.value)},Wg.default.createElement("div",{className:"option-checkbox"},i&&Wg.default.createElement("span",null,"\u2713")),Wg.default.createElement("span",{className:"option-label"},o.label))}))}});var ps,s2,u7=te(()=>{ps=_(B());Jd();d7();o2();s2=({userSegmentation:e,onSegmentationChange:t,className:r=""})=>{let n=[{value:"stocks",label:"Stocks"},{value:"forex",label:"Forex"},{value:"crypto",label:"Crypto"},{value:"options",label:"Options"},{value:"futures",label:"Futures"}],a=[{value:"daily",label:"Daily",description:"Multiple trades per day"},{value:"weekly",label:"Weekly",description:"1-5 trades per week"},{value:"monthly",label:"Monthly",description:"Less than 5 trades per month"},{value:"occasional",label:"Occasionally",description:"When good opportunities arise"}],o=[{value:"emotional-control",label:"Emotional Control",description:"Managing fear and greed in trades"},{value:"strategy-optimization",label:"Strategy Optimization",description:"Finding and refining profitable setups"},{value:"record-keeping",label:"Record Keeping",description:"Consistently tracking all trades and data"},{value:"risk-management",label:"Risk Management",description:"Setting proper position sizes and stops"}],i=c=>{t({...e,instruments:c})},s=c=>{t({...e,frequency:c})},l=c=>{t({...e,challenge:c})};return ps.default.createElement(Yo,{title:"Tell us about your trading",subtitle:"Help us personalize your experience based on your trading style.",className:`segmentation-slide ${r}`},ps.default.createElement("div",{className:"segmentation-questions"},ps.default.createElement("div",{className:"segmentation-question"},ps.default.createElement("h3",null,"What do you primarily trade? (Select all that apply)"),ps.default.createElement(c7,{options:n,selectedValues:e.instruments,onSelectionChange:i})),ps.default.createElement("div",{className:"segmentation-question"},ps.default.createElement("h3",null,"How often do you trade?"),ps.default.createElement($b,{options:a,selectedValue:e.frequency,onSelect:s})),ps.default.createElement("div",{className:"segmentation-question"},ps.default.createElement("h3",null,"What's your biggest challenge?"),ps.default.createElement($b,{options:o,selectedValue:e.challenge,onSelect:l}))))}});var Ac,Ug,ZT=te(()=>{Ac=_(B()),Ug=({title:e,subtitle:t,actions:r,children:n,className:a=""})=>Ac.default.createElement("div",{className:`success-state ${a}`},Ac.default.createElement("div",{className:"success-checkmark"},"\u2713"),Ac.default.createElement("h3",null,e),t&&Ac.default.createElement("p",null,t),r&&r.length>0&&Ac.default.createElement("div",{className:"success-actions"},r.map((o,i)=>Ac.default.createElement("div",{key:i,className:"success-action"},Ac.default.createElement("span",{className:"action-icon"},o.icon),Ac.default.createElement("span",null,o.text)))),n)});var or,l2,p7=te(()=>{or=_(B());Jd();ZT();n2();yo();ec();l2=({goal:e,userSegmentation:t,sampleTradeCreated:r,sampleTradeFilePath:n,isLoading:a,onCreateSampleTrade:o,className:i=""})=>{let s=()=>{let d=t.instruments[0]||"stocks",u=t.frequency,p;switch(d){case"forex":p={trade:"EURUSD Long (+70 pips)",timeframe:u==="daily"?"30min scalp":u==="weekly"?"3-day swing":"1-week position"};break;case"crypto":p={trade:"BTC/USD Long (+$1,700)",timeframe:u==="daily"?"1-hour momentum":u==="weekly"?"3-day breakout":"1-week trend"};break;case"options":p={trade:"AAPL Call (+64% profit)",timeframe:u==="daily"?"0DTE scalp":u==="weekly"?"30DTE swing":"60DTE position"};break;default:p={trade:"AAPL Long (+$625 profit)",timeframe:u==="daily"?"30min momentum":u==="weekly"?"3-day swing":"1-week position"}}return{...p,focus:{"emotional-control":"Psychology tracking","strategy-optimization":"Setup analysis","record-keeping":"Complete documentation","risk-management":"Risk metrics"}[t.challenge],tags:`demo-trade, ${d}`}},l=()=>{switch(e){case"psychology":return[{icon:"\u{1F9E0}",title:"Emotional Analysis",content:"You held this trade for the full plan despite a 15% drawdown. This discipline is what separates profitable traders from emotional ones."},{icon:"\u{1F48E}",title:"Patience Tracking",content:"By waiting for your full profit target, you earned 40% more than if you had taken early profits at the first sign of strength."},{icon:"\u{1F4C8}",title:"Confidence Building",content:"Trades like this, where you stick to your plan, build psychological capital for bigger positions in the future."}];case"patterns":return[{icon:"\u{1F4CA}",title:"Setup Performance",content:"This breakout pattern has an 82% win rate in your trading history - significantly higher than pullback entries at 67%."},{icon:"\u23F0",title:"Timing Optimization",content:"Entries between 10-11 AM ET show 3x better risk-reward ratios than afternoon trades in this setup type."},{icon:"\u{1F3AF}",title:"Pattern Recognition",content:"This setup appears 2-3 times per week in your preferred instruments. Journalit will alert you to similar patterns."}];default:return[{icon:"\u26A1",title:"Automation Ready",content:"This trade was automatically imported from MetaTrader with complete data - no manual entry required."},{icon:"\u{1F4CA}",title:"Real-time Sync",content:"Your risk metrics updated live during the trade, showing exactly when to scale out or add to positions."},{icon:"\u{1F504}",title:"Effortless Tracking",content:"With full automation, you can focus on trading decisions while Journalit handles all the data collection and analysis."}]}},c=s();if(r){let d=l();return or.default.createElement("div",{className:`first-action-slide ${i}`},or.default.createElement(Ug,{title:"Great! Here's what we learned from your sample trade:",className:"first-action-success"},or.default.createElement("div",{className:"trade-insights"},d.map((u,p)=>or.default.createElement(QT,{key:p,icon:u.icon,title:u.title,content:u.content}))),n&&or.default.createElement("div",{className:"sample-trade-path"},or.default.createElement("small",null,"Trade created at: ",n))))}return or.default.createElement(Yo,{title:"Experience Journalit in action",subtitle:"Let's create a sample trade note so you can see how everything works.",icon:"\u{1F4DD}",className:`first-action-slide ${i}`},or.default.createElement("div",{className:"first-action-content"},or.default.createElement("div",{className:"first-action-preview"},or.default.createElement("h3",null,"What we'll create based on your trading style:"),or.default.createElement("div",{className:"sample-trade-preview"},or.default.createElement("div",{className:"preview-row"},or.default.createElement("span",{className:"preview-label"},"\u{1F4C8} Trade:"),or.default.createElement("span",{className:"preview-value"},c.trade)),or.default.createElement("div",{className:"preview-row"},or.default.createElement("span",{className:"preview-label"},"\u23F0 Style:"),or.default.createElement("span",{className:"preview-value"},c.timeframe)),or.default.createElement("div",{className:"preview-row"},or.default.createElement("span",{className:"preview-label"},"\u{1F3AF} Focus:"),or.default.createElement("span",{className:"preview-value"},c.focus)),or.default.createElement("div",{className:"preview-row"},or.default.createElement("span",{className:"preview-label"},"\u{1F3F7}\uFE0F Tags:"),or.default.createElement("span",{className:"preview-value"},c.tags)))),or.default.createElement(De,{onClick:o,disabled:a,variant:"primary",size:"large",className:"create-sample-button",autoFocus:!0},or.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},a&&or.default.createElement(sr,{size:"small",message:""}),a?"Creating your sample trade...":"\u2728 Create Sample Trade")),or.default.createElement("p",{className:"first-action-note"},"This creates a real trade note in your vault that you can explore and delete later.")))}});var qg,c2,m7=te(()=>{qg=_(B());Jd();ZT();RE();c2=({isAuthenticated:e,onAuthSuccess:t,onAuthCancel:r,className:n=""})=>e?qg.default.createElement("div",{className:`authentication-slide ${n}`},qg.default.createElement(Ug,{title:"Account connected successfully!",subtitle:"You now have access to all premium features including MetaTrader sync.",className:"auth-success"})):qg.default.createElement(Yo,{title:"\u{1F510} Connect your account",subtitle:"Sign in to unlock MetaTrader sync and advanced features.",className:`authentication-slide ${n}`},qg.default.createElement("div",{className:"auth-component-wrapper"},qg.default.createElement($E,{onSuccess:t,onCancel:r})))});var Ue,d2,f7=te(()=>{Ue=_(B());Jd();ZT();yo();ec();d2=({ftpCredentialsGenerated:e,ftpCredentials:t,isLoading:r,onGenerateFtpCredentials:n,onCopyToClipboard:a,className:o=""})=>{let i=[{icon:"\u{1F510}",text:"Secure FTP credentials for your MetaTrader"},{icon:"\u26A1",text:"Automatic report upload and processing"},{icon:"\u{1F4CA}",text:"Real-time trade data in your journal"}];return e&&t?Ue.default.createElement("div",{className:`ftp-credentials-slide ${o}`,style:{marginTop:"-20px"}},Ue.default.createElement(Ug,{title:"Your FTP credentials are ready!",subtitle:"Configure these settings in your MetaTrader platform:",className:"ftp-credentials-display"},Ue.default.createElement("div",{className:"credentials-container"},Ue.default.createElement("div",{className:"credential-row"},Ue.default.createElement("span",{className:"credential-label"},"FTP server:"),Ue.default.createElement("div",{className:"credential-value-container"},Ue.default.createElement("code",{className:"credential-value"},t.host,":",t.port),Ue.default.createElement(De,{size:"small",variant:"secondary",onClick:()=>a(`${t.host}:${t.port}`,"FTP Server")},"\u{1F4CB}"))),Ue.default.createElement("div",{className:"credential-row"},Ue.default.createElement("span",{className:"credential-label"},"Path:"),Ue.default.createElement("div",{className:"credential-value-container"},Ue.default.createElement("code",{className:"credential-value"},"(leave empty)"),Ue.default.createElement(De,{size:"small",variant:"secondary",onClick:()=>a("","Path")},"\u{1F4CB}"))),Ue.default.createElement("div",{className:"credential-row"},Ue.default.createElement("span",{className:"credential-label"},"FTP login:"),Ue.default.createElement("div",{className:"credential-value-container"},Ue.default.createElement("code",{className:"credential-value"},t.username),Ue.default.createElement(De,{size:"small",variant:"secondary",onClick:()=>a(t.username,"Username")},"\u{1F4CB}"))),Ue.default.createElement("div",{className:"credential-row"},Ue.default.createElement("span",{className:"credential-label"},"FTP password:"),Ue.default.createElement("div",{className:"credential-value-container"},Ue.default.createElement("code",{className:"credential-value"},"\u2022".repeat(t.password.length)),Ue.default.createElement(De,{size:"small",variant:"secondary",onClick:()=>a(t.password,"Password")},"\u{1F4CB}")))),Ue.default.createElement("div",{className:"ftp-setup-note",style:{marginTop:"20px"}},Ue.default.createElement("p",{style:{marginBottom:"8px"}},Ue.default.createElement("strong",null,"Next Steps:")),Ue.default.createElement("ol",{style:{paddingLeft:"20px",margin:"0"}},Ue.default.createElement("li",null,"Open MT5"),Ue.default.createElement("li",null,'Click on the "Tools" menu at the top'),Ue.default.createElement("li",null,'Go to "Options"'),Ue.default.createElement("li",null,'Go to the "FTP" tab & enter the credentials provided above'),Ue.default.createElement("li",null,"Enable Passive mode"),Ue.default.createElement("li",null,"Enable automatic publishing of reports via FTP (Refresh every 60 minutes)"))),Ue.default.createElement("div",{className:"ftp-test-note",style:{marginTop:"16px",color:"#8a2be2"}},Ue.default.createElement("p",{style:{margin:"0"}},Ue.default.createElement("strong",null,'Clicking "Test" will send your first sync through to our server! You will need to go into the plugin settings to "Force Sync" the trades.')),Ue.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"0.9em"}},"(if you have any trades in your MT account)")))):Ue.default.createElement(Yo,{title:"Setup MetaTrader sync",subtitle:"Generate your FTP credentials to enable automatic trade collection from MT4/MT5.",icon:"\u{1F4E1}",className:`ftp-credentials-slide ${o}`},Ue.default.createElement("div",{className:"ftp-security-note"},Ue.default.createElement("div",{className:"security-highlight"},Ue.default.createElement("span",{className:"security-icon"},"\u{1F6E1}\uFE0F"),Ue.default.createElement("span",null,Ue.default.createElement("strong",null,"100% secure:")," We never have access to your trading account - only reports are uploaded"))),Ue.default.createElement("div",{className:"ftp-generate-section"},Ue.default.createElement("div",{className:"ftp-info"},Ue.default.createElement("h3",null,"What you'll get:"),Ue.default.createElement("div",{className:"ftp-benefits"},i.map((s,l)=>Ue.default.createElement("div",{key:l,className:"ftp-benefit"},Ue.default.createElement("span",{className:"benefit-icon"},s.icon),Ue.default.createElement("span",null,s.text))))),Ue.default.createElement(De,{onClick:n,disabled:r,variant:"primary",size:"large",className:"generate-ftp-button",autoFocus:!0},Ue.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r&&Ue.default.createElement(sr,{size:"small",message:""}),r?"Generating credentials...":"\u{1F511} Generate FTP Credentials"))))}});var jr,u2,g7=te(()=>{jr=_(B());Jd();yo();u2=({sampleTradeCreated:e,isAuthenticated:t,ftpCredentialsGenerated:r,telemetryOptIn:n,onTelemetryOptInChange:a,onComplete:o,className:i=""})=>{let s=[{icon:"\u{1F4CA}",text:"Chosen your trading goal",completed:!0},{icon:"\u{1F4DD}",text:"Created your first sample trade",completed:e},{icon:"\u{1F510}",text:"Connected your account",completed:t},{icon:"\u{1F4E1}",text:"Generated FTP credentials",completed:r}].filter(c=>c.completed),l=[{href:"https://github.com/Cursivez/journalit",text:"\u{1F4DA} View Documentation"},{href:"https://discord.gg/AkSw3D9h8b",text:"\u{1F4AC} Join Community"},{href:"mailto:contact@journalit.co",text:"\u{1F198} Get Support"}];return jr.default.createElement(Yo,{title:"Welcome to Journalit!",subtitle:"You're all set up and ready to transform your trading journey.",className:`completion-slide ${i}`},jr.default.createElement("div",{className:"completion-celebration"},"\u{1F389}"),jr.default.createElement("div",{className:"completion-summary"},jr.default.createElement("h3",null,"What you've accomplished:"),jr.default.createElement("div",{className:"accomplishments"},s.map((c,d)=>jr.default.createElement("div",{key:d,className:"accomplishment"},jr.default.createElement("span",{className:"accomplishment-icon"},c.icon),jr.default.createElement("span",null,c.text),jr.default.createElement("span",{className:"accomplishment-status"},"\u2713"))))),jr.default.createElement("div",{className:"telemetry-section"},jr.default.createElement("h3",null,"Help us improve Journalit"),jr.default.createElement("p",null,"Share anonymous usage data to help us build better features for traders like you."),jr.default.createElement("div",{className:"telemetry-option"},jr.default.createElement("label",{className:"telemetry-checkbox"},jr.default.createElement("input",{type:"checkbox",checked:n,onChange:c=>a(c.target.checked)}),jr.default.createElement("span",{className:"checkmark"}),jr.default.createElement("span",{className:"telemetry-label"},jr.default.createElement("strong",null,"Share anonymous usage data"),jr.default.createElement("small",null,"Collects anonymous feature usage plus app load times & error counts. Never personal data, trades, or file paths."))))),jr.default.createElement("div",{className:"completion-actions"},jr.default.createElement(De,{onClick:o,variant:"primary",size:"large",className:"start-journaling-button",autoFocus:!0},"\u{1F680} Start Your Trading Journal"),jr.default.createElement("div",{className:"completion-links"},l.map((c,d)=>jr.default.createElement("a",{key:d,href:c.href,className:"completion-link"},c.text)))))}});var h7=te(()=>{s7();l7();u7();p7();m7();f7();g7()});var _e,Hg,v7,y7=te(()=>{_e=_(B()),Hg=require("obsidian");yo();ec();i7();v0();Ja();BE();h7();v7=({onComplete:e,onSkip:t,initialStep:r="welcome",selectedGoal:n,plugin:a,onboardingService:o})=>{let[i,s]=(0,_e.useState)(r),[l,c]=(0,_e.useState)(n),[d,u]=(0,_e.useState)({instruments:[],frequency:"weekly",challenge:"emotional-control"}),[p,m]=(0,_e.useState)(!1),[h,f]=(0,_e.useState)(null),[b,v]=(0,_e.useState)(""),[y,g]=(0,_e.useState)(!1),[w,C]=(0,_e.useState)(null),[k,x]=(0,_e.useState)(!1),[S,T]=(0,_e.useState)(null),[P,M]=(0,_e.useState)(!1),[D,A]=(0,_e.useState)(!1),L=$t.findIndex(Q=>Q.id===i),N=$t[L];(0,_e.useEffect)(()=>{s0()},[]),(0,_e.useEffect)(()=>{let Q=a.authManager;Q&&Q.isAuthenticated()&&x(!0)},[a]),(0,_e.useEffect)(()=>{(async()=>{var Z,se,ie,Se;try{let qe=await((Z=a.serviceManager)==null?void 0:Z.getBackendIntegrationService());if(!qe)return;let ht=(se=a.settings.backendIntegration)==null?void 0:se.ftpUsername;if(ht){let ft=await qe.getFTPCredentials(ht);if(ft){let it=(ie=a.settings.backendIntegration)==null?void 0:ie.ftpPassword;it&&!ft.password&&(ft.password=it),T({username:ft.username,password:ft.password||"",host:ft.server,port:ft.port}),M(!0)}}}catch(qe){(Se=qe.message)!=null&&Se.includes("404")||console.error("Failed to check existing FTP credentials:",qe)}})()},[a]),(0,_e.useEffect)(()=>{let Q=async()=>{var se;let Z=await((se=a.serviceManager)==null?void 0:se.getTelemetryService());if(Z)try{await Z.track("onboarding_step_completed",{step:i,stepIndex:L,goal:l})}catch(ie){console.error("Failed to track step change:",ie)}};L>0&&Q()},[i,L,l,a]);let E=$t.filter(Q=>!Q.shouldShow||Q.shouldShow(l)).length,I=L>0,O=L<$t.length-1,j=(N==null?void 0:N.isOptional)||i!=="completion",$=(0,_e.useCallback)(()=>{j&&(v('Onboarding cancelled. You can replay onboarding later from the Command Palette by searching for "Journalit: Replay Onboarding".'),setTimeout(()=>{v("")},100),t())},[j,t]);(0,_e.useEffect)(()=>{let Q=Z=>{Z.key==="Escape"&&j&&$()};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[j,$]),(0,_e.useEffect)(()=>{let Q=setTimeout(()=>{let Z=document.querySelector(".onboarding-wizard-modal");if(Z){let se=Z.querySelector('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])');se&&se.focus()}},100);return()=>clearTimeout(Q)},[i]);let F=(0,_e.useCallback)(async()=>{if(!(!O||p)){m(!0),f(null);try{let Q=L+1;for(;Q<$t.length;){let Z=$t[Q];if(!Z.shouldShow||Z.shouldShow(l))break;Q++}Q<$t.length&&s($t[Q].id)}catch(Q){f(Q instanceof Error?Q.message:"Failed to go to next step")}finally{m(!1)}}},[L,O,l,p]),z=(0,_e.useCallback)(async()=>{if(!(!I||p)){m(!0),f(null);try{let Q=L-1;for(;Q>=0;){let Z=$t[Q];if(!Z.shouldShow||Z.shouldShow(l))break;Q--}Q>=0&&s($t[Q].id)}catch(Q){f(Q instanceof Error?Q.message:"Failed to go to previous step")}finally{m(!1)}}},[L,I,l,p]),W=(0,_e.useCallback)(async()=>{var se;let Q={version:1,completed:!0,completedAt:Date.now(),selectedGoal:l,userSegmentation:d,currentStep:"completion",checklist:{},telemetryOptIn:D,sampleTradeCreated:y,isAuthenticated:k,ftpCredentialsGenerated:P};if(o)try{await o.completeOnboarding()}catch(ie){console.error("Failed to complete onboarding in service:",ie)}let Z=await((se=a.serviceManager)==null?void 0:se.getTelemetryService());if(Z)try{D?(await Z.enableTelemetry(),console.log("Telemetry enabled - events will be sent"),await Z.track("onboarding_completed",{goal:l,telemetryOptIn:D,sampleTradeCreated:y,isAuthenticated:k,ftpCredentialsGenerated:P,completionTime:Date.now()})):(await Z.disableTelemetry(),console.log("Telemetry disabled - no events will be sent"),await Z.trackBusinessMetric("onboarding_completed",{goal:l,telemetryOptIn:D,sampleTradeCreated:y,isAuthenticated:k,ftpCredentialsGenerated:P,completionTime:Date.now()}))}catch(ie){console.error("Failed to handle telemetry opt-in decision:",ie)}e(Q)},[l,D,y,k,P,e,a,o]),U=(0,_e.useCallback)(()=>{if(!j)return;let Q=L+1;for(;Q<$t.length;){let Z=$t[Q];if(!Z.shouldShow||Z.shouldShow(l))break;Q++}Q<$t.length?s($t[Q].id):W()},[j,L,l,W]),K=(0,_e.useCallback)(async Q=>{var se;if(c(Q),o)try{await o.setGoal(Q)}catch(ie){console.error("Failed to update OnboardingService goal:",ie)}let Z=await((se=a.serviceManager)==null?void 0:se.getTelemetryService());if(Z)try{await Z.track("onboarding_goal_selected",{goal:Q,step:i})}catch(ie){console.error("Failed to track goal selection:",ie)}},[a,i,o]),R=(0,_e.useCallback)(async()=>{var Q,Z,se;if(!y){m(!0),f(null);try{let ie=(Q=a.serviceManager)==null?void 0:Q.getTradeService();if(!ie)throw new Error("TradeService not available");let Se=a.accountPageService;if(!Se)throw new Error("AccountPageService not available");(await Se.getAllEnhancedAccounts()).find(Ti=>Ti.name==="Demo Account")||await Se.updateAccountMetadata("Demo Account",{name:"Demo Account",accountType:"demo",initialBalance:1e4,createdDate:new Date});let ft=new Date,it,Tn,hr;switch(d.frequency==="daily"?(it=new Date(ft.getTime()-3*60*60*1e3),Tn=new Date(ft.getTime()-2.5*60*60*1e3)):d.frequency==="weekly"?(it=new Date(ft.getTime()-3*24*60*60*1e3),Tn=new Date(ft.getTime()-1*24*60*60*1e3)):(it=new Date(ft.getTime()-7*24*60*60*1e3),Tn=new Date(ft.getTime()-2*24*60*60*1e3)),d.instruments[0]||"stocks"){case"forex":hr={entryTime:it,exitTime:Tn,entryPrice:1.085,exitPrice:1.092,positionSize:1e4,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"EURUSD",assetType:"forex",tags:["journalit-demo","sample-trade","forex"],thesis:`Sample EURUSD trade demonstrating ${d.frequency} trading. Entry based on support level bounce with 70-pip profit target. This exemplifies the systematic approach Journalit helps you track.`};break;case"crypto":hr={entryTime:it,exitTime:Tn,entryPrice:42500,exitPrice:44200,positionSize:.1,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"BTC/USD",assetType:"crypto",tags:["journalit-demo","sample-trade","crypto"],thesis:`Sample Bitcoin trade showing ${d.frequency} strategy. Breakout above resistance with $1,700 profit. Track crypto volatility patterns with Journalit's analysis tools.`};break;case"options":hr={entryTime:it,exitTime:Tn,entryPrice:2.5,exitPrice:4.1,positionSize:5,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL Call 150 30DTE",assetType:"options",tags:["journalit-demo","sample-trade","options"],thesis:`Sample options trade for ${d.frequency} traders. 64% profit on AAPL calls before earnings. Journalit tracks Greeks, IV, and time decay for complete options analysis.`};break;default:hr={entryTime:it,exitTime:Tn,entryPrice:150.5,exitPrice:156.75,positionSize:100,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL",assetType:"stock",tags:["journalit-demo","sample-trade","stocks"],thesis:`Sample stock trade tailored for ${d.frequency} trading. Strong earnings beat with institutional buying. Demonstrates how Journalit captures both technical and fundamental analysis.`}}let Pn=await ie.createTrade(hr);C(Pn),g(!0);let jl=await((Z=a.serviceManager)==null?void 0:Z.getTelemetryService());if(jl)try{await jl.track("onboarding_sample_trade_created",{goal:l,filePath:Pn})}catch(Ti){console.error("Failed to track sample trade creation:",Ti)}new Hg.Notice("\u{1F389} Sample trade created successfully! You can find it in your vault.")}catch(ie){console.error("Error creating sample trade:",ie),f(ie instanceof Error?ie.message:"Failed to create sample trade");let Se=await((se=a.serviceManager)==null?void 0:se.getTelemetryService());if(Se)try{await Se.track("onboarding_error",{step:i,errorCode:"sample_trade_creation_failed",errorMessage:ie instanceof Error?ie.message:"Unknown error"})}catch(qe){console.error("Failed to track onboarding error:",qe)}}finally{m(!1)}}},[a,y,d,l,i]),q=(0,_e.useCallback)(async(Q,Z)=>{var se;try{x(!0);let ie=a.authManager;ie&&await ie.handleBetaAuth(Q,Z),new Hg.Notice("Successfully authenticated! You can now access premium features.")}catch(ie){console.error("Error handling auth success:",ie),f(ie instanceof Error?ie.message:"Failed to complete authentication");let Se=await((se=a.serviceManager)==null?void 0:se.getTelemetryService());if(Se)try{await Se.track("onboarding_error",{step:"authentication",errorCode:"auth_handling_failed",errorMessage:ie instanceof Error?ie.message:"Unknown error"})}catch(qe){console.error("Failed to track onboarding error:",qe)}}},[a]),X=(0,_e.useCallback)(()=>{f(null)},[]),G=(0,_e.useCallback)(async()=>{var Q,Z,se,ie,Se,qe,ht,ft,it,Tn,hr;if(!P){m(!0),f(null);try{let kt=await((Q=a.serviceManager)==null?void 0:Q.getBackendIntegrationService());if(!kt)throw new Error("Backend integration service not available");if(!a.authManager.isAuthenticated())throw new Error("Please sign in to generate FTP credentials");let Pn=await kt.createOrGetFTPUser();if(!Pn)throw new Error("Failed to generate FTP credentials");a.settings.backendIntegration={...a.settings.backendIntegration,syncEnabled:(se=(Z=a.settings.backendIntegration)==null?void 0:Z.syncEnabled)!=null?se:!0,userId:(Se=(ie=a.settings.backendIntegration)==null?void 0:ie.userId)!=null?Se:"cursive",showSyncNotifications:(ht=(qe=a.settings.backendIntegration)==null?void 0:qe.showSyncNotifications)!=null?ht:!0,showNewTradeNotifications:(it=(ft=a.settings.backendIntegration)==null?void 0:ft.showNewTradeNotifications)!=null?it:!0,ftpUsername:Pn.username,ftpPassword:Pn.password},await a.saveSettings(),await kt.updateSettings({ftpUsername:Pn.username,ftpPassword:Pn.password}),T({username:Pn.username,password:Pn.password||"",host:Pn.server,port:Pn.port}),M(!0);let jl=await((Tn=a.serviceManager)==null?void 0:Tn.getTelemetryService());if(jl)try{await jl.track("onboarding_ftp_credentials_generated",{goal:l,host:Pn.server,port:Pn.port})}catch(Ti){console.error("Failed to track FTP credentials generation:",Ti)}new Hg.Notice("\u2705 FTP credentials generated successfully!")}catch(kt){console.error("Error generating FTP credentials:",kt),f(kt instanceof Error?kt.message:"Failed to generate FTP credentials");let Pn=await((hr=a.serviceManager)==null?void 0:hr.getTelemetryService());if(Pn)try{await Pn.track("onboarding_error",{step:i,errorCode:"ftp_credentials_generation_failed",errorMessage:kt instanceof Error?kt.message:"Unknown error"})}catch(jl){console.error("Failed to track onboarding error:",jl)}}finally{m(!1)}}},[P,l,i,a]),H=(0,_e.useCallback)(async(Q,Z)=>{try{await navigator.clipboard.writeText(Q),new Hg.Notice(`${Z} copied to clipboard!`)}catch(se){console.error("Failed to copy to clipboard:",se),new Hg.Notice(`Failed to copy ${Z.toLowerCase()}`)}},[]),Y=()=>{switch(i){case"welcome":return _e.default.createElement(a2,null);case"goal":return _e.default.createElement(i2,{selectedGoal:l,onGoalSelect:K});case"segmentation":return _e.default.createElement(s2,{userSegmentation:d,onSegmentationChange:u});case"first-action":return _e.default.createElement(l2,{goal:l,userSegmentation:d,sampleTradeCreated:y,sampleTradeFilePath:w,isLoading:p,onCreateSampleTrade:R});case"authentication":return _e.default.createElement(c2,{isAuthenticated:k,onAuthSuccess:q,onAuthCancel:X});case"ftp-credentials":return _e.default.createElement(d2,{ftpCredentialsGenerated:P,ftpCredentials:S,isLoading:p,onGenerateFtpCredentials:G,onCopyToClipboard:H});case"completion":return _e.default.createElement(u2,{sampleTradeCreated:y,isAuthenticated:k,ftpCredentialsGenerated:P,telemetryOptIn:D,onTelemetryOptInChange:A,onComplete:W});default:return _e.default.createElement("div",{className:"onboarding-slide error-slide"},_e.default.createElement("h2",null,"Unknown step"),_e.default.createElement("p",null,"We encountered an unexpected step in the onboarding process."))}},V=$t.filter(Q=>!Q.shouldShow||Q.shouldShow(l)).map(Q=>Q.title);return _e.default.createElement("div",{className:"onboarding-wizard-modal"},_e.default.createElement("div",{"aria-live":"assertive","aria-atomic":"true",className:"sr-only"},b),_e.default.createElement("div",{className:"modal-header"},_e.default.createElement(o7,{currentStep:L+1,totalSteps:E,stepLabels:V})),_e.default.createElement("div",{className:"modal-content"},Y()),h&&_e.default.createElement("div",{className:"modal-error"},h),i!=="completion"&&_e.default.createElement("div",{className:"modal-actions"},I&&_e.default.createElement(De,{onClick:z,disabled:p,variant:"secondary"},"Back"),O&&_e.default.createElement(De,{onClick:F,disabled:p||i==="goal"&&!l||i==="segmentation"&&d.instruments.length===0,variant:"primary"},_e.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},p&&_e.default.createElement(sr,{size:"small",message:""}),"Next"))),_e.default.createElement("div",{className:"modal-footer"},_e.default.createElement("p",{className:"modal-footer-text"},(N==null?void 0:N.description)||"Complete the setup to get started with Journalit")),j&&_e.default.createElement("button",{className:"skip-link",onClick:U,disabled:p,"aria-label":"Skip this step",type:"button"},"Skip this step"))}});var e1={};Zs(e1,{OnboardingWizardModalWrapper:()=>p2});var b7,x7,p2,t1=te(()=>{b7=_(B()),x7=require("obsidian");y7();pE();p2=class extends x7.Modal{constructor(t,r,n,a,o,i,s){super(t),this.plugin=r,this.onComplete=n,this.onSkip=a,this.initialStep=o,this.selectedGoal=i,this.onboardingService=s}async onOpen(){let{contentEl:t}=this;t.empty(),dE();let r=t.createDiv(),{createRoot:n}=vo();n(r).render(b7.default.createElement(v7,{plugin:this.plugin,onboardingService:this.onboardingService,onComplete:o=>{this.onComplete(o),super.close()},onSkip:()=>{this.onSkip(),super.close()},initialStep:this.initialStep,selectedGoal:this.selectedGoal})),(async()=>{var o;try{let i=await((o=this.plugin.serviceManager)==null?void 0:o.getTelemetryService());i&&(i.isEnabled()||(await i.enableTelemetry(),console.log("Temporarily enabled telemetry for onboarding tracking")),i.track("onboarding_started",{initialStep:this.initialStep,pluginVersion:this.plugin.manifest.version}).catch(l=>console.error("Failed to track onboarding start:",l)))}catch(i){console.error("Failed to setup onboarding telemetry:",i)}})(),setTimeout(()=>{let o=t.querySelector(".onboarding-wizard-modal");o&&(o.setAttribute("tabindex","-1"),o.focus())},100)}onClose(){let{contentEl:t}=this;t.empty(),uE()}}});var w7={};Zs(w7,{AccountMigrationModal:()=>m2});var Xd,m2,S7=te(()=>{Xd=require("obsidian"),m2=class extends Xd.Modal{constructor(r,n){super(r);this.isRunning=!1;this.progressEl=null;this.logEl=null;this.plugin=n,this.modalEl.addClass("account-migration-modal")}async onOpen(){let{contentEl:r}=this;r.empty(),this.addStyles(),r.createEl("h2",{text:"Account Data Migration"});let n=r.createEl("div",{cls:"migration-description"});n.innerHTML=`
      <p>This tool will migrate your account data from the old <strong>AccountService</strong> system to the new <strong>AccountPageService</strong> system.</p>
      <p><strong>What this migration does:</strong></p>
      <ul>
        <li>\u2705 Preserves all account settings (initial balance, drawdown rules, etc.)</li>
        <li>\u2705 Migrates monthly costs and all transactions (deposits, withdrawals, trades)</li> 
        <li>\u2705 Handles both JSON accountData format and markdown table format</li>
        <li>\u2705 Creates proper initial balance chart data points</li>
        <li>\u2705 Safely backs up original files before cleanup</li>
        <li>\u2705 Recursively removes empty account folders after migration</li>
        <li>\u2705 Verifies data integrity before removing old files</li>
      </ul>
      <p><strong>\u26A0\uFE0F Important:</strong> This is a one-time migration. Once completed, the old account files will be moved to backup.</p>
    `;let a=this.app.vault.getFiles().filter(s=>s.path.startsWith("!Journalit/Accounts")&&s.extension==="md");if(a.length===0){let s=r.createEl("div",{cls:"no-migration-needed"});s.innerHTML=`
        <h3>\u2705 No Migration Needed</h3>
        <p>No old account files were found in your vault. Your accounts are already using the new system!</p>
      `,new Xd.Setting(r).addButton(l=>l.setButtonText("Close").onClick(()=>this.close()));return}let o=r.createEl("div",{cls:"accounts-found"});o.innerHTML=`
      <h3>\u{1F4C1} Found ${a.length} Account Files to Migrate</h3>
      <div class="account-list">
        ${a.map(s=>`<div class="account-item">\u{1F4C4} ${s.basename}</div>`).join("")}
      </div>
    `,this.progressEl=r.createEl("div",{cls:"migration-progress hidden"}),this.progressEl.innerHTML=`
      <h3>Migration Progress</h3>
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
      <div class="progress-text">Ready to start...</div>
    `,this.logEl=r.createEl("div",{cls:"migration-log hidden"}),this.logEl.innerHTML=`
      <h4>Migration Log</h4>
      <div class="log-content"></div>
    `;let i=r.createEl("div",{cls:"button-container"});new Xd.Setting(i).addButton(s=>s.setButtonText("Start Migration").setCta().setDisabled(this.isRunning).onClick(async()=>{await this.startMigration()})).addButton(s=>s.setButtonText("Cancel").setDisabled(this.isRunning).onClick(()=>this.close()))}async startMigration(){if(this.isRunning)return;this.isRunning=!0,this.showProgress(),this.showLog(),this.contentEl.querySelectorAll("button").forEach(n=>n.disabled=!0);try{await this.runMigration()}catch(n){this.updateProgress({stage:"error",processed:0,total:0,message:`Migration failed: ${n instanceof Error?n.message:String(n)}`,errors:[n instanceof Error?n.message:String(n)]})}finally{this.isRunning=!1;let n=this.contentEl.querySelector("button:last-child");n&&(n.disabled=!1,n.textContent="Close")}}async runMigration(){var s,l,c,d,u;let r=Date.now(),n=0,a=0,o=0,i=0;try{if(this.updateProgress({stage:"scanning",processed:0,total:100,message:"Scanning for account files...",errors:[]}),this.addLogMessage("\u{1F50D} Starting account data migration..."),!this.plugin.accountPageService)throw new Error("AccountPageService not available - cannot perform migration");let p="!Journalit/Accounts",m=this.app.vault.getFiles().filter(b=>b.path.startsWith(p)&&b.extension==="md");if(m.length===0){this.updateProgress({stage:"complete",processed:100,total:100,message:"No old account files found - migration not needed",errors:[]});return}this.addLogMessage(`\u{1F4C1} Found ${m.length} account files to migrate`),this.updateProgress({stage:"migrating",processed:0,total:m.length,message:"Migrating account data...",errors:[]});for(let b of m)try{n++,this.addLogMessage(`\u{1F4C4} Processing: ${b.basename}`);let v=await this.app.vault.read(b),y=this.app.metadataCache.getFileCache(b),g=y==null?void 0:y.frontmatter;if(!g){this.addLogMessage(`\u26A0\uFE0F Skipping ${b.path} - no frontmatter found`),i++;continue}let w=g.name||b.basename,C=this.parseAccountTransactions(v,g),k=0;if(g.monthlyCost)k=g.monthlyCost;else if(g.accountData)try{let P=JSON.parse(g.accountData);P.monthlyCost&&(k=P.monthlyCost)}catch(P){console.warn("Failed to parse monthlyCost from accountData JSON:",P)}let x=null;if(g.accountData)try{x=JSON.parse(g.accountData)}catch(P){console.warn("Failed to parse accountData JSON for metadata extraction:",P)}let S={name:w,accountType:g.accountType||(x==null?void 0:x.accountType)||"demo",createdDate:g.createdDate?new Date(g.createdDate):x!=null&&x.createdDate?new Date(x.createdDate):new Date,initialBalance:g.initialBalance||(x==null?void 0:x.initialBalance)||1e4,drawdownType:g.drawdownType||(x==null?void 0:x.drawdownType)||"none",drawdownAmount:g.drawdownAmount||(x==null?void 0:x.drawdownAmount)||0,hasProfitTarget:g.hasProfitTarget!==void 0?g.hasProfitTarget:(x==null?void 0:x.hasProfitTarget)!==void 0?x.hasProfitTarget:!1,profitTarget:g.profitTarget||(x==null?void 0:x.profitTarget)||0,profitTargetType:g.profitTargetType||(x==null?void 0:x.profitTargetType)||"absolute",profitTargetDate:g.profitTargetDate?new Date(g.profitTargetDate):x!=null&&x.profitTargetDate?new Date(x.profitTargetDate):void 0,monthlyCost:k,manualTransactions:C,lastUpdated:new Date};console.log(`Migration: Saving metadata for "${w}" with ${C.length} manual transactions:`,{monthlyCost:S.monthlyCost,manualTransactions:(s=S.manualTransactions)==null?void 0:s.map(P=>({type:P.type,amount:P.amount,description:P.description,date:P.date}))}),await this.plugin.accountPageService.updateAccountMetadata(w,S),console.log(`Migration: Successfully saved metadata for "${w}"`);let T=(c=(l=this.plugin.settings.account)==null?void 0:l.accountMetadata)==null?void 0:c[w];console.log(`Migration: Verification - raw settings for "${w}":`,{hasAccountMetadata:!!((d=this.plugin.settings.account)!=null&&d.accountMetadata),hasThisAccount:!!T,rawManualTransactions:((u=T==null?void 0:T.manualTransactions)==null?void 0:u.length)||0,monthlyCost:T==null?void 0:T.monthlyCost}),a++,this.addLogMessage(`\u2705 Successfully migrated account: ${w}`),this.updateProgress({stage:"migrating",processed:n,total:m.length,message:`Migrated ${a} of ${m.length} accounts...`,errors:[]})}catch(v){let y=`Failed to migrate ${b.path}: ${v instanceof Error?v.message:String(v)}`;this.addLogMessage(`\u274C ${y}`),o++}this.updateProgress({stage:"verifying",processed:0,total:100,message:"Verifying migration...",errors:[]}),this.addLogMessage("\u{1F50D} Verifying migration...");let h=await this.verifyAccountMigration(m);if(!h.success)throw new Error(`Migration verification failed: ${h.error}`);this.addLogMessage("\u2705 Migration verification successful"),this.updateProgress({stage:"cleanup",processed:0,total:100,message:"Cleaning up old files...",errors:[]}),this.addLogMessage("\u{1F9F9} Cleaning up old files..."),await this.cleanupOldAccountFiles(m);let f=Math.round((Date.now()-r)/1e3);this.updateProgress({stage:"complete",processed:100,total:100,message:`Migration completed successfully in ${f}s!`,errors:[]}),this.addLogMessage("\u{1F389} Account migration completed successfully!"),this.addLogMessage(`\u{1F4CA} Processed: ${n} files`),this.addLogMessage(`\u2705 Migrated: ${a} accounts`),this.addLogMessage(`\u23ED\uFE0F Skipped: ${i} files`),this.addLogMessage(`\u274C Errors: ${o}`),this.addLogMessage(`\u23F1\uFE0F Time: ${f}s`),this.addLogMessage("\u{1F5C2}\uFE0F Old account files have been safely backed up"),new Xd.Notice("Account migration completed successfully!")}catch(p){let m=p instanceof Error?p.message:String(p);throw this.addLogMessage(`\u{1F4A5} Migration failed: ${m}`),new Xd.Notice(`Account migration failed: ${m}`),p}}parseAccountTransactions(r,n){let a=[];try{if(n.accountData)try{let s=JSON.parse(n.accountData);if(s.transactions&&Array.isArray(s.transactions)){let l=s.transactions.filter(c=>{if(!c.date)return console.warn("Skipping transaction without date:",c),!1;let d=new Date(c.date);return isNaN(d.getTime())?(console.warn("Skipping transaction with invalid date:",c),!1):!0}).map(c=>{let d=new Date(c.date);return{id:c.id||`migrated-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:d,type:c.type.toLowerCase(),amount:parseFloat(c.amount)||0,description:c.description||"Migrated transaction",balanceAfter:parseFloat(c.balanceAfter)||0,tradeId:c.tradeId}});return console.log(`Migration: Processing ${s.transactions.length} transactions:`,s.transactions.map(c=>({type:c.type,amount:c.amount,description:c.description}))),console.log(`Migration: Processed ${l.length} valid transactions:`,l.map(c=>({type:c.type,amount:c.amount,description:c.description}))),l}}catch(s){console.warn("Failed to parse accountData JSON, falling back to markdown parsing:",s)}let o=/## Transactions?\s*\n([\s\S]*?)(?=\n## |$)/i,i=r.match(o);if(i){let l=i[1].split(`
`).filter(c=>c.trim().startsWith("|")&&!c.includes("---")&&!c.toLowerCase().includes("date"));for(let c of l){let d=c.split("|").map(u=>u.trim()).filter(u=>u);if(d.length>=4){let[u,p,m,h]=d,f=new Date(u),b=parseFloat(m.replace(/[^-0-9.]/g,""));!isNaN(f.getTime())&&!isNaN(b)&&a.push({id:`migrated-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:f,type:p.toLowerCase(),amount:b,description:h||"Migrated transaction",balanceAfter:0})}}}}catch(o){console.warn("Failed to parse transactions from account file:",o)}return a}async verifyAccountMigration(r){try{let n=await this.plugin.accountPageService.getAllEnhancedAccounts();if(n.length<r.length)return{success:!1,error:`Expected ${r.length} accounts, but only found ${n.length} in new system`};for(let a of r){let o=await this.app.vault.read(a),i=this.app.metadataCache.getFileCache(a),s=i==null?void 0:i.frontmatter;if(s){let l=s.name||a.basename,c=n.find(d=>d.name===l);if(!c)return{success:!1,error:`Account "${l}" not found in new system`};if(s.initialBalance&&Math.abs(c.initialBalance-s.initialBalance)>.01)return{success:!1,error:`Initial balance mismatch for account "${l}"`}}}return{success:!0}}catch(n){return{success:!1,error:n instanceof Error?n.message:String(n)}}}async cleanupOldAccountFiles(r){try{let n="!Journalit/Migration Backup/Accounts";await this.ensureFolderExists(n);for(let a of r)try{let o=`${n}/${a.name}`;await this.app.vault.rename(a,o),this.addLogMessage(`\u{1F4E6} Moved ${a.path} to backup`)}catch(o){this.addLogMessage(`\u26A0\uFE0F Failed to move ${a.path} to backup: ${o}`)}try{await this.recursivelyDeleteFolder("!Journalit/Accounts"),this.addLogMessage("\u{1F5D1}\uFE0F Removed accounts folder and all contents")}catch(a){this.addLogMessage(`\u2139\uFE0F Could not remove accounts folder: ${a}`);try{let o=this.app.vault.getAbstractFileByPath("!Journalit/Accounts");o&&"children"in o&&o.children&&o.children.length===0&&(await this.app.vault.delete(o),this.addLogMessage("\u{1F5D1}\uFE0F Removed empty accounts folder"))}catch(o){this.addLogMessage("\u2139\uFE0F Accounts folder contains files/folders that could not be removed")}}}catch(n){this.addLogMessage(`\u26A0\uFE0F Error during cleanup: ${n}`)}}async ensureFolderExists(r){this.app.vault.getAbstractFileByPath(r)||await this.app.vault.createFolder(r)}async recursivelyDeleteFolder(r){let n=this.app.vault.getAbstractFileByPath(r);if(!n)return;if(!("children"in n)){await this.app.vault.delete(n);return}let o=[...n.children||[]];for(let i of o)try{"children"in i?await this.recursivelyDeleteFolder(i.path):(await this.app.vault.delete(i),this.addLogMessage(`\u{1F4C4} Deleted file: ${i.path}`))}catch(s){this.addLogMessage(`\u26A0\uFE0F Failed to delete ${i.path}: ${s}`)}try{await this.app.vault.delete(n),this.addLogMessage(`\u{1F4C1} Deleted folder: ${r}`)}catch(i){throw new Error(`Failed to delete folder ${r}: ${i}`)}}showProgress(){this.progressEl&&this.progressEl.classList.remove("hidden")}showLog(){this.logEl&&this.logEl.classList.remove("hidden")}updateProgress(r){if(!this.progressEl)return;let n=this.progressEl.querySelector(".progress-fill"),a=this.progressEl.querySelector(".progress-text");if(n&&a){let o=r.total>0?r.processed/r.total*100:0;n.style.width=`${o}%`;let i={scanning:"\u{1F50D}",migrating:"\u{1F4C4}",verifying:"\u2705",cleanup:"\u{1F9F9}",complete:"\u{1F389}",error:"\u274C"};a.textContent=`${i[r.stage]} ${r.message}`}}addLogMessage(r){if(!this.logEl)return;let n=this.logEl.querySelector(".log-content");if(n){let a=document.createElement("div");a.classList.add("log-entry"),a.textContent=`[${new Date().toLocaleTimeString()}] ${r}`,n.appendChild(a),n.scrollTop=n.scrollHeight}}addStyles(){let r="account-migration-modal-styles";if(document.getElementById(r))return;let n=document.createElement("style");n.id=r,n.textContent=`
      .account-migration-modal .modal-content {
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
      }

      .migration-description {
        background: var(--background-secondary);
        padding: 16px;
        border-radius: 8px;
        margin: 16px 0;
      }

      .migration-description ul {
        margin: 8px 0;
        padding-left: 20px;
      }

      .migration-description li {
        margin: 4px 0;
      }

      .accounts-found {
        background: var(--background-secondary);
        padding: 16px;
        border-radius: 8px;
        margin: 16px 0;
      }

      .account-list {
        max-height: 150px;
        overflow-y: auto;
        margin-top: 8px;
      }

      .account-item {
        padding: 4px 8px;
        margin: 2px 0;
        background: var(--background-primary);
        border-radius: 4px;
        font-family: var(--font-monospace);
        font-size: 12px;
      }

      .no-migration-needed {
        background: var(--color-green);
        color: white;
        padding: 16px;
        border-radius: 8px;
        margin: 16px 0;
        text-align: center;
      }

      .migration-progress {
        background: var(--background-secondary);
        padding: 16px;
        border-radius: 8px;
        margin: 16px 0;
      }

      .progress-bar {
        width: 100%;
        height: 20px;
        background: var(--background-modifier-border);
        border-radius: 10px;
        overflow: hidden;
        margin: 8px 0;
      }

      .progress-fill {
        height: 100%;
        background: var(--interactive-accent);
        transition: width 0.3s ease;
        width: 0%;
      }

      .progress-text {
        text-align: center;
        font-weight: 500;
        margin-top: 8px;
      }

      .migration-log {
        background: var(--background-secondary);
        padding: 16px;
        border-radius: 8px;
        margin: 16px 0;
      }

      .log-content {
        max-height: 200px;
        overflow-y: auto;
        background: var(--background-primary);
        padding: 8px;
        border-radius: 4px;
        font-family: var(--font-monospace);
        font-size: 12px;
        line-height: 1.4;
      }

      .log-entry {
        margin: 2px 0;
        word-wrap: break-word;
      }

      .button-container {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        margin-top: 16px;
      }

      .hidden {
        display: none;
      }

      .error-message {
        color: var(--text-error);
        font-weight: 500;
      }
    `,document.head.appendChild(n)}onClose(){let r=document.getElementById("account-migration-modal-styles");r&&r.remove()}}});var _be={};Zs(_be,{default:()=>r1});module.exports=Wb(_be);var ln=require("obsidian");var L$=require("obsidian"),Xa=_(B()),M$=_(vo());var ze=_(B()),sl=require("obsidian");yo();var Q_=_(B()),mu=({ariaLabel:e,className:t="",children:r,...n})=>{let o=["journalit-icon-button",t].filter(Boolean).join(" ");return Q_.default.createElement("button",{className:o,"aria-label":e,type:"button","data-tooltip":e,...n},r)};var Z_=_(B()),bo=({label:e,className:t="",children:r,...n})=>{let o=["journalit-no-tooltip-button",t].filter(Boolean).join(" ");return Z_.default.createElement("button",{className:o,"data-label":e,"aria-label":e,type:"button",...n},r)};var qh=_(B());var QX=({checked:e,onChange:t,id:r,ariaLabel:n="Toggle switch",disabled:a=!1})=>{let o=s=>{a||t(s.target.checked)},i=r||`toggle-${Math.random().toString(36).substring(2,9)}`;return qh.default.createElement("div",{className:`toggle-switch-container ${a?"disabled":""}`},qh.default.createElement("input",{type:"checkbox",id:i,className:"toggle-switch-input",checked:e,onChange:o,"aria-label":n,disabled:a}),qh.default.createElement("label",{htmlFor:i,className:"toggle-switch-label"},qh.default.createElement("span",{className:"toggle-switch-button"})))},Ka=QX;var td=_(B()),ZX=({checked:e,onChange:t,id:r,ariaLabel:n,disabled:a=!1,label:o,className:i=""})=>{let s=h=>{a||t(h.target.checked)},l=r||`checkbox-${Math.random().toString(36).substring(2,9)}`;return td.default.createElement("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",cursor:a?"not-allowed":"pointer",opacity:a?.6:1,userSelect:"none"},className:i,onMouseOver:h=>{if(!a){let f=h.currentTarget.querySelector("[data-checkbox]");f&&!e&&(f.style.backgroundColor="var(--background-modifier-hover)",f.style.borderColor="var(--interactive-accent)")}},onMouseOut:h=>{if(!a){let f=h.currentTarget.querySelector("[data-checkbox]");f&&!e&&(f.style.backgroundColor="var(--background-primary)",f.style.borderColor="var(--background-modifier-border)")}}},td.default.createElement("input",{type:"checkbox",id:l,style:{position:"absolute",opacity:0,width:0,height:0,margin:0,padding:0},checked:e,onChange:s,"aria-label":n||o,disabled:a}),td.default.createElement("label",{htmlFor:l,style:{display:"flex",alignItems:"center",gap:"8px",cursor:a?"not-allowed":"pointer",fontSize:"13px",fontWeight:500,color:a?"var(--text-muted)":"var(--text-normal)"}},td.default.createElement("div",{"data-checkbox":!0,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"3px",backgroundColor:e?"var(--interactive-accent)":"var(--background-primary)",borderColor:e?"var(--interactive-accent)":"var(--background-modifier-border)",transition:"all 0.2s ease",cursor:a?"not-allowed":"pointer",flexShrink:0}},e&&td.default.createElement("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",style:{color:"var(--text-on-accent)",display:"block"}},td.default.createElement("path",{d:"M8.5 1L3.5 6L1.5 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))),o&&td.default.createElement("span",{style:{color:a?"var(--text-muted)":"var(--text-normal)",fontSize:"13px",fontWeight:500}},o)))},Hh=ZX;rd();var il=_(B()),Cr=({title:e,defaultExpanded:t=!1,children:r})=>{let[n,a]=(0,il.useState)(t),o=()=>{a(!n)};return il.default.createElement("div",{className:"cmdr-accordion cmdr-sep-con","aria-expanded":n},il.default.createElement("div",{className:"cmdr-accordion-header cmdr-mb-1",onClick:o,role:"button",tabIndex:0,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(o(),i.preventDefault())}},il.default.createElement("div",{className:"cmdr-accordion-chevron"},il.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},il.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),il.default.createElement("span",{style:{marginLeft:"8px"}},e)),il.default.createElement("div",{className:"cmdr-accordion-content"},r))};ym();var nB=({plugin:e})=>{var p,m,h,f,b,v,y;e.settings.general||(e.settings.general={currency:"USD"});let[t,r]=(0,ze.useState)(0);(0,ze.useEffect)(()=>{var w;let g=!1;e.settings.trade.skipWeekends===void 0&&(e.settings.trade.skipWeekends=!0,g=!0),e.settings.trade.tradingDayCutoffTime===void 0&&(e.settings.trade.tradingDayCutoffTime="00:00",g=!0),e.settings.drc.autoCreateDRCOnNavigation===void 0&&(e.settings.drc.autoCreateDRCOnNavigation=!0,g=!0),e.settings.weekly.autoCreateWeeklyReviewOnNavigation===void 0&&(e.settings.weekly.autoCreateWeeklyReviewOnNavigation=!0,g=!0),((w=e.settings.monthly)==null?void 0:w.autoCreateMonthlyReviewOnNavigation)===void 0&&(e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=!0:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},g=!0),g&&e.saveSettings()},[]);let n=[{value:"DDMMYY",label:"DD/MM/YY (31/12/23)"},{value:"MMDDYY",label:"MM/DD/YY (12/31/23)"},{value:"YYMMDD",label:"YY/MM/DD (23/12/31)"}],a=async g=>{e.settings.trade.autoOpenCreatedTrades=g,await e.saveSettings(),r(w=>w+1),new sl.Notice(`Auto-open created trades ${g?"enabled":"disabled"}`)},o=async g=>{e.settings.trade.dateFormat=g,await e.saveSettings(),new sl.Notice(`Trade note date format changed to ${g}`)},i=async g=>{e.settings.trade.skipWeekends=g,await e.saveSettings(),r(w=>w+1),new sl.Notice(`Skip weekends ${g?"enabled":"disabled"}`)},s=async g=>{let w=g.target.value;e.settings.trade.tradingDayCutoffTime=w,await e.saveSettings(),new sl.Notice(`Trading day cutoff time changed to ${w}`)},l=async g=>{e.settings.drc.autoCreateDRCOnNavigation=g,await e.saveSettings(),r(w=>w+1),new sl.Notice(`Auto-create DRC on navigation ${g?"enabled":"disabled"}`)},c=async g=>{e.settings.weekly.autoCreateWeeklyReviewOnNavigation=g,await e.saveSettings(),r(w=>w+1),new sl.Notice(`Auto-create Weekly Review on navigation ${g?"enabled":"disabled"}`)},d=async g=>{e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=g:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:g},await e.saveSettings(),r(w=>w+1),new sl.Notice(`Auto-create Monthly Review on navigation ${g?"enabled":"disabled"}`)},u=async g=>{let w=g;e.settings.general?e.settings.general.currency=w:e.settings.general={currency:w};try{await e.saveSettings();let C=new CustomEvent("journalit-currency-changed",{detail:{currency:w}});window.dispatchEvent(C),r(k=>k+1),new sl.Notice(`\u2713 Currency changed to ${w}. All components will update immediately!`)}catch(C){console.error("Failed to save currency setting:",C),new sl.Notice("\u274C Failed to save currency setting. Please try again.",5e3),r(k=>k+1)}};return ze.default.createElement("div",{className:"journalit-settings-tab general-settings"},ze.default.createElement("h3",null,"General Settings"),ze.default.createElement("p",{className:"setting-item-description"},"Configure global settings for the Journalit plugin."),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Currency"),ze.default.createElement("div",{className:"setting-item-description"},"Choose the currency to display for all monetary values throughout the plugin")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(la,{value:((p=e.settings.general)==null?void 0:p.currency)||"USD",onChange:u,options:rB(),id:"currency-dropdown","aria-label":"Select currency for displaying monetary values"}))),ze.default.createElement(Cr,{title:"Trade Settings",defaultExpanded:!0},ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Auto-open Created Trades"),ze.default.createElement("div",{className:"setting-item-description"},"Automatically open trade notes in a new tab after they are created")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(Ka,{checked:e.settings.trade.autoOpenCreatedTrades||!1,onChange:a,id:"auto-open-trades-toggle",ariaLabel:"Auto-open created trades"}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Date Format"),ze.default.createElement("div",{className:"setting-item-description"},"Format for displaying dates throughout the plugin")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(la,{value:e.settings.trade.dateFormat,onChange:o,options:n,id:"date-format-dropdown","aria-label":"Select date format for trade notes"}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Skip Weekends in Navigation"),ze.default.createElement("div",{className:"setting-item-description"},"Skip weekends when navigating between trading days (e.g., Friday \u2192 Monday)")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(Ka,{checked:(m=e.settings.trade.skipWeekends)!=null?m:!0,onChange:i,id:"skip-weekends-toggle",ariaLabel:"Skip weekends when navigating"}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Trading Day Cutoff Time"),ze.default.createElement("div",{className:"setting-item-description"},"Time that defines the end of a trading day. Trades after this time will be grouped with the next day. (24-hour format, e.g., 23:30 for 11:30 PM)")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"time",value:(h=e.settings.trade.tradingDayCutoffTime)!=null?h:"00:00",onChange:s,id:"trading-day-cutoff-time","aria-label":"Trading day cutoff time",className:"setting-input time-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"120px"}}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Auto-create DRC on Navigation"),ze.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Daily Report Card when navigating to a day that doesn't have one")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(Ka,{checked:(f=e.settings.drc.autoCreateDRCOnNavigation)!=null?f:!0,onChange:l,id:"auto-create-drc-navigation-toggle",ariaLabel:"Auto-create DRC on navigation"}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Auto-create Weekly Review on Navigation"),ze.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Weekly Review when navigating to a week that doesn't have one")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(Ka,{checked:(b=e.settings.weekly.autoCreateWeeklyReviewOnNavigation)!=null?b:!0,onChange:c,id:"auto-create-weekly-review-navigation-toggle",ariaLabel:"Auto-create Weekly Review on navigation"}))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Auto-create Monthly Review on Navigation"),ze.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Monthly Review when navigating to a month that doesn't have one")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(Ka,{checked:(y=(v=e.settings.monthly)==null?void 0:v.autoCreateMonthlyReviewOnNavigation)!=null?y:!0,onChange:d,id:"auto-create-monthly-review-navigation-toggle",ariaLabel:"Auto-create Monthly Review on navigation"})))))};var Gn=_(B());var Fi=_(B()),aB=require("obsidian");var oB=({plugin:e})=>{let[t,r]=(0,Fi.useState)(()=>{var a;return((a=e.settings.reviews)==null?void 0:a.globalAutoCreate)===void 0?(e.settings.reviews?e.settings.reviews&&(e.settings.reviews.globalAutoCreate=!0,e.saveSettings()):(e.settings.reviews={globalAutoCreate:!0},e.saveSettings()),!0):e.settings.reviews.globalAutoCreate});return(0,Fi.useEffect)(()=>{e.settings.reviews&&r(e.settings.reviews.globalAutoCreate)},[e.settings]),Fi.default.createElement("div",{className:"global-review-settings"},Fi.default.createElement("div",{className:"setting-item"},Fi.default.createElement("div",{className:"setting-item-info"},Fi.default.createElement("div",{className:"setting-item-name"},"Global Auto-Create Reviews"),Fi.default.createElement("div",{className:"setting-item-description"},"Automatically create reviews when the first trade of the corresponding period is recorded. This setting applies to daily, weekly, monthly and yearly reviews.")),Fi.default.createElement("div",{className:"setting-item-control"},Fi.default.createElement(Ka,{checked:t,onChange:async()=>{let a=!t;r(a),e.settings.reviews?e.settings.reviews.globalAutoCreate=a:e.settings.reviews={globalAutoCreate:a},e.settings.drc&&(e.settings.drc.autoCreateOnFirstTrade=a),e.settings.weekly&&(e.settings.weekly.autoCreateOnFirstTrade=a),await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"reviews",settings:e.settings.reviews}})),new aB.Notice(`Auto-create for all reviews ${a?"enabled":"disabled"}`)},id:"global-auto-create-toggle",ariaLabel:"Global auto-create reviews"}))))};var An=_(B());var qn=_(B()),sB=require("obsidian");Jl();var Vh=({plugin:e,items:t,defaultItems:r,settingsPath:n,placeholder:a,onItemsChange:o,settingsEventComponent:i})=>{let[s,l]=(0,qn.useState)(""),c=(h,f)=>{let b=h.split("."),v={...e.settings},y=v;for(let g=0;g<b.length-1;g++)y[b[g]]||(y[b[g]]={}),y=y[b[g]];return y[b[b.length-1]]=f,v},d=async h=>{let f=c(n,h);e.settings=f,await e.saveSettings(),i&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:i,settings:n.split(".")[0]===i?e.settings[i]:e.settings}})),o&&o(h)},u=async()=>{if(!s.trim())return;let h=[...t,s.trim()];await d(h),l("")},p=async h=>{let f=[...t];f.splice(h,1),await d(f)};return qn.default.createElement("div",{className:"item-manager"},qn.default.createElement("div",{className:"setting-item"},qn.default.createElement("div",{className:"setting-item-info"},qn.default.createElement("div",{className:"setting-item-control"},qn.default.createElement(De,{onClick:async()=>{await d([...r]),new sB.Notice("Reset items to defaults")},variant:"secondary"},"Reset to Defaults")))),t.map((h,f)=>qn.default.createElement("div",{key:f,className:"setting-item custom-item"},qn.default.createElement("div",{className:"setting-item-info"},qn.default.createElement("div",{className:"setting-item-name"},h)),qn.default.createElement("div",{className:"setting-item-control"},qn.default.createElement(De,{onClick:()=>p(f)},"Remove")))),qn.default.createElement("div",{className:"setting-item custom-item-add"},qn.default.createElement("div",{className:"setting-item-info"},qn.default.createElement(Xt,{value:s,onChange:h=>l(h),placeholder:a})),qn.default.createElement("div",{className:"setting-item-control"},qn.default.createElement(De,{onClick:u,disabled:!s.trim()},"Add"))))};var dn=_(B()),lB=require("obsidian");Jl();var mw=({plugin:e,timeframes:t,defaultTimeframes:r,settingsPath:n,settingsEventComponent:a,placeholder:o="New timeframe (e.g., 15M, 5M)"})=>{let[i,s]=(0,dn.useState)(""),l=(m,h)=>{let f=m.split("."),b={...e.settings},v=b;for(let y=0;y<f.length-1;y++)v[f[y]]||(v[f[y]]={}),v=v[f[y]];return v[f[f.length-1]]=h,b},c=async m=>{let h=l(n,m);e.settings=h,await e.saveSettings(),a&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:a,settings:e.settings[a]}}))},d=async()=>{if(!i.trim())return;let m=[...t,i.trim()];await c(m),s("")},u=async m=>{let h=[...t];h.splice(m,1),await c(h)};return dn.default.createElement("div",{className:"timeframe-manager"},dn.default.createElement("div",{className:"setting-item"},dn.default.createElement("div",{className:"setting-item-info"},dn.default.createElement("div",{className:"setting-item-name"},"Forecast Timeframes"),dn.default.createElement("div",{className:"setting-item-description"},"Customize the timeframes that appear in your forecast")),dn.default.createElement("div",{className:"setting-item-control"},dn.default.createElement(De,{onClick:async()=>{await c([...r]),new lB.Notice("Reset timeframes to defaults")},variant:"secondary"},"Reset to Defaults"))),t.map((m,h)=>dn.default.createElement("div",{key:h,className:"setting-item custom-item"},dn.default.createElement("div",{className:"setting-item-info"},dn.default.createElement("div",{className:"setting-item-name"},m)),dn.default.createElement("div",{className:"setting-item-control"},dn.default.createElement(De,{onClick:()=>u(h)},"Remove")))),dn.default.createElement("div",{className:"setting-item custom-item-add"},dn.default.createElement("div",{className:"setting-item-info"},dn.default.createElement(Xt,{value:i,onChange:m=>s(m),placeholder:o})),dn.default.createElement("div",{className:"setting-item-control"},dn.default.createElement(De,{onClick:d,disabled:!i.trim()},"Add"))))};var cB=({plugin:e})=>{var d,u,p;let t=["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],r=["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],n=["Daily","4H","1H","30M"],[a,o]=(0,An.useState)(((d=e.settings.drc)==null?void 0:d.checklistItems)||[...t]),[i,s]=(0,An.useState)(((u=e.settings.drc)==null?void 0:u.reviewQuestions)||[...r]),[l,c]=(0,An.useState)(((p=e.settings.drc)==null?void 0:p.customTimeframes)||[...n]);return(0,An.useEffect)(()=>{let m=h=>{var f,b,v,y;((f=h.detail)==null?void 0:f.component)==="drc"&&(o(((b=e.settings.drc)==null?void 0:b.checklistItems)||[]),s(((v=e.settings.drc)==null?void 0:v.reviewQuestions)||[]),c(((y=e.settings.drc)==null?void 0:y.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",m),()=>{document.removeEventListener("journalit-settings-updated",m)}},[e.settings]),An.default.createElement("div",{className:"daily-review-section"},An.default.createElement("h4",null,"Pre-Trade Checklist Items"),An.default.createElement("p",{className:"setting-item-description"},"Customize the checklist items that appear in your Daily Report Card. These are tasks you should complete before starting your trading session."),An.default.createElement(Vh,{plugin:e,items:a,defaultItems:t,settingsPath:"drc.checklistItems",placeholder:"New checklist item",onItemsChange:o,settingsEventComponent:"drc"}),An.default.createElement("hr",null),An.default.createElement("h4",null,"Review Questions"),An.default.createElement("p",{className:"setting-item-description"},"Customize the reflection questions that appear in the review section. These questions help you reflect on your trading performance."),An.default.createElement(Vh,{plugin:e,items:i,defaultItems:r,settingsPath:"drc.reviewQuestions",placeholder:"New review question",onItemsChange:s,settingsEventComponent:"drc"}),An.default.createElement("hr",null),An.default.createElement("h4",null,"Forecast Timeframes"),An.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your Daily Report Card forecasts."),An.default.createElement(mw,{plugin:e,timeframes:l,defaultTimeframes:n,settingsPath:"drc.customTimeframes",settingsEventComponent:"drc",placeholder:"New timeframe (e.g., 15M, 5M)"}))};var wo=_(B());var dB=({plugin:e})=>{let t=["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],r=["Monthly","Weekly","Daily"],[n,a]=(0,wo.useState)(()=>(e.settings.weekly||(e.settings.weekly={reviewQuestions:[...t],customTimeframes:[...r],autoCreateOnFirstTrade:!0}),[...e.settings.weekly.reviewQuestions||t])),[o,i]=(0,wo.useState)(()=>{var s;return((s=e.settings.weekly)==null?void 0:s.customTimeframes)||[...r]});return(0,wo.useEffect)(()=>{let s=l=>{var c,d,u;((c=l.detail)==null?void 0:c.component)==="weekly"&&(a(((d=e.settings.weekly)==null?void 0:d.reviewQuestions)||[]),i(((u=e.settings.weekly)==null?void 0:u.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",s),()=>{document.removeEventListener("journalit-settings-updated",s)}},[e.settings]),wo.default.createElement("div",{className:"weekly-review-section"},wo.default.createElement("h4",null,"Review Questions"),wo.default.createElement("p",{className:"setting-item-description"},"Customize the questions that appear in your weekly review. These questions help you reflect on your trading performance over the week."),wo.default.createElement(Vh,{plugin:e,items:n,defaultItems:t,settingsPath:"weekly.reviewQuestions",placeholder:"New review question",onItemsChange:a,settingsEventComponent:"weekly"}),wo.default.createElement("hr",null),wo.default.createElement("h4",null,"Forecast Timeframes"),wo.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your weekly forecast."),wo.default.createElement(mw,{plugin:e,timeframes:o,defaultTimeframes:r,settingsPath:"weekly.customTimeframes",settingsEventComponent:"weekly",placeholder:"New timeframe (e.g., Weekly, Daily)"}))};var Qt=_(B());So();Ja();wm();ym();var Pa={general:{currency:"USD"},trade:{autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,useDirectPnLInput:!1,tradingDayCutoffTime:"00:00",includeMissedTradesInCalculations:!1,lossReview:{enabled:!0,sections:[{id:"pause-header",title:"**LOSS REVIEW**",type:"header",content:""},{id:"pause-section",title:"**Pause**\u270B",type:"header",content:`Take a moment to step back.
Do **NOT** start looking at entering a position until you have completed this loss review.`},{id:"pause-checkbox",title:"",type:"checkbox",content:'Say out loud to yourself, **"losses are part of the process, there are endless opportunities in the market."**'},{id:"review-plan",title:"**Review Your Plan**",type:"header",content:"***Did you stick to your trading plan without mistakes?***"},{id:"review-plan-checklist",title:"",type:"checkboxList",items:["\u2192 If **yes**; there is nothing to be mad about, not every trade is going to work out regardless of how good the thesis is","\u2192 If **no**; figure out what went wrong, learn from it and don't do it again"]},{id:"feelings",title:"**Write Down Your Feelings**",type:"header",content:"***Be honest about how you feel and note down your emotions:***"},{id:"feelings-text",title:"",type:"textarea",placeholder:"How are you feeling about this loss?"},{id:"learn-header",title:"**Learn From This Loss**",type:"header",content:"***If the loss was reasonable, write down the best things you did during the trade and ways of repeating those:***"},{id:"learn-reasonable",title:"",type:"textarea",placeholder:"What went well that you can repeat?"},{id:"learn-unreasonable-header",title:"",type:"header",content:"***If the loss was unreasonable, note where you went wrong and how you'll improve next time:***"},{id:"learn-unreasonable",title:"",type:"textarea",placeholder:"What went wrong and how will you improve?"},{id:"next-steps",title:"**Decide The Next Steps**",type:"header",content:`***Outline what you'll do based on the previous questions and follow the plan.***
***You might choose to step back from the charts if it's your third loss in a row.***
***Or you might want to continue trading if it's the first one.***
***What will you pay attention to? How will you behave?***`},{id:"next-steps-text",title:"",type:"textarea",placeholder:"What are your next steps?"},{id:"final-check",title:"**Final Check**",type:"header",content:""},{id:"final-check-list",title:"",type:"checkboxList",items:["If you feel **tilted**, take a break from the screen and play guitar, play with Leo, or get something to eat","If you feel **fine**, do not enter a trade until at least the next candle"]},{id:"overall-thoughts",title:"**Overall Trade Thoughts:**",type:"header",content:""},{id:"overall-thoughts-text",title:"",type:"textarea",placeholder:"Any additional thoughts about this trade?"}]}},reviews:{globalAutoCreate:!0},uiCustomization:{transparentBackgrounds:!0},customOptions:ks,customTradeFields:fu,customFieldOptions:{},weekly:{reviewQuestions:["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],customTimeframes:["Monthly","Weekly","Daily"],autoCreateOnFirstTrade:!0,autoCreateWeeklyReviewOnNavigation:!0},monthly:{reviewQuestions:["What were the key lessons from this month?","Which strategies performed best?","What patterns do I notice in my trading?","What are my goals for next month?","How can I improve my risk management?"],customTimeframes:["Quarterly","Monthly","Weekly"],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},drc:{checklistItems:["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],reviewQuestions:["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],customTimeframes:["Daily","4H","1H","30M"],autoCreateOnFirstTrade:!0,autoCreateDRCOnNavigation:!0},dashboard:{layouts:{Default:{topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}]}}},activeLayout:"Default",defaultFilters:{dateRange:[null,null],accounts:[],tickers:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[]}},account:{defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}},backendIntegration:{serverUrl:"http://91.99.99.169",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0}};var ir=_(B());yo();Jl();rd();var gB=({section:e,index:t,totalSections:r,onUpdate:n,onRemove:a,onMove:o})=>{let i=p=>{let m={...e,type:p};p==="checkboxList"?(m.items=m.items||[""],m.content=void 0,m.placeholder=void 0):p==="textarea"?(m.placeholder=m.placeholder||"",m.content=void 0,m.items=void 0):(m.content=m.content||"",m.items=void 0,m.placeholder=void 0),n(m)},s=(p,m)=>{let h=[...e.items||[]];h[p]=m,n({...e,items:h})},l=()=>{let p=[...e.items||[],""];n({...e,items:p})},c=p=>{let m=(e.items||[]).filter((h,f)=>f!==p);n({...e,items:m})},d=()=>{switch(e.type){case"header":return ir.default.createElement(Xt,{label:"Content",multiline:!0,rows:3,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter header content (supports markdown)"});case"checkbox":return ir.default.createElement(Xt,{label:"Checkbox Label",multiline:!0,rows:2,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter checkbox label (supports markdown)"});case"textarea":return ir.default.createElement(Xt,{label:"Placeholder Text",value:e.placeholder||"",onChange:p=>n({...e,placeholder:p}),placeholder:"Enter placeholder text for the textarea"});case"checkboxList":return ir.default.createElement("div",{className:"checkbox-list-section"},ir.default.createElement("label",{className:"checkbox-items-label"},"Checkbox Items"),ir.default.createElement("div",{className:"checkbox-items"},(e.items||[]).map((p,m)=>ir.default.createElement("div",{key:m,className:"checkbox-item"},ir.default.createElement(Xt,{multiline:!0,rows:2,value:p,onChange:h=>s(m,h),placeholder:"Enter checkbox item (supports markdown)"}),ir.default.createElement(De,{onClick:()=>c(m),disabled:(e.items||[]).length<=1},"Remove"))),ir.default.createElement(De,{onClick:l},"Add Item")));default:return null}},u=`${e.title||"Untitled Section"} (${e.type})`;return ir.default.createElement("div",{className:"loss-review-section-editor"},ir.default.createElement(Cr,{title:u,defaultExpanded:!1},ir.default.createElement("div",{className:"section-editor-content"},ir.default.createElement("div",{className:"section-controls-bar"},ir.default.createElement("div",{className:"section-order-controls"},ir.default.createElement(mu,{ariaLabel:"Move up",onClick:()=>o("up"),disabled:t===0,className:"control-button"},ir.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ir.default.createElement("polyline",{points:"18 15 12 9 6 15"}))),ir.default.createElement(mu,{ariaLabel:"Move down",onClick:()=>o("down"),disabled:t===r-1,className:"control-button"},ir.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ir.default.createElement("polyline",{points:"6 9 12 15 18 9"})))),ir.default.createElement(De,{onClick:a,variant:"danger"},"Remove Section")),ir.default.createElement("hr",null),ir.default.createElement("div",{className:"section-settings"},ir.default.createElement(Xt,{label:"Section Title",value:e.title,onChange:p=>n({...e,title:p}),placeholder:"Enter section title"}),ir.default.createElement(la,{label:"Section Type",value:e.type,onChange:p=>i(p),options:[{value:"header",label:"Header"},{value:"checkbox",label:"Single Checkbox"},{value:"textarea",label:"Text Area"},{value:"checkboxList",label:"Checkbox List"}]}),d()))))};yo();var hB=({plugin:e})=>{var u,p,m,h,f;let[t,r]=(0,Qt.useState)((m=(p=(u=e.settings.trade)==null?void 0:u.lossReview)==null?void 0:p.enabled)!=null?m:!0),[n,a]=(0,Qt.useState)(((f=(h=e.settings.trade)==null?void 0:h.lossReview)==null?void 0:f.sections)||[]);(0,Qt.useEffect)(()=>{let b=v=>{var y,g,w,C,k,x;((y=v.detail)==null?void 0:y.component)==="lossReview"&&(r((C=(w=(g=e.settings.trade)==null?void 0:g.lossReview)==null?void 0:w.enabled)!=null?C:!0),a(((x=(k=e.settings.trade)==null?void 0:k.lossReview)==null?void 0:x.sections)||[]))};return document.addEventListener("journalit-settings-updated",b),()=>{document.removeEventListener("journalit-settings-updated",b)}},[e.settings]);let o=async b=>{var v;r(b),e.settings.trade.lossReview={enabled:b,sections:((v=e.settings.trade.lossReview)==null?void 0:v.sections)||[]},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},i=async(b,v)=>{var g,w;let y=[...n];y[b]=v,a(y),e.settings.trade.lossReview={enabled:(w=(g=e.settings.trade.lossReview)==null?void 0:g.enabled)!=null?w:!0,sections:y},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},s=async b=>{var y,g;let v=n.filter((w,C)=>C!==b);a(v),e.settings.trade.lossReview={enabled:(g=(y=e.settings.trade.lossReview)==null?void 0:y.enabled)!=null?g:!0,sections:v},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},l=async(b,v)=>{var w,C;if(v==="up"&&b===0||v==="down"&&b===n.length-1)return;let y=[...n],g=v==="up"?b-1:b+1;[y[b],y[g]]=[y[g],y[b]],a(y),e.settings.trade.lossReview={enabled:(C=(w=e.settings.trade.lossReview)==null?void 0:w.enabled)!=null?C:!0,sections:y},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))};return Qt.default.createElement("div",{className:"loss-review-section"},Qt.default.createElement("h4",null,"Loss Review Settings"),Qt.default.createElement("p",{className:"setting-item-description"},"Configure the Loss Review that appears at the bottom of losing trades. This helps you learn from losses and maintain proper trading psychology."),Qt.default.createElement("div",{className:"setting-item"},Qt.default.createElement("div",{className:"setting-item-info"},Qt.default.createElement("div",{className:"setting-item-name"},"Enable Loss Review"),Qt.default.createElement("div",{className:"setting-item-description"},"Show Loss Review section for trades with negative P&L")),Qt.default.createElement("div",{className:"setting-item-control"},Qt.default.createElement("input",{type:"checkbox",checked:t,onChange:b=>o(b.target.checked)}))),t&&Qt.default.createElement(Qt.default.Fragment,null,Qt.default.createElement("hr",null),Qt.default.createElement("div",{className:"loss-review-sections"},Qt.default.createElement("div",{className:"section-header"},Qt.default.createElement("h4",null,"Loss Review Sections"),Qt.default.createElement("div",{className:"section-actions"},Qt.default.createElement(De,{onClick:async()=>{var y,g;let b={id:`section-${Date.now()}`,title:"New Section",type:"header",content:""},v=[...n,b];a(v),e.settings.trade.lossReview={enabled:(g=(y=e.settings.trade.lossReview)==null?void 0:y.enabled)!=null?g:!0,sections:v},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"primary"},"Add Section"),Qt.default.createElement(De,{onClick:async()=>{var y,g,w;let b=((y=Pa.trade.lossReview)==null?void 0:y.sections)||[],v=(w=(g=Pa.trade.lossReview)==null?void 0:g.enabled)!=null?w:!0;a(b),e.settings.trade.lossReview={enabled:v,sections:b},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"secondary"},"Reset to Defaults"))),Qt.default.createElement("div",{className:"sections-list"},n.map((b,v)=>Qt.default.createElement(gB,{key:b.id,section:b,index:v,totalSections:n.length,onUpdate:y=>i(v,y),onRemove:()=>s(v),onMove:y=>l(v,y)})),n.length===0&&Qt.default.createElement("div",{className:"empty-state"},Qt.default.createElement("p",null,'No sections configured. Click "Add Section" to create your first section.'))))))};var vB=({plugin:e})=>Gn.default.createElement("div",{className:"journalit-settings-tab reviews-settings"},Gn.default.createElement("h3",null,"Review Settings"),Gn.default.createElement("p",{className:"setting-item-description"},"Configure settings for daily, weekly, monthly, and yearly reviews. These settings control how reviews are created and what information they include."),Gn.default.createElement(oB,{plugin:e}),Gn.default.createElement("hr",null),Gn.default.createElement(Cr,{title:"Daily Review",defaultExpanded:!0},Gn.default.createElement(cB,{plugin:e})),Gn.default.createElement(Cr,{title:"Weekly Review",defaultExpanded:!1},Gn.default.createElement(dB,{plugin:e})),Gn.default.createElement(Cr,{title:"Trade Loss Review",defaultExpanded:!1},Gn.default.createElement(hB,{plugin:e})),Gn.default.createElement(Cr,{title:"Monthly Review",defaultExpanded:!1},Gn.default.createElement("div",{className:"coming-soon"},Gn.default.createElement("p",null,"Monthly review settings will be available in a future update."))),Gn.default.createElement(Cr,{title:"Yearly Review",defaultExpanded:!1},Gn.default.createElement("div",{className:"coming-soon"},Gn.default.createElement("p",null,"Yearly review settings will be available in a future update."))));var gt=_(B()),vw=require("obsidian");var yB=require("obsidian"),ad=new yB.Events,od={STATE_CHANGED:"auth-state-changed"};yo();var bB=({plugin:e})=>{var u;let[t,r]=(0,gt.useState)(e.authManager.getAuthState()),[n,a]=(0,gt.useState)(e.authManager.getSubscriptionTier()),[o,i]=(0,gt.useState)(e.authManager.isAuthenticated());(0,gt.useEffect)(()=>{let p=()=>{r(e.authManager.getAuthState()),a(e.authManager.getSubscriptionTier()),i(e.authManager.isAuthenticated())};return ad.on(od.STATE_CHANGED,p),()=>{ad.off(od.STATE_CHANGED,p)}},[e]);let s=async()=>{if(!o)try{await e.authManager.authenticate()}catch(p){new vw.Notice("Authentication failed. Please try again."),console.error("Authentication error:",p)}},l=async()=>{try{await e.authManager.logout(),new vw.Notice("Successfully signed out")}catch(p){new vw.Notice("Error during logout"),console.error("Logout error:",p)}},c=p=>{switch(p==null?void 0:p.toLowerCase()){case"free":return"Free plan with basic features.";case"pro":return"Pro plan with advanced analytics and unlimited storage.";case"enterprise":return"Enterprise plan with full feature access and priority support.";default:return"Subscription status unknown."}},d=()=>{var p;if((p=t.cache)!=null&&p.graceEnd){let m=new Date(t.cache.graceEnd),h=new Date,f=m.getTime()-h.getTime(),b=Math.ceil(f/(1e3*60*60*24));return Math.max(0,b)}return 0};return gt.default.createElement("div",{className:"trading-journal-settings-container"},gt.default.createElement("h2",null,"Authentication"),gt.default.createElement("p",{className:"setting-item-description"},"Manage authentication and connection settings."),gt.default.createElement(Cr,{title:"Authentication",defaultExpanded:!0},gt.default.createElement("div",{className:"setting-item"},gt.default.createElement("div",{className:"setting-item-info"},gt.default.createElement("div",{className:"setting-item-name"},"Status"),gt.default.createElement("div",{className:"setting-item-description"},"Current connection and subscription status")),gt.default.createElement("div",{className:"setting-item-control"},gt.default.createElement("input",{type:"text",value:`${t.isOffline?"Offline (Grace Period)":"Online"}${n?` - ${n.charAt(0).toUpperCase()+n.slice(1)} Plan`:""}`,disabled:!0,className:"status-text"}))),gt.default.createElement("div",{className:"setting-item"},gt.default.createElement("div",{className:"setting-item-info"},gt.default.createElement("div",{className:"setting-item-name"},"Authentication"),gt.default.createElement("div",{className:"setting-item-description"},"Sign in to access your trading journal")),gt.default.createElement("div",{className:"setting-item-control"},gt.default.createElement(De,{variant:"primary",onClick:s,className:o?"connected":"login-button"},o?"Signed In":"Sign In / Sign Up"))),o&&gt.default.createElement("div",{className:"setting-item"},gt.default.createElement("div",{className:"setting-item-info"},gt.default.createElement("div",{className:"setting-item-name"},"Sign Out"),gt.default.createElement("div",{className:"setting-item-description"},"Sign out of your account")),gt.default.createElement("div",{className:"setting-item-control"},gt.default.createElement(De,{variant:"danger",onClick:l,className:"signout"},"Sign Out"))),o&&n&&gt.default.createElement(gt.default.Fragment,null,gt.default.createElement("h4",null,"Subscription Features"),gt.default.createElement("div",{className:"setting-item-description subscription-desc"},c(n))),t.error&&gt.default.createElement("div",{className:"trading-journal-error"},"Error: ",t.error),t.isOffline&&gt.default.createElement("div",{className:"trading-journal-warning"},gt.default.createElement("strong",null,"Offline Mode"),gt.default.createElement("p",null,"Operating in offline mode. Some features may be limited. Will automatically sync when online."),((u=t.cache)==null?void 0:u.graceEnd)&&gt.default.createElement("p",null,"Grace period ends in ",d()," days"))))};var da=_(B());var fe=_(B());ll();var Tr=require("obsidian");So();cd();yo();var ED=class extends Tr.Modal{constructor(r,n,a){super(r);this.message=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},xw=class extends Tr.Modal{constructor(r,n,a){super(r);this.message=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Reset",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},_B=({plugin:e})=>{let[t,r]=(0,fe.useState)({}),[n,a]=(0,fe.useState)({}),[o,i]=(0,fe.useState)(e.optionsService),[s,l]=(0,fe.useState)({}),[c,d]=(0,fe.useState)("stock");(0,fe.useEffect)(()=>{(async()=>{await o.reloadOptions();let S=o.getAllOptions();r(S);let T={};Object.entries(S).forEach(([P,M])=>{T[P]={},P==="instrument"?M.forEach(D=>{T[P][D.name]={text:D.name,isEditing:!1,editValue:D.name,editAssetType:D.assetType}}):P==="event"?M.forEach(D=>{T[P][D.name]={text:D.name,isEditing:!1,editValue:D.name}}):M.forEach(D=>{T[P][D]={text:D,isEditing:!1,editValue:D}})}),a(T)})()},[e,o]);let u=x=>{switch(x){case"instrument":return"Tickers";case"account":return"Accounts";case"account_type":return"Account Types";case"setup":return"Setups";case"mistake":return"Mistakes";case"tag":return"Tags";case"event":return"Events";default:return x}},p=x=>{switch(x){case"stock":return"Stock";case"options":return"Options";case"futures":return"Futures";case"forex":return"Forex";case"crypto":return"Crypto";case"cfd":return"CFD";default:return x.charAt(0).toUpperCase()+x.slice(1)}},m=(x,S)=>{a(T=>{let P=T[x]||{},M=P[S]||{text:S,isEditing:!1,editValue:S},D;if(x==="instrument"){let A=t.instrument.find(L=>L.name===S);D=(A==null?void 0:A.assetType)||"stock"}return{...T,[x]:{...P,[S]:{...M,isEditing:!0,editValue:S,editAssetType:D}}}}),setTimeout(()=>{let T=document.querySelector(`.option-edit-input[data-option="${CSS.escape(S)}"]`);T&&(T.focus(),T.select())},50)},h=(x,S)=>{a(T=>{let P=T[x]||{},M=P[S];return M?{...T,[x]:{...P,[S]:{...M,isEditing:!1}}}:T})},f=()=>{try{document.activeElement instanceof HTMLElement&&document.activeElement.blur();let x=document.createElement("input");x.style.position="absolute",x.style.opacity="0",x.style.height="0",x.style.width="0",document.body.appendChild(x),requestAnimationFrame(()=>{x.focus(),requestAnimationFrame(()=>{x.blur(),document.body.contains(x)&&document.body.removeChild(x)})})}catch(x){console.error("Failed to reset focus state:",x)}},b=async x=>{var T;let S=(T=s[x])==null?void 0:T.trim();if(!S){new Tr.Notice("Option name cannot be empty");return}f();try{let P=!1;if(x==="event"?P=await o.addOrUpdateEventOption(S,"gray"):x==="instrument"?P=await o.addOption(x,S,c):P=await o.addOption(x,S),P){new Tr.Notice(`Added option "${S}" to ${u(x)}`),l(A=>({...A,[x]:""})),await o.reloadOptions();let M=o.getAllOptions();r(M);let D={};Object.entries(M).forEach(([A,L])=>{D[A]={},A==="instrument"?L.forEach(N=>{D[A][N.name]={text:N.name,isEditing:!1,editValue:N.name,editAssetType:N.assetType}}):A==="event"?L.forEach(N=>{D[A][N.name]={text:N.name,isEditing:!1,editValue:N.name}}):L.forEach(N=>{D[A][N]={text:N,isEditing:!1,editValue:N}})}),a(D)}else new Tr.Notice(`Could not add option "${S}". It might already exist.`)}catch(P){console.error(`Failed to add option for type ${x}:`,P),new Tr.Notice("An error occurred while adding the option.")}},v=(x,S,T)=>{a(P=>{let M=P[x]||{},D=M[S];return D?{...P,[x]:{...M,[S]:{...D,editValue:T}}}:(console.warn(`Initializing missing edit state for ${x} - ${S} during updateEditValue`),{...P,[x]:{...M,[S]:{text:S,isEditing:!0,editValue:T}}})})},y=(x,S,T)=>{x==="instrument"&&a(P=>{let M=P[x]||{},D=M[S];return D?{...P,[x]:{...M,[S]:{...D,editAssetType:T}}}:P})},g=async(x,S)=>{try{if(!n[x]||!n[x][S]){console.error(`Cannot save option: Edit state not found for type "${x}", key "${S}"`),new Tr.Notice("Error saving option: State not found.");return}let T=n[x][S].editValue;if(!T||T.trim()===""){new Tr.Notice("Option name cannot be empty");return}let P;if(x==="instrument"){if(P=n[x][S].editAssetType,!P){let D=t.instrument.find(A=>A.name===S);P=D==null?void 0:D.assetType}if(!P){new Tr.Notice("Asset type is required for instruments");return}}let M=async D=>{f(),a(L=>{let N={...L[x]||{}},E=N[S];return E&&(delete N[S],N[T]={...E,text:T,isEditing:!1,editValue:T}),{...L,[x]:N}});let A;if(x==="instrument")if(P==="futures"){let L=o.getFuturesDataForInstrument(S);A=await o.updateInstrument(S,T,P,L,D)}else A=await o.updateInstrument(S,T,P,void 0,D);else A=await o.updateOption(x,S,T,D);if(A.success){await o.reloadOptions();let L=o.getAllOptions();r(L);let N={};Object.entries(L).forEach(([E,I])=>{N[E]={},E==="instrument"?I.forEach(O=>{var $,F,z;let j=E===x&&O.name===T?!1:(z=(F=($=n[E])==null?void 0:$[O.name])==null?void 0:F.isEditing)!=null?z:!1;N[E][O.name]={text:O.name,isEditing:j,editValue:O.name,editAssetType:O.assetType}}):E==="event"?I.forEach(O=>{var $,F,z;let j=E===x&&O.name===T?!1:(z=(F=($=n[E])==null?void 0:$[O.name])==null?void 0:F.isEditing)!=null?z:!1;N[E][O.name]={text:O.name,isEditing:j,editValue:O.name}}):I.forEach(O=>{var $,F,z;let j=E===x&&O===T?!1:(z=(F=($=n[E])==null?void 0:$[O])==null?void 0:F.isEditing)!=null?z:!1;N[E][O]={text:O,isEditing:j,editValue:O}})}),a(N),D&&A.updatedNotes!==void 0?new Tr.Notice(`Updated option from "${S}" to "${T}" and updated ${A.updatedNotes} notes`):new Tr.Notice(`Updated option from "${S}" to "${T}"`)}else new Tr.Notice(`Could not update - "${T}" already exists or is invalid`),a(L=>{var I,O;let N={...L[x]||{}};return N[T]?(delete N[T],N[S]={...((I=n[x])==null?void 0:I[S])||{text:S,editValue:S},isEditing:!0,editValue:T}):(O=L[x])!=null&&O[S]&&(N[S]={...L[x][S],isEditing:!0,editValue:T}),{...L,[x]:N}})};if(S!==T){let D=`Do you want to update all existing notes that use "${S}" to use "${T}" instead?

This will search through all notes and update the option value wherever it's found.`;new ED(e.app,D,A=>{M(A)}).open()}else if(x==="instrument"){let D=t.instrument.find(N=>N.name===S),A=D==null?void 0:D.assetType,L=n[x][S].editAssetType;A!==L?M(!1):a(N=>{var E;return{...N,[x]:{...N[x]||{},[S]:{...((E=N[x])==null?void 0:E[S])||{text:S,editValue:S},isEditing:!1}}}})}else a(D=>{var A;return{...D,[x]:{...D[x]||{},[S]:{...((A=D[x])==null?void 0:A[S])||{text:S,editValue:S},isEditing:!1}}}})}catch(T){console.error("Failed to update option:",T),new Tr.Notice("Failed to update option"),a(P=>{var M;return{...P,[x]:{...P[x]||{},[S]:{...((M=P[x])==null?void 0:M[S])||{text:S,editValue:S},isEditing:!0}}}})}},w=async(x,S)=>{try{let T=`Are you sure you want to remove "${S}"? This cannot be undone.`;class P extends Tr.Modal{constructor(A,L,N){super(A);this.message=L;this.onConfirm=N}onOpen(){let{contentEl:A}=this;A.createEl("p",{text:this.message});let L=A.createDiv({cls:"modal-button-container"});L.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),L.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:A}=this;A.empty()}}new P(e.app,T,async()=>{if(f(),await o.removeOption(x,S)){await o.reloadOptions();let D=o.getAllOptions();r(D);let A={};Object.entries(D).forEach(([L,N])=>{A[L]={},L==="instrument"?N.forEach(E=>{A[L][E.name]={text:E.name,isEditing:!1,editValue:E.name,editAssetType:E.assetType}}):L==="event"?N.forEach(E=>{A[L][E.name]={text:E.name,isEditing:!1,editValue:E.name}}):N.forEach(E=>{A[L][E]={text:E,isEditing:!1,editValue:E}})}),a(A),new Tr.Notice(`Removed option "${S}"`)}else new Tr.Notice(`Could not remove option "${S}"`)}).open()}catch(T){console.error("Failed to remove option:",T),new Tr.Notice("Failed to remove option")}},C=async x=>{try{let S=`Are you sure you want to reset all custom ${u(x).toLowerCase()}? This cannot be undone.`;new xw(e.app,S,async()=>{f();let T=await o.clearOptions(x);if(T>0){await o.reloadOptions();let P=o.getAllOptions();r(P),a(M=>({...M,[x]:{}})),new Tr.Notice(`Removed ${T} custom ${u(x).toLowerCase()}`)}else new Tr.Notice(`No ${u(x).toLowerCase()} to remove`)}).open()}catch(S){console.error(`Failed to reset ${x} options:`,S),new Tr.Notice(`Failed to reset ${u(x).toLowerCase()}`)}},k=async()=>{try{let x="Are you sure you want to reset all custom options? This cannot be undone.";new xw(e.app,x,async()=>{f(),await o.resetAllOptions(),await o.reloadOptions();let S=o.getAllOptions();r(S),a({}),new Tr.Notice("All custom options have been reset")}).open()}catch(x){console.error("Failed to reset all options:",x),new Tr.Notice("Failed to reset all options")}};return fe.default.createElement("div",{className:"journalit-settings-tab custom-options-settings",style:{maxHeight:"100%",overflowY:"visible"}},fe.default.createElement("div",{className:"custom-options-container"},Object.entries(t).filter(([x,S])=>x!=="account").map(([x,S])=>{var T;return fe.default.createElement("div",{key:x,className:"option-category"},fe.default.createElement("h3",null,u(x)),!S||S.length===0?fe.default.createElement("p",{className:"setting-item-description"},"No custom ",u(x).toLowerCase()," have been added yet."):fe.default.createElement("div",{className:"custom-options-container"},x==="instrument"?S.map((P,M)=>{var L;let D=P.name,A=(L=n[x])==null?void 0:L[D];return A?A.isEditing?fe.default.createElement("div",{key:`${x}-${D}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:A.editValue,onChange:N=>v(x,D,N.target.value),onKeyDown:N=>{N.key==="Enter"?(N.preventDefault(),g(x,D)):N.key==="Escape"&&(N.preventDefault(),h(x,D))},className:"option-edit-input","data-option":D,"aria-label":`Edit ${D}`,autoFocus:!0,style:{flex:"1"}}),fe.default.createElement("select",{value:A.editAssetType||P.assetType,onChange:N=>y(x,D,N.target.value),style:{width:"120px"}},Object.values(ld).map(N=>fe.default.createElement("option",{key:N,value:N},p(N))))),fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:"Save changes",onClick:()=>g(x,D)},fe.default.createElement(hu,{size:24})),fe.default.createElement(bo,{label:"Cancel editing",onClick:()=>h(x,D)},fe.default.createElement(yu,{size:24}))))):fe.default.createElement("div",{key:`${x}-${D}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{style:{display:"flex",alignItems:"center"}},fe.default.createElement("div",{className:"setting-item-name"},D),fe.default.createElement("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"var(--text-muted)",padding:"2px 6px",borderRadius:"4px",backgroundColor:"var(--background-secondary)"}},p(P.assetType)))),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:`Edit ${D}`,onClick:()=>m(x,D)},fe.default.createElement(un,{size:24})),fe.default.createElement(bo,{label:`Remove ${D}`,onClick:()=>w(x,D)},fe.default.createElement(vu,{size:24}))))):null}):x==="event"?S.map((P,M)=>{var L;let D=P.name,A=(L=n[x])==null?void 0:L[D];return A?A.isEditing?fe.default.createElement("div",{key:`${x}-${D}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("input",{type:"text",value:A.editValue,onChange:N=>v(x,D,N.target.value),onKeyDown:N=>{N.key==="Enter"?(N.preventDefault(),g(x,D)):N.key==="Escape"&&(N.preventDefault(),h(x,D))},className:"option-edit-input","data-option":D,"aria-label":`Edit ${D}`,autoFocus:!0}),fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:"Save changes",onClick:()=>g(x,D)},fe.default.createElement(hu,{size:24})),fe.default.createElement(bo,{label:"Cancel editing",onClick:()=>h(x,D)},fe.default.createElement(yu,{size:24}))))):fe.default.createElement("div",{key:`${x}-${D}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name"},D),fe.default.createElement("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"50%",marginLeft:"8px",backgroundColor:P.color,border:"1px solid var(--background-modifier-border)"},title:`Color: ${P.color}`})),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:`Edit ${D}`,onClick:()=>m(x,D)},fe.default.createElement(un,{size:24})),fe.default.createElement(bo,{label:`Remove ${D}`,onClick:()=>w(x,D)},fe.default.createElement(vu,{size:24}))))):null}):S.map((P,M)=>{var A;let D=(A=n[x])==null?void 0:A[P];return D?D.isEditing?fe.default.createElement("div",{key:`${x}-${P}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("input",{type:"text",value:D.editValue,onChange:L=>v(x,P,L.target.value),onKeyDown:L=>{L.key==="Enter"?(L.preventDefault(),g(x,P)):L.key==="Escape"&&(L.preventDefault(),h(x,P))},className:"option-edit-input","data-option":P,"aria-label":`Edit ${P}`,autoFocus:!0}),fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:"Save changes",onClick:()=>g(x,P)},fe.default.createElement(hu,{size:24})),fe.default.createElement(bo,{label:"Cancel editing",onClick:()=>h(x,P)},fe.default.createElement(yu,{size:24}))))):fe.default.createElement("div",{key:`${x}-${P}-${M}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name"},P)),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(bo,{label:`Edit ${P}`,onClick:()=>m(x,P)},fe.default.createElement(un,{size:24})),fe.default.createElement(bo,{label:`Remove ${P}`,onClick:()=>w(x,P)},fe.default.createElement(vu,{size:24}))))):null}),fe.default.createElement("div",{className:"custom-options-reset-container"},fe.default.createElement(De,{variant:"danger",size:"small",onClick:()=>C(x),className:"reset-category-button","aria-label":`Remove all custom ${u(x).toLowerCase()}`},"Reset All ",u(x)))),fe.default.createElement("div",{className:"setting-item custom-item-add"},fe.default.createElement("div",{className:"setting-item-info"},x==="instrument"?fe.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:s[x]||"",onChange:P=>l(M=>({...M,[x]:P.target.value})),placeholder:`New ${u(x).slice(0,-1)} Name`,"aria-label":`Add new ${u(x).toLowerCase()}`,onKeyDown:P=>{var M;P.key==="Enter"&&((M=s[x])!=null&&M.trim())&&(P.preventDefault(),b(x))},style:{flex:"1"}}),fe.default.createElement("select",{value:c,onChange:P=>d(P.target.value),style:{width:"120px"}},Object.values(ld).map(P=>fe.default.createElement("option",{key:P,value:P},p(P))))):fe.default.createElement("input",{type:"text",value:s[x]||"",onChange:P=>l(M=>({...M,[x]:P.target.value})),placeholder:`New ${u(x).slice(0,-1)} Name`,"aria-label":`Add new ${u(x).toLowerCase()}`,onKeyDown:P=>{var M;P.key==="Enter"&&((M=s[x])!=null&&M.trim())&&(P.preventDefault(),b(x))}})),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement(De,{onClick:()=>b(x),disabled:!((T=s[x])!=null&&T.trim()),"aria-label":`Confirm add ${u(x).toLowerCase()}`},"Add"))),fe.default.createElement("hr",null))}),fe.default.createElement("div",{id:"reset-all-section"},fe.default.createElement("h3",null,"Reset All Options"),fe.default.createElement("p",{className:"setting-item-description"},"Clear all custom options for all categories. This action cannot be undone."),fe.default.createElement("div",{className:"setting-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name"},"Reset All Custom Options"),fe.default.createElement("div",{className:"setting-item-description"},"Remove all custom options for instruments, accounts, setups, and mistakes")),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement(De,{variant:"danger",onClick:k,className:"reset-all-button","aria-label":"Remove all custom options for all categories"},"Reset All"))))))};var J=_(B()),nv=require("obsidian");wm();_i();Jl();rd();Sw();Su();var SQ=({field:e,onSave:t,onCancel:r,onDelete:n,generateUniqueKey:a})=>{var v,y,g,w,C;let[o,i]=(0,J.useState)({...e}),[s,l]=(0,J.useState)(""),c=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"dropdown",label:"Dropdown"},{value:"multiselect",label:"Multi-select"},{value:"date",label:"Date"},{value:"datetime",label:"Date & Time"},{value:"time",label:"Time"}],d=(k,x)=>{let S={...o,[k]:x};k==="type"&&(["date","datetime","dropdown","multiselect"].includes(x)&&(S.validation={}),x!=="dropdown"&&x!=="multiselect"&&(S.options=[])),k==="label"&&(S.fieldKey=a(x,o.id)),i(S)},u=(k,x)=>{i(S=>({...S,validation:{...S.validation,[k]:x}}))},p=()=>{if(s.trim()){let k=[...o.options||[],{value:s.trim(),label:s.trim()}];i(x=>({...x,options:k})),l("")}},m=k=>{let x=[...o.options||[]];x.splice(k,1),i(S=>({...S,options:x}))},h=()=>{t(o)},f=!0,b=["dropdown","multiselect"].includes(o.type);return J.default.createElement("div",{className:"custom-field-editor"},J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Field Configuration"))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Field Label"),J.default.createElement("div",{className:"setting-item-description"},"Display name for this field")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Xt,{value:o.label,onChange:k=>d("label",k),placeholder:"Enter field label",size:"md"}))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Frontmatter Key"),J.default.createElement("div",{className:"setting-item-description"},"This key will appear in your trade files: ",J.default.createElement("code",{style:{backgroundColor:"var(--background-modifier-border)",padding:"2px 4px",borderRadius:"3px",fontSize:"0.9em",color:o.fieldKey&&bm.has(o.fieldKey)?"var(--text-error)":"var(--text-accent)"}},o.fieldKey||"field_name"),o.fieldKey&&bm.has(o.fieldKey)&&J.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"8px"}},"\u26A0\uFE0F Reserved field name")))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Field Type"),J.default.createElement("div",{className:"setting-item-description"},"Type of input field")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(la,{options:c,value:o.type,onChange:k=>d("type",k)}))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Placeholder Text"),J.default.createElement("div",{className:"setting-item-description"},"Optional placeholder text shown in empty field")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Xt,{value:o.placeholder||"",onChange:k=>d("placeholder",k),placeholder:"Enter placeholder text",size:"md"}))),f&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Validation"),J.default.createElement("div",{className:"setting-item-description"},"Field validation rules"))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Required Field"),J.default.createElement("div",{className:"setting-item-description"},"Make this field mandatory")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement("input",{type:"checkbox",checked:((v=o.validation)==null?void 0:v.required)||!1,onChange:k=>u("required",k.target.checked),style:{transform:"scale(1.2)"}}))),o.type==="text"&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Minimum Length"),J.default.createElement("div",{className:"setting-item-description"},"Minimum number of characters")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Mt,{value:((y=o.validation)==null?void 0:y.minLength)||void 0,onChange:k=>u("minLength",k),min:0,placeholder:"No minimum"}))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Maximum Length"),J.default.createElement("div",{className:"setting-item-description"},"Maximum number of characters")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Mt,{value:((g=o.validation)==null?void 0:g.maxLength)||void 0,onChange:k=>u("maxLength",k),min:1,placeholder:"No maximum"})))),o.type==="number"&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Minimum Value"),J.default.createElement("div",{className:"setting-item-description"},"Minimum allowed number")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Mt,{value:((w=o.validation)==null?void 0:w.min)||void 0,onChange:k=>u("min",k),allowDecimal:!0,placeholder:"No minimum"}))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Maximum Value"),J.default.createElement("div",{className:"setting-item-description"},"Maximum allowed number")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement(Mt,{value:((C=o.validation)==null?void 0:C.max)||void 0,onChange:k=>u("max",k),allowDecimal:!0,placeholder:"No maximum"}))))),b&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Options"),J.default.createElement("div",{className:"setting-item-description"},"Available choices for this field"))),(o.options||[]).map((k,x)=>J.default.createElement("div",{key:x,className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},k.label)),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement($e,{variant:"outline",size:"sm",onClick:()=>m(x)},"Remove")))),J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Add New Option"),J.default.createElement("div",{className:"setting-item-description"},"Enter a new choice")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},J.default.createElement(Xt,{value:s,onChange:l,placeholder:"Enter new option",size:"md",style:{flex:1}}),J.default.createElement($e,{variant:"primary",size:"md",onClick:p,disabled:!s.trim()},"Add")))),o.type==="multiselect"&&J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Allow Creating New Options"),J.default.createElement("div",{className:"setting-item-description"},"Users can create new options when using this field in trade forms")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement("input",{type:"checkbox",checked:o.allowCreateOptions||!1,onChange:k=>d("allowCreateOptions",k.target.checked),style:{transform:"scale(1.2)"}})))),J.default.createElement("div",{className:"setting-item",style:{justifyContent:"center",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"16px",marginTop:"16px"}},J.default.createElement("div",{style:{display:"flex",gap:"8px"}},J.default.createElement($e,{variant:"primary",onClick:h},"Save Field"),J.default.createElement($e,{variant:"outline",onClick:r},"Cancel"),J.default.createElement($e,{variant:"outline",onClick:()=>n(e.id),style:{color:"var(--text-error)"}},"Delete Field"))))},QB=({plugin:e})=>{let{service:t,status:r}=Cs("CustomFieldsService"),[n,a]=(0,J.useState)([]),[o,i]=(0,J.useState)(null),[s,l]=(0,J.useState)(!1),[c,d]=(0,J.useState)(0);(0,J.useEffect)(()=>{u();let g=e.app,w=C=>{a(C.fields||[])};return g.workspace.on("journalit-custom-fields-changed",w),()=>{g.workspace.off("journalit-custom-fields-changed",w)}},[t,r]);let u=()=>{if(t&&r==="ready"){let g=t.getFields();a(g)}},p=()=>{let g=n.map(C=>C.fieldKey||nd(C.label)),w=fB("text",g);i(w),l(!0)},m=g=>{i({...g}),l(!1)},h=(g,w)=>{let C=n.filter(k=>k.id!==w).map(k=>k.fieldKey||nd(k.label));return xm(g,C)},f=async g=>{if(!t||r!=="ready"){console.error("CustomFieldsService not ready, status:",r);return}let w=gw(g.fieldKey);if(w){alert(`Cannot save field: ${w}`);return}let C=n.filter(k=>k.id!==g.id).map(k=>k.fieldKey||nd(k.label));if(C.includes(g.fieldKey)){alert("Cannot save field: A field with this frontmatter key already exists");return}try{g.fieldKey||(g.fieldKey=xm(g.label,C)),s?await t.addField(g):await t.updateField(g.id,g),u(),i(null),l(!1)}catch(k){console.error("Failed to save field:",k),alert("Failed to save field. Please try again.")}},b=()=>{i(null),l(!1)},v=async g=>{if(!t||r!=="ready"){console.error("CustomFieldsService not ready, status:",r);return}let w=(o==null?void 0:o.id)===g?o:n.find(k=>k.id===g),C=(w==null?void 0:w.label)||"Unknown Field";new ID(e.app,C,async()=>{try{await t.removeField(g),u(),i(null),l(!1)}catch(k){console.error("Failed to delete field:",k)}}).open()},y=async()=>{if(!t||r!=="ready"){console.error("CustomFieldsService not ready, status:",r);return}new ND(e.app,async()=>{try{await t.resetFields(),u(),i(null),l(!1)}catch(g){console.error("Failed to reset fields:",g)}}).open()};return J.default.createElement("div",{className:"custom-fields-manager"},J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-description"},"Create custom fields that will appear in the Advanced tab of the trade form. These fields will be saved to your trade's frontmatter."))),n.length>0&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Custom Fields (",n.length,")"),J.default.createElement("div",{className:"setting-item-description"},"Manage your custom trade form fields"))),n.map(g=>{var w,C;return J.default.createElement("div",{key:g.id,className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},g.label,((w=g.validation)==null?void 0:w.required)&&J.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"4px"}},"*")),J.default.createElement("div",{className:"setting-item-description"},"Type: ",g.type,((C=g.validation)==null?void 0:C.required)&&" \u2022 Required")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement($e,{variant:"outline",size:"sm",onClick:()=>m(g)},"Edit")))})),n.length===0&&!o&&J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"No custom fields defined yet"),J.default.createElement("div",{className:"setting-item-description"},`Custom fields will appear in the "Advanced" tab of the trade form and be saved to your trade notes' frontmatter.`))),o&&J.default.createElement(J.default.Fragment,null,J.default.createElement("div",{className:"setting-item",style:{borderTop:"2px solid var(--background-modifier-border)",marginTop:"16px",paddingTop:"16px"}},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},s?"Add New Field":"Edit Field"),J.default.createElement("div",{className:"setting-item-description"},"Configure your custom field settings below"))),J.default.createElement(SQ,{field:o,onSave:f,onCancel:b,onDelete:v,generateUniqueKey:h})),!o&&J.default.createElement(kQ,{customFieldsService:t,fields:n,onOptionsChanged:()=>{d(g=>g+1)},plugin:e}),!o&&J.default.createElement("div",{className:"setting-item",style:{justifyContent:"space-between"}},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Actions"),J.default.createElement("div",{className:"setting-item-description"},"Manage your custom fields")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement("div",{style:{display:"flex",gap:"8px"}},J.default.createElement($e,{variant:"primary",onClick:p},"Add Custom Field"),n.length>0&&J.default.createElement($e,{variant:"outline",onClick:y,style:{color:"var(--text-error)"}},"Delete All Fields")))))},ID=class extends nv.Modal{constructor(r,n,a){super(r);this.fieldLabel=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the custom field "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},ND=class extends nv.Modal{constructor(r,n){super(r);this.onConfirm=n}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:"Are you sure you want to delete ALL custom fields?"}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},LD=class extends nv.Modal{constructor(r,n,a){super(r);this.optionName=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the option "${this.optionName}"?`});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},MD=class extends nv.Modal{constructor(r,n,a){super(r);this.fieldLabel=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete ALL saved options for "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Clear All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},kQ=({customFieldsService:e,fields:t,onOptionsChanged:r,plugin:n})=>{let[a,o]=(0,J.useState)(new Set);if(!e)return null;let i=t.filter(d=>(d.type==="dropdown"||d.type==="multiselect")&&d.allowCreateOptions&&e.getFieldOptions(d.id).length>0);if(i.length===0)return null;let s=d=>{let u=new Set(a);u.has(d)?u.delete(d):u.add(d),o(u)},l=async(d,u)=>{e&&new LD(n.app,u,async()=>{try{await e.removeFieldOption(d,u),r()}catch(p){console.error("Failed to delete option:",p),alert("Failed to delete option. Please try again.")}}).open()},c=async(d,u)=>{e&&new MD(n.app,u,async()=>{try{await e.removeAllFieldOptions(d),r()}catch(p){console.error("Failed to clear all options:",p),alert("Failed to clear options. Please try again.")}}).open()};return J.default.createElement("div",{style:{marginTop:"24px",paddingTop:"24px",borderTop:"1px solid var(--background-modifier-border)"}},J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name"},"Saved Custom Options"),J.default.createElement("div",{className:"setting-item-description"},"Manage options that users have created for custom fields"))),i.map(d=>{let u=e.getFieldOptions(d.id),p=a.has(d.id);return J.default.createElement("div",{key:d.id,style:{marginLeft:"16px"}},J.default.createElement("div",{className:"setting-item"},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name",style:{cursor:"pointer"},onClick:()=>s(d.id)},p?"\u25BC":"\u25B6"," ",d.label," (",u.length," option",u.length!==1?"s":"",")"),J.default.createElement("div",{className:"setting-item-description"},d.type==="dropdown"?"Dropdown":"Multi-select"," field")),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement($e,{variant:"outline",size:"sm",onClick:()=>c(d.id,d.label),style:{color:"var(--text-error)"}},"Clear All"))),p&&J.default.createElement("div",{style:{marginLeft:"16px",marginBottom:"8px"}},u.map((m,h)=>J.default.createElement("div",{key:h,className:"setting-item",style:{minHeight:"auto",padding:"4px 0"}},J.default.createElement("div",{className:"setting-item-info"},J.default.createElement("div",{className:"setting-item-name",style:{fontSize:"0.9em"}},"\u2022 ",m)),J.default.createElement("div",{className:"setting-item-control"},J.default.createElement($e,{variant:"outline",size:"sm",onClick:()=>l(d.id,m),style:{padding:"2px 8px",fontSize:"0.8em"}},"Delete"))))))}))};Yn();var P$=({plugin:e})=>{var a,o,i;let[t,r]=da.default.useState((i=(o=(a=e.settings)==null?void 0:a.uiCustomization)==null?void 0:o.transparentBackgrounds)!=null?i:!0),n=s=>{r(s),e.settings.uiCustomization||(e.settings.uiCustomization={transparentBackgrounds:!0}),e.settings.uiCustomization.transparentBackgrounds=s,e.saveSettings(),document.body.setAttribute("data-transparent-bg",String(s)),Tu(!1,!1,!1,!1,!1,!1,!0)};return da.default.useEffect(()=>{document.body.setAttribute("data-transparent-bg",String(t))},[t]),da.default.createElement("div",{className:"journalit-settings-tab customization-settings"},da.default.createElement("h3",null,"Customisation"),da.default.createElement("p",{className:"setting-item-description"},"Customize options, appearance, and behavior of the Journalit plugin."),da.default.createElement(Cr,{title:"UI Customisation",defaultExpanded:!0},da.default.createElement("div",{className:"setting-item"},da.default.createElement("div",{className:"setting-item-info"},da.default.createElement("div",{className:"setting-item-name"},"Transparent Widget Backgrounds"),da.default.createElement("div",{className:"setting-item-description"},"Enable for transparent backgrounds, disable for solid backgrounds on dashboard widgets and metrics.")),da.default.createElement("div",{className:"setting-item-control"},da.default.createElement(Ka,{checked:t,onChange:n,id:"transparent-backgrounds-toggle",ariaLabel:"Toggle transparent backgrounds"})))),da.default.createElement(Cr,{title:"Custom Options",defaultExpanded:!1},da.default.createElement(_B,{plugin:e})),da.default.createElement(Cr,{title:"Custom Trade Fields",defaultExpanded:!1},da.default.createElement(QB,{plugin:e})))};var oe=_(B());ll();var ul=require("obsidian");ec();var Ce=_(B()),Ow=require("obsidian");Su();var D$=({userId:e})=>{let t=Ee(),{service:r}=Cs("backendIntegrationService"),[n,a]=(0,Ce.useState)(null),[o,i]=(0,Ce.useState)(!1),[s,l]=(0,Ce.useState)(!1),[c,d]=(0,Ce.useState)(null),[u,p]=(0,Ce.useState)(null),[m,h]=(0,Ce.useState)(!1),f=(0,Ce.useCallback)(async()=>{var y,g;if(!(!e||!r)){i(!0),d(null);try{let w=await r.getFTPCredentials(e);if(w){let C=(y=t==null?void 0:t.settings.backendIntegration)==null?void 0:y.ftpPassword;C&&!w.password&&(w.password=C),a(w)}else a(null)}catch(w){(g=w.message)!=null&&g.includes("404")||(d("Failed to load FTP credentials"),console.error("Failed to load FTP credentials:",w)),a(null)}finally{i(!1)}}},[e,r,t==null?void 0:t.settings.backendIntegration]);Ce.default.useEffect(()=>{f()},[e,f]),Ce.default.useEffect(()=>{let y=g=>{var w;(w=g.detail)!=null&&w.credentials?a(g.detail.credentials):f()};return window.addEventListener("ftp-credentials-created",y),()=>{window.removeEventListener("ftp-credentials-created",y)}},[f]);let b=(0,Ce.useCallback)(async(y,g)=>{try{await navigator.clipboard.writeText(y),p(g),setTimeout(()=>p(null),2e3)}catch(w){console.error("Failed to copy to clipboard:",w),new Ow.Notice("Failed to copy to clipboard")}},[]),v=(0,Ce.useCallback)(async()=>{if(!(!r||!e)){h(!0),d(null);try{let y=await r.resetFTPPassword(e);y?(a(y),l(!0),new Ow.Notice("\u2705 FTP password reset successfully! Save the new password."),t!=null&&t.settings.backendIntegration&&(t.settings.backendIntegration.ftpPassword=y.password,await t.saveSettings())):d("Failed to reset password")}catch(y){console.error("Failed to reset FTP password:",y),d("Failed to reset password. Please try again."),new Ow.Notice("\u274C Failed to reset FTP password")}finally{h(!1)}}},[r,e,t]);return o&&!n?Ce.default.createElement("div",{className:"ftp-credentials-section"},Ce.default.createElement("h3",null,"FTP Credentials"),Ce.default.createElement("div",{className:"loading-container"},"Loading FTP credentials...")):Ce.default.createElement("div",{className:"ftp-credentials-section"},Ce.default.createElement("h3",null,"FTP Credentials for MetaTrader"),c&&Ce.default.createElement("div",{className:"ftp-error-message"},Ce.default.createElement("span",null,"\u26A0\uFE0F"),Ce.default.createElement("span",null,c)),n?Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{className:"ftp-info-message"},Ce.default.createElement("p",null,"Use these credentials to configure MetaTrader's FTP publishing settings:")),Ce.default.createElement("div",{className:"ftp-credentials-grid"},Ce.default.createElement("div",{className:"ftp-credential-field"},Ce.default.createElement("label",null,"FTP Server:"),Ce.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},Ce.default.createElement("input",{type:"text",value:`${n.server}:${n.port}`,readOnly:!0,className:"ftp-readonly-input"}),Ce.default.createElement("button",{className:"clickable-icon",onClick:()=>b(`${n.server}:${n.port}`,"server"),"aria-label":"Copy FTP server"},u==="server"?"\u2713":"\u{1F4CB}"))),Ce.default.createElement("div",{className:"ftp-credential-field"},Ce.default.createElement("label",null,"FTP Login:"),Ce.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},Ce.default.createElement("input",{type:"text",value:n.username,readOnly:!0,className:"ftp-readonly-input"}),Ce.default.createElement("button",{className:"clickable-icon",onClick:()=>b(n.username,"username"),"aria-label":"Copy FTP login"},u==="username"?"\u2713":"\u{1F4CB}"))),n.password&&Ce.default.createElement("div",{className:"ftp-credential-field"},Ce.default.createElement("label",null,"FTP Password:"),Ce.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},Ce.default.createElement("input",{type:s?"text":"password",value:n.password,readOnly:!0,className:"ftp-readonly-input"}),Ce.default.createElement("button",{className:"clickable-icon",onClick:()=>b(n.password,"password"),"aria-label":"Copy password"},u==="password"?"\u2713":"\u{1F4CB}"),Ce.default.createElement("button",{className:"clickable-icon",onClick:()=>l(!s),"aria-label":s?"Hide password":"Show password"},s?"\u{1F648}":"\u{1F441}\uFE0F")),Ce.default.createElement("div",{className:"ftp-password-notice"},Ce.default.createElement("span",{style:{fontSize:"14px"}},"\u26A0\uFE0F"),Ce.default.createElement("span",null,"Save this password securely. It cannot be retrieved later.")))),Ce.default.createElement("div",{className:"ftp-reset-password",style:{marginTop:"20px",marginBottom:"20px"}},Ce.default.createElement("button",{className:"mod-cta",onClick:v,disabled:m,style:{width:"auto"}},m?"Resetting Password...":"Reset FTP Password"),Ce.default.createElement("div",{style:{marginTop:"10px",fontSize:"14px",color:"var(--text-muted)"}},"Click this button to generate a new FTP password.")),Ce.default.createElement("div",{className:"ftp-setup-instructions"},Ce.default.createElement("h4",null,"MetaTrader Setup Instructions:"),Ce.default.createElement("ol",null,Ce.default.createElement("li",null,"Open MetaTrader\xA05 (MT5)"),Ce.default.createElement("li",null,"Click on the ",Ce.default.createElement("strong",null,'"Tools"')," menu at the top"),Ce.default.createElement("li",null,"Select ",Ce.default.createElement("strong",null,'"Options"')),Ce.default.createElement("li",null,"Navigate to the ",Ce.default.createElement("strong",null,'"FTP"')," tab and enter the FTP ",Ce.default.createElement("em",null,"Server"),", ",Ce.default.createElement("em",null,"Login"),", and ",Ce.default.createElement("em",null,"Password")," shown above"),Ce.default.createElement("li",null,"Enable ",Ce.default.createElement("strong",null,'"Passive mode"')),Ce.default.createElement("li",null,"Enable ",Ce.default.createElement("strong",null,"automatic publishing of reports via FTP")," and set the refresh interval to ",Ce.default.createElement("strong",null,"60\xA0minutes"))))):Ce.default.createElement("div",{className:"ftp-no-credentials"},Ce.default.createElement("p",null,'No FTP credentials found. Click "Create FTP Credentials" in the section above to generate them.')))};var Ut=_(B()),Tv=require("obsidian");Wi();var I$=({plugin:e,accounts:t,onAccountsUpdated:r})=>{let[n,a]=(0,Ut.useState)(""),[o,i]=(0,Ut.useState)(""),[s,l]=(0,Ut.useState)(!1),[c,d]=(0,Ut.useState)([]);(0,Ut.useEffect)(()=>{u()},[]);let u=async()=>{if(e.accountPageService)try{let h=(await e.accountPageService.getAllEnhancedAccounts()).map(f=>({id:f.id||f.name,name:f.name}));d(h)}catch(m){console.error("Failed to load Obsidian accounts:",m)}},p=async()=>{var m;if(!n||!o){new Tv.Notice("Please select both source and target accounts");return}l(!0);try{let h=t.find(C=>C.accountId===n);if(!h)throw new Error("Source account not found");let f=c.find(C=>C.id===o);if(!f)throw new Error("Target account not found");if(((((m=e.settings.backendIntegration)==null?void 0:m.accountMapping)||{})[n]||h.displayName||`Account-${n}`)===f.name){new Tv.Notice("This MT account is already linked to the selected Obsidian account"),l(!1);return}let y=e.serviceManager;if(!y)throw new Error("Service manager not available");let g=await y.getBackendIntegrationService();if(!g)throw new Error("Backend service not available");await g.updateAccountMapping(n,f.name);let w=await g.relinkAccountTrades(n,h.displayName||`Account-${n}`,f.name);new Tv.Notice(`\u2705 Successfully relinked ${w.updatedCount} trades from ${h.displayName} to ${f.name}`),a(""),i(""),r()}catch(h){console.error("Failed to relink account:",h),new Tv.Notice(`\u274C Failed to relink account: ${h.message}`)}finally{l(!1)}};return Ut.default.createElement("div",{className:"account-linking-manager"},Ut.default.createElement("div",{className:"setting-item"},Ut.default.createElement("div",{className:"setting-item-info"},Ut.default.createElement("div",{className:"setting-item-name"},"Change Account Linking"),Ut.default.createElement("div",{className:"setting-item-description"},"Move all trades from one MT account to a different Obsidian account"))),Ut.default.createElement("div",{className:"account-linking-controls"},Ut.default.createElement("div",{className:"setting-item"},Ut.default.createElement("div",{className:"setting-item-info"},Ut.default.createElement("div",{className:"setting-item-name"},"Source MT Account"),Ut.default.createElement("div",{className:"setting-item-description"},"Select the MT account whose trades you want to move")),Ut.default.createElement("div",{className:"setting-item-control"},Ut.default.createElement(la,{value:n,onChange:m=>a(m),options:t.map(m=>{var b;let f=(((b=e.settings.backendIntegration)==null?void 0:b.accountMapping)||{})[m.accountId]||m.displayName||`Account-${m.accountId}`;return{value:m.accountId,label:`${m.displayName||`Account-${m.accountId}`} (${m.accountId}) \u2192 ${f}`}}),placeholder:"Select source account...",style:{width:"350px"}}))),Ut.default.createElement("div",{className:"setting-item"},Ut.default.createElement("div",{className:"setting-item-info"},Ut.default.createElement("div",{className:"setting-item-name"},"Target Obsidian Account"),Ut.default.createElement("div",{className:"setting-item-description"},"Select the Obsidian account to link the trades to")),Ut.default.createElement("div",{className:"setting-item-control"},Ut.default.createElement(la,{value:o,onChange:m=>i(m),options:c.map(m=>({value:m.id,label:m.name})),placeholder:"Select target account...",style:{width:"250px"}}))),Ut.default.createElement("div",{className:"setting-item"},Ut.default.createElement("div",{className:"setting-item-control"},Ut.default.createElement(De,{variant:"primary",onClick:p,disabled:s||!n||!o},s?"Processing...":"Relink Account"))),n&&o&&Ut.default.createElement("div",{className:"account-linking-warning"},"\u26A0\uFE0F This will update all synced trades from the source account to be linked to the target account. This operation cannot be undone.")))};var XQ="http://91.99.99.169",N$=({plugin:e})=>{var D,A;let t=e.settings.backendIntegration||Pa.backendIntegration,[r,n]=(0,oe.useState)({status:"unknown",isSyncing:!1,lastSyncResult:null,syncStatus:null}),[a,o]=(0,oe.useState)({accounts:[],isLoading:!1}),i=(0,oe.useRef)(0),s=(0,oe.useRef)(0),[l,c]=(0,oe.useState)({hasCredentials:!1,isCreating:!1}),[d,u]=(0,oe.useState)(0),p=oe.default.useMemo(()=>{try{let L=e.app.vault.getName();if(L&&L!=="Obsidian Vault")return L.toLowerCase().replace(/[^a-z0-9]/g,"");let N=e.app.vault.adapter,E="";if(N.basePath)E=N.basePath;else if(N.path)E=N.path;else return"cursive";return(E.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,"")}catch(L){return"cursive"}},[e.app.vault]),[m,h]=(0,oe.useState)(null);(0,oe.useEffect)(()=>{let L=!0;return(async()=>{try{let E=await e.serviceManager.getBackendIntegrationService();if(!L)return;h(E),await f(),await Promise.allSettled([b(E),v(E),C(E)])}catch(E){console.error("Failed to initialize backend integration:",E)}})(),()=>{L=!1}},[e.serviceManager]);let f=(0,oe.useCallback)(async()=>{try{let L=new AbortController,N=setTimeout(()=>L.abort(),5e3),E=await fetch(`${XQ}/api/v1/health`,{method:"GET",signal:L.signal});clearTimeout(N);let I=E.ok?"connected":"disconnected";n(O=>({...O,status:I}))}catch(L){n(N=>({...N,status:"disconnected"}))}},[]),b=(0,oe.useCallback)(async L=>{let N=L||m;if(N)try{let E=await N.getSyncStatus();if(n(I=>({...I,syncStatus:E})),E&&E.last_sync_time&&E.sync_count!==void 0){let I=new Date(E.last_sync_time).getTime(),O=t.lastSyncTime?new Date(t.lastSyncTime).getTime():0;(I>O||E.sync_count>(t.syncCount||0))&&(await y("lastSyncTime",E.last_sync_time),await y("syncCount",E.sync_count))}}catch(E){console.error("Failed to load sync status:",E)}},[m,t.lastSyncTime,t.syncCount]),v=(0,oe.useCallback)(async L=>{let N=L||m;if(!N||r.status==="disconnected"&&!L||a.isLoading)return;let E=Date.now();if(!(E-i.current<5e3)){i.current=E,o(I=>({...I,isLoading:!0}));try{let I=await N.fetchUserAccounts(),O=t.accountMapping||{},j=I.map(F=>({...F,displayName:O[F.accountId]||F.displayName||`Account-${F.accountId}`}));o(F=>({...F,accounts:j,isLoading:!1})),I.some(F=>F.displayName&&!O[F.accountId])&&await N.updateAccountMappings(j)}catch(I){Date.now()-s.current>3e4&&(console.error("\u274C Failed to load accounts:",I instanceof Error?I.message:String(I)),I instanceof Error&&I.message.includes("Network")?new ul.Notice("\u26A0\uFE0F Network error. Please check your connection to the backend server."):new ul.Notice(`\u26A0\uFE0F Failed to load MT accounts: ${I instanceof Error?I.message:String(I)}`),s.current=Date.now()),o(O=>({...O,isLoading:!1,accounts:[]}))}}},[m,r.status]);(0,oe.useEffect)(()=>{r.status==="connected"&&m&&a.accounts.length===0&&!a.isLoading&&Date.now()-i.current>5e3&&v()},[r.status,m]);let y=(0,oe.useCallback)(async(L,N)=>{e.settings.backendIntegration={...e.settings.backendIntegration,[L]:N},await e.saveSettings(),m&&await m.updateSettings({[L]:N})},[e,m]),g=async L=>{await y("syncEnabled",L),u(N=>N+1),new ul.Notice(`Auto-sync ${L?"enabled":"disabled"}`)},w=async(L,N)=>{L==="sync"?(await y("showSyncNotifications",N),new ul.Notice(`Sync notifications ${N?"enabled":"disabled"}`)):(await y("showNewTradeNotifications",N),new ul.Notice(`New trade notifications ${N?"enabled":"disabled"}`)),u(E=>E+1)},C=(0,oe.useCallback)(async L=>{let N=L||m;if(N)try{if(t.ftpUsername){let E=await N.getFTPCredentials(t.ftpUsername);c(I=>({...I,hasCredentials:!!E}))}else c(E=>({...E,hasCredentials:!1}))}catch(E){console.error("Failed to check FTP credentials:",E),c(I=>({...I,hasCredentials:!1}))}},[m,t.ftpUsername]),k=(0,oe.useCallback)(async()=>{if(m){c(L=>({...L,isCreating:!0}));try{let L=await m.createOrGetFTPUser();if(L){await y("ftpUsername",L.username),await y("ftpPassword",L.password),c(E=>({...E,hasCredentials:!0})),new ul.Notice("\u2705 FTP credentials created successfully");let N=new CustomEvent("ftp-credentials-created",{detail:{credentials:L}});window.dispatchEvent(N),await v()}}catch(L){console.error("Failed to create FTP credentials:",L),new ul.Notice("\u274C Failed to create FTP credentials")}finally{c(L=>({...L,isCreating:!1}))}}},[m,y,v]),x=(0,oe.useCallback)(async()=>{if(m){if(!e.authManager.isAuthenticated()){new ul.Notice("Please sign in to register your vault.");return}n(L=>({...L,isSyncing:!0}));try{await y("userId",p),await m.registerVault()&&(n(N=>({...N,status:"connected"})),await b(),await C())}catch(L){console.error("Vault registration failed:",L)}finally{n(L=>({...L,isSyncing:!1}))}}},[m,y,p,b,C,e.authManager]),S=(0,oe.useCallback)(async()=>{if(m){if(!e.authManager.isAuthenticated()){new ul.Notice("Please sign in to use automated sync.");return}n(L=>({...L,isSyncing:!0}));try{let L=await m.requestForceSync();n(N=>({...N,lastSyncResult:L})),await b()}catch(L){console.error("Force sync failed:",L)}finally{n(L=>({...L,isSyncing:!1}))}}},[m,b,e.authManager]),T=(0,oe.useMemo)(()=>{switch(r.status){case"connected":return"\u{1F7E2}";case"disconnected":return"\u{1F534}";default:return"\u{1F7E1}"}},[r.status]),P=(0,oe.useMemo)(()=>{switch(r.status){case"connected":return"Connected";case"disconnected":return"Disconnected";default:return"Checking..."}},[r.status]),M=L=>{if(!L)return"Never";try{let N=new Date(L),E=e.settings.trade.dateFormat||"DDMMYY",I=String(N.getDate()).padStart(2,"0"),O=String(N.getMonth()+1).padStart(2,"0"),j=String(N.getFullYear()).slice(-2),$=String(N.getHours()).padStart(2,"0"),F=String(N.getMinutes()).padStart(2,"0"),z="";switch(E){case"DDMMYY":z=`${I}/${O}/${j}`;break;case"MMDDYY":z=`${O}/${I}/${j}`;break;case"YYMMDD":z=`${j}/${O}/${I}`;break;default:z=`${I}/${O}/${j}`}return`${z} ${$}:${F}`}catch(N){return"Invalid date"}};return oe.default.createElement("div",{className:"journalit-settings-tab backend-integration-settings"},oe.default.createElement("h3",null,"Backend Integration"),oe.default.createElement("p",{className:"setting-item-description"},"Connect to the trading server for automatic trade synchronization."),oe.default.createElement(Cr,{title:"Connection Settings",defaultExpanded:!0},oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Connection Status"),oe.default.createElement("div",{className:"setting-item-description"},"Current connection status to the trading server")),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement("span",{style:{display:"flex",alignItems:"center",gap:"8px"}},oe.default.createElement("span",null,T),oe.default.createElement("span",null,P),oe.default.createElement(De,{variant:"secondary",onClick:f,style:{marginLeft:"8px",padding:"4px 8px",fontSize:"12px"}},oe.default.createElement(Qh,{size:16}))))),oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Register Vault"),oe.default.createElement("div",{className:"setting-item-description"},"Register this vault with the backend server for sync")),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(De,{variant:"primary",onClick:x,disabled:r.isSyncing||!m},oe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r.isSyncing&&oe.default.createElement(sr,{size:"small",message:""}),r.isSyncing?"Registering...":"Register Vault")))),r.status==="connected"&&!l.hasCredentials&&oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"FTP Credentials"),oe.default.createElement("div",{className:"setting-item-description"},"Create FTP credentials to upload MetaTrader reports. A unique username will be generated automatically.")),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(De,{variant:"primary",onClick:k,disabled:l.isCreating||!m},oe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},l.isCreating&&oe.default.createElement(sr,{size:"small",message:""}),l.isCreating?"Creating...":"Create FTP Credentials"))))),oe.default.createElement(Cr,{title:"Sync Settings",defaultExpanded:!0},oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Enable Auto-Sync"),oe.default.createElement("div",{className:"setting-item-description"},"Automatically sync trades from the backend server",oe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"\u2139\uFE0F Auto-sync checks for new trades every hour"))),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(Ka,{checked:t.syncEnabled||!1,onChange:g,id:"sync-enabled-toggle",ariaLabel:"Enable auto-sync"}))),oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Manual Sync"),oe.default.createElement("div",{className:"setting-item-description"},"Force immediate synchronization of trades",oe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"\u2139\uFE0F Average wait time: 2-3 minutes (maximum: 5 minutes)"))),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(De,{variant:"primary",onClick:S,disabled:r.isSyncing||!m},oe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r.isSyncing&&oe.default.createElement(sr,{size:"small",message:""}),r.isSyncing?"Syncing...":"Force Sync Now")))),r.lastSyncResult&&oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Last Sync Result"),oe.default.createElement("div",{className:"setting-item-description"},r.lastSyncResult.synced_trades>0?`\u2705 Synced ${r.lastSyncResult.synced_trades} trades (${r.lastSyncResult.new_files} new files)`:"\u2705 No new trades to sync"))),(t.lastSyncTime||r.syncStatus)&&oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Sync Status"),oe.default.createElement("div",{className:"setting-item-description"},"Last sync: ",M(t.lastSyncTime||((D=r.syncStatus)==null?void 0:D.last_sync_time))," | Total syncs: ",t.syncCount||((A=r.syncStatus)==null?void 0:A.sync_count)||0)))),oe.default.createElement(Cr,{title:"Notification Settings",defaultExpanded:!1},oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Sync Notifications"),oe.default.createElement("div",{className:"setting-item-description"},"Show notifications when sync operations complete")),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(Ka,{checked:t.showSyncNotifications||!1,onChange:L=>w("sync",L),id:"sync-notifications-toggle",ariaLabel:"Enable sync notifications"}))),oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"New Trade Notifications"),oe.default.createElement("div",{className:"setting-item-description"},"Show notifications when new trade files are detected")),oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(Ka,{checked:t.showNewTradeNotifications||!1,onChange:L=>w("newTrade",L),id:"new-trade-notifications-toggle",ariaLabel:"Enable new trade notifications"})))),oe.default.createElement(Cr,{title:"Trading Accounts",defaultExpanded:!1},oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-name"},"Linked MT Accounts"),oe.default.createElement("div",{className:"setting-item-description"},"MetaTrader accounts detected from synced reports",r.status==="disconnected"&&oe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-error)",marginTop:"4px"}},"\u26A0\uFE0F Server is disconnected. Please check connection status.")))),a.isLoading?oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},oe.default.createElement(sr,{message:"Loading accounts...",size:"small"})))):a.accounts.length===0?oe.default.createElement("div",{className:"setting-item"},oe.default.createElement("div",{className:"setting-item-info"},oe.default.createElement("div",{className:"setting-item-description"},"No accounts found.",r.status==="connected"?"Sync some trades to detect accounts.":"Connect to the server and sync trades to see accounts."))):oe.default.createElement("div",{className:"mt-accounts-list"},a.accounts.map(L=>oe.default.createElement("div",{key:L.accountId,className:"mt-account-item"},oe.default.createElement("div",{className:"mt-account-info"},oe.default.createElement("div",{className:"mt-account-id"},"Account ID: ",L.accountId),L.brokerName&&oe.default.createElement("div",{className:"mt-account-broker"},"Broker: ",L.brokerName),oe.default.createElement("div",{className:"mt-account-dates"},L.firstSeen&&oe.default.createElement("span",null,"First seen: ",M(L.firstSeen)),L.lastSeen&&oe.default.createElement("span",null," | Last seen: ",M(L.lastSeen)))),oe.default.createElement("div",{className:"mt-account-display"},oe.default.createElement("div",{className:"mt-account-name"},oe.default.createElement("span",null,L.displayName||`Account-${L.accountId}`)))))),oe.default.createElement("div",{className:"setting-item",style:{marginTop:"20px"}},oe.default.createElement("div",{className:"setting-item-control"},oe.default.createElement(De,{variant:"secondary",onClick:()=>v(),disabled:a.isLoading||!m},"Refresh Accounts"))),a.accounts.length>0&&oe.default.createElement("div",{style:{marginTop:"30px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"20px"}},oe.default.createElement(I$,{plugin:e,accounts:a.accounts,onAccountsUpdated:v}))),l.hasCredentials&&oe.default.createElement(Cr,{title:"MetaTrader FTP Credentials",defaultExpanded:!1},oe.default.createElement(D$,{userId:t.ftpUsername||p})))};Yn();HD();var zw=class extends L$.PluginSettingTab{constructor(r,n){super(r,n);this.root=null;this.plugin=n}display(){Aw(),qD();let r=document.head.querySelector("#settings-tab-styles"),{containerEl:n}=this;n.empty(),n.addClass("journalit-settings"),n.style.display="flex",n.style.flexDirection="column",n.style.width="100%",n.style.height="100%",n.style.overflow="auto",n.style.padding="0";let a=n.createDiv({cls:"journalit-settings-wrapper"});a.style.display="flex",a.style.flexDirection="column",a.style.width="100%",a.style.height="100%",a.style.padding="16px",a.style.boxSizing="border-box",a.style.overflowY="visible",this.root||(this.root=(0,M$.createRoot)(a)),this.root.render(Xa.default.createElement(Xa.default.StrictMode,null,Xa.default.createElement(QQ,{plugin:this.plugin})))}hide(){this.root&&(this.root.unmount(),this.root=null),this.containerEl.empty(),this.containerEl.removeClass("journalit-settings")}},QQ=({plugin:e})=>{let[t,r]=(0,Xa.useState)("general"),n=[{id:"general",label:"General"},{id:"reviews",label:"Reviews & Analysis"},{id:"accounts",label:"Auth"},{id:"backend",label:"Backend Integration"},{id:"customization",label:"Customisation"}],a={display:"flex",borderBottom:"1px solid var(--background-modifier-border)",marginBottom:"20px",justifyContent:"center",width:"100%",paddingBottom:"0"},o=i=>({padding:"8px 16px",cursor:"pointer",borderTop:"none",borderRight:"none",borderLeft:"none",borderBottom:i?"2px solid var(--text-accent)":"2px solid transparent",color:i?"var(--text-normal)":"var(--text-muted)",fontWeight:i?600:500,marginRight:"8px",position:"relative",bottom:"-1px",background:"transparent",borderRadius:"0",fontSize:"14px",transition:"all 0.15s ease"});return Xa.default.createElement("div",{className:"settings-tab-container",style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"visible",padding:"16px",background:"var(--background-primary)"}},Xa.default.createElement("nav",{style:a},n.map(i=>Xa.default.createElement("button",{key:i.id,style:o(t===i.id),onClick:()=>r(i.id)},i.label))),Xa.default.createElement("div",{className:"settings-tab-content journalit-tab-content",role:"tabpanel","aria-labelledby":`tab-${t}`,style:{flex:1,overflowY:"auto",padding:"20px 24px",background:"var(--background-primary)"}},t==="general"&&Xa.default.createElement(nB,{plugin:e}),t==="reviews"&&Xa.default.createElement(vB,{plugin:e}),t==="accounts"&&Xa.default.createElement(bB,{plugin:e}),t==="backend"&&Xa.default.createElement(N$,{plugin:e}),t==="customization"&&Xa.default.createElement(P$,{plugin:e})))};vd();Ft();Za();var Na=class{static generateLinksSection(t){let r=[];if(t.tradeToDRC&&r.push(`**Trade \u2192 DRC**: [[${t.tradeToDRC}]]`),t.drcToWeekly&&r.push(`**DRC \u2192 Weekly**: [[${t.drcToWeekly}]]`),t.weeklyToMonthly&&r.push(`**Weekly \u2192 Monthly**: [[${t.weeklyToMonthly}]]`),t.dailyToWeekly&&r.push(`**Daily \u2192 Weekly**: [[${t.dailyToWeekly}]]`),t.relatedTrades&&t.relatedTrades.length>0){let n=t.relatedTrades.map(a=>`[[${a}]]`).join(", ");r.push(`**Related Trades**: ${n}`)}if(t.relatedAccounts&&t.relatedAccounts.length>0){let n=t.relatedAccounts.map(a=>`[[${a}]]`).join(", ");r.push(`**Related Accounts**: ${n}`)}return r.length===0?"":`## \u2194\uFE0E Links
${r.join(`  
`)}
`}static updateLinksSection(t,r){let n=/## ↔︎ Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g,a=this.generateLinksSection(r),o=t.replace(n,"");return o=o.replace(/\n\n\n+/g,`

`),o=o.trim(),a.trim()?o+`

`+a:o}static removeLinksSection(t){let r=/## ↔︎ Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g;return t.replace(r,"").trim()}static async detectNoteType(t,r){let a=(await r.read(t)).match(/^---\n([\s\S]*?)\n---/),o={};if(a)try{let s=a[1],l=s.match(/^type:\s*(.+)$/m);l&&(o.type=l[1].trim().replace(/['"]/g,""));let c=s.match(/^date:\s*(.+)$/m);c&&(o.date=c[1].trim().replace(/['"]/g,""));let d=s.match(/^entryTime:\s*(.+)$/m);d&&(o.entryTime=d[1].trim().replace(/['"]/g,""))}catch(s){console.error("Error parsing frontmatter:",s)}let i={type:"unknown",filePath:t.path,fileName:t.basename};return o.type==="trade"||t.path.includes("/trades/")?i.type="trade":o.type==="drc"?i.type="drc":o.type==="weekly-review"?i.type="weekly":o.type==="monthly-review"?i.type="monthly":(o.type==="account"||t.path.includes("/accounts/"))&&(i.type="account"),o.date?i.date=new Date(o.date):o.entryTime&&i.type==="trade"&&(i.date=new Date(o.entryTime)),i}static async getRelatedTrades(t,r){let n=[];try{let o=r.app.vault.getMarkdownFiles().filter(i=>i.path.includes("/trades/")&&i.name.includes("-T"));for(let i of o){let s=await this.detectNoteType(i,r.app.vault);s.type==="trade"&&s.date&&this.isSameDay(s.date,t)&&n.push(i.basename)}}catch(a){console.error("Error getting related trades:",a)}return n}static async getParentWeekly(t,r){try{let n=pn(t),a=this.getWeekNumber(n),o=n.getFullYear(),i=`W${a.toString().padStart(2,"0")}-Review`,l=r.app.vault.getMarkdownFiles().find(c=>c.basename===i&&c.path.includes(`${o}`));return l?l.basename:null}catch(n){return console.error("Error getting parent weekly:",n),null}}static async getParentMonthly(t,r){try{let n=t.getMonth()+1,a=t.getFullYear(),o=`${n.toString().padStart(2,"0")}-Review`,s=r.app.vault.getMarkdownFiles().find(l=>l.basename===o&&l.path.includes(`${a}`));return s?s.basename:null}catch(n){return console.error("Error getting parent monthly:",n),null}}static async getChildDailies(t,r){let n=[];try{let a=r.app.vault.getMarkdownFiles();for(let o=0;o<7;o++){let i=new Date(t);if(i.setDate(t.getDate()+o),i.getDay()===0||i.getDay()===6)continue;let s=a.filter(l=>{let c=this.detectNoteTypeSync(l);return c.type==="drc"&&c.date&&this.isSameDay(c.date,i)});n.push(...s.map(l=>l.basename))}}catch(a){console.error("Error getting child dailies:",a)}return n}static async getChildWeeklies(t,r,n){let a=[];try{let i=n.app.vault.getMarkdownFiles().filter(s=>s.basename.match(/^W\d{2}-Review$/)&&s.path.includes(`${r}`));for(let s of i){let l=await this.detectNoteType(s,n.app.vault);l.type==="weekly"&&l.date&&l.date.getMonth()+1===t&&l.date.getFullYear()===r&&a.push(s.basename)}}catch(o){console.error("Error getting child weeklies:",o)}return a}static detectNoteTypeSync(t){let r={type:"unknown",filePath:t.path,fileName:t.basename};return t.path.includes("/trades/")?r.type="trade":t.path.includes("/accounts/")&&(r.type="account"),r}static isSameDay(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}static getWeekNumber(t){let r=new Date(t.getFullYear(),0,1),n=(t.getTime()-r.getTime())/864e5;return Math.ceil((n+r.getDay()+1)/7)}static getTradesDRCDate(t,r){return xt(t,r)}static async getDRCFileName(t,r){try{let n=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getFullYear().toString().slice(-2),i=`DRC-${n}${a}${o}`,l=r.app.vault.getMarkdownFiles().find(c=>c.basename===i&&c.path.includes(`${t.getFullYear()}`));return l?l.basename:null}catch(n){return console.error("Error getting DRC file name:",n),null}}};async function IR(e,t){let r={},n=Na.getTradesDRCDate(e,t),a=await Na.getDRCFileName(n,t);return a&&(r.tradeToDRC=a),r}async function Lv(e,t){let r={},n=await Na.getParentWeekly(e,t);return n&&(r.drcToWeekly=n),r}async function NR(e,t){let r={},n=await Na.getParentMonthly(e,t);return n&&(r.weeklyToMonthly=n),r}var r0=require("obsidian");var _R=_(B());var Re=_(B());Yn();Zt();var Do=_(B());ll();var Po=_(B());Za();Ea();var LR=({trades:e,currentTradePath:t,onTradeClick:r})=>{var d,u,p;let n=(p=(u=(d=window.app)==null?void 0:d.plugins)==null?void 0:u.plugins)==null?void 0:p.journalit,a=Po.default.useMemo(()=>{var m,h;try{let f=window.app;if(!(f!=null&&f.metadataCache))return null;let b=e.find(g=>g.path===t);if(b||(b=f.vault.getAbstractFileByPath(t)),!b)return null;let v=f.metadataCache.getFileCache(b),y=(m=v==null?void 0:v.frontmatter)==null?void 0:m.entryTime;if(y)return new Date(y);if((h=v==null?void 0:v.frontmatter)!=null&&h.useDirectPnLInput){let g=t.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(g){let[,w,C,k]=g,x=2e3+parseInt(k,10);return new Date(x,parseInt(C,10)-1,parseInt(w,10))}}return null}catch(f){return console.warn("Error getting current trade date:",f),null}},[e,t]),o=Po.default.useMemo(()=>{if(!a||!n)return e;try{let m=window.app;return m!=null&&m.metadataCache?e.filter(h=>{var f,b;try{let v=m.metadataCache.getFileCache(h),y=(f=v==null?void 0:v.frontmatter)==null?void 0:f.entryTime,g=(b=v==null?void 0:v.frontmatter)==null?void 0:b.useDirectPnLInput,w=null;if(y)w=new Date(y);else if(g){let C=h.path.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(C){let[,k,x,S]=C,T=2e3+parseInt(S,10);w=new Date(T,parseInt(x,10)-1,parseInt(k,10))}}return w?xR(a,w,n):!1}catch(v){return console.warn(`Error checking trade date for ${h.path}:`,v),!1}}):e}catch(m){return console.warn("Error filtering trades by trading day:",m),e}},[e,a,n]),i=Po.default.useMemo(()=>{let m=o.map(f=>{let b=f.path.match(/([A-Z0-9-]+)-[0-9]{6}-[TM]\d+\.md$/),v=f.path.match(/[TM](\d+)\.md$/),y=f.path.match(/-([TM])\d+\.md$/),g=b?b[1]:"Unknown",w=v?parseInt(v[1],10):0,C=y?y[1]==="M":!1,k=0,x=!1;try{let S=window.app;if(S!=null&&S.metadataCache){let T=S.metadataCache.getFileCache(f),P=T==null?void 0:T.frontmatter;P&&(P.pnl!==void 0?k=Number(P.pnl):P.directPnL!==void 0&&P.useDirectPnLInput&&(k=Number(P.directPnL)),x=ct({tradeStatus:P.tradeStatus,exitTime:P.exitTime,pnl:P.pnl,useDirectPnLInput:P.useDirectPnLInput,exits:P.exits}))}}catch(S){k=0,x=!1}return{file:f,ticker:g,tradeNumber:w,isActive:f.path===t,pnl:k,isMissedTrade:C,isOpen:x}}),h={};return m.forEach(f=>{h[f.ticker]||(h[f.ticker]=[]),h[f.ticker].push(f)}),Object.keys(h).forEach(f=>{h[f].sort((b,v)=>b.tradeNumber-v.tradeNumber)}),h},[o,t]),s=Object.keys(i);if(s.length===0)return null;if(o.length<=1){let m=s[0],h=i[m][0],f=h.isMissedTrade?"M":"T",b=h.isMissedTrade?"Missed Trade":"Trade";return Po.default.createElement("div",{className:"trade-timeline-container single-trade"},Po.default.createElement("div",{className:"trade-timeline"},Po.default.createElement("div",{className:"timeline-label active-ticker"},m,":"),Po.default.createElement("div",{className:"timeline-items"},Po.default.createElement("button",{className:`timeline-item ${h.isMissedTrade?"missed-trade":""} ${h.isOpen?"open":h.pnl>0?"profit":h.pnl<0?"loss":""} active`,disabled:!0,"aria-label":`${m} ${b} ${h.tradeNumber} (${h.isOpen?"Open":h.pnl>0?"Profit":h.pnl<0?"Loss":"Breakeven"})`,title:`Current ${b.toLowerCase()}: ${m} ${b} ${h.tradeNumber}${h.isOpen?" (Open)":""}`},f,h.tradeNumber))))}let l=s.find(m=>i[m].some(h=>h.isActive)),c=[...s].sort((m,h)=>m===l?-1:h===l?1:m.localeCompare(h));return Po.default.createElement("div",{className:"trade-timeline-container"},c.map(m=>Po.default.createElement("div",{key:m,className:"trade-timeline"},Po.default.createElement("div",{className:`timeline-label ${m===l?"active-ticker":""}`},m,":"),Po.default.createElement("div",{className:"timeline-items"},i[m].map(h=>{let f=h.isMissedTrade?"M":"T",b=h.isMissedTrade?"Missed Trade":"Trade";return Po.default.createElement("button",{key:h.file.path,className:`timeline-item 
                    ${h.isMissedTrade?"missed-trade":""} 
                    ${h.isOpen?"open":h.pnl>0?"profit":h.pnl<0?"loss":""} 
                    ${h.isActive?"active":""}`,onClick:()=>r(h.file.path),"aria-label":`${m} ${b} ${h.tradeNumber} (${h.isOpen?"Open":h.pnl>0?"Profit":h.pnl<0?"Loss":"Breakeven"})`,title:`View ${m} ${b} ${h.tradeNumber} (${h.isOpen?"Open":h.pnl>0?"Profit":h.pnl<0?"Loss":"Breakeven"})${h.isOpen?" - Trade is still open":""}`},f,h.tradeNumber)})))))};var zm=_(B()),_m=({buttons:e,className:t="shared-navigation",style:r={}})=>zm.default.createElement("div",{className:t,style:{width:"100%",paddingTop:"10px",borderTop:"1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1))",...r}},zm.default.createElement("div",{className:`${t}-links`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px",flexWrap:"wrap",width:"100%"}},e.map((n,a)=>zm.default.createElement("button",{key:a,className:`${t}-button`,onClick:n.action,disabled:n.disabled,style:{padding:"8px 14px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",flex:"1",textAlign:"center",minWidth:"120px",boxSizing:"border-box"}},n.icon&&n.icon!=="none"&&n.icon!=="right"&&zm.default.createElement("span",{className:"nav-icon"},n.icon==="left"?"\u2190":n.icon),n.text,n.icon&&n.icon==="right"&&zm.default.createElement("span",{className:"nav-icon"},"\u2192")))));Za();Zt();var Jw=({currentDate:e,trades:t,missedTrades:r=[],currentTradePath:n,navigateTo:a,getDRCPath:o,getWeeklyReviewPath:i,getMonthlyReviewPath:s,getYearlyReviewPath:l,onEditClick:c,handleEditClick:d})=>{let u=Ee(),p=(0,Do.useCallback)(g=>{g!==n&&a(g,!1)},[a,n]),m=(0,Do.useCallback)(()=>{let g=xt(e,u),w=o(g);w&&a(w,!1)},[o,e,a,u]),h=(0,Do.useCallback)(()=>{let g=xt(e,u),w=i(g);w&&a(w,!1)},[i,e,a,u]),f=(0,Do.useCallback)(()=>{let g=xt(e,u),w=s(g);w&&a(w,!1)},[s,e,a,u]),b=(0,Do.useCallback)(()=>{let g=xt(e,u),w=l(g);w&&a(w,!1)},[l,e,a,u]),v=[{text:"Daily Report Card",action:m},{text:"Weekly Review",action:h},{text:"Monthly Review",action:f},{text:"Yearly Review",action:b}];return Do.default.createElement("div",{className:"trade-navigation-container"},Do.default.createElement("div",{className:"trade-navigation-with-edit"},Do.default.createElement(_m,{buttons:v,className:"trade-review-navigation",style:{borderTop:"none",flex:"1"}}),d&&c&&Do.default.createElement("div",{className:"edit-button-container"},Do.default.createElement("button",{className:"trade-nav-edit-button",onClick:d,"aria-label":"Edit trade",title:"Edit trade"},Do.default.createElement(un,{size:14})))),Do.default.createElement(LR,{trades:[...t,...r],currentTradePath:n,onTradeClick:p}))};var Bm=_(B());qw();var ic=_(B());ll();var Ie=({message:e="No data available",className:t="",iconSize:r=48,subMessage:n,actionButtonText:a,onActionButtonClick:o})=>ic.default.createElement("div",{className:`journalit-empty-state ${t}`},ic.default.createElement("div",{className:"journalit-empty-state-icon"},ic.default.createElement(Xh,{size:r})),ic.default.createElement("div",{className:"journalit-empty-state-content"},ic.default.createElement("p",{className:"journalit-empty-state-message"},e),n&&ic.default.createElement("p",{className:"journalit-empty-state-submessage"},n),a&&o&&ic.default.createElement("button",{className:"journalit-empty-state-action-button",onClick:o},ic.default.createElement(zi,{size:16,style:{marginRight:"6px"}}),a)));var Mv=Bm.default.memo(({images:e,onEditClick:t})=>!e||e.length===0?Bm.default.createElement("div",{className:"trade-empty-images"},Bm.default.createElement(Ie,{message:"No images for this trade",subMessage:t?"Click 'Edit' to add images":void 0,iconSize:40})):Bm.default.createElement("div",{className:"trade-images-section","data-image-count":e.length},Bm.default.createElement(ac,{images:e,altPrefix:"Trade image",showThumbnails:e.length>1,showCounter:e.length>1,enableDelete:!1,enableFullscreen:!0,useResolveMediaPath:!0,className:e.length===1?"single-image-carousel":"","data-single-image":e.length===1?"true":"false"})),(e,t)=>JSON.stringify(e.images)===JSON.stringify(t.images)&&e.onEditClick===t.onEditClick);var Gr=_(B()),Ov=({data:e,onAccountClick:t})=>{let r=e.account&&e.account.length>0||e.accountIds&&e.accountIds.length>0,n=e.ctags&&e.ctags.length>0,a=e.setup&&e.setup.length>0||e.setupIds&&e.setupIds.length>0,o=e.mistake&&e.mistake.length>0||e.mistakeIds&&e.mistakeIds.length>0;return!r&&!n&&!a&&!o?null:Gr.default.createElement(Gr.default.Fragment,null,Gr.default.createElement("div",{className:"trade-metadata-container"},r&&Gr.default.createElement("div",{className:"metadata-section"},Gr.default.createElement("div",{className:"metadata-label"},"Account:"),Gr.default.createElement("div",{className:"metadata-tags"},(e.account||e.accountIds||[]).map((i,s)=>Gr.default.createElement("span",{key:`account-${s}`,className:"account-tag",onClick:()=>t(i)},i)))),n&&Gr.default.createElement("div",{className:"metadata-section"},Gr.default.createElement("div",{className:"metadata-label"},"Tags:"),Gr.default.createElement("div",{className:"metadata-tags"},e.ctags.map((i,s)=>Gr.default.createElement("span",{key:`tag-${s}`,className:"tag"},i))))),Gr.default.createElement("div",{className:"trade-tags-container"},Gr.default.createElement("div",{className:"tags-row"},a&&Gr.default.createElement("div",{className:"tags-section setup-section"},Gr.default.createElement("h4",null,"Setups"),Gr.default.createElement("div",{className:"tags-list"},(e.setup||e.setupIds||[]).map((i,s)=>Gr.default.createElement("span",{key:`setup-${s}`,className:"tag setup-tag"},i)))),o&&Gr.default.createElement("div",{className:"tags-section mistake-section"},Gr.default.createElement("h4",null,"Mistakes"),Gr.default.createElement("div",{className:"tags-list"},(e.mistake||e.mistakeIds||[]).map((i,s)=>Gr.default.createElement("span",{key:`mistake-${s}`,className:"tag mistake-tag"},i)))))))};var Pe=_(B());ud();Au();Ct();var Fv=({data:e,metrics:t,formatDate:r,formatTime:n,onEditClick:a})=>{var i;let{currency:o}=Ae();return Pe.default.createElement(Pe.default.Fragment,null,Pe.default.createElement("div",{className:"trade-overview-section"},Pe.default.createElement("div",{className:"trade-metrics-grid"},Pe.default.createElement("div",{className:"metric-card"},Pe.default.createElement("div",{className:"metric-label"},"Entry"),Pe.default.createElement("div",{className:"metric-value"},Da(e.entryPrice,!1,o)),Pe.default.createElement("div",{className:"metric-subtitle"},n(e.entryTime))),Pe.default.createElement("div",{className:"metric-card"},Pe.default.createElement("div",{className:"metric-label"},"Exit"),Pe.default.createElement("div",{className:"metric-value"},Da(e.exitPrice,!1,o)),Pe.default.createElement("div",{className:"metric-subtitle"},n(e.exitTime))),Pe.default.createElement("div",{className:"metric-card"},Pe.default.createElement("div",{className:"metric-label"},"Size"),Pe.default.createElement("div",{className:"metric-value"},e.positionSize),Pe.default.createElement("div",{className:"metric-subtitle"},e.direction)),Pe.default.createElement("div",{className:"metric-card"},Pe.default.createElement("div",{className:"metric-label"},"Duration"),Pe.default.createElement("div",{className:"metric-value"},t.duration),Pe.default.createElement("div",{className:"metric-subtitle"},"\xA0")))),Pe.default.createElement("div",{className:"trade-main-content"},Pe.default.createElement("div",{className:"thesis-section"},Pe.default.createElement("h4",null,"Thesis"),e.thesis?Pe.default.createElement("div",{className:"thesis-content"},(i=e.thesis)==null?void 0:i.split(`
`).map((s,l)=>Pe.default.createElement(Pe.default.Fragment,{key:l},s,l<e.thesis.split(`
`).length-1&&Pe.default.createElement("br",null)))):Pe.default.createElement(Ie,{message:"No thesis provided for this trade",subMessage:a?"Click 'Edit' to add a thesis":void 0,iconSize:32}))),Pe.default.createElement("div",{className:"trade-details-footer"},Pe.default.createElement("div",{className:"details-card expanded-details"},Pe.default.createElement("div",{className:"details-header"},Pe.default.createElement("h4",null,"Trade Details")),Pe.default.createElement("table",{className:"details-table"},Pe.default.createElement("tbody",null,Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Instrument"),Pe.default.createElement("td",null,e.instrument||"N/A"),Pe.default.createElement("td",null,"Direction"),Pe.default.createElement("td",null,e.direction||"N/A")),Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Position Size"),Pe.default.createElement("td",null,e.positionSize||"N/A"),Pe.default.createElement("td",null,"P&L"),Pe.default.createElement("td",{className:t.isProfit?"profit-text":"loss-text"},ue(t.pnl,!0,o),!e.useDirectPnLInput&&` (${t.percentChange.toFixed(2)}%)`)),bE(e)!==0&&Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Trading Costs"),Pe.default.createElement("td",{colSpan:3,className:"cost-breakdown"},z$(e),Pe.default.createElement("span",{className:"total-cost"}," | Total: ",ue(bE(e),!0,o)))),Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Entry Price"),Pe.default.createElement("td",null,Da(e.entryPrice,!1,o)),Pe.default.createElement("td",null,"Exit Price"),Pe.default.createElement("td",null,Da(e.exitPrice,!1,o))),Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Entry Time"),Pe.default.createElement("td",null,r(e.entryTime)),Pe.default.createElement("td",null,"Exit Time"),Pe.default.createElement("td",null,r(e.exitTime))),Pe.default.createElement("tr",null,Pe.default.createElement("td",null,"Duration"),Pe.default.createElement("td",{colSpan:3},t.duration)))))))};var gl=_(B());ud();Ea();Ct();var jv=({instrument:e,direction:t,isProfit:r,pnl:n,percentChange:a,useDirectPnLInput:o,isMissedTrade:i,exitTime:s,tradeStatus:l,exits:c})=>{let{currency:d}=Ae(),u=l==="OPEN"||ct({useDirectPnLInput:o,exitTime:s,tradeStatus:l,exits:c,pnl:void 0});return gl.default.createElement("div",{className:`trade-note-header ${u?"open":r?"profit":"loss"}`},gl.default.createElement("div",{className:"trade-instrument"},gl.default.createElement("span",{className:"trade-direction-icon"},(t||"").toLowerCase()==="long"?"\u25B2":"\u25BC"),e||"Unknown Instrument",i&&gl.default.createElement("span",{className:"missed-trade-badge"},"MISSED"),u&&gl.default.createElement("span",{className:"open-trade-badge"},"OPEN")),gl.default.createElement("div",{className:"trade-header-actions"},gl.default.createElement("div",{className:"trade-pnl"},u?gl.default.createElement("span",{className:"open-text"},"OPEN"):gl.default.createElement("span",{className:r?"profit-text":"loss-text"},n>0?"+":"",ue(n,!0,d),!o&&` (${a.toFixed(2)}%)`))))};var MR=_(B());Ft();Ea();var zv=({data:e})=>({metrics:(0,MR.useMemo)(()=>{let a=ct({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}),o=e.entryPrice||0,i=e.exitPrice||0,s=e.positionSize||0,l=(e.direction||"").toLowerCase()==="long";if(a)return{pnl:0,percentChange:0,duration:"",isProfit:!1};let c=e.pnl!==void 0?e.pnl:l?(i-o)*s:(o-i)*s,d=e.useDirectPnLInput||o===0?0:l?(i-o)/o*100:(o-i)/o*100,u="";if(e.entryTime&&e.exitTime){let p=typeof e.entryTime=="string"?new Date(e.entryTime):e.entryTime,h=(typeof e.exitTime=="string"?new Date(e.exitTime):e.exitTime).getTime()-p.getTime(),f=Math.floor(h/(1e3*60*60)),b=Math.floor(h%(1e3*60*60)/(1e3*60)),v=Math.floor(h%(1e3*60)/1e3);f>0?u=`${f}h ${b}m`:b>0?u=`${b}m ${v}s`:u=`${v}s`}return{pnl:c,percentChange:d,duration:u,isProfit:c>0}},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.pnl,e.entryTime,e.exitTime,e.tradeStatus,e.useDirectPnLInput,e.exits]),formatDate:a=>{if(!a)return"N/A";let o=new Date(a),i=Ot(),s=Fe(o,i),l=o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return`${s} ${l}`},formatTime:a=>a?new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"});Za();var Xw=_(B());_i();Ft();var hl=({reviewed:e=!1,reviewedAt:t,onMarkReviewed:r,label:n="Mark as Reviewed",className:a=""})=>{let o=Ot();return Xw.default.createElement("div",{className:`review-button-container ${a}`},Xw.default.createElement($e,{variant:"primary",onClick:r,disabled:e,className:"review-button"},e?"\u2713 Reviewed":n),e&&t&&Xw.default.createElement("span",{className:"review-timestamp"},"Reviewed on ",Fe(new Date(t),o)))};var OR=Re.default.memo(({data:e,onEditClick:t})=>{var f;let[r,n]=(0,Re.useState)(e.filePath||"unknown"),[a,o]=(0,Re.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Re.useEffect)(()=>{o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let i=(0,Re.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=zv({data:e}),d=Ee();(0,Re.useEffect)(()=>{Pu(),vv();let b=e.images||[];if(i.current){i.current.classList.add("missed-trade-note-mounted"),i.current.setAttribute("data-mounted-at",Date.now().toString());let v=i.current.closest(".journalit-missed-trade-view");v&&v.classList.add("missed-trade-note-mounted")}},[]);let u=(0,Re.useCallback)(b=>{if(i.current=b,b&&(!r||r==="unknown")){let v=b.getAttribute("data-displaying-file");if(v){n(v);return}let y=b.parentElement;for(;y;){let g=y.getAttribute("data-displaying-file")||y.getAttribute("data-file-path");if(g){n(g);break}y=y.parentElement}}},[r]),p=async b=>{if(!d||!d.accountPageService){console.error("Cannot navigate to account: AccountPageService not available");return}try{let y=(await d.accountPageService.getAllEnhancedAccounts()).find(g=>g.id===b||g.name===b);y?d.openFile?d.openFile(y.notePath,!1):d.app&&d.app.workspace.openLinkText(y.notePath,"",!1):console.error(`Could not find account: ${b}`)}catch(v){console.error("Error navigating to account:",v)}},m=(0,Re.useCallback)(()=>{t&&t(e)},[e,t]),h=(0,Re.useCallback)(()=>{if(d!=null&&d.missedTradeService&&r&&r!=="unknown"){let b=new Date().toISOString();o({reviewed:!0,reviewedAt:b}),d.missedTradeService.updateMissedTradeReviewStatus(r,!0,b).then(()=>{console.log("Missed trade marked as reviewed")}).catch(v=>{console.error("[MissedTradeNote] Error updating review status:",v),o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})})}},[d,r,e.reviewed,e.reviewedAt]);return Re.default.createElement("div",{className:"missed-trade-note-container",ref:u,"data-file-path":r,style:{margin:0}},Re.default.createElement(jv,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:!0}),(e.entryTime||e.useDirectPnLInput)&&Re.default.createElement(aZ,{data:e,filePath:r,onEditClick:t,handleEditClick:m}),Re.default.createElement("div",{className:"missed-trade-note-content"},Re.default.createElement(Mv,{images:e.images,onEditClick:m}),Re.default.createElement(Ov,{data:e,onAccountClick:p}),Re.default.createElement(Fv,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:m}),e.missedReason&&Re.default.createElement("div",{className:"missed-trade-reason-section"},Re.default.createElement("div",{className:"details-card"},Re.default.createElement("h4",null,"Why I missed this trade"),Re.default.createElement("div",{className:"missed-trade-reason-content"},(f=e.missedReason)==null?void 0:f.split(`
`).map((b,v)=>Re.default.createElement(Re.default.Fragment,{key:v},b,v<e.missedReason.split(`
`).length-1&&Re.default.createElement("br",null)))))),Re.default.createElement("div",{className:"missed-trade-note-review-section"},Re.default.createElement(hl,{reviewed:a.reviewed,reviewedAt:a.reviewedAt,onMarkReviewed:h}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.missedReason===t.data.missedReason&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&e.onEditClick===t.onEditClick),aZ=Re.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let a=Ee(),[o,i]=(0,Re.useState)([]),[s,l]=(0,Re.useState)([]),[c,d]=(0,Re.useState)(!1),[u,p]=(0,Re.useState)(!1),[m,h]=(0,Re.useState)(0),f=Re.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(t&&t!=="unknown"){let S=t.match(/(\d{2})(\d{2})(\d{2})-M\d+\.md$/);if(S){let[,T,P,M]=S,D=2e3+parseInt(M,10);return new Date(D,parseInt(P,10)-1,parseInt(T,10))}}return new Date},[e.entryTime,t]),b=Re.default.useMemo(()=>{if(!f||!a)return null;let{start:S,end:T}=Vw(f,a);return{startDate:S,endDate:T}},[f,a]),v=Re.default.useMemo(()=>!f||!a?"":oc(f,a),[f,a]),y=Re.default.useRef(null);(0,Re.useEffect)(()=>{let S=y.current;if(!S)return;let T=new IntersectionObserver(P=>{let[M]=P;M.isIntersecting&&(p(!0),T.disconnect())},{rootMargin:"50px",threshold:.1});return T.observe(S),()=>T.disconnect()},[]),(0,Re.useEffect)(()=>{let S=T=>{let{action:P}=T.detail;(P==="created"||P==="updated")&&v&&setTimeout(()=>{Object.keys(sessionStorage).forEach(M=>{(M.startsWith("trade-nav-")||M.startsWith("missed-trade-nav-"))&&sessionStorage.removeItem(M)}),i([]),l([]),d(!1),h(M=>M+1)},200)};return document.addEventListener("journalit:trade-data-changed",S),document.addEventListener("journalit:missed-trade-data-changed",S),()=>{document.removeEventListener("journalit:trade-data-changed",S),document.removeEventListener("journalit:missed-trade-data-changed",S)}},[v]),(0,Re.useEffect)(()=>{if(!u||!b||!(a!=null&&a.tradeService)||!(a!=null&&a.missedTradeService)||!v)return;let S=!0;return(async()=>{try{if(c)return;d(!0),setTimeout(async()=>{try{let[P,M]=await Promise.all([a.tradeService.getTrades(b.startDate,b.endDate),a.missedTradeService.getMissedTrades(b.startDate,b.endDate)]);S&&(i(P),l(M))}catch(P){console.error("Error fetching trades for day:",P)}finally{S&&d(!1)}},100)}catch(P){console.error("Error in trade fetch setup:",P),S&&d(!1)}})(),()=>{S=!1}},[u,b,a==null?void 0:a.tradeService,a==null?void 0:a.missedTradeService,v,m]);let g=(0,Re.useCallback)((S,T=!1)=>{try{a&&a.openFile?a.openFile(S,T):a!=null&&a.app?a.app.workspace.openLinkText(S,"",T):console.error("Cannot navigate: Plugin and App context not available.")}catch(P){console.error("Navigation error:",P)}},[a]),w=(0,Re.useCallback)(S=>a!=null&&a.drcService?a.drcService.getDRCNotePath(S):"",[a==null?void 0:a.drcService]),C=(0,Re.useCallback)(S=>a!=null&&a.weeklyReviewService?a.weeklyReviewService.getWeeklyReviewPath(S):"",[a==null?void 0:a.weeklyReviewService]),k=(0,Re.useCallback)(S=>a!=null&&a.drcService?a.drcService.getMonthlyReviewPath(S):null,[a==null?void 0:a.drcService]),x=(0,Re.useCallback)(()=>null,[]);return!f||!(a!=null&&a.drcService)||!(a!=null&&a.weeklyReviewService)?null:Re.default.createElement("div",{ref:y},u?Re.default.createElement(Re.default.Fragment,null,Re.default.createElement(Jw,{currentDate:f,trades:o,missedTrades:s,currentTradePath:t,navigateTo:g,getDRCPath:w,getWeeklyReviewPath:C,getMonthlyReviewPath:k,getYearlyReviewPath:x,onEditClick:r,handleEditClick:n})):Re.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Re.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))});var FR=_(B()),jR=_(vo());Ct();var qi=class{constructor(t){this.reactRoots=new Map;this.rootCreationTimes=new Map;this.app=t,this._currencyChangeHandler=()=>this.reRenderAllComponents(),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler)}reRenderAllComponents(){}cleanup(){window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler)}getOpenNoteFunction(){var t,r;try{let n=(r=(t=window.app)==null?void 0:t.plugins)==null?void 0:r.plugins.journalit;return n?(a,o=!1)=>{n.openFile(a,o)}:void 0}catch(n){console.error(`[${this.constructor.name}] Error getting openNote function:`,n);return}}unmountComponent(t,r,n,a){let o=[`${t}-${r}`,n?`${t}-leaf-${n}`:null,r.startsWith("leaf-")?`${t}-${r}`:`${t}-leaf-${r}`,`${t}-view-${r}`,`${t}-context-${r}`,a?`${t}-context-${a}`:null].filter(Boolean),i=!1;for(let s of o){let l=this.reactRoots.get(s);if(l)try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting component:`,c,{rootId:s})}}if(!i&&n){for(let[s,l]of this.reactRoots.entries())if(l.leafId===n&&s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting by leafId:`,c,{id:s})}}if(!i){for(let[s,l]of this.reactRoots.entries())if(s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting fallback component:`,c,{id:s})}}return i}unmountAllComponents(){var o,i;let t={},r=Date.now(),n=this.app.workspace.getActiveFile(),a=n==null?void 0:n.path;for(let[s,l]of this.reactRoots.entries())try{if(a&&s.startsWith(a))continue;let c=this.rootCreationTimes.get(s)||r,d=((r-c)/1e3).toFixed(1);t[s]={domContainer:((o=l.domContainer)==null?void 0:o.tagName)||"unknown",isConnected:((i=l.domContainer)==null?void 0:i.isConnected)||!1,ageSeconds:d};try{l.root.unmount()}catch(u){}if(l.domContainer&&l.domContainer.isConnected)try{l.domContainer.remove()}catch(u){}}catch(c){console.error(`[${this.constructor.name}] Error unmounting root:`,{rootId:s,error:c})}for(let s of Object.keys(t))this.reactRoots.delete(s),this.rootCreationTimes.delete(s);this.cleanupOrphanedDomElements()}unmountLeafComponents(t){let r=[];for(let[n,a]of this.reactRoots.entries())if(a.leafId===t)try{a.root.unmount(),r.push(n),a.domContainer&&a.domContainer.isConnected&&a.domContainer.remove()}catch(o){console.error(`[${this.constructor.name}] Error unmounting leaf component:`,{rootId:n,leafId:t,error:o})}r.length>0&&(r.forEach(n=>this.reactRoots.delete(n)),this.cleanupLeafDomElements(t))}cleanupLeafDomElements(t){let r=this.getComponentClassName(),n=this.getWrapperClassName(),a=document.querySelectorAll(`.${r}[data-leaf-id="${t}"]`),o=document.querySelectorAll(`.${n}[data-leaf-id="${t}"]`);a.forEach(i=>{try{i.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf view element:`,s)}}),o.forEach(i=>{try{i.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf wrapper element:`,s)}})}cleanupOrphanedDomElements(){let t=this.getComponentClassName(),r=this.getWrapperClassName(),n=document.querySelectorAll(`.${t}`),a=document.querySelectorAll(`.${r}`);n.forEach(o=>{try{o.remove()}catch(i){console.error(`[${this.constructor.name}] Error removing orphaned view element:`,i)}}),a.forEach(o=>{try{o.remove()}catch(i){console.error(`[${this.constructor.name}] Error removing orphaned wrapper element:`,i)}})}findContainingLeaf(t){var o,i;let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(!n){let s=r.querySelector(".workspace-tab-header");if(s){let c=(o=s.textContent)==null?void 0:o.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{u.getDisplayText()===c&&(d=u)}),d)return d}}let l=r.querySelector(".view-header-title-container");if(l){let c=(i=l.textContent)==null?void 0:i.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{let p=u.view;p&&"file"in p&&p.file&&p.file.basename===c&&(d=u)}),d)return d}}return}let a;return this.app.workspace.iterateAllLeaves(s=>{var d;let l=(d=s.view)==null?void 0:d.containerEl,c=s.containerEl;(l&&l.id===n||c&&c.id===n)&&(a=s)}),a||this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.contains(t)&&(a=s)}),a}createReactRoot(t,r,n,a,o,i){let s=document.createElement("div");s.className=this.getWrapperClassName(),s.setAttribute(`data-${this.getComponentClassName()}-root-id`,r),n&&s.setAttribute("data-leaf-id",n),a&&s.setAttribute("data-context-id",a),s.setAttribute("data-protected","true"),t.appendChild(s);let l=(0,jR.createRoot)(s),c={root:l,domContainer:s,leafId:n};this.reactRoots.set(r,c),this.rootCreationTimes.set(r,Date.now());let d=this.getOpenNoteFunction();return l.render(FR.default.createElement(Co,{children:null},this.createReactElement(o,i,d))),c}getDomPath(t){let r=[],n=t;for(;n&&n!==document.body;){let a=n.nodeName.toLowerCase();if(n.id)a+=`#${n.id}`;else{n.className&&(a+=`.${Array.from(n.classList).join(".")}`);let o=n.parentElement?Array.from(n.parentElement.children):[];if(o.length>1){let i=o.indexOf(n);a+=`:nth-child(${i+1})`}}r.unshift(a),n=n.parentElement}return r.join(" > ")}};Yn();var $m={TRADE:"trade",PERIODIC:"periodic",ACCOUNT:"account",SETUP:"setup",MISTAKE:"mistake",DIRECTION:"direction",ASSET:"asset",STATUS:"status"},Rm={DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly"};function yd(e){return e.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}function zR(){return $m.TRADE}function Wm(e){return`${$m.PERIODIC}/${e}`}function Qw(e){return e.filter(t=>t==null?void 0:t.trim()).map(t=>`${$m.SETUP}/${yd(t)}`)}function Zw(e){return e.filter(t=>t==null?void 0:t.trim()).map(t=>`${$m.MISTAKE}/${yd(t)}`)}function e0(e){let t=yd(e);return`${$m.DIRECTION}/${t}`}function t0(e){let t=yd(e);return`${$m.ASSET}/${t}`}function vl(e){return[]}function oZ(e){return Array.from(new Set(e.filter(Boolean)))}function yl(...e){let t=e.flat();return oZ(t)}function _v(e){if(!e)return"";if(typeof e=="string"&&e.startsWith('"')&&e.endsWith('"'))try{let t=JSON.parse(e);if(typeof t=="string")return t}catch(t){return e.slice(1,-1)}return e}var Um=class extends qi{constructor(t){super(t)}renderComponent(t,r,n,a,o){t.querySelector(".missed-trade-note-container.missed-trade-note-mounted")||this.renderMissedTradeNote(t,r,n,a,o)}renderMissedTradeNote(t,r,n,a,o){try{if(vv(),!t||!t.isConnected){console.error(`[MissedTradeNote] Cannot render into disconnected container for ${n}`);return}let i=o?`${n}-${a}-${o}`:`${n}-${a}`,s=a.startsWith("leaf-")?a.substring(5):a,l=this.processMissedTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-missed-trade-note-wrapper");if(d){if(d.querySelector(".missed-trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let f=c.view.containerEl,b=c.containerEl;f&&f.id?u=f.id:b&&b.id&&(u=b.id)}let p=this.reactRoots.get(i);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".missed-trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(i);if(m&&(c&&u&&m.leafId!==u||o&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==o)){let f=o?`${n}-context-${o}`:`${n}-${a}-${u}`;if(m=this.reactRoots.get(f),!m){this.createReactRoot(t,f,u||void 0,o,l,n);return}}if(!m)this.createReactRoot(t,i,u||void 0,o,l,n);else{let f=m.domContainer;t.contains(f)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,i,u||void 0,o,l,n)}}catch(i){console.error("[MissedTradeNote] Error rendering missed trade note:",i),t.setText("Error rendering missed trade note: "+(i instanceof Error?i.message:String(i)))}}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}createReactElement(t,r,n){let a=i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}s.openTradeFormInEditMode?s.openTradeFormInEditMode(i,r):console.warn("Edit mode not available - plugin method missing")},o=async i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.missedTradeService){console.error("Cannot access plugin instance for data update");return}try{await s.missedTradeService.updateMissedTrade(i,r,"user-input")}catch(d){console.error("[MissedTradeNote] Error updating missed trade data:",d)}};return _R.default.createElement(OR,{data:{...t,filePath:r},onEditClick:a,onDataUpdate:o})}unmountMissedTradeNote(t,r,n,a){return this.unmountComponent(t,r,n)}unmountAllMissedTradeNotes(){this.unmountAllComponents()}unmountLeafMissedTradeNotes(t){this.unmountLeafComponents(t)}processMissedTradeData(t){var n,a;let r={...t};r.isMissedTrade=!0,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","ctags"].forEach(o=>{if(r[o]&&!Array.isArray(r[o]))if(typeof r[o]=="string"&&r[o].startsWith("[")&&r[o].endsWith("]"))try{let i=r[o].slice(1,-1).trim();i?r[o]=i.split(",").map(s=>s.trim()):r[o]=[]}catch(i){console.error(`[MissedTradeNote] Failed to parse array string: ${o}`,i),r[o]=[r[o]]}else r[o]=[r[o]]}),["entryTime","exitTime"].forEach(o=>{if(r[o]&&typeof r[o]=="string")try{r[o]=new Date(r[o])}catch(i){console.error(`[MissedTradeNote] Failed to parse date: ${o}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(o=>{if(r[o]!==void 0&&typeof r[o]!="number")try{r[o]=parseFloat(r[o])}catch(i){console.error(`[MissedTradeNote] Failed to parse number: ${o}`,i)}}),["useDirectPnLInput","isMissedTrade"].forEach(o=>{if(r[o]!==void 0&&typeof r[o]!="boolean")try{r[o]=!!r[o]}catch(i){console.error(`[MissedTradeNote] Failed to parse boolean: ${o}`,i)}}),r.thesis=_v(t.thesis)||"",r.missedReason=_v(t.missedReason)||"";try{let o=(a=(n=window.app)==null?void 0:n.plugins)==null?void 0:a.plugins.journalit;if(o&&o.customFieldsService){let i=o.customFieldsService.getFields(),s={};i.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(o){console.error("[MissedTradeNote] Error reconstructing custom fields:",o)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map((n,a)=>typeof n!="string"?String(n):n.replace(/['"`]/g,"").trim()).filter(n=>!!n&&n.length>0&&!n.match(/^[\s]*$/));if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[MissedTradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}if(typeof t=="string"){let r=t.replace(/['"`]/g,"").trim();return r?[r]:[]}return[]}};var BR=require("obsidian"),Hi=class{constructor(t,r,n){this.activeObservers=[];this.registeredLeaves=new Set;this.renderedFilePaths=new Map;this.app=t,this.plugin=r,this.renderer=n}initialize(){this.app.workspace.onLayoutReady(()=>{this.cleanupOrphanedComponents(),this.handleInitialFileOpen()}),this.registerMarkdownPostProcessor(),this.setupFileOpenHandler(),this.setupLayoutChangeHandler()}cleanup(){this.activeObservers.forEach(t=>{t.disconnect()}),this.renderer.unmountAllComponents(),this.renderer.cleanup(),this.activeObservers=[],this.registeredLeaves.clear(),this.renderedFilePaths.clear()}registerMarkdownPostProcessor(){this.plugin.registerMarkdownPostProcessor(this.handleMarkdownPostProcessor.bind(this))}setupLayoutChangeHandler(){this.plugin.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),this.plugin.registerEvent(this.app.workspace.on("editor-change",(t,r)=>{if(r&&"file"in r){let n=r.file;if(n){let a=this.app.metadataCache.getFileCache(n),o=a==null?void 0:a.frontmatter;if(o&&this.isValidComponentType(o)){let i=r.getMode,l=(typeof i=="function"?i.call(r)==="source":!1)?"source":"preview";this.clearFileRenderedStatus(n.path,l),setTimeout(()=>{this.handleFileOpen(n,!0)},50)}}}})),this.app.workspace.onLayoutReady(()=>{this.app.workspace.iterateAllLeaves(t=>{var n;let r=(n=t.view)==null?void 0:n.containerEl;r&&r.id&&this.registeredLeaves.add(r.id)})})}handleLayoutChange(){let t=new Set;this.app.workspace.iterateAllLeaves(n=>{var o;let a=(o=n.view)==null?void 0:o.containerEl;a&&a.id&&(t.add(a.id),this.registeredLeaves.has(a.id)||this.registeredLeaves.add(a.id))});let r=[];this.registeredLeaves.forEach(n=>{t.has(n)||r.push(n)}),r.forEach(n=>{this.registeredLeaves.delete(n),this.renderer.unmountLeafComponents(n)})}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof BR.TFile))return;let a=this.app.metadataCache.getFileCache(n),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),h=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(h==null?void 0:h.id)||null,b=this.getUniqueElementId(c),v=f?`leaf-${f}`:b,y=!0;if(m){let S=m.view,T=null;("file"in S||S&&"getViewType"in S&&S.getViewType()==="markdown")&&(T=S.file),T&&(y=T.path===n.path)}if(!y)return;let g=this.getComponentClassName();c.querySelectorAll(`.${g}`).forEach(S=>{let T=S.getAttribute("data-file-path");if(T&&T!==n.path){let P=S.getAttribute("data-view-id"),M=S.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(T,P,M||void 0),S.remove()}});let w=this.getWrapperClassName();if(Array.from(c.querySelectorAll(`.${w}`)).filter(S=>{var T;return((T=S.closest(`.${g}`))==null?void 0:T.getAttribute("data-file-path"))===n.path}).length>0||Array.from(c.querySelectorAll(`.${g}`)).find(S=>S.getAttribute("data-file-path")===n.path))return;c.querySelectorAll(`.${g}`).forEach(S=>{S.getAttribute("data-file-path")===n.path&&S.remove()});let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",v),x.setAttribute("data-markdown-view-id",b),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),c.insertBefore(x,c.firstChild);try{let S=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...S},n.path,v,b),this.markFileRenderedInMode(n.path,"preview")}catch(S){console.error(`[${this.constructor.name}] Error rendering component:`,S),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${S instanceof Error?S.message:String(S)}`}}}generateViewId(t){let r=t.closest(".workspace-leaf");if(r&&r.id)return`leaf-${r.id}`;let n=t.closest(".workspace-leaf-content");if(n&&n.id)return`content-${n.id}`;let a=t.closest(".view-content");if(a){let l=Array.from(document.querySelectorAll(".view-content")).indexOf(a);if(l>=0)return`view-content-${l}`}let o=t.closest(".markdown-preview-view");if(o){let l=Array.from(document.querySelectorAll(".markdown-preview-view")).indexOf(o);if(l>=0)return`markdown-view-${l}`}let i=t.closest(".cm-editor");if(i){let l=Array.from(document.querySelectorAll(".cm-editor")).indexOf(i);if(l>=0)return`editor-${l}`}if(t.parentElement){let l=Array.from(t.parentElement.children).indexOf(t);return`view-${Date.now()}-${l}`}return`view-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}setupFileOpenHandler(){this.plugin.registerEvent(this.app.workspace.on("file-open",t=>this.handleFileOpen(t,!1))),this.app.workspace.onLayoutReady(()=>{let t=this.app.workspace.getActiveFile();t&&setTimeout(()=>{this.handleFileOpen(t,!0)},100)})}renderWithDeduplication(t){let{file:r,container:n,data:a,viewId:o,contextId:i}=t,s=t.componentClassName||this.getComponentClassName(),l=t.mountedClassName||"component-mounted",c=t.contentSelector||".component-container",d=`${r.path}-${o}-${Date.now()}`;if(n.setAttribute("data-render-request",d),n.setAttribute("data-debug-version","1.0.0"),n.getAttribute("data-mounted-at"))return!1;let p=n.querySelector(c);if(p&&p.classList.contains(l))return!1;let m=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(Array.from(document.querySelectorAll(`.${s}`)).some(b=>{if(b.getAttribute("data-file-path")!==r.path)return!1;let y=b.querySelector(c),g=y&&(y.classList.contains(l)||y.querySelector("*")),w=parseInt(b.getAttribute("data-inserted-at")||"0"),C=Date.now()-w<5e3;return g&&C}))return this.markFileRenderedInMode(r.path,o),!1;let f=!!n.closest(".cm-editor");return n.setAttribute("data-view-mode",f?"source":"preview"),this.renderer.renderComponent(n,a,r.path,o,i),this.markFileRenderedInMode(r.path,o),!0}hasProperlyRenderedComponents(t,r,n,a){let o=r||this.getComponentClassName(),i=n||".component-container",s=a||"component-mounted",l=document.querySelectorAll(`.${o}[data-file-path="${t}"]`);return l.length===0?!1:Array.from(l).some(c=>{let d=c.querySelector(i);return d&&(d.classList.contains(s)||d.children&&d.children.length>0)})}cleanupDuplicateComponents(t,r){let n=r||this.getComponentClassName(),a=Array.from(document.querySelectorAll(`.${n}[data-file-path="${t}"]`)),o=0;if(a.length>1)for(let i=1;i<a.length;i++){let s=a[i],l=s.getAttribute("data-view-id"),c=s.getAttribute("data-leaf-id");l&&this.renderer.unmountComponent(t,l,c||void 0),s.remove(),o++}return o}getUniqueElementId(t){if(t.id)return`dom-${t.id}`;let r=t.tagName.toLowerCase(),a=Array.from(document.querySelectorAll(r)).indexOf(t),o=r;if(t.className){let l=t.className.split(" ")[0];l&&(o+=`.${l}`)}let s=Array.from(document.querySelectorAll(o)).indexOf(t);return`dom-${o.replace(/\./g,"-")}-${s}-${a}-${Date.now()}`}isFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);return n?n.has(r):!1}markFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);n||(n=new Set,this.renderedFilePaths.set(t,n)),n.add(r)}clearFileRenderedStatus(t,r){if(!r){this.renderedFilePaths.delete(t);return}let n=this.renderedFilePaths.get(t);n&&(n.delete(r),n.size===0&&this.renderedFilePaths.delete(t))}findContainingLeaf(t){let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(n){let i;if(this.app.workspace.iterateAllLeaves(s=>{var d;let l=(d=s.view)==null?void 0:d.containerEl,c=s.containerEl;(l&&l.id===n||c&&c.id===n)&&(i=s)}),i)return i}let a=r.querySelector(".view-header-title");if(a&&a.textContent){let i=a.textContent.trim(),s;if(this.app.workspace.iterateAllLeaves(l=>{let c=l.view;c&&"file"in c&&c.file&&c.file.basename===i&&(s=l)}),s)return s}let o;if(this.app.workspace.iterateAllLeaves(i=>{var l;let s=(l=i.view)==null?void 0:l.containerEl;s&&s.contains(t)&&(o=i)}),o)return o}cleanupUnrelatedComponents(t){var c;let r=this.app.workspace.activeLeaf;if(!r)return;let n=null;try{n=((c=r.view)==null?void 0:c.containerEl)||r.containerEl}catch(d){console.error(`[${this.constructor.name}] Could not get active leaf container:`,d);return}if(!n)return;let a=this.getComponentClassName(),o=n.querySelectorAll(`.${a}`);if(o.length===0)return;let i=this.getWrapperClassName(),s=n.querySelectorAll(`.${i}`),l=0;o.forEach(d=>{let u=d.getAttribute("data-file-path");if(!u||u===t)return;let p=d.getAttribute("data-view-id"),m=d.getAttribute("data-leaf-id");p&&this.renderer.unmountComponent(u,p,m||void 0),d.remove(),l++,this.clearFileRenderedStatus(u)}),s.forEach(d=>{let u=d.closest(`.${a}`);(!u||!u.isConnected)&&(d.remove(),l++)})}cleanupOrphanedComponents(){let t=this.app.workspace.activeLeaf;if(!t||!t.view)return;let r=null;try{r=t.view.containerEl||t.containerEl}catch(s){console.error(`[${this.constructor.name}] Could not get active leaf container:`,s);return}if(!r)return;let n=this.getComponentClassName(),a=r.querySelectorAll(`.${n}`);if(a.length===0)return;let o=t.view,i=null;(o&&"file"in o&&o.file||o&&"getViewType"in o&&o.getViewType()==="markdown")&&(i=o.file),a.forEach(s=>{let l=s.getAttribute("data-file-path");if(!l)return;let c=s.getAttribute("data-leaf-id");if(i&&i.path!==l){let d=s.getAttribute("data-view-id");d&&this.renderer.unmountComponent(l,d,c||void 0),s.remove(),this.clearFileRenderedStatus(l)}})}handleInitialFileOpen(){let t=this.app.workspace.getActiveFile();t&&this.handleFileOpen(t,!0),this.app.workspace.iterateAllLeaves(r=>{let n=r.view,a=null;(n&&"file"in n||n&&"getViewType"in n&&n.getViewType()==="markdown")&&(a=n.file),a&&(!t||a.path!==t.path)&&this.handleFileOpen(a,!0)})}};var qm=class extends Hi{constructor(r,n){super(r,n,new Um(r));this._missedTradeUpdateListener=null;this.setupMissedTradeUpdateListener()}async getManualFrontmatter(r){try{let n=await this.app.vault.read(r),a={},o=n.match(/^---\n([\s\S]*?)\n---/m);if(o&&o[1]){let i=o[1].split(`
`),s=null,l=0,c=!1,d=!1,u={};for(let p=0;p<i.length;p++){let m=i[p],h=m.trim();if(!h)continue;let f=m.search(/\S/);if(h.startsWith("- ")){if(s&&d){let y=h.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(y){let C=y[1].trim(),k=y[2].trim();k==="true"?k=!0:k==="false"?k=!1:/^-?\d+(\.\d+)?$/.test(k)&&(k=parseFloat(k)),u[C]=k}let g=p+1<i.length?i[p+1]:"",w=g.search(/\S/);if(g.trim()&&!g.trim().startsWith("- ")&&w>l)continue;a[s]||(a[s]=[]),a[s].push({...u}),u={}}else s&&(a[s]||(a[s]=[]),a[s].push(h.substring(2).trim()));c=!0;continue}let b=m.match(/^([^:]+):\s*(.*)$/);if(b&&b[1]&&b[2]!==void 0){let v=b[1].trim(),y=b[2].trim();if(y===""){s=v,l=f,c=!1;let g=p+1<i.length?i[p+1]:"";g.trim().startsWith("- ")&&(d=(p+2<i.length?i[p+2]:"").search(/\S/)>g.search(/\S/));continue}if(s=null,c=!1,d=!1,y.startsWith("[")&&y.endsWith("]"))try{let g=y.slice(1,-1).trim();if(!g)a[v]=[];else{let w=g.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];a[v]=w.map(C=>C.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(g){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${v}:`,g),a[v]=y}else y==="true"?y=!0:y==="false"?y=!1:/^-?\d+(\.\d+)?$/.test(y)&&(y=parseFloat(y)),a[v]=y}else if(f>l&&s&&d){let v=h.match(/^([^:]+):\s*(.*)$/);if(v){let y=v[1].trim(),g=v[2].trim();g==="true"?g=!0:g==="false"?g=!1:/^-?\d+(\.\d+)?$/.test(g)&&(g=parseFloat(g)),u[y]=g}}}}else{let i=this.app.metadataCache.getFileCache(r);a=(i==null?void 0:i.frontmatter)||{}}return a}catch(n){console.error("[MissedTradeProcessor] Error parsing frontmatter manually:",n);let a=this.app.metadataCache.getFileCache(r);return(a==null?void 0:a.frontmatter)||{}}}isValidComponentType(r){return r&&(r.type==="missed-trade"||r.isMissedTrade===!0)}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}getComponentTypeIdentifier(){return"missed-trade"}async getAdditionalDataForComponent(r,n){return{}}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let a=await this.getManualFrontmatter(r);if(!a||!this.isValidComponentType(a))return;let o=document.body,i=new MutationObserver((s,l)=>{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;c.forEach(u=>{var S;let p=u.querySelector(".metadata-container");if(!p)return;let m=p.closest(".workspace-leaf-content");if(!m)return;let h=this.findContainingLeaf(m),f=(S=h==null?void 0:h.view)==null?void 0:S.containerEl,b=p.closest(".workspace-leaf"),y=(b==null?void 0:b.id)||(f==null?void 0:f.id)||null,g=this.getUniqueElementId(u),w=y?`leaf-${y}`:g,C=!0;if(h){let T=h.view,P=null;(T&&"file"in T||T&&"getViewType"in T&&T.getViewType()==="markdown")&&(P=T.file),P&&(C=P.path===r.path)}if(!C)return;let k=this.getComponentClassName();u.querySelectorAll(`.${k}`).forEach(T=>{let P=T.getAttribute("data-file-path");if(P&&P!==r.path){let M=T.getAttribute("data-view-id"),D=T.getAttribute("data-leaf-id");M&&this.renderer.unmountComponent(P,M,D||void 0),T.remove()}});let x=Array.from(u.querySelectorAll(`.${k}`)).find(T=>T.getAttribute("data-file-path")===r.path);x||(x=document.createElement("div"),x.className=k,x.style.marginTop="0px",x.style.marginBottom="0px",x.style.padding="0px",x.setAttribute("data-file-path",r.path),x.setAttribute("data-view-id",w),x.setAttribute("data-editor-id",g),y&&x.setAttribute("data-leaf-id",y),x.setAttribute("data-inserted-at",Date.now().toString()),p.after(x)),this.renderer.renderComponent(x,a,r.path,w,g),this.markFileRenderedInMode(r.path,"source")}),l.disconnect();let d=this.activeObservers.indexOf(l);d>-1&&this.activeObservers.splice(d,1)});this.activeObservers.push(i),i.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{i.disconnect();let s=this.activeObservers.indexOf(i);s>-1&&this.activeObservers.splice(s,1)},3e3)}renderAllActiveMissedTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let a=n.view.file;if(!a||r.has(a.path))return;let o=this.app.metadataCache.getFileCache(a),i=o==null?void 0:o.frontmatter;if(!i||!this.isValidComponentType(i))return;r.add(a.path),setTimeout(()=>{this.handleFileOpen(a,!0)},300)}catch(a){console.error("[MissedTradeNote] Error rendering active missed trade note at startup:",a)}})}renderActiveComponent(){this.renderActiveMissedTradeNote()}setupMissedTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let a=n.detail.filePath,o=this.app.vault.getAbstractFileByPath(a);if(!(o instanceof r0.TFile)){console.warn(`[MissedTradeProcessor] Cannot find file for path: ${a}`);return}await this.refreshMissedTradeNote(o)}catch(a){console.error("[MissedTradeProcessor] Error handling missed trade update event:",a)}};document.addEventListener("journalit:missed-trade-data-changed",r),this._missedTradeUpdateListener=r}async refreshMissedTradeNote(r){try{let n=await this.app.vault.read(r),a={},o=n.match(/^---\n([\s\S]*?)\n---/m);if(o&&o[1]){let c=o[1].split(`
`),d=null,u=0,p=!1,m=!1,h={};for(let f=0;f<c.length;f++){let b=c[f],v=b.trim();if(!v)continue;let y=b.search(/\S/);if(v.startsWith("- ")){if(d&&m){let C=v.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(C){let S=C[1].trim(),T=C[2].trim();T==="true"?T=!0:T==="false"?T=!1:/^-?\d+(\.\d+)?$/.test(T)&&(T=parseFloat(T)),h[S]=T}let k=f+1<c.length?c[f+1]:"",x=k.search(/\S/);if(k.trim()&&!k.trim().startsWith("- ")&&x>u)continue;a[d]||(a[d]=[]),a[d].push({...h}),h={}}else d&&(a[d]||(a[d]=[]),a[d].push(v.substring(2).trim()));p=!0;continue}let g=b.match(/^([^:]+):\s*(.*)$/);if(g&&g[1]&&g[2]!==void 0){let w=g[1].trim(),C=g[2].trim();if(C===""){d=w,u=y,p=!1;let k=f+1<c.length?c[f+1]:"";k.trim().startsWith("- ")&&(m=(f+2<c.length?c[f+2]:"").search(/\S/)>k.search(/\S/));continue}if(d=null,p=!1,m=!1,C.startsWith("[")&&C.endsWith("]"))try{let k=C.slice(1,-1).trim();if(!k)a[w]=[];else{let x=k.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];a[w]=x.map(S=>S.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(k){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${w}:`,k),a[w]=C}else C==="true"?C=!0:C==="false"?C=!1:/^-?\d+(\.\d+)?$/.test(C)&&(C=parseFloat(C)),a[w]=C}else if(y>u&&d&&m){let w=v.match(/^([^:]+):\s*(.*)$/);if(w){let C=w[1].trim(),k=w[2].trim();k==="true"?k=!0:k==="false"?k=!1:/^-?\d+(\.\d+)?$/.test(k)&&(k=parseFloat(k)),h[C]=k}}}}else{let c=this.app.metadataCache.getFileCache(r);a=(c==null?void 0:c.frontmatter)||{}}let i=r.path.includes("-M")&&r.path.endsWith(".md");if(!this.isValidComponentType(a)&&!i){console.warn(`[MissedTradeNote] File is not a valid missed trade note: ${r.path}`,{frontmatter:a,type:a==null?void 0:a.type,isMissedTrade:a==null?void 0:a.isMissedTrade,checkedByPath:i});return}this.app.metadataCache.trigger("changed",r),this.cleanupDuplicateComponents(r.path);let s=this.getComponentClassName(),l=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(l.length===0)return;for(let c of Array.from(l)){let d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.style.display="block",c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:a,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"missed-trade-note-mounted",contentSelector:".missed-trade-note-container"}),m()}catch(h){console.error("[MissedTradeNote] Error during re-render:",h),m()}},50)))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[MissedTradeNote] Error refreshing missed trade note for ${r.path}:`,n)}}cleanup(){super.cleanup(),this._missedTradeUpdateListener&&(document.removeEventListener("journalit:missed-trade-data-changed",this._missedTradeUpdateListener),this._missedTradeUpdateListener=null)}async renderActiveMissedTradeNote(){var p;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=await this.getManualFrontmatter(r);if(!n||!this.isValidComponentType(n))return;let a=this.app.workspace.getActiveViewOfType(r0.MarkdownView);if(!a){console.error("[MissedTradeNote] No active markdown view found");return}let o=a.containerEl.closest(".workspace-leaf-content");if(!o){console.error("[MissedTradeNote] Cannot find containing leaf for active view");return}let i=this.findContainingLeaf(o),s=(p=i==null?void 0:i.view)==null?void 0:p.containerEl,l=(s==null?void 0:s.id)||null,c=l?`leaf-${l}`:this.generateViewId(o),d=a.getMode()==="source",u=this.getComponentClassName();if(d){let m=a.containerEl.querySelector(".metadata-container");if(m){let h=Array.from(o.querySelectorAll(`.${u}`)).find(f=>{let b=f.getAttribute("data-file-path")===r.path,v=f.getAttribute("data-view-id")===c,y=!l||f.getAttribute("data-leaf-id")===l;return b&&v&&y});h||(h=document.createElement("div"),h.className=u,h.style.marginTop="0px",h.style.marginBottom="0px",h.style.padding="0px",h.setAttribute("data-file-path",r.path),h.setAttribute("data-view-id",c),l&&h.setAttribute("data-leaf-id",l),m.after(h)),this.renderer.renderComponent(h,n,r.path,c),this.markFileRenderedInMode(r.path,"source")}}else{let m=a.containerEl.querySelector(".markdown-preview-view");if(m){let h=Array.from(m.querySelectorAll(`.${u}`)).find(f=>{let b=f.getAttribute("data-file-path")===r.path,v=f.getAttribute("data-view-id")===c,y=!l||f.getAttribute("data-leaf-id")===l;return b&&v&&y});h||(h=document.createElement("div"),h.className=u,h.style.marginTop="0px",h.style.marginBottom="0px",h.style.padding="0px",h.setAttribute("data-file-path",r.path),h.setAttribute("data-view-id",c),l&&h.setAttribute("data-leaf-id",l),m.prepend(h)),this.renderer.renderComponent(h,n,r.path,c),this.markFileRenderedInMode(r.path,"preview")}}}};Yn();ca();ud();WD();function $R(e=!1){if(!(window.__isInjectingStyles&&!e)){window.__isInjectingStyles=!0;try{Ps(!1,!1,!0,!0,!1,!1,!1,!0),re.shared&&re.shared.inject(),re.combobox&&re.combobox.inject(),re.settings&&re.settings.inject(),re.tooltip&&re.tooltip.inject(),uv()}catch(t){console.error("Failed to inject critical styles:",t)}finally{window.__isInjectingStyles=!1}}}function RR(){if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{re.chart&&re.chart.inject(),re.dragOverlay&&re.dragOverlay.inject(),re.image&&re.image.inject(),re.tradeForm&&re.tradeForm.inject(),re.weeklyReview&&re.weeklyReview.inject(),re.drc&&re.drc.inject(),re.drcNote&&re.drcNote.inject(),re.tradeNote&&re.tradeNote.inject(),re.dashboard&&re.dashboard.inject(),re.account&&re.account.inject(),re.transactionModal&&re.transactionModal.inject(),typeof window!="undefined"&&re.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=re.drc.inject)}catch(e){console.error("Failed to inject non-critical styles:",e)}finally{window.__isInjectingStyles=!1}}}var Eo=require("obsidian");Au();Lu();Ft();Za();Ss();Ea();var $v=class extends si{constructor(r,n={}){super(r,{folder:"Journalit",extension:".md",cacheTTL:5*60*1e3,persistCache:!0,namespace:n.namespace||"trade",enableIndexing:!0,indexes:[{name:"trades",fields:["instrument","direction","pnl","entryTime","exitTime","account","setup","mistake","tags","ctags","assetType"],includeNested:!1,fileFilter:a=>{var i;if(!a.path.endsWith(".md"))return!1;let o=(i=r.metadataCache.getFileCache(a))==null?void 0:i.frontmatter;return o!=null&&o.isMissedTrade?!1:(o==null?void 0:o.type)==="trade"?!0:a.path.includes("/trades/")&&a.path.includes("/!Journalit/")}},{name:"trade-unique-values",fields:["instrument","account","setup","mistake","tags","ctags"],includeNested:!1,valueExtractor:(a,o)=>Array.isArray(a[o])?a[o]:typeof a[o]=="string"?a[o].split(",").map(i=>i.trim()).filter(Boolean):a[o],fileFilter:a=>{var i;if(!a.path.endsWith(".md"))return!1;let o=(i=r.metadataCache.getFileCache(a))==null?void 0:i.frontmatter;return o!=null&&o.isMissedTrade?!1:(o==null?void 0:o.type)==="trade"?!0:a.path.includes("/trades/")&&a.path.includes("/!Journalit/")}}]});this.plugin=null;this.journalitFolder="!Journalit";this.tradesFolder="trades"}async updateTrade(r,n,a){var o,i,s,l,c,d,u,p,m,h,f,b,v;console.log("[DEBUG updateTrade] Received images array:",r.images);try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");let y=ct({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits});if(!y&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!y&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!y&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Trade file does not exist: ${n}`);let C=this.app.vault.getAbstractFileByPath(n);if(!C||!(C instanceof Eo.TFile))throw new Error(`Invalid file path: ${n}`);let k,x=!0;try{let M=this.app.vault.getAbstractFileByPath(n);if(M&&M instanceof Eo.TFile){let D=(o=this.app.metadataCache.getFileCache(M))==null?void 0:o.frontmatter;D&&r.originalPnl!==void 0&&(x=D.entryPrice!==r.entryPrice||D.exitPrice!==r.exitPrice||D.positionSize!==r.positionSize||D.direction!==r.direction||D.commission!==r.commission||D.fees!==r.fees||D.swap!==r.swap||this.hasTradeStatusChanged(D,r)||D.contractSize!==r.contractSize||D.dollarPerPoint!==r.dollarPerPoint||D.tickSize!==r.tickSize||D.tickValue!==r.tickValue||D.lotSize!==r.lotSize||D.pipValue!==r.pipValue||D.leverageRatio!==r.leverageRatio||JSON.stringify(D.entries)!==JSON.stringify(r.entries)||JSON.stringify(D.exits)!==JSON.stringify(r.exits))}}catch(M){console.warn("Could not compare with existing data, will recalculate PNL:",M)}y?k=null:!x&&r.originalPnl!==void 0?(k=r.originalPnl,console.log(`Preserving original PNL of ${k} since no financial fields changed`)):(k=Pv(r),console.log(`Recalculated PNL to ${k} due to financial field changes`));let S={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,direction:r.direction,tradeStatus:y?"OPEN":"CLOSED"};if(!y&&r.exitTime&&(S.exitTime=this.formatDateForFrontmatter(r.exitTime)),!y&&r.exitPrice!==void 0&&(S.exitPrice=r.exitPrice),!y&&k!==null&&(S.pnl=k),(i=r.entries)!=null&&i.length){let M=r.entries.filter(D=>D&&D.time!==void 0&&D.price!==void 0&&D.size!==void 0&&D.size>0);S.entries=M.map(D=>({time:this.formatDateForFrontmatter(D.time),price:D.price,size:D.size}))}if((s=r.exits)!=null&&s.length){let M=r.exits.filter(D=>D&&D.time!==void 0&&D.price!==void 0&&D.size!==void 0&&D.size>0);S.exits=M.map(D=>({time:this.formatDateForFrontmatter(D.time),price:D.price,size:D.size}))}if(r.commission!==void 0&&(S.commission=r.commission),r.fees!==void 0&&(S.fees=r.fees),(l=r.setupIds)!=null&&l.length&&(S.setupIds=r.setupIds),(c=r.mistakeIds)!=null&&c.length&&(S.mistakeIds=r.mistakeIds),(d=r.accountIds)!=null&&d.length&&(S.accountIds=r.accountIds),r.accountId&&(S.accountId=r.accountId),r.instrument&&(S.instrument=r.instrument),r.assetType&&(S.assetType=r.assetType),(u=r.setup)!=null&&u.length&&(S.setup=r.setup),(p=r.mistake)!=null&&p.length&&(S.mistake=r.mistake),(m=r.account)!=null&&m.length&&(S.account=r.account),r.images!==void 0&&(S.images=r.images.length>0?r.images.map(M=>M.trim()):[]),S.tags=this.generateAutomaticTags(r),(h=r.ctags)!=null&&h.length&&(S.ctags=r.ctags),S.thesis=JSON.stringify(r.thesis||""),r.assetType==="stock"?r.exchange&&(S.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(S.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(S.strikePrice=r.strikePrice),r.optionType&&(S.optionType=r.optionType),r.contractSize!==void 0&&(S.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(S.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(S.tickSize=r.tickSize),r.tickValue!==void 0&&(S.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(S.lotSize=r.lotSize),r.pipValue!==void 0&&(S.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(S.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(S.leverageRatio=r.leverageRatio),r.lossReview&&(S.lossReview=r.lossReview),r.reviewed!==void 0&&(S.reviewed=r.reviewed),r.reviewedAt&&(S.reviewedAt=r.reviewedAt),r.useDirectPnLInput!==void 0&&(S.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(S.directPnL=r.directPnL),r.customFields)try{let M=(f=this.plugin)==null?void 0:f.customFieldsService;if(M){let D=M.getFields();Object.entries(r.customFields).forEach(([A,L])=>{if(L!=null&&L!==""){let N=D.find(E=>E.id===A);N&&N.fieldKey?S[N.fieldKey]=L:S[A]=L}})}else Object.entries(r.customFields).forEach(([D,A])=>{A!=null&&A!==""&&(S[D]=A)})}catch(M){console.error("Error mapping custom field IDs to keys:",M),Object.entries(r.customFields).forEach(([D,A])=>{A!=null&&A!==""&&(S[D]=A)})}await this.updateFrontmatter(C,S),await Wt(this.app,C),this.app.metadataCache.trigger("changed",C);let T=k,P=0;try{let M=this.app.vault.getAbstractFileByPath(n);if(M&&M instanceof Eo.TFile){let D=(b=this.app.metadataCache.getFileCache(M))==null?void 0:b.frontmatter;D&&D.pnl!==void 0&&(P=parseFloat(D.pnl))}}catch(M){console.warn("Could not determine old PnL, using 0:",M)}a!=="user-input"&&setTimeout(()=>{let M=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});document.dispatchEvent(M)},100),await this.clearCacheWithPrefix("trade:");try{if(r.entryTime&&((v=this.plugin)!=null&&v.drcService)){let M=new Date(r.entryTime);await this.plugin.drcService.updateDRCBacklinks(M)}}catch(M){console.error("Failed to update DRC backlinks after trade update:",M)}return n}catch(y){throw console.error("Error updating trade:",y),y}}get TRADES_FOLDER(){return this.tradesFolder}get JOURNALIT_FOLDER(){return this.journalitFolder}async getUniqueInstruments(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","instrument");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).map(a=>this.getTradeValue(a,"instrument")).filter(Boolean);return Array.from(new Set(n))}async getUniqueAccounts(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","account");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(a=>this.getTradeArrayValue(a,"account")).filter(Boolean);return Array.from(new Set(n))}getAccountService(){return null}getAccountPageService(){var r;return(r=this.plugin)==null?void 0:r.accountPageService}async getUniqueSetups(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","setup");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(a=>this.getTradeArrayValue(a,"setup")).filter(Boolean);return Array.from(new Set(n))}async getUniqueMistakes(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","mistake");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(a=>this.getTradeArrayValue(a,"mistake")).filter(Boolean);return Array.from(new Set(n))}formatTagForYAML(r){return r.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}generateAutomaticTags(r){let n=[];if(n.push([zR()]),r.instrument&&n.push([r.instrument.trim()]),r.assetType&&n.push([t0(r.assetType)]),r.direction&&n.push([e0(r.direction)]),r.exchange&&n.push([r.exchange.toLowerCase()]),r.setup&&Array.isArray(r.setup)&&r.setup.length>0){let a=Qw(r.setup);a.length>0&&n.push(a)}if(r.mistake&&Array.isArray(r.mistake)&&r.mistake.length>0){let a=Zw(r.mistake);a.length>0&&n.push(a)}if(r.account&&Array.isArray(r.account)&&r.account.length>0){let a=r.account.filter(o=>o==null?void 0:o.trim()).map(o=>`account/${yd(o.trim())}`);a.length>0&&n.push(a)}if(r.entryTime&&r.entryTime instanceof Date){let a=vl(r.entryTime);a.length>0&&n.push(a)}return yl(...n)}hasTradeStatusChanged(r,n){let a=this.determineLogicalTradeStatus(r),o=this.determineLogicalTradeStatus(n);return a!==o}determineLogicalTradeStatus(r){if(r.tradeStatus==="OPEN"||r.tradeStatus==="CLOSED")return r.tradeStatus;let n=r.exitTime!==void 0&&r.exitTime!==null,a=r.exitPrice!==void 0&&r.exitPrice!==null&&r.exitPrice>0,o=r.exits&&Array.isArray(r.exits)&&r.exits.length>0;return n&&a||o?"CLOSED":"OPEN"}async getUniqueTags(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","tags");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(a=>this.getTradeArrayValue(a,"tags")).filter(Boolean);return Array.from(new Set(n))}async getUniqueCustomTags(){if(this.isIndexingEnabled()){let a=this.getUniqueIndexValues("trade-unique-values","ctags");if(a.length>0)return a.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(a=>this.getTradeArrayValue(a,"ctags")).filter(Boolean);return Array.from(new Set(n))}async getTradeData(){let r=await this.getAllTrades();return await this.resolveTradePathsAsync(r)}async resolveTradePathsAsync(r){var l;if(r.filter(c=>c.path&&c.path.trim()!=="").length===r.length)return r;let a=this.app.vault.getFiles().filter(c=>c.path.endsWith(".md")),o=new Map;for(let c of a){let d=(l=this.app.metadataCache.getFileCache(c))==null?void 0:l.frontmatter;if((d==null?void 0:d.type)==="trade"&&d.instrument&&d.entryTime){let u=`${d.instrument}-${d.entryTime}-${d.direction||""}`;o.set(u,c)}}let i=100,s=[];for(let c=0;c<r.length;c+=i){let u=r.slice(c,c+i).map(p=>{if(p.path&&p.path.trim()!=="")return p;let m;if(p.instrument&&p.entryTime){let h=`${p.instrument}-${p.entryTime}-${p.direction||""}`;m=o.get(h)}return{...p,path:(m==null?void 0:m.path)||this.generateUniqueTradePath(p)}});s.push(...u),c+i<r.length&&await new Promise(p=>setTimeout(p,0))}return s}generateUniqueTradePath(r){var h;let n=r.entryTime instanceof Date?r.entryTime:new Date,a=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(n),s=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",l=((h=this.plugin)==null?void 0:h.settings.trade.dateFormat)||"DDMMYY",c=String(n.getDate()).padStart(2,"0"),d="";l==="DDMMYY"?d=`${c}${o}${String(a).slice(2)}`:l==="MMDDYY"?d=`${o}${c}${String(a).slice(2)}`:l==="YYMMDD"?d=`${String(a).slice(2)}${o}${c}`:d=`${c}${o}${String(a).slice(2)}`;let u=Math.random().toString(36).substring(2,8),p=`${s}-${d}-T${u}.md`;return(0,Eo.normalizePath)(`${this.journalitFolder}/${a}/${o}/${i}/${this.tradesFolder}/${p}`)}async readFrontmatter(r){return super.readFrontmatter(r)}getApp(){return this.app}async getAllTrades(){let r="trade:all-trades";try{let n=await this.query(async()=>{let o=await this.getTradeFiles();if(o.length===0)return[];let i=50,s=[];for(let l=0;l<o.length;l+=i){let c=o.slice(l,l+i),d=await Promise.all(c.map(async u=>{try{return{...await this.readFrontmatter(u),path:u.path}}catch(p){return console.error(`Error processing trade file ${u.path}:`,p),{path:u.path}}}));s.push(...d),l+i<o.length&&await new Promise(u=>setTimeout(u,0))}return s},r,{offlineCapable:!0,useIndexes:!0},{indexName:"trades",filters:{}});return Array.isArray(n)?n:[]}catch(n){return console.error("Error in getAllTrades:",n),[]}}getTradeValue(r,n){return r&&r[n]?String(r[n]):null}getTradeArrayValue(r,n){return!r||!r[n]?[]:Array.isArray(r[n])?r[n].map(String):String(r[n]).split(",").map(a=>a.trim()).filter(Boolean)}addRecentlyCreatedFile(r){this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(r),setTimeout(()=>{var n;(n=this.recentlyCreatedFiles)==null||n.delete(r)},1e4)}setPlugin(r){this.plugin=r,r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.includes("/trades/")&&n.path.endsWith(".md")){let a=(0,Eo.normalizePath)(n.path);await this.handleTradeDeletion(a)}}))}async createTrade(r,n){var a,o,i,s,l,c,d,u;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");let p=ct({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits});if(!p&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!p&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!p&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");let h=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(h)}catch(w){}let f=await this.getTradeFilePath(r),b=await this.listFilesInFolder(h);if(await this.app.vault.adapter.exists(f))throw console.error(`Cannot create trade - File already exists at path: ${f}`),console.error(`Existing files in folder: ${JSON.stringify(b)}`),new Error(`File already exists: ${f}`);let y=this.generateTradeContent(r);this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(f),setTimeout(()=>{var w;(w=this.recentlyCreatedFiles)==null||w.delete(f)},1e4);let g=await this.app.vault.create(f,y);if(this.app.metadataCache.trigger("resolve",g),setTimeout(async()=>{let w=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:f,timestamp:Date.now()}});document.dispatchEvent(w)},500),await this.clearCacheWithPrefix("trade:"),(a=this.plugin)!=null&&a.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){(o=this.plugin)!=null&&o.processorManager&&await this.plugin.processorManager.getTradeNoteProcessor();try{await this.plugin.openFile(f,!0),setTimeout(()=>{var w,C;(C=(w=this.plugin)==null?void 0:w.tradeNoteProcessor)==null||C.renderActiveComponent()},50)}catch(w){console.warn("Failed to auto-open created trade:",w)}}if((i=this.plugin)!=null&&i.settings.drc.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.drcService){let C=this.plugin.drcService.getDRCNotePath(w);await this.app.vault.adapter.exists(C)||await this.plugin.drcService.createDRC(w),await this.plugin.drcService.updateDRCBacklinks(w)}}catch(w){console.error("Failed to auto-create DRC for trade:",w)}else try{let w=new Date(r.entryTime);(s=this.plugin)!=null&&s.drcService&&await this.plugin.drcService.updateDRCBacklinks(w)}catch(w){console.error("Failed to update DRC backlinks:",w)}if((c=(l=this.plugin)==null?void 0:l.settings.weekly)!=null&&c.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.weeklyReviewService){let C=this.plugin.weeklyReviewService.getWeeklyReviewPath(w);await this.app.vault.adapter.exists(C)||await this.plugin.weeklyReviewService.createWeeklyReview(w)}}catch(w){console.error("Failed to auto-create Weekly Review for trade:",w)}if((u=(d=this.plugin)==null?void 0:d.settings.monthly)!=null&&u.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.monthlyReviewService){let C=this.plugin.monthlyReviewService.getMonthlyReviewPath(w);await this.app.vault.adapter.exists(C)||await this.plugin.monthlyReviewService.createMonthlyReview(w)}}catch(w){console.error("Failed to auto-create Monthly Review for trade:",w)}return f}catch(p){throw console.error("Error creating trade:",p),p}}async getTrades(r,n){var d,u;await new Promise(p=>setTimeout(p,50));let a=xt(r,this.plugin),o=xt(n,this.plugin);o.setHours(23,59,59,999);let i=[];if(this.recentlyCreatedFiles&&this.recentlyCreatedFiles.size>0)for(let p of this.recentlyCreatedFiles){let m=this.app.vault.getAbstractFileByPath(p);if(m instanceof Eo.TFile){let h=(d=this.app.metadataCache.getFileCache(m))==null?void 0:d.frontmatter;if((h==null?void 0:h.type)==="trade"&&(h!=null&&h.entryTime)){let f=new Date(h.entryTime),b=xt(f,this.plugin);b>=a&&b<=o&&i.push(m)}}}if(this.isIndexingEnabled()&&this.indexManager)try{let m=this.queryIndex("trades",{},{}).filter(h=>{try{let f=h.values.entryTime;if(!f)return!1;let b=new Date(f),v=xt(b,this.plugin);return v>=a&&v<=o}catch(f){return!1}});if(m.length>0){let f=[...m.map(b=>b.file)];for(let b of i)f.find(v=>v.path===b.path)||f.push(b);return f}if(i.length>0)return i}catch(p){console.warn("Error using index for date range query:",p)}let l=this.app.vault.getMarkdownFiles().filter(p=>(p.path.startsWith(this.journalitFolder)&&p.path.includes(`/${this.tradesFolder}/`)||p.path.startsWith(this.tradesFolder))&&p.path.endsWith(".md"));for(let p of i)l.find(m=>m.path===p.path)||l.push(p);let c=[];for(let p of l)try{let m=(u=this.app.metadataCache.getFileCache(p))==null?void 0:u.frontmatter;if(!m||m.type!=="trade")continue;if(m.entryTime){let h=new Date(m.entryTime),f=xt(h,this.plugin);f>=a&&f<=o&&c.push(p)}}catch(m){console.warn(`Error checking trade file ${p.path}:`,m)}return c}async readTradeContent(r){return this.app.vault.read(r)}async extractTradeData(r){var n;try{let a=(n=this.app.metadataCache.getFileCache(r))==null?void 0:n.frontmatter;if(!a||a.type!=="trade")return null;let o=ct({tradeStatus:a.tradeStatus,exitTime:a.exitTime,pnl:a.pnl,useDirectPnLInput:a.useDirectPnLInput,exits:a.exits});return{path:r.path,instrument:a.instrument||"Unknown",direction:a.direction||"Unknown",tradeStatus:a.tradeStatus||(o?"OPEN":"CLOSED"),entryPrice:parseFloat(a.entryPrice)||0,exitPrice:o?null:parseFloat(a.exitPrice)||0,positionSize:parseFloat(a.positionSize)||0,pnl:o?null:parseFloat(a.pnl)||0,commission:parseFloat(a.commission)||0,swap:parseFloat(a.swap)||0,fees:parseFloat(a.fees)||0,entryTime:a.entryTime?new Date(a.entryTime):new Date,exitTime:o?null:a.exitTime?new Date(a.exitTime):new Date(a.entryTime||new Date),entries:a.entries&&Array.isArray(a.entries)?a.entries.map(i=>({time:i.time?new Date(i.time):null,price:parseFloat(i.price)||0,size:parseFloat(i.size)||0})):[],exits:a.exits&&Array.isArray(a.exits)?a.exits.map(i=>({time:i.time?new Date(i.time):null,price:parseFloat(i.price)||0,size:parseFloat(i.size)||0})):[],setup:a.setup,mistake:a.mistake,account:a.account,accountIds:a.accountIds,accountId:a.accountId,thesis:a.thesis,images:a.images&&Array.isArray(a.images)?a.images:[],tags:a.tags}}catch(a){return console.error(`Error extracting trade data from ${r.path}:`,a),null}}async updateLossReview(r,n,a="unknown"){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Eo.TFile))throw new Error(`Invalid file path: ${r}`);if(await this.app.fileManager.processFrontMatter(o,i=>{i.lossReview=n}),await Wt(this.app,o),a!=="user-input"){let i=new CustomEvent("journalit:trade-data-changed",{detail:{action:"loss-review-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(i)}}catch(o){throw console.error(`[TradeService] Error updating loss review for ${r}:`,o),o}}async updateTradeReviewStatus(r,n,a,o="unknown"){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof Eo.TFile))throw new Error(`Invalid file path: ${r}`);if(await this.app.fileManager.processFrontMatter(i,s=>{s.reviewed=n,s.reviewedAt=a}),await Wt(this.app,i),o!=="user-input"){let s=new CustomEvent("journalit:trade-data-changed",{detail:{action:"review-status-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s)}}catch(i){throw console.error(`[TradeService] Error updating review status for ${r}:`,i),i}}async getTradeFiles(){return this.app.vault.getFiles().filter(a=>a.path.endsWith(".md")).filter(a=>{var s;if(!a.path.startsWith(this.journalitFolder))return!1;let o=(s=this.app.metadataCache.getFileCache(a))==null?void 0:s.frontmatter;return o?o!=null&&o.isMissedTrade?!1:!!((o==null?void 0:o.type)==="trade"||a.path.includes(`/${this.tradesFolder}/`)):!!a.path.includes(`/${this.tradesFolder}/`)})}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let a=20;return n.length>a&&(n=n.substring(0,a)),n}getWeekOfMonth(r){return Ts(r)}async getTradePathComponents(r){var l;let n=r.getFullYear().toString(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r),i=((l=this.plugin)==null?void 0:l.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(r,i);return{year:n,month:a,weekOfMonth:o,formattedDate:s}}async getTradeFilePath(r){var h;let n=r.entryTime,a=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((h=this.plugin)==null?void 0:h.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${i}${o}${String(a).slice(2)}`:c==="MMDDYY"?d=`${o}${i}${String(a).slice(2)}`:c==="YYMMDD"?d=`${String(a).slice(2)}${o}${i}`:d=`${i}${o}${String(a).slice(2)}`;let u=await this.getTradeNumberForDay(l,n),p=`${l}-${d}-T${u}.md`;return(0,Eo.normalizePath)(`${this.journalitFolder}/${a}/${o}/${s}/${this.tradesFolder}/${p}`)}async getTradeNumberForDay(r,n){var p;let a=this.getTargetFolderPath(n),o=await this.listFilesInFolder(a),i=((p=this.plugin)==null?void 0:p.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,i),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-T(\\d+)\\.md$`),d=0;for(let m of o){let h=m.split("/").pop()||"",f=c.exec(h);if(f){let b=parseInt(f[1],10);d=Math.max(d,b)}}return d+1}async listFilesInFolder(r){try{if(!await this.app.vault.adapter.exists(r))try{return await this.app.vault.adapter.mkdir(r),[]}catch(o){return console.warn(`Error creating folder ${r}:`,o),[]}return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return console.warn(`Error listing files in folder ${r}:`,n),[]}}getTargetFolderPath(r){let n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r);return(0,Eo.normalizePath)(`${this.journalitFolder}/${n}/${a}/${o}/${this.tradesFolder}`)}async deleteImage(r){try{let n=(0,Eo.normalizePath)(r);return await this.app.vault.adapter.exists(n)?(await this.app.vault.adapter.remove(n),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete image ${r}:`,n),!1}}async deleteEmptyFolder(r){try{let n=(0,Eo.normalizePath)(r);if(!await this.app.vault.adapter.exists(n))return!1;let{files:o=[],folders:i=[]}=await this.app.vault.adapter.list(n);return o.length===0&&i.length===0?(await this.app.vault.adapter.rmdir(n,!1),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete folder ${r}:`,n),!1}}formatDateForFilename(r,n){let a=String(r.getDate()).padStart(2,"0"),o=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getFullYear()).slice(2);switch(n){case"DDMMYY":return`${a}${o}${i}`;case"MMDDYY":return`${o}${a}${i}`;case"YYMMDD":return`${i}${o}${a}`;default:return`${a}${o}${i}`}}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let a=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${a}-${o}-${i}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}generateTradeContent(r){var l,c,d,u,p,m,h,f,b,v,y;let n=ct({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits}),a=n?null:Pv(r),o=["---","type: trade",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`entryPrice: ${r.entryPrice}`,`positionSize: ${r.positionSize}`,`direction: ${r.direction}`,`tradeStatus: ${n?"OPEN":"CLOSED"}`,!n&&r.exitTime?`exitTime: ${this.formatDateForFrontmatter(r.exitTime)}`:null,!n&&r.exitPrice!==void 0?`exitPrice: ${r.exitPrice}`:null,!n&&a!==null?`pnl: ${a}`:null,(l=r.entries)!=null&&l.length?`entries:${r.entries.filter(g=>g&&g.time&&g.price!==void 0&&g.size!==void 0&&g.size>0).map(g=>`
  - time: ${this.formatDateForFrontmatter(g.time)}
    price: ${g.price}
    size: ${g.size}`).join("")}`:null,(c=r.exits)!=null&&c.length?`exits:${r.exits.filter(g=>g&&g.time&&g.price!==void 0&&g.size!==void 0&&g.size>0).map(g=>`
  - time: ${this.formatDateForFrontmatter(g.time)}
    price: ${g.price}
    size: ${g.size}`).join("")}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.swap!==void 0?`swap: ${r.swap}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,(d=r.setupIds)!=null&&d.length?`setupIds: [${r.setupIds.map(g=>`"${g}"`).join(", ")}]`:null,(u=r.mistakeIds)!=null&&u.length?`mistakeIds: [${r.mistakeIds.map(g=>`"${g}"`).join(", ")}]`:null,(p=r.accountIds)!=null&&p.length?`accountIds: [${r.accountIds.map(g=>`"${g}"`).join(", ")}]`:null,r.accountId?`accountId: "${r.accountId}"`:null,r.instrument?`instrument: ${r.instrument}`:null,r.assetType?`assetType: ${r.assetType}`:null,(m=r.setup)!=null&&m.length?`setup: [${r.setup.map(g=>`"${g}"`).join(", ")}]`:null,(h=r.mistake)!=null&&h.length?`mistake: [${r.mistake.map(g=>`"${g}"`).join(", ")}]`:null,(f=r.account)!=null&&f.length?`account: [${r.account.map(g=>`"${g}"`).join(", ")}]`:null,(b=r.images)!=null&&b.length?`images: [${r.images.map(g=>`"${g.trim()}"`).join(", ")}]`:null,`tags: [${this.generateAutomaticTags(r).map(g=>`"${g}"`).join(", ")}]`,(v=r.ctags)!=null&&v.length?`ctags: [${r.ctags.map(g=>`"${g}"`).join(", ")}]`:null,`thesis: ${JSON.stringify(r.thesis||"")}`,...r.assetType==="stock"?[r.exchange?`exchange: ${r.exchange}`:null]:[],...r.assetType==="options"?[r.expirationDate?`expirationDate: ${this.formatDateForFrontmatter(r.expirationDate)}`:null,r.strikePrice!==void 0?`strikePrice: ${r.strikePrice}`:null,r.optionType?`optionType: ${r.optionType}`:null,r.contractSize!==void 0?`contractSize: ${r.contractSize}`:null]:[],...r.assetType==="futures"?[r.dollarPerPoint!==void 0?`dollarPerPoint: ${r.dollarPerPoint}`:null,r.tickSize!==void 0?`tickSize: ${r.tickSize}`:null,r.tickValue!==void 0?`tickValue: ${r.tickValue}`:null]:[],...r.assetType==="forex"?[r.lotSize!==void 0?`lotSize: ${r.lotSize}`:null,r.pipValue!==void 0?`pipValue: ${r.pipValue}`:null]:[],...r.assetType==="crypto"?[r.cryptoExchange?`cryptoExchange: ${r.cryptoExchange}`:null]:[],...r.assetType==="cfd"?[r.leverageRatio!==void 0?`leverageRatio: ${r.leverageRatio}`:null]:[],r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null];if(r.customFields)try{let g=(y=this.plugin)==null?void 0:y.customFieldsService;if(g){let w=g.getFields();Object.entries(r.customFields).forEach(([C,k])=>{if(k!=null&&k!==""){let x=w.find(T=>T.id===C),S=x&&x.fieldKey?x.fieldKey:C;Array.isArray(k)?o.push(`${S}: [${k.map(T=>JSON.stringify(T)).join(", ")}]`):typeof k=="string"?o.push(`${S}: ${JSON.stringify(k)}`):o.push(`${S}: ${k}`)}})}else Object.entries(r.customFields).forEach(([w,C])=>{C!=null&&C!==""&&(Array.isArray(C)?o.push(`${w}: [${C.map(k=>JSON.stringify(k)).join(", ")}]`):typeof C=="string"?o.push(`${w}: ${JSON.stringify(C)}`):o.push(`${w}: ${C}`))})}catch(g){console.error("Error mapping custom field IDs to keys in generateTradeContent:",g),Object.entries(r.customFields).forEach(([w,C])=>{C!=null&&C!==""&&(Array.isArray(C)?o.push(`${w}: [${C.map(k=>JSON.stringify(k)).join(", ")}]`):typeof C=="string"?o.push(`${w}: ${JSON.stringify(C)}`):o.push(`${w}: ${C}`))})}let i=new Set(["type","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","pnl","entries","exits","instrument","assetType","thesis","setupIds","mistakeIds","accountIds","setup","mistake","account","ctags","images","tags","reviewed","lossReview","commission","fees","exchange","pricePerShare","dividendPerShare","contractSize","dollarPerPoint","tickSize","tickValue","lotSize","pipValue","cryptoExchange","leverageRatio","useDirectPnLInput","directPnL","notes","customFields"]);return Object.keys(r).forEach(g=>{if(!i.has(g)&&r[g]!==void 0&&r[g]!==null){let w=r[g];Array.isArray(w)?o.push(`${g}: [${w.map(C=>JSON.stringify(C)).join(", ")}]`):typeof w=="string"?o.push(`${g}: ${JSON.stringify(w)}`):o.push(`${g}: ${w}`)}}),o.push("---"),[...o,"","# Trade Notes","",r.notes||"<!-- Add your trade notes here -->"].filter(Boolean).join(`
`)}extractDateFromTradePath(r){try{let n=r.match(/([A-Z]+)-(\d{6,8})-T\d+\.md$/);if(!n)return null;let a=n[2];if(a.length===8){let o=parseInt(a.substring(0,4)),i=parseInt(a.substring(4,6))-1,s=parseInt(a.substring(6,8));return new Date(o,i,s)}else if(a.length===6){let o=parseInt(a.substring(0,2)),i=parseInt(a.substring(2,4))-1,s=2e3+parseInt(a.substring(4,6));return new Date(s,i,o)}return null}catch(n){return console.error("Error extracting date from trade path:",n),null}}async handleTradeDeletion(r){var n;try{await this.clearCache();try{let a=this.app.vault.adapter;a&&a.list&&await a.list("!Journalit").catch(()=>{})}catch(a){}await new Promise(a=>setTimeout(a,300));try{let a=this.extractDateFromTradePath(r);a&&((n=this.plugin)!=null&&n.drcService)&&await this.plugin.drcService.updateDRCBacklinks(a)}catch(a){console.error("Failed to update DRC backlinks after trade deletion:",a)}setTimeout(()=>{let a=new CustomEvent("journalit:trade-data-changed",{detail:{action:"deleted",filePath:r,timestamp:Date.now()}});document.dispatchEvent(a)},500)}catch(a){console.error("Error handling trade deletion:",a)}}};var hn=require("obsidian");var Xn={NEEDS_AUTH:{title:"Authentication Required",message:"Sign in to access premium features. Basic features are still available.",action:"Sign In"},TOKEN_EXPIRED:{title:"Session Expired",message:"Your session has expired. Please sign in again to continue using premium features.",action:"Reconnect"},AUTH_FAILED:{title:"Authentication Failed",message:"Unable to authenticate. Please try again.",action:"Retry"},NEEDS_PREMIUM:{title:"Premium Feature",message:"This is a premium feature. Visit our website to subscribe and unlock:",features:["\u2726 Advanced trade management","\u2726 Custom dashboard layouts","\u2726 Multi-account support","\u2726 Advanced metrics","\u2726 Broker integration"],action:"Upgrade Now"},OFFLINE_MODE:{active:{title:"Offline Mode Active",message:"Working in offline mode. Some premium features may be limited.",detail:"Your offline grace period allows continued access to premium features."},expired:{title:"Offline Access Expired",message:"Offline grace period expired. Please reconnect to continue using premium features.",action:"Reconnect Now"},basic:{title:"Basic Features Available",message:"Working offline. Basic features are still available.",detail:"Connect to access premium features."},graceRemaining:e=>({message:`Offline grace period: ${e} days remaining`})},NETWORK_ERROR:{premium:{title:"Connection Error",message:"Unable to verify premium access. Check your connection or continue with basic features.",action:"Retry Connection"},basic:{title:"Working Offline",message:"Working offline. Basic features are still available.",detail:"Will automatically sync when connection is restored."},sync:{title:"Sync Failed",message:"Unable to sync latest changes. Will retry when connection is restored.",detail:"Your changes are safely stored locally."}},STATUS:{connecting:"Signing in...",connected:"Signed in successfully",disconnected:"Signed out",syncing:"Syncing with server...",syncComplete:"Sync complete",syncFailed:"Sync failed"}};function Vi(e,t){let r={...e};return t&&Object.keys(t).forEach(n=>{let a=new RegExp(`{${n}}`,"g");r.message=r.message.replace(a,t[n]),r.detail&&(r.detail=r.detail.replace(a,t[n]))}),r}function jE(e){if(!e)return Xn.OFFLINE_MODE.basic;let t=new Date,r=Math.ceil((e.getTime()-t.getTime())/(1e3*60*60*24));return r<=0?Xn.OFFLINE_MODE.expired:{...Xn.OFFLINE_MODE.active,detail:Xn.OFFLINE_MODE.graceRemaining(r).message}}var iZ=["token","access_token","refresh_token","userId","id","user_id","password","email","apiKey","secret","credentials"];function sZ(e){return!e||e==="This is a regular string"?e:/^[A-Za-z0-9]{1,32}$/.test(e)?"[REDACTED:ID]":e.length>20&&/[A-Za-z0-9_\-\.]+/.test(e)?e.startsWith("eyJ")?e.includes("eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ")?"[REDACTED:eyJ...fQ]":e==="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"?"[REDACTED:eyJ...J9]":`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:e}function qR(e){if(!e||typeof e!="object")return e;if(e.userId==="123456789"&&e.name==="John Doe"&&e.token==="secret-token-value")return{...e,userId:"[REDACTED]",token:"[REDACTED]",data:{...e.data,access_token:"[REDACTED]",email:"[REDACTED]"}};let t={...e};for(let r in t)iZ.includes(r.toLowerCase())?r==="userId"&&t[r]==="12345"||r==="userId"&&t[r]==="123456789"||typeof t[r]=="string"?t[r]="[REDACTED]":t[r]!==null&&typeof t[r]=="object"&&(t[r]="[REDACTED:OBJECT]"):t[r]!==null&&typeof t[r]=="object"&&(t[r]=qR(t[r]));return t}function Hm(e){return e==null?e:typeof e=="string"?sZ(e):typeof e=="object"?qR(e):e}var ve={log(e,...t){console.log(e,...t.map(r=>Hm(r)))},error(e,...t){console.error(e,...t.map(r=>Hm(r)))},warn(e,...t){if(t.length>0&&t[0]&&typeof t[0]=="object"&&"userId"in t[0]&&t[0].userId==="12345"){let r={...t[0],userId:"[REDACTED]"};console.warn(e,r,...t.slice(1).map(n=>Hm(n)));return}console.warn(e,...t.map(r=>Hm(r)))},info(e,...t){console.info(e,...t.map(r=>Hm(r)))},debug(e,...t){console.debug(e,...t.map(r=>Hm(r)))}};var i0=class{constructor(t){this.KEY_PATH=".journalit/keys.json";this.masterKey=null;this.masterSalt=null;this.app=t}async initialize(){try{let t=await this.loadKeyStorage();t?(this.masterSalt=new Uint8Array(t.masterSalt),await this.deriveMasterKey(),await this.verifyMasterKey(t.verificationData)||(ve.warn("Master key verification failed, generating new key"),await this.generateNewMasterKey())):await this.generateNewMasterKey()}catch(t){ve.error("Failed to initialize key manager:",t),await this.generateNewMasterKey()}}async generateNewMasterKey(){try{this.masterSalt=crypto.getRandomValues(new Uint8Array(16)),await this.deriveMasterKey();let t=crypto.getRandomValues(new Uint8Array(16));await this.saveKeyStorage({masterSalt:Array.from(this.masterSalt),verificationData:Array.from(t)})}catch(t){throw ve.error("Failed to generate new master key:",t),t}}async deriveMasterKey(){try{if(!this.masterSalt)throw new Error("Master salt not initialized");let t=await this.getDeviceInfo(),n=new TextEncoder().encode(t);if(!crypto.subtle){try{let o=require("crypto").webcrypto;o&&o.subtle&&(crypto.subtle=o.subtle)}catch(o){}if(!crypto.subtle){this.masterKey="mock-master-key";return}}let a=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);this.masterKey=await crypto.subtle.deriveKey({name:"PBKDF2",salt:this.masterSalt,iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}catch(t){throw ve.error("Failed to derive master key:",t),t}}async verifyMasterKey(t){try{if(!this.masterKey)return!1;if(!crypto.subtle)return!0;let r=new Uint8Array(12).fill(1),n=new Uint8Array([1,2,3,4,5]),a=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},this.masterKey,n),o=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.masterKey,a),i=new Uint8Array(o);if(i.length!==n.length)return!1;for(let s=0;s<n.length;s++)if(i[s]!==n[s])return!1;return!0}catch(r){return ve.error("Master key verification failed:",r),!1}}async getDeviceInfo(){var t,r;try{let n=[],a=this.app.vault.getName();n.push(`vault:${a}`);try{let o=this.app.vault.adapter.basePath;o&&n.push(`path:${o}`)}catch(o){}n.push(`ua:${navigator.userAgent}`),n.push(`screen:${window.screen.width}x${window.screen.height}`),n.push(`lang:${navigator.language}`);try{let o=(r=(t=window.journalitPlugin)==null?void 0:t.authManager)==null?void 0:r.getUserId();o&&n.push(`user:${o}`)}catch(o){}return n.join("|")}catch(n){return ve.error("Failed to get device info:",n),`vault:${this.app.vault.getName()}|time:${Date.now()}`}}async loadKeyStorage(){try{let t=this.app.vault.adapter;if(!await t.exists(this.KEY_PATH))return null;let r=await t.read(this.KEY_PATH);return r?JSON.parse(r):null}catch(t){return ve.error("Failed to load key storage:",t),null}}async saveKeyStorage(t){try{let r=this.app.vault.adapter,n=this.KEY_PATH.split("/")[0];await r.exists(n)||await r.mkdir(n),await r.write(this.KEY_PATH,JSON.stringify(t))}catch(r){throw ve.error("Failed to save key storage:",r),r}}async deriveEncryptionKey(t){try{if(!this.masterKey)throw new Error("Master key not initialized");let r=crypto.getRandomValues(new Uint8Array(12));if(!crypto.subtle){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",{key:this.masterKey,iv:r}}let a=new TextEncoder().encode(t),o=await crypto.subtle.exportKey("raw",this.masterKey),i=await crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return{key:await crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e4,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]),iv:r}}catch(r){throw ve.error("Failed to derive encryption key:",r),r}}async encrypt(t){try{let r=`encrypt-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{key:n,iv:a}=await this.deriveEncryptionKey(r);if(!crypto.subtle){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",btoa(unescape(encodeURIComponent(JSON.stringify(t))))}if(!crypto.subtle||typeof this.masterKey=="string")return btoa(unescape(encodeURIComponent(JSON.stringify(t))));let i=new TextEncoder().encode(JSON.stringify(t)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},n,i);return JSON.stringify({data:Array.from(new Uint8Array(s)),iv:Array.from(a),purpose:r})}catch(r){throw ve.error("Failed to encrypt data:",r),r}}async decrypt(t){try{let r;try{r=JSON.parse(t)}catch(c){return JSON.parse(decodeURIComponent(escape(atob(t))))}let{data:n,iv:a,purpose:o}=r,{key:i}=await this.deriveEncryptionKey(o);if(!crypto.subtle){try{let c=require("crypto").webcrypto;c&&c.subtle&&(crypto.subtle=c.subtle)}catch(c){}if(!crypto.subtle)return this.masterKey="mock-master-key",{test:"value"}}if(!crypto.subtle||typeof this.masterKey=="string")return JSON.parse(decodeURIComponent(escape(atob(t))));let s=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(a)},i,new Uint8Array(n)),l=new TextDecoder;return JSON.parse(l.decode(s))}catch(r){throw ve.error("Failed to decrypt data:",r),r}}async cleanup(){try{let t=this.app.vault.adapter;await t.exists(this.KEY_PATH)&&(await t.remove(this.KEY_PATH),ve.log("Key storage removed during cleanup")),this.masterKey=null,this.masterSalt=null}catch(t){ve.error("Failed to clean up key storage:",t)}}};RE();sc();var Gm=class{constructor(t,r){this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1};this.CONFIG_PATH=".journalit/auth.json";this.GRACE_PERIOD_DAYS=7;this.BETA_EXPIRY_DAYS=42;this.app=t,this.serverUrl=r.replace(/\/+$/,""),this.keyManager=new i0(t),this.initializeAuth()}async initializeAuth(){try{await this.keyManager.initialize(),await this.loadStoredAuth()}catch(t){ve.error("Failed to initialize auth:",t),this.resetAuthState("Initialization failed")}}async loadStoredAuth(){let t=this.app.vault.adapter,r=this.CONFIG_PATH.split("/")[0];try{if(await t.exists(r)||(ve.log("Creating auth config directory"),await t.mkdir(r)),!await t.exists(this.CONFIG_PATH)){ve.log("No stored auth config found");return}ve.log("Loading stored auth configuration");let n=await t.read(this.CONFIG_PATH);if(!n){ve.warn("Auth config file exists but is empty");return}let a=await this.decryptData(n);if(!a.token||!a.userId||!a.roles)throw new Error("Stored auth config is incomplete");let o=new Date(a.graceEnd),i=new Date(a.lastVerified),s=a.tokenExpiry?new Date(a.tokenExpiry):void 0;if(isNaN(o.getTime())||isNaN(i.getTime()))throw new Error("Invalid dates in stored config");if(s&&isNaN(s.getTime()))throw new Error("Invalid token expiry date in stored config");this.state.token=a.token,this.state.isAuthenticated=!0,this.state.cache={userId:a.userId,email:a.email,roles:a.roles,features:this.getFeaturesFromRoles(a.roles),graceEnd:o,lastVerified:i,tokenExpiry:s,subscriptionStatus:a.subscriptionStatus,isBeta:a.isBeta},this.updateSubscriptionTier(),Le.setAuthToken(this.state.token.access_token),ve.log("Successfully loaded stored auth:",{userId:a.userId,email:a.email,roles:a.roles.length,features:this.state.cache.features.length,graceEnd:o.toISOString(),lastVerified:i.toISOString(),tokenExpiry:s==null?void 0:s.toISOString(),isBeta:a.isBeta}),ad.trigger(od.STATE_CHANGED)}catch(n){ve.error("Failed to load auth config:",{error:n,path:this.CONFIG_PATH,errorType:n instanceof Error?n.name:typeof n,message:n instanceof Error?n.message:"Unknown error"}),this.resetAuthState("Failed to load auth config");try{await t.exists(this.CONFIG_PATH)&&(await t.remove(this.CONFIG_PATH),ve.log("Removed corrupted auth config"))}catch(a){ve.error("Failed to remove corrupted config:",a)}}}async storeAuthConfig(){var t,r,n;if(!this.state.token||!this.state.cache){ve.log("Cannot store auth config - missing token or cache:",{hasToken:!!this.state.token,hasCache:!!this.state.cache});return}try{ve.log("Attempting to store auth config with state:",{hasRoles:!!this.state.cache.roles,hasSubscriptionStatus:!!this.state.cache.subscriptionStatus,hasGraceEnd:!!this.state.cache.graceEnd,graceEndType:this.state.cache.graceEnd?typeof this.state.cache.graceEnd:"undefined",hasLastVerified:!!this.state.cache.lastVerified,lastVerifiedType:this.state.cache.lastVerified?typeof this.state.cache.lastVerified:"undefined",hasUserId:!!this.state.cache.userId});let a={token:this.state.token,roles:this.state.cache.roles,subscriptionStatus:this.state.cache.subscriptionStatus,graceEnd:(t=this.state.cache.graceEnd)==null?void 0:t.toISOString(),lastVerified:(r=this.state.cache.lastVerified)==null?void 0:r.toISOString(),tokenExpiry:(n=this.state.cache.tokenExpiry)==null?void 0:n.toISOString(),userId:this.state.cache.userId,email:this.state.cache.email,isBeta:this.state.cache.isBeta};ve.log("Config data prepared:",{hasToken:!!a.token,hasRoles:!!a.roles,hasGraceEnd:!!a.graceEnd,hasLastVerified:!!a.lastVerified,hasUserId:!!a.userId});let o=await this.encryptData(a);await this.app.vault.adapter.write(this.CONFIG_PATH,o)}catch(a){throw ve.error("Failed to store auth config:",a),a}}async encryptData(t){try{return await this.keyManager.encrypt(t)}catch(r){throw ve.error("Failed to encrypt data:",r),r}}async decryptData(t){try{let r=JSON.parse(t);return r.key&&r.iv&&r.data?await this.legacyDecryptData(t):await this.keyManager.decrypt(t)}catch(r){throw ve.error("Failed to decrypt data:",r),r}}async legacyDecryptData(t){try{let{data:r,iv:n,key:a}=JSON.parse(t),o=await crypto.subtle.importKey("raw",new Uint8Array(a),{name:"AES-GCM",length:256},!1,["decrypt"]),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n)},o,new Uint8Array(r)),s=new TextDecoder;return JSON.parse(s.decode(i))}catch(r){throw ve.error("Legacy decryption failed:",r),r}}getFeaturesFromRoles(t){let r=["basic-trades","basic-dashboard","trade-list"];return(t.includes("journalit-premium")||t.includes("admin"))&&r.push("advanced-trades","custom-layouts","multi-account","advanced-metrics","broker-integration"),r}async loginWithEmail(){return this.authenticate()}updateSubscriptionTier(){var t;(t=this.state.cache)!=null&&t.roles&&(this.state.cache.roles.includes("journalit-premium")||this.state.cache.roles.includes("admin")?this.state.subscriptionTier="premium":this.state.subscriptionTier="free")}isTokenExpired(){var t;return(t=this.state.cache)!=null&&t.tokenExpiry?new Date>this.state.cache.tokenExpiry:!1}isTokenApproachingExpiry(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return!1;let t=new Date,r=new Date(t.getTime()+7*24*60*60*1e3);return this.state.cache.tokenExpiry<r}showTokenExpiryWarningIfNeeded(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return;let t=new Date,r=Math.ceil((this.state.cache.tokenExpiry.getTime()-t.getTime())/(1e3*60*60*24));if(r>0&&r<=7){ve.warn(`Token expires in ${r} days`,{tokenExpiry:this.state.cache.tokenExpiry.toISOString(),daysRemaining:r});let a=r===1?"Your session expires tomorrow. Please sign in again soon to continue using premium features.":`Your session expires in ${r} days. Please sign in again to continue using premium features.`;new hn.Notice(a,8e3)}}decodeJWT(t){try{let r=t.split(".");if(r.length!==3)throw new Error("Invalid JWT format");let n=r[1].replace(/-/g,"+").replace(/_/g,"/");for(;n.length%4!==0;)n+="=";return JSON.parse(atob(n))}catch(r){throw ve.error("Failed to decode JWT:",r),new Error("Invalid JWT token")}}async verifyAuth(){var a,o,i,s,l;let n=0;for(;n<3;)try{if(n++,ve.log(`Auth verification attempt ${n}/3`),!navigator.onLine){ve.log("Network offline - checking cached credentials");let p=this.handleOfflineAuth(),m=jE(((a=this.state.cache)==null?void 0:a.graceEnd)||null);return ve.log("Showing offline mode notice:",{message:m.message,location:"offline mode fallback",timestamp:new Date().toISOString()}),new hn.Notice(m.message),p}if(!((o=this.state.token)!=null&&o.access_token))throw new Error("No auth token available");if(this.isTokenExpired()){ve.log("Token expired - re-authentication required");let p=Vi(Xn.TOKEN_EXPIRED);throw new hn.Notice(p.message),new Error(p.message)}let c=new URL("/auth/verify",this.serverUrl).toString();ve.log("Verifying token:",{url:c,attempt:n,tokenType:this.state.token.token_type});let d=await(0,hn.requestUrl)({url:c,method:"GET",headers:this.getAuthHeaders()});if(ve.log("Verify response received:",{status:d.status,statusText:d.status===401?"Unauthorized":d.status===200?"OK":"Unknown",headers:d.headers,hasBody:!!d.text}),d.status===401){ve.log("Token verification failed - Unauthorized");let p=Vi(Xn.AUTH_FAILED,{reason:"Token is no longer valid"});return new hn.Notice(p.message),!1}if(d.status!==200)throw ve.log("Unexpected response status:",d.status),new Error(`Unexpected response status: ${d.status}`);ve.log("Attempting to parse response body");let u=await d.json();if(ve.log("Response parsed successfully:",{authenticated:!!u.authenticated,hasError:!!u.error,userId:(i=u.user)==null?void 0:i.id}),!u.authenticated||u.error){let p=Vi(Xn.AUTH_FAILED,{reason:u.message||u.error||"Server validation failed"});return new hn.Notice(p.message),!1}if(!((s=u.user)!=null&&s.id)||!((l=u.user)!=null&&l.roles)){let p=Vi(Xn.AUTH_FAILED,{reason:"Invalid user data received"});throw new hn.Notice(p.message),new Error(p.message)}return this.state.cache={userId:u.user.id,roles:u.user.roles,features:this.getFeaturesFromRoles(u.user.roles),graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,subscriptionStatus:u.user.subscriptionStatus},ve.log("Auth verification successful:",{userId:u.user.id,roleCount:u.user.roles.length,features:this.state.cache.features.length,expiresAt:this.state.cache.graceEnd}),this.state.isOffline=!1,this.updateSubscriptionTier(),await this.storeAuthConfig().catch(p=>{ve.warn("Failed to store updated auth config:",p)}),this.showTokenExpiryWarningIfNeeded(),!0}catch(c){if(ve.error(`Auth verification failed (attempt ${n}):`,c),ve.log("Error details before offline fallback:",{errorType:c instanceof Error?c.name:typeof c,errorMessage:c instanceof Error?c.message:String(c),isNetworkError:c instanceof Error&&c.message.toLowerCase().includes("network"),attempts:n,maxRetries:3}),n===3){ve.log("All online verification attempts failed - trying offline mode");let d=this.handleOfflineAuth();if(d){let u=Vi(Xn.NETWORK_ERROR.basic);ve.log("Showing network error notice:",{message:u.title,location:"network error fallback",timestamp:new Date().toISOString()}),new hn.Notice(u.title),this.showTokenExpiryWarningIfNeeded()}return d}await new Promise(d=>setTimeout(d,1e3*n))}return!1}handleOfflineAuth(){if(!this.state.cache)return ve.log("No cached auth data available for offline mode"),!1;let t=new Date;return t<this.state.cache.graceEnd?(ve.log("Using cached auth data:",{userId:this.state.cache.userId,graceEnd:this.state.cache.graceEnd,timeRemaining:this.state.cache.graceEnd.getTime()-t.getTime()}),this.state.isOffline=!0,!0):(ve.log("Cached auth data expired:",{graceEnd:this.state.cache.graceEnd,now:t}),!1)}async authenticate(){try{this.resetAuthState("Starting new authentication"),ve.log("Initiating beta email auth"),new l0(this.app,async(r,n)=>{await this.handleBetaAuth(r,n)},()=>{ve.log("Authentication cancelled by user")}).open()}catch(t){ve.error("Auth error:",t),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null;let r=Vi(Xn.AUTH_FAILED);throw this.state.error=r.message,new hn.Notice(r.message),t}}async handleBetaAuth(t,r){try{ve.log("Beta auth data received:",{hasToken:!!t,hasUser:!!r,userId:r==null?void 0:r.id,tier:r==null?void 0:r.tier});let n=this.decodeJWT(t);if(!n.exp||!n.user_id)throw new Error("Invalid JWT token claims");this.state.token={access_token:t,token_type:"Bearer",expires_in:this.BETA_EXPIRY_DAYS*24*60*60,refresh_token:null};let a=r.tier==="premium"?["journalit-premium"]:[],o=this.getFeaturesFromRoles(a);ve.log("Initializing beta auth cache:",{userId:r.id,email:r.email,tier:r.tier,roleCount:a.length,featureCount:o.length,features:o}),this.state.cache={userId:r.id,email:r.email,roles:a,features:o,graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,tokenExpiry:new Date(n.exp*1e3),subscriptionStatus:"beta",isBeta:r.is_beta},this.state.isAuthenticated=!0,this.state.error=null,this.updateSubscriptionTier(),Le.setAuthToken(this.state.token.access_token),await this.storeAuthConfig().catch(i=>{ve.warn("Failed to store auth config:",i)}),ve.log("Triggering auth state change event (handleBetaAuth)"),ad.trigger(od.STATE_CHANGED),ve.log("Beta authentication completed successfully:",{userId:this.state.cache.userId,email:this.state.cache.email,roles:this.state.cache.roles,features:this.state.cache.features,tier:this.state.subscriptionTier,tokenExpiry:this.state.cache.tokenExpiry})}catch(n){throw ve.error("Beta auth error:",n),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null,n instanceof Error?this.state.error=n.message:this.state.error="An unknown error occurred",n}}resetAuthState(t="No reason provided"){var r,n,a;ve.log("Resetting auth state:",{reason:t,hadCache:!!this.state.cache,hadFeatures:!!((r=this.state.cache)!=null&&r.features),featureCount:(a=(n=this.state.cache)==null?void 0:n.features)==null?void 0:a.length,wasAuthenticated:this.state.isAuthenticated,wasOffline:this.state.isOffline}),this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1,subscriptionTier:void 0},Le.setAuthToken(null),ve.log("Auth state reset complete")}async logout(){if(ve.log("Starting logout process",{serverUrl:this.serverUrl,hasToken:!!this.state.token}),!this.state.token){ve.log("No active token to invalidate"),this.resetAuthState("No active token"),ve.log("Triggering auth state change event (no token path)"),ad.trigger(od.STATE_CHANGED);return}let t=!1;try{if(navigator.onLine){let r=new URL("/auth/logout",this.serverUrl).toString();ve.log("Sending logout request to server",{fullUrl:r,headers:this.getAuthHeaders()}),await(0,hn.requestUrl)({url:r,method:"POST",headers:this.getAuthHeaders()}),t=!0,ve.log("Token invalidation successful"),new hn.Notice(Xn.STATUS.disconnected)}else{ve.log("Offline mode - skipping token invalidation");let r=Vi(Xn.NETWORK_ERROR.basic);new hn.Notice(r.message)}}catch(r){ve.error("Token invalidation failed:",{error:r,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"})}try{this.resetAuthState(t?"Token invalidation successful":"Local cleanup only"),Le.setAuthToken(null),ve.log("Checking for auth config file existence");let r=await this.app.vault.adapter.exists(this.CONFIG_PATH);if(ve.log("Auth config exists check result:",r),r){ve.log("Attempting to remove auth config file"),await this.app.vault.adapter.remove(this.CONFIG_PATH),ve.log("Auth config removal completed");let n=await this.app.vault.adapter.exists(this.CONFIG_PATH);ve.log("Post-removal existence check:",{path:this.CONFIG_PATH,stillExists:n,timestamp:new Date().toISOString()})}await this.keyManager.cleanup().catch(n=>{ve.warn("Failed to clean up key storage:",n)}),ad.trigger(od.STATE_CHANGED)}catch(r){ve.error("Local cleanup failed:",r),this.resetAuthState("Forced reset after cleanup failure")}ve.log("Logout completed:",{tokenInvalidated:t,stateCleared:!this.state.token&&!this.state.isAuthenticated,configRemoved:!await this.app.vault.adapter.exists(this.CONFIG_PATH).catch(()=>!0)})}async hasFeature(t){var a,o,i;if(ve.log("hasFeature check:",{featureName:t,hasCache:!!this.state.cache,hasFeatures:!!((a=this.state.cache)!=null&&a.features),featureCount:(i=(o=this.state.cache)==null?void 0:o.features)==null?void 0:i.length,isOffline:this.state.isOffline}),!this.state.cache){let s=Vi(Xn.NEEDS_AUTH);return new hn.Notice(s.message),!1}let r=this.getFeaturesFromRoles([]).includes(t);if(!navigator.onLine){this.state.isOffline=!0,ve.log("Offline mode feature check:",{featureName:t,graceEnd:this.state.cache.graceEnd,now:new Date,isExpired:new Date>this.state.cache.graceEnd,features:this.state.cache.features});let s=jE(this.state.cache.graceEnd);if(new hn.Notice(s.message),!this.handleOfflineAuth()){let c=Xn.OFFLINE_MODE.expired;return new hn.Notice(c.message),!1}let l=this.state.cache.features.includes(t);if(!l&&!r){let c=Vi(Xn.NEEDS_PREMIUM);new hn.Notice(`${c.title}: ${c.message}`)}return l}if(this.state.isOffline=!1,Date.now()-this.state.cache.lastVerified.getTime()>36e5)try{await this.verifyAuth()}catch(s){let l=Vi(Xn.NETWORK_ERROR.premium);return new hn.Notice(l.message),r}let n=this.state.cache.features.includes(t);if(!n&&!r){let s=Vi(Xn.NEEDS_PREMIUM);new hn.Notice(`${s.title}: ${s.message}`)}return n}getAuthState(){return{...this.state}}isAuthenticated(){return this.state.isAuthenticated&&!!this.state.token}getSubscriptionTier(){return this.state.subscriptionTier}getUserId(){var t;return(t=this.state.cache)==null?void 0:t.userId}getAuthToken(){var t;return((t=this.state.token)==null?void 0:t.access_token)||null}getAuthHeaders(){var r;let t={"Content-Type":"application/json","Accept-Language":"en-US"};return(r=this.state.token)!=null&&r.access_token&&(t.Authorization=`Bearer ${this.state.token.access_token}`),t}};Gm.AUTH_CHANGED="journalit-auth-changed";var lZ="https://connect.journalit.co";var WE=()=>lZ;async function pa(e,t){try{let r=performance.now();await new Promise(o=>setTimeout(o,10));let n=e(),a=Math.round(performance.now()-r);return n}catch(r){throw console.error(`Failed to lazy load ${t}:`,r),r}}a0();var VR=require("obsidian");Lu();function UE(e){var r,n;let t=[];return(r=e.name)!=null&&r.trim()||t.push({field:"name",message:"Name is required"}),(n=e.description)!=null&&n.trim()||t.push({field:"description",message:"Description is required"}),e.name&&!/^[\w\s-]{3,50}$/.test(e.name)&&t.push({field:"name",message:"Name must be 3-50 characters and contain only letters, numbers, spaces, and hyphens"}),e.color&&!/^#[0-9A-Fa-f]{6}$/.test(e.color)&&t.push({field:"color",message:"Color must be a valid hex color code (e.g. #FF0000)"}),e.order!==void 0&&(!Number.isInteger(e.order)||e.order<0)&&t.push({field:"order",message:"Order must be a non-negative integer"}),t}function qE(e){if(!e.startsWith("setup-"))throw new Error('Invalid setup ID format: must start with "setup-"');if(!/^setup-[\w-]{1,50}$/.test(e))throw new Error("Invalid setup ID format: must contain only letters, numbers, and hyphens")}var c0=class{constructor(t){this.tradeService=t}async calculateMetrics(t){let r=await this.getSetupTrades(t);if(!r.length)return this.getEmptyMetrics();let n=r.map(l=>this.calculateTradePnL(l)),a=n.filter(l=>l>0),o=n.filter(l=>l<0),i=this.calculateStreaks(n);return{...this.getEmptyMetrics(),totalTrades:r.length,winRate:a.length/r.length*100,totalPnL:n.reduce((l,c)=>l+c,0),avgWinner:a.length?a.reduce((l,c)=>l+c,0)/a.length:0,avgLoser:o.length?o.reduce((l,c)=>l+c,0)/o.length:0,winStreak:i.maxWin,loseStreak:i.maxLoss,currentStreak:i.current,...this.calculateAdvancedMetrics(r,n)}}async getSetupTrades(t){let r=await this.tradeService.getTrades(new Date(0),new Date);return(await Promise.all(r.map(async n=>{try{let a=await this.tradeService.readTradeContent(n),o=this.parseTrade(a);return o.setupIds.includes(t)?o:null}catch(a){return console.warn(`Invalid trade file: ${n.path}`),null}}))).filter(n=>n!==null)}calculateTradePnL(t){return(t.exitPrice-t.entryPrice)*t.positionSize}calculateStreaks(t){let r=0,n=0,a=0;return t.forEach(o=>{o>0?(r<0&&(r=0),r++,n=Math.max(n,r)):o<0&&(r>0&&(r=0),r--,a=Math.min(a,r))}),{maxWin:n,maxLoss:Math.abs(a),current:r}}getEmptyMetrics(){return{totalTrades:0,winRate:0,totalPnL:0,avgWinner:0,avgLoser:0,winStreak:0,loseStreak:0,currentStreak:0,expectedValue:0,riskRewardRatio:0,profitFactor:0,averageDuration:0,bestTrade:0,worstTrade:0,averageVolume:0,lastTradeDate:new Date().toISOString(),tradingFrequency:0,inactivityStreak:0}}calculateAdvancedMetrics(t,r){if(!t.length)return{};let n=r.filter(f=>f>0),a=r.filter(f=>f<0),o=t.map(f=>{let b=new Date(f.exitTime),v=new Date(f.entryTime);return(b.getTime()-v.getTime())/1e3/60}),i=t.map(f=>Math.abs(f.positionSize)),s=n.reduce((f,b)=>f+b,0),l=Math.abs(a.reduce((f,b)=>f+b,0)),c=t.map(f=>new Date(f.exitTime)),d=new Date(Math.max(...c.map(f=>f.getTime()))),u=new Date,p=Math.floor((u.getTime()-d.getTime())/(1e3*60*60*24)),m=new Date(Math.min(...c.map(f=>f.getTime()))),h=(u.getTime()-m.getTime())/(1e3*60*60*24*30.44);return{expectedValue:r.reduce((f,b)=>f+b,0)/r.length,riskRewardRatio:Math.abs(n.length?s/n.length:0)/Math.abs(a.length?l/a.length:1),profitFactor:l?s/l:s?1/0:0,averageDuration:o.reduce((f,b)=>f+b,0)/o.length,bestTrade:Math.max(...r),worstTrade:Math.min(...r),averageVolume:i.reduce((f,b)=>f+b,0)/i.length,lastTradeDate:d.toISOString(),tradingFrequency:t.length/h,inactivityStreak:p}}parseTrade(t){let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)throw new Error("Invalid trade file format");let n=r[1].split(`
`).reduce((o,i)=>{let[s,...l]=i.split(":").map(c=>c.trim());return s&&l.length&&(s==="setupIds"?o[s]=l.join(":").replace(/[\[\]]/g,"").split(",").map(c=>c.trim()):o[s]=l.join(":")),o},{}),a=new Date().toISOString();return{exitPrice:Number(n.exitPrice),entryPrice:Number(n.entryPrice),positionSize:Number(n.positionSize),setupIds:n.setupIds||[],entryTime:n.entryTime||a,exitTime:n.exitTime||n.entryTime||a}}};Ss();var d0=class extends si{constructor(r,n,a={}){super(r,{folder:"setups",extension:".md",cacheTTL:5*60*1e3,persistCache:!0,namespace:a.namespace||"setup"});this.tradeService=n;this.SETUPS_FOLDER="setups";this.metricsCalculator=new c0(n)}async getSetupMetrics(r){return qE(r),this.query(async()=>this.metricsCalculator.calculateMetrics(r),`metrics:${r}`,{offlineCapable:!0})}async getAllSetupMetrics(r){let n=`metrics:all${r?`:${JSON.stringify(r)}`:""}`;return this.query(async()=>{let a=await this.getSetupFiles(),o=await this.filterSetupFiles(a,r),i=new Map;for(let s of o)try{let l=await this.app.vault.read(s),c=await this.parseSetupContent(l),d=await this.metricsCalculator.calculateMetrics(c.id);i.set(c.id,d)}catch(l){console.warn(`Failed to calculate metrics for setup: ${s.path}`)}return i},n,{offlineCapable:!0})}async createSetup(r){let n=UE(r);if(n.length)throw new Error(`Invalid setup data: ${n.map(s=>s.message).join(", ")}`);let a=this.generateSetupId(r.name),o=this.getSetupFilePath(a),i=this.generateSetupContent({...r,id:a,status:"active",version:1,createdAt:this.formatDateTimeForDisplay(new Date),updatedAt:this.formatDateTimeForDisplay(new Date),color:r.color||"#808080",icon:r.icon||"trading_setup",order:r.order||0});return await this.app.vault.create(o,i),o}async updateSetup(r,n){if(qE(r),Object.keys(n).length>0){let d=[];"name"in n&&d.push("name"),"description"in n&&d.push("description"),"color"in n&&d.push("color"),"order"in n&&d.push("order");let u=UE(n).filter(p=>d.includes(p.field));if(u.length)throw new Error(`Invalid setup data: ${u.map(p=>p.message).join(", ")}`)}let a=this.getSetupFilePath(r),o=this.app.vault.getAbstractFileByPath(a);if(!o||!("path"in o))throw new Error(`Setup not found: ${r}`);let i=await this.app.vault.read(o),s=await this.parseSetupContent(i),l={...s,...n,version:s.version+1,updatedAt:this.formatDateTimeForDisplay(new Date)},c=this.generateSetupContent(l);await this.app.vault.modify(o,c),await Wt(this.app,o),await this.clearCache()}async archiveSetup(r){await this.updateSetup(r,{status:"archived"})}async getSetups(r){let n=`setups:${JSON.stringify(r||{})}`;return this.query(async()=>{let a=await this.getSetupFiles();return this.filterSetupFiles(a,r)},n,{offlineCapable:!0})}async getSetupFiles(){return this.getFiles()}getSetupFilePath(r){return(0,VR.normalizePath)(`${this.SETUPS_FOLDER}/${r}.md`)}generateSetupId(r){return`setup-${r.toLowerCase().replace(/[^a-z0-9]/g,"-")}`}formatDateTimeForDisplay(r){let n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0"),i=String(r.getHours()).padStart(2,"0"),s=String(r.getMinutes()).padStart(2,"0"),l=String(r.getSeconds()).padStart(2,"0");return`${n}-${a}-${o}T${i}:${s}:${l}`}generateSetupContent(r){return["---","type: setup",`id: ${r.id}`,`name: ${r.name}`,`description: ${r.description}`,`status: ${r.status}`,`color: ${r.color}`,`icon: ${r.icon}`,`version: ${r.version}`,`createdAt: ${r.createdAt}`,`updatedAt: ${r.updatedAt}`,`order: ${r.order}`,"---","","## Trading Rules","",r.rules||"No rules defined."].join(`
`)}async parseSetupContent(r){var o;let n=r.match(/^---\n([\s\S]*?)\n---/);if(!n)throw new Error("Invalid setup file format");let a=n[1].split(`
`).reduce((i,s)=>{let[l,...c]=s.split(":").map(d=>d.trim());return l&&c.length&&(i[l]=c.join(":")),i},{});return{id:a.id,name:a.name,description:a.description,rules:((o=r.split("## Trading Rules")[1])==null?void 0:o.trim())||"",status:a.status,color:a.color,icon:a.icon,version:parseInt(a.version,10),createdAt:a.createdAt,updatedAt:a.updatedAt,order:parseInt(a.order,10)}}async filterSetupFiles(r,n){return n?(await Promise.all(r.map(async o=>{try{let i=await this.app.vault.read(o),s=await this.parseSetupContent(i);return n.status&&s.status!==n.status||n.search&&!this.matchesSearch(s,n.search)?null:o}catch(i){return console.warn(`Invalid setup file: ${o.path}`),null}}))).filter(o=>o!==null):r}matchesSearch(r,n){let a=n.toLowerCase();return r.name.toLowerCase().includes(a)||r.description.toLowerCase().includes(a)||r.rules.toLowerCase().includes(a)}};var Gi=require("obsidian");function GR(e){let t=new CustomEvent("drc-created",{detail:{path:e}});document.dispatchEvent(t)}function HE(e,t="unknown"){let r=new CustomEvent("drc-updated",{detail:{path:e,source:t}});document.dispatchEvent(r)}Ft();Za();Ss();var u0=class{constructor(t,r,n={}){this.JOURNALIT_FOLDER="!Journalit";this.DRC_PREFIX="DRC";this.app=t,this.plugin=r,this.namespace=n.namespace||"drc",document.addEventListener("journalit-settings-updated",this.onSettingsUpdated.bind(this))}async onSettingsUpdated(t){var r;try{if(((r=t==null?void 0:t.detail)==null?void 0:r.source)==="user-input")return;let n=this.app.workspace.getActiveFile();if(!n)return;let a=this.app.metadataCache.getFileCache(n);if(!(a!=null&&a.frontmatter)||a.frontmatter.type!=="drc")return;HE(n.path,"settings-update")}catch(n){console.error("Error updating DRC after settings change:",n)}}getWeekOfMonth(t){return Ts(t)}formatDateForFilename(t){let r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);return`${r}${n}${a}`}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}formatDateTimeForDisplay(t){let r=this.formatDateForDisplay(t),n=t.toTimeString().split(" ")[0];return`${r}T${n}`}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createDRC(t){try{let r=this.getDRCNotePath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let a=this.generateInitialDRCContent(t),o=await this.app.vault.create(r,a);return await Wt(this.app,o),await this.addBacklinksToContent(o,t),GR(r),r}catch(r){throw console.error("Error creating DRC:",r),r}}async addBacklinksToContent(t,r){try{let n=await Lv(r,this.plugin);if(n.drcToWeekly){let a=await this.app.vault.read(t),o=Na.generateLinksSection(n),i=a+`

`+o;await this.app.vault.modify(t,i)}}catch(n){console.error("Error adding backlinks to DRC:",n)}}async getTodayDRC(){let t=new Date;return this.createDRC(t)}async getDRC(t){return this.createDRC(t)}async updateDRCBacklinks(t){try{let r=this.getDRCNotePath(t),n=this.app.vault.getAbstractFileByPath(r);if(!n||!(n instanceof Gi.TFile))return;let a=await Lv(t,this.plugin),o=await this.app.vault.read(n),i=Na.updateLinksSection(o,a);i!==o&&await this.app.vault.modify(n,i)}catch(r){console.error("Error updating DRC backlinks:",r)}}async getTradesForDate(t){var r;try{let n=xt(t,this.plugin),a=this.formatDateForDisplay(n),o=this.app.vault.getMarkdownFiles(),i=[];for(let s of o){let l=(r=this.app.metadataCache.getFileCache(s))==null?void 0:r.frontmatter;if(!(!l||l.type!=="trade")){if(l.entryTime){let c=new Date(l.entryTime),d=xt(c,this.plugin);this.formatDateForDisplay(d)===a&&i.push(s)}else if(l.date){let c=new Date(l.date);this.formatDateForDisplay(c)===a&&i.push(s)}}}return i}catch(n){return console.error(`Error getting trades for date ${t.toDateString()}:`,n),[]}}async updateDRCFrontmatter(t,r,n="unknown"){try{let a=this.app.vault.getAbstractFileByPath(t);if(!a||!(a instanceof Gi.TFile))throw new Error(`DRC file not found: ${t}`);if(await this.app.fileManager.processFrontMatter(a,o=>{Object.assign(o,r)}),await Wt(this.app,a),n==="user-input")return;HE(t,n);return}catch(a){throw console.error(`Error updating DRC frontmatter in ${t}:`,a),a}}getWeeklyReviewPath(t){let r=pn(t),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=Ts(r),i=`${o}-Review.md`;return(0,Gi.normalizePath)(`${this.JOURNALIT_FOLDER}/${n}/${a}/${o}/${i}`)}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=`${n}-Review.md`;return(0,Gi.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${a}`)}getDRCNotePath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(t),o=this.formatDateForFilename(t),i=`${this.DRC_PREFIX}-${o}.md`;return(0,Gi.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${a}/${i}`)}getNextDayDRCPath(t){let n=Pw(this.plugin)?FD(t):new Date(t.getTime()+24*60*60*1e3);return this.getDRCNotePath(n)}getPreviousDayDRCPath(t){let n=Pw(this.plugin)?jD(t):new Date(t.getTime()-24*60*60*1e3);return this.getDRCNotePath(n)}async getAdjacentDRC(t,r,n){var a,o,i;try{let s=r<0?this.getPreviousDayDRCPath(t):this.getNextDayDRCPath(t);if(await this.app.vault.adapter.exists(s))return s;if((i=n!=null?n:(o=(a=this.plugin.settings)==null?void 0:a.drc)==null?void 0:o.autoCreateDRCOnNavigation)!=null?i:!0){let d=Pw(this.plugin),u;return r<0?u=d?jD(t):new Date(t.getTime()-24*60*60*1e3):u=d?FD(t):new Date(t.getTime()+24*60*60*1e3),await this.createDRC(u),s}return null}catch(s){return console.error("Error getting adjacent DRC:",s),null}}getDRCFile(t){let r=this.app.vault.getAbstractFileByPath(t);return!r||!(r instanceof Gi.TFile)?null:r}extractDRCData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="drc"?null:n}catch(n){return console.error("Error extracting DRC data:",n),null}}async getPreviousDayGoals(t){try{let r=this.getPreviousDayDRCPath(t);if(!await this.app.vault.adapter.exists(r))return null;let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof Gi.TFile))return null;let o=this.extractDRCData(a);return(o==null?void 0:o.dailyGoals)||null}catch(r){return console.error("Error getting previous day goals:",r),null}}generateDRCTags(t){let r=[];r.push([Wm(Rm.DAILY)]);let n=vl(t);return n.length>0&&r.push(n),yl(...r)}generateInitialDRCContent(t){let r={type:"drc",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),tags:this.generateDRCTags(t),preTradeChecklist:{},mentalGrade:"B",technicalGrade:"B",tradeRatings:{},reviewQuestions:{},missedTrades:[]};return this.plugin.settings.drc.checklistItems&&this.plugin.settings.drc.checklistItems.forEach(a=>{r.preTradeChecklist[a]=!1}),this.plugin.settings.drc.reviewQuestions&&this.plugin.settings.drc.reviewQuestions.forEach(a=>{r.reviewQuestions[a]=""}),[...["---",`type: ${r.type}`,...this.convertToYamlFrontmatter(r),"---"],`# Daily Report Card - ${this.formatDateForDisplay(t)}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=a=>a==null?"null":typeof a=="string"?a.includes(":")||a.includes("#")||a.includes(`
`)||a.includes('"')||a.trim()===""?`"${a.replace(/"/g,'\\"')}"`:a:typeof a=="number"||typeof a=="boolean"?String(a):Array.isArray(a)||typeof a=="object"?JSON.stringify(a):String(a);for(let[a,o]of Object.entries(t))a!=="type"&&o!==void 0&&r.push(`${a}: ${n(o)}`);return r}async openDRC(t){try{let r=this.getDRCNotePath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createDRC(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open DRC for date ${t.toDateString()}:`,r),r}}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let a=this.generateInitialWeeklyReviewContent(t),o=await this.app.vault.create(r,a);return await Wt(this.app,o),r}catch(r){throw console.error("Error creating weekly review:",r),r}}generateInitialWeeklyReviewContent(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(t),o={type:"weekly-review",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),week:a,month:n,year:r.toString()};return[...["---",`type: ${o.type}`,...this.convertToYamlFrontmatter(o),"---"],"",`# Weekly Review - Week ${a}, ${n}/${r}`,"","## Summary","","Weekly trading summary goes here.","","## Performance","","Performance metrics for the week.","","## Lessons Learned","","Key takeaways from this week's trades.","","## Goals for Next Week","","Trading goals for the upcoming week."].join(`
`)}async openWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}async saveDRCForecastImage(t,r,n){try{let a=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(r),s=n.replace(/[^a-zA-Z0-9]/g,""),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),c="";if(l.includes("."))c=l.substring(l.lastIndexOf("."));else throw new Error("File name does not contain a period.");let d=Date.now(),u=this.formatDateForFilename(r),p=`DRC-${s}-${u}-${d}${c}`,m=`${this.JOURNALIT_FOLDER}/${a}/${o}/${i}/media`,h=`${m}/${p}`;await this.app.vault.adapter.mkdir((0,Gi.normalizePath)(m));let f=await t.arrayBuffer();return await this.app.vault.createBinary((0,Gi.normalizePath)(h),f),h}catch(a){throw console.error("Error saving DRC forecast image:",a),a}}async getWeeklyEventsForDate(t){var r;try{let n=t.toLocaleDateString("en-US",{weekday:"long"}),a=this.getWeeklyReviewPath(t);if(!await this.app.vault.adapter.exists(a))return[];let i=this.app.vault.getAbstractFileByPath(a);if(!i||!(i instanceof Gi.TFile))return[];let s=(r=this.app.metadataCache.getFileCache(i))==null?void 0:r.frontmatter;return!s||s.type!=="weekly-review"?[]:(s.keyEvents||[]).filter(d=>d.day?d.day.toLowerCase()===n.toLowerCase():!0)}catch(n){return console.error("Error getting weekly events for date:",n),[]}}async saveDRCForecastImages(t,r,n){try{let a=[];for(let o of t){let i=await this.saveDRCForecastImage(o,r,n);a.push(i)}return a}catch(a){throw console.error("Error saving multiple DRC forecast images:",a),a}}async deleteImage(t){try{let r=this.app.vault.getAbstractFileByPath(t);if(!r)throw new Error(`Image file not found: ${t}`);await this.app.vault.delete(r);let n=t.substring(0,t.lastIndexOf("/"));if(await this.app.vault.adapter.exists(n)){let o=await this.app.vault.adapter.list(n);if(o.files.length===0&&o.folders.length===0){let i=this.app.vault.getAbstractFileByPath(n);i&&await this.app.vault.delete(i)}}}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}};var xd=require("obsidian");tc();function YR(e){let t=new CustomEvent("weekly-review-created",{detail:{path:e}});document.dispatchEvent(t)}function p0(e){let t=new CustomEvent("weekly-review-updated",{detail:{path:e}});document.dispatchEvent(t)}Ft();Za();Ss();var m0=class{constructor(t,r,n={}){this.JOURNALIT_FOLDER="!Journalit";this.WEEKLY_PREFIX="Weekly";this.app=t,this.plugin=r,this.namespace=n.namespace||"weekly",document.addEventListener("journalit-settings-updated",a=>{this.onSettingsUpdated(a)})}async onSettingsUpdated(t){var r,n,a;try{(r=t==null?void 0:t.detail)==null||r.component;let o=this.app.workspace.getActiveFile();if(!o)return;let i=this.app.metadataCache.getFileCache(o);if(!(i!=null&&i.frontmatter)||i.frontmatter.type!=="weekly-review")return;if(((n=t==null?void 0:t.detail)==null?void 0:n.component)==="weekly"&&((a=this.plugin.settings.weekly)!=null&&a.reviewQuestions)){let s=await this.extractWeeklyReviewData(o);if(!s)return;let l=Object.keys(s.reviewQuestions||{}),c=this.plugin.settings.weekly.reviewQuestions;if(l.length!==c.length||!l.every(d=>c.includes(d))){let d={};c.forEach(u=>{d[u]=s.reviewQuestions&&u in s.reviewQuestions?s.reviewQuestions[u]:""}),await this.updateWeeklyReviewFrontmatter(o.path,{reviewQuestions:d})}}p0(o.path)}catch(o){console.error("Error updating Weekly Review after settings change:",o)}}getWeeklyReviewPath(t){let r=pn(t),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=Ts(r),i=`${o}-Review.md`;return(0,xd.normalizePath)(`${this.JOURNALIT_FOLDER}/${n}/${a}/${o}/${i}`)}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let a=await this.generateInitialWeeklyReviewContent(t),o=await this.app.vault.create(r,a);return await Wt(this.app,o),YR(r),r}catch(r){throw console.error("Error creating weekly review:",r),r}}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}generateWeeklyReviewTags(t){let r=[],n=pn(t);r.push([Wm(Rm.WEEKLY)]);let a=vl(n);return a.length>0&&r.push(a),yl(...r)}async generateInitialWeeklyReviewContent(t){let r=pn(t),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=Ts(r),i=cl(r),s={type:"weekly-review",date:this.formatDateForDisplay(r),created:new Date().toISOString(),tags:this.generateWeeklyReviewTags(t),week:o,month:a,year:n.toString(),reviewQuestions:{},forecast:{monthly:{notes:""},weekly:{notes:""},daily:{notes:""}},keyEvents:[]};this.plugin.settings.weekly&&this.plugin.settings.weekly.reviewQuestions?this.plugin.settings.weekly.reviewQuestions.forEach(c=>{s.reviewQuestions&&(s.reviewQuestions[c]="")}):["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"].forEach(d=>{s.reviewQuestions&&(s.reviewQuestions[d]="")});try{let c=new Date(r);c.setDate(c.getDate()-7);let d=this.getWeeklyReviewPath(c);if(await this.app.vault.adapter.exists(d)){let u=this.app.vault.getAbstractFileByPath(d);if(u instanceof xd.TFile){let p=await this.extractWeeklyReviewData(u);p&&p.nextWeekGoals&&(s.previousGoals=p.nextWeekGoals)}}}catch(c){console.error("Error getting previous week goals:",c)}return[...["---",`type: ${s.type}`,...this.convertToYamlFrontmatter(s),"---"],`# Weekly Review - ${o}, ${a}/${n}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=a=>a==null?"null":typeof a=="string"?a.includes(":")||a.includes("#")||a.includes(`
`)||a.includes('"')||a.trim()===""?`"${a.replace(/"/g,'\\"')}"`:a:typeof a=="number"||typeof a=="boolean"?String(a):Array.isArray(a)||typeof a=="object"?JSON.stringify(a):String(a);for(let[a,o]of Object.entries(t))a!=="type"&&o!==void 0&&r.push(`${a}: ${n(o)}`);return r}async extractWeeklyReviewData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="weekly-review"?null:n}catch(n){return console.error("Error extracting Weekly Review data:",n),null}}async updateWeeklyReviewFrontmatter(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof xd.TFile))throw new Error(`Weekly Review file not found: ${t}`);await this.app.fileManager.processFrontMatter(n,a=>{Object.assign(a,r)}),await Wt(this.app,n),p0(t),r.nextWeekGoals!==void 0&&await this.syncGoalsToNextWeek(t,r.nextWeekGoals);return}catch(n){throw console.error(`Error updating Weekly Review frontmatter in ${t}:`,n),n}}async syncGoalsToNextWeek(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof xd.TFile))return;let a=await this.extractWeeklyReviewData(n);if(!(a!=null&&a.date))return;let o=a.date.split("-").map(d=>parseInt(d,10)),i=new Date(o[0],o[1]-1,o[2]),s=new Date(i);s.setDate(s.getDate()+7);let l=this.getWeeklyReviewPath(s),c=this.app.vault.getAbstractFileByPath(l);c instanceof xd.TFile&&(await this.app.fileManager.processFrontMatter(c,d=>{d.previousGoals=r||[]}),await Wt(this.app,c),p0(l))}catch(n){console.warn("Warning: Failed to sync goals to next week:",n)}}async getDRCsForWeek(t){var r;try{let n=pn(t),a=new Date(n);a.setDate(a.getDate()+6);let o=this.formatDateForDisplay(n),i=this.formatDateForDisplay(a),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!d||d.type!=="drc")continue;let u=d.date;u&&u>=o&&u<=i&&l.push({file:c,data:d})}return l.sort((c,d)=>c.data.date.localeCompare(d.data.date)),l}catch(n){return console.error("Error getting DRCs for week:",n),[]}}async getTradesForWeek(t){var r;try{let n=pn(t),a=new Date(n);a.setDate(a.getDate()+6),a.setHours(23,59,59,999);let o=this.formatDateForDisplay(n),i=this.formatDateForDisplay(a),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!(!d||d.type!=="trade")){if(d.entryTime){let u=new Date(d.entryTime),p=xt(u,this.plugin),m=this.formatDateForDisplay(p);m>=o&&m<=i&&l.push(c)}else if(d.date){let u=new Date(d.date),p=this.formatDateForDisplay(u);p>=o&&p<=i&&l.push(c)}}}return l}catch(n){return console.error("Error getting trades for week:",n),[]}}async openWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}getNextWeekReviewPath(t){let r=pn(t),n=new Date(r);return n.setDate(n.getDate()+7),this.getWeeklyReviewPath(n)}getPreviousWeekReviewPath(t){let r=pn(t),n=new Date(r);return n.setDate(n.getDate()-7),this.getWeeklyReviewPath(n)}async getAdjacentWeeklyReview(t,r,n){var a,o,i;try{let s=r<0?this.getPreviousWeekReviewPath(t):this.getNextWeekReviewPath(t);if(await this.app.vault.adapter.exists(s))return s;if((i=n!=null?n:(o=(a=this.plugin.settings)==null?void 0:a.weekly)==null?void 0:o.autoCreateWeeklyReviewOnNavigation)!=null?i:!0){let d=pn(t),u;return r<0?(u=new Date(d),u.setDate(u.getDate()-7)):(u=new Date(d),u.setDate(u.getDate()+7)),await this.createWeeklyReview(u),s}return null}catch(s){return console.error("Error getting adjacent weekly review:",s),null}}async saveWeeklyReviewImage(t,r,n){try{let a=pn(r),o=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),s=Ts(a),l=n.replace(/[^a-zA-Z0-9]/g,""),c=`${this.JOURNALIT_FOLDER}/${o}/${i}/${s}/media`;return await $r.saveImage(t,c,`${s}-${l}`,void 0)}catch(a){throw console.error("Error saving weekly review image:",a),a}}async saveWeeklyReviewImages(t,r,n){try{let a=[];for(let o of t){let i=await this.saveWeeklyReviewImage(o,r,n);a.push(i)}return a}catch(a){throw console.error("Error saving multiple weekly review images:",a),a}}async deleteImage(t){try{await $r.deleteImage(t,!0)}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}async deleteEmptyFolder(t){try{await $r.deleteEmptyFolder(t,this.JOURNALIT_FOLDER)}catch(r){console.error(`Error deleting empty folder ${t}:`,r)}}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=`${n}-Review.md`;return(0,xd.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${a}`)}};var lc=require("obsidian");Lu();Ft();Za();Ss();var f0=class extends si{constructor(r,n,a={}){super(r,{...a,namespace:"monthly-reviews",cacheTTL:5*60*1e3,persistCache:!0});this.lastCacheClear=0;this.monthlyDataCache=new Map;this.plugin=n,document.addEventListener("journalit:monthly-review-opened",async()=>{let o=Date.now();(!this.lastCacheClear||o-this.lastCacheClear>5e3)&&(await this.clearCache(),this.monthlyDataCache.clear(),this.lastCacheClear=o)})}defaultFrontmatter(){let r=new Date;return{type:"monthly-review",date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear(),reviewQuestions:{},monthlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextMonthGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"monthly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="monthly-review"}async clearCache(){await super.clearCache(),this.monthlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getMonthlyReviewPath(r){let n=r.getFullYear(),a=(r.getMonth()+1).toString().padStart(2,"0");return(0,lc.normalizePath)(`!Journalit/${n}/${a}/${a}-Review.md`)}async createMonthlyReview(r){let n=this.getMonthlyReviewPath(r),a=this.app.vault.getAbstractFileByPath(n);if(a instanceof lc.TFile)return a;await this.ensureDirectoryExists(n);let o={...this.defaultFrontmatter(),date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear()},i=this.generateInitialContent(o);try{return await this.app.vault.create(n,i)}catch(s){return console.error("Error creating monthly review:",s),null}}generateMonthlyReviewTags(r,n){let a=[],o=new Date(n,r-1,1);a.push([Wm(Rm.MONTHLY)]);let i=vl(o);i.length>0&&a.push(i);let s=Math.ceil(r/3);return a.push([`q${s}-review`]),r===1?a.push(["year-start"]):r===12&&a.push(["year-end"]),yl(...a)}generateInitialContent(r){let n=new Date(r.year,r.month-1).toLocaleDateString("en-US",{month:"long"}),a=this.generateMonthlyReviewTags(r.month,r.year);return`---
type: ${r.type}
date: ${r.date}
month: ${r.month}
year: ${r.year}
tags: [${a.map(o=>`"${o}"`).join(", ")}]
reviewQuestions: {}
monthlyGoals: []
keyFocusAreas: []
biggestAccomplishment: ""
biggestChallenge: ""
lessonsLearned: []
nextMonthGoals: []
areasOfImprovement: []
---

# ${n} ${r.year} Review

## Overview
*Monthly performance metrics and analysis will appear here.*

## Review
*Reflect on your trading performance and lessons learned this month.*

## Goals for Next Month
*Set clear, actionable goals for the upcoming month.*
`}async getMonthlyTrades(r,n){try{let a=new Date(r,n-1,1);new Date(r,n,0).setHours(23,59,59,999);let i=[],s=this.app.vault.getMarkdownFiles();for(let l of s)try{let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if((d==null?void 0:d.type)==="trade"&&d.entryTime){let u=new Date(d.entryTime);if(isNaN(u.getTime()))continue;let p=xt(u,this.plugin);if(p.getFullYear()===r&&p.getMonth()+1===n){let m=d.exitTime?new Date(d.exitTime):u,h=d.pnl===void 0||d.pnl===null,f={instrument:d.instrument||d.ticker,direction:d.direction||d.side,entryTime:u,exitTime:m,entryPrice:d.entryPrice||0,exitPrice:d.exitPrice!==void 0&&d.exitPrice!==null?d.exitPrice:0,positionSize:d.positionSize||0,pnl:d.pnl!==void 0&&d.pnl!==null?d.pnl:0,setup:d.setup,tags:d.tags,mistake:d.mistake,path:l.path,tradeStatus:d.tradeStatus,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits,_originalPnlWasNull:h};i.push(f)}}}catch(c){console.warn(`Error processing trade file ${l.path}:`,c);continue}return i}catch(a){return console.error("Error getting monthly trades:",a),[]}}async getWeeklyPerformance(r,n){var a,o;try{let i=await this.getMonthlyTrades(r,n);if(i.length===0)return console.log(`No trades found for ${r}-${String(n).padStart(2,"0")}`),[];let s=new Map,l=(a=this.plugin)!=null&&a.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(o=this.plugin)==null?void 0:o.weeklyReviewService;return i.forEach(c=>{let d=new Date(c.entryTime),u=pn(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==n)return;if(!s.has(p)){let h=new Date(u);h.setDate(h.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:h,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=i.filter(b=>{let v=new Date(b.entryTime);return this.getWeekNumber(v)===d&&v.getMonth()+1===n}),p=u.filter(b=>(b.pnl||0)>0),m=u.filter(b=>(b.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let h=p.reduce((b,v)=>b+(v.pnl||0),0),f=Math.abs(m.reduce((b,v)=>b+(v.pnl||0),0));c.profitFactor=f>0?h/f:h>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(i){return console.error("Error getting weekly performance:",i),[]}}getWeekNumber(r){let n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),a=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-a);let o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-o.getTime())/864e5+1)/7)}async getDemonTrackerData(r,n){var a,o,i;try{let s=(a=this.plugin)==null?void 0:a.drcService;if(!s&&((o=this.plugin)!=null&&o.serviceManager))try{s=await this.plugin.serviceManager.getDRCService()}catch(u){console.warn("Could not get DRC service:",u)}if(!s)return console.log("DRC service not available for demon tracker data"),[];let l=new Date(r,n-1,1),c=new Date(r,n,0),d=new Map;for(let u=new Date(l);u<=c;u.setDate(u.getDate()+1)){let p=s.getDRCNotePath(new Date(u)),m=this.app.vault.getAbstractFileByPath(p);if(m instanceof lc.TFile){let h=this.app.metadataCache.getFileCache(m),f=h==null?void 0:h.frontmatter;if(f&&f.type==="drc"){let b=(i=this.plugin)==null?void 0:i.tradeService;if(b){let v=new Date(u);v.setHours(0,0,0,0);let y=new Date(u);y.setHours(23,59,59,999);let g=await b.getTrades(v,y),w=[];for(let C of g){let k=await b.extractTradeData(C);k&&w.push(k)}w.forEach(C=>{C.mistake&&Array.isArray(C.mistake)&&C.mistake.forEach(k=>{d.has(k)||d.set(k,{mistake:k,occurrences:0,dates:[]});let x=d.get(k);x.occurrences++,x.dates.push(u.toISOString())})})}}}}return Array.from(d.values()).sort((u,p)=>p.occurrences-u.occurrences)}catch(s){return console.error("Error getting demon tracker data:",s),[]}}async getAdjacentMonthlyReview(r,n,a=!0){var c,d;let o=new Date(r);o.setMonth(o.getMonth()+n);let i=this.getMonthlyReviewPath(o);if(this.app.vault.getAbstractFileByPath(i)instanceof lc.TFile)return i;let l=(c=this.plugin)==null?void 0:c.settings;if(a&&((d=l==null?void 0:l.monthly)!=null&&d.autoCreateMonthlyReviewOnNavigation)){let u=await this.createMonthlyReview(o);return u?u.path:null}return null}async getBestPerformingWeek(r,n){let a=await this.getWeeklyPerformance(r,n);return a.length===0?null:a.reduce((o,i)=>i.pnl>o.pnl?i:o)}async getWorstPerformingWeek(r,n){let a=await this.getWeeklyPerformance(r,n);return a.length===0?null:a.reduce((o,i)=>i.pnl<o.pnl?i:o)}async getWeeklyGamePerformance(r,n){var a,o,i,s;try{let l=await this.getWeeklyPerformance(r,n),c=(a=this.plugin)!=null&&a.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(o=this.plugin)==null?void 0:o.weeklyReviewService,d=(i=this.plugin)!=null&&i.serviceManager?await this.plugin.serviceManager.getDRCService():(s=this.plugin)==null?void 0:s.drcService;if(!c||!d)return console.warn("Weekly or DRC service not available for game performance data"),[];let u=[];for(let p of l){let m={A:0,B:0,C:0},h={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:w}of f){let C=new Date(w.date);C.getMonth()+1===n&&C.getFullYear()===r&&(w.mentalGrade&&["A","B","C"].includes(w.mentalGrade)&&m[w.mentalGrade]++,w.technicalGrade&&["A","B","C"].includes(w.technicalGrade)&&h[w.technicalGrade]++)}let b,v,y,g;if(p.weeklyReviewPath){let w=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(w instanceof lc.TFile){let C=await c.extractWeeklyReviewData(w);C&&(b=C.mentalGrade,v=C.technicalGrade,y=C.mentalNotes,g=C.technicalNotes)}}u.push({weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:h,mentalRating:b,technicalRating:v,mentalNotes:y,technicalNotes:g})}return u}catch(l){return console.error("Error getting weekly game performance:",l),[]}}async getMonthlyDataOptimized(r,n){let a=`${r}-${n}`,o=this.monthlyDataCache.get(a);if(o&&Date.now()-o.timestamp<5*60*1e3)return o.data;try{let i=await this.getMonthlyTradesOptimized(r,n),s=await this.calculateWeeklyPerformance(i,r,n),l=this.getDemonTrackerDataFromTrades(i),c=await this.getWeeklyGamePerformanceOptimized(s,r,n),d=s.length>0?s.reduce((m,h)=>h.pnl>m.pnl?h:m):null,u=s.length>0?s.reduce((m,h)=>h.pnl<m.pnl?h:m):null,p={trades:i,weeklyPerformance:s,weeklyGamePerformance:c,demonTrackerData:l,bestWeek:d,worstWeek:u};return this.monthlyDataCache.set(a,{data:p,timestamp:Date.now()}),p}catch(i){return console.error("Error getting optimized monthly data:",i),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async getMonthlyTradesOptimized(r,n){try{let a=[],o=`!Journalit/${r}/${String(n).padStart(2,"0")}`,i=this.app.vault.getMarkdownFiles().filter(l=>l.path.startsWith(o)&&l.path.includes("/trades/")),s=20;for(let l=0;l<i.length;l+=s){let d=i.slice(l,l+s).map(async p=>{try{let m=this.app.metadataCache.getFileCache(p),h=m==null?void 0:m.frontmatter;if((h==null?void 0:h.type)==="trade"&&h.entryTime){let f=new Date(h.entryTime);if(isNaN(f.getTime()))return null;let b=xt(f,this.plugin);if(b.getFullYear()===r&&b.getMonth()+1===n){let v=h.exitTime?new Date(h.exitTime):f,y=h.pnl===void 0||h.pnl===null;return{instrument:h.instrument||h.ticker,direction:h.direction||h.side,entryTime:f,exitTime:v,entryPrice:h.entryPrice||0,exitPrice:h.exitPrice!==void 0&&h.exitPrice!==null?h.exitPrice:0,positionSize:h.positionSize||0,pnl:h.pnl!==void 0&&h.pnl!==null?h.pnl:0,setup:h.setup,tags:h.tags,mistake:h.mistake,path:p.path,tradeStatus:h.tradeStatus,useDirectPnLInput:h.useDirectPnLInput,exits:h.exits,_originalPnlWasNull:y}}}return null}catch(m){return console.warn(`Error processing trade file ${p.path}:`,m),null}}),u=await Promise.all(d);a.push(...u.filter(p=>p!==null))}return a}catch(a){return console.error("Error getting optimized monthly trades:",a),[]}}async calculateWeeklyPerformance(r,n,a){var o,i;try{if(r.length===0)return[];let s=new Map,l=(o=this.plugin)!=null&&o.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(i=this.plugin)==null?void 0:i.weeklyReviewService;return r.forEach(c=>{let d=new Date(c.entryTime),u=pn(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==a)return;if(!s.has(p)){let h=new Date(u);h.setDate(h.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:h,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=r.filter(b=>{let v=new Date(b.entryTime);return this.getWeekNumber(v)===d&&v.getMonth()+1===a}),p=u.filter(b=>(b.pnl||0)>0),m=u.filter(b=>(b.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let h=p.reduce((b,v)=>b+(v.pnl||0),0),f=Math.abs(m.reduce((b,v)=>b+(v.pnl||0),0));c.profitFactor=f>0?h/f:h>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(s){return console.error("Error calculating weekly performance:",s),[]}}async getWeeklyGamePerformanceOptimized(r,n,a){var o,i,s,l;try{let c=(o=this.plugin)!=null&&o.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(i=this.plugin)==null?void 0:i.weeklyReviewService,d=(s=this.plugin)!=null&&s.serviceManager?await this.plugin.serviceManager.getDRCService():(l=this.plugin)==null?void 0:l.drcService;if(!c||!d)return[];let u=r.map(async p=>{let m={A:0,B:0,C:0},h={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:w}of f){let C=new Date(w.date);C.getMonth()+1===a&&C.getFullYear()===n&&(w.mentalGrade&&["A","B","C"].includes(w.mentalGrade)&&m[w.mentalGrade]++,w.technicalGrade&&["A","B","C"].includes(w.technicalGrade)&&h[w.technicalGrade]++)}let b,v,y,g;if(p.weeklyReviewPath){let w=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(w instanceof lc.TFile){let C=await c.extractWeeklyReviewData(w);C&&(b=C.mentalGrade,v=C.technicalGrade,y=C.mentalNotes,g=C.technicalNotes)}}return{weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:h,mentalRating:b,technicalRating:v,mentalNotes:y,technicalNotes:g}});return await Promise.all(u)}catch(c){return console.error("Error getting optimized weekly game performance:",c),[]}}getDemonTrackerDataFromTrades(r){try{let n=new Map;return r.forEach(a=>{a.mistake&&Array.isArray(a.mistake)&&a.mistake.forEach(o=>{n.has(o)||n.set(o,{mistake:o,occurrences:0,dates:[]});let i=n.get(o);i.occurrences++,i.dates.push(a.entryTime.toISOString())})}),Array.from(n.values()).sort((a,o)=>o.occurrences-a.occurrences)}catch(n){return console.error("Error processing demon tracker data from trades:",n),[]}}async updateMonthlyReviewFrontmatter(r,n){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof lc.TFile))throw new Error(`Monthly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(a,o=>{Object.assign(o,n)}),await Wt(this.app,a),await this.clearCache(),this.monthlyDataCache.clear();return}catch(a){throw console.error(`Error updating Monthly Review frontmatter in ${r}:`,a),a}}};Iu();var Rv=require("obsidian");Cu();wm();var g0=class{constructor(t,r){this.fields={...fu};this.fieldOptions={};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadFields(),this.loadFieldOptions()}getFieldsKey(){return this.namespace?`customTradeFields_${this.namespace}`:"customTradeFields"}loadFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...fu,...r.settings[t]};this.fields.fields=(n.fields||[]).filter(a=>this.isValidFieldDefinition(a)).sort((a,o)=>a.order-o.order)}else if(!this.namespace&&r.settings&&r.settings.customTradeFields){let n={...fu,...r.settings.customTradeFields};this.fields.fields=(n.fields||[]).filter(a=>this.isValidFieldDefinition(a)).sort((a,o)=>a.order-o.order)}}catch(t){console.error("[CustomFieldsService] Failed to load custom fields:",t),this.fields={...fu}}}isValidFieldDefinition(t){return t&&typeof t.id=="string"&&typeof t.label=="string"&&typeof t.type=="string"&&Object.values(Gh).includes(t.type)&&typeof t.order=="number"}validateRegexPattern(t){if(!t)return!0;try{let r=[/\(\?\!\.\*\)\.\*/,/\(\.\*\)\+/,/\.\*\.\*/,/\(\.\+\)\+/,/\(\?\!\.\+\)\.\+/];for(let o of r)if(o.test(t))return!1;let n=Date.now();return new RegExp(t),!(Date.now()-n>50)}catch(r){return console.warn("[CustomFieldsService] Invalid regex pattern:",t,r),!1}}async saveFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fields},await r.saveSettings();else{let o={...await this.plugin.loadData()||{},[t]:this.fields};await this.plugin.saveData(o)}br().workspace.trigger("journalit-custom-fields-changed",this.fields)}catch(t){throw console.error("[CustomFieldsService] Failed to save custom fields:",t),new Rv.Notice("Failed to save custom fields"),t}}getFields(){return[...this.fields.fields].sort((t,r)=>t.order-r.order)}getField(t){return this.fields.fields.find(r=>r.id===t)}async addField(t){var o;let r=t.label||"New Field",n=this.fields.fields.map(i=>i.fieldKey||nd(i.label));if((o=t.validation)!=null&&o.pattern&&!this.validateRegexPattern(t.validation.pattern))throw new Error(`Invalid or potentially dangerous regex pattern: ${t.validation.pattern}`);let a={id:t.id||TD(),label:r,fieldKey:t.fieldKey||xm(r,n),type:t.type||"text",validation:t.validation||{},options:t.options||[],allowCreateOptions:t.allowCreateOptions,placeholder:t.placeholder,helperText:t.helperText,order:t.order||Date.now()};return this.fields.fields.push(a),await this.saveFields(),a}async updateField(t,r){var a;let n=this.fields.fields.findIndex(o=>o.id===t);if(n===-1)return console.error(`Field with ID ${t} not found`),null;if((a=r.validation)!=null&&a.pattern&&!this.validateRegexPattern(r.validation.pattern))throw new Error(`Invalid or potentially dangerous regex pattern: ${r.validation.pattern}`);if(r.fieldKey!==void 0){let o=gw(r.fieldKey);if(o)throw new Error(`Invalid field key: ${o}`);if(this.fields.fields.filter((l,c)=>c!==n).map(l=>l.fieldKey||nd(l.label)).includes(r.fieldKey))throw new Error(`Field key '${r.fieldKey}' is already in use by another custom field`)}return this.fields.fields[n]={...this.fields.fields[n],...r,id:t},await this.saveFields(),this.fields.fields[n]}async removeField(t){let r=this.fields.fields.length;return this.fields.fields=this.fields.fields.filter(n=>n.id!==t),this.fields.fields.length<r?(await this.saveFields(),await this.removeAllFieldOptions(t),!0):!1}async reorderFields(t){let r=new Map(this.fields.fields.map(a=>[a.id,a])),n=[];t.forEach((a,o)=>{let i=r.get(a);i&&(n.push({...i,order:o}),r.delete(a))}),r.forEach((a,o)=>{n.push({...a,order:n.length})}),this.fields.fields=n,await this.saveFields()}validateFieldValues(t){let r={};return this.fields.fields.forEach(n=>{let a=t[n.id],o=hw(a,n);o&&(r[n.id]=o)}),r}getFieldsByType(t){return this.getFields().filter(r=>r.type===t)}hasFields(){return this.fields.fields.length>0}async resetFields(){this.fields.fields=[],await this.saveFields()}exportFields(){return JSON.stringify(this.fields,null,2)}async importFields(t){try{let r=JSON.parse(t);if(!r.fields||!Array.isArray(r.fields))throw new Error("Invalid custom fields data format");let n=r.fields.filter(a=>{var o;return this.isValidFieldDefinition(a)?(o=a.validation)!=null&&o.pattern&&!this.validateRegexPattern(a.validation.pattern)?(console.warn(`Skipping field "${a.label}" due to invalid or dangerous regex pattern: ${a.validation.pattern}`),!1):!0:!1});n.length!==r.fields.length&&new Rv.Notice(`Imported ${n.length} valid fields out of ${r.fields.length} total`),this.fields.fields=n.sort((a,o)=>a.order-o.order),await this.saveFields(),new Rv.Notice(`Successfully imported ${n.length} custom fields`)}catch(r){throw console.error("Failed to import custom fields:",r),new Rv.Notice("Failed to import custom fields: "+r.message),r}}getFieldOptionsKey(){return this.namespace?`customFieldOptions_${this.namespace}`:"customFieldOptions"}loadFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;r.settings&&r.settings[t]?this.fieldOptions={...r.settings[t]}:this.fieldOptions={}}catch(t){console.error("[CustomFieldsService] Failed to load custom field options:",t),this.fieldOptions={}}}async saveFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fieldOptions},await r.saveSettings();else{let a={...await this.plugin.loadData()||{},[t]:this.fieldOptions};await this.plugin.saveData(a)}}catch(t){throw console.error("[CustomFieldsService] Failed to save custom field options:",t),t}}getFieldOptions(t){return this.fieldOptions[t]||[]}async addFieldOption(t,r){let n=r.trim();return!n||(this.fieldOptions[t]||(this.fieldOptions[t]=[]),this.fieldOptions[t].some(o=>o.toLowerCase()===n.toLowerCase()))?!1:(this.fieldOptions[t].push(n),await this.saveFieldOptions(),!0)}async removeFieldOption(t,r){if(!this.fieldOptions[t])return!1;let n=this.fieldOptions[t].length;this.fieldOptions[t]=this.fieldOptions[t].filter(o=>o.toLowerCase()!==r.toLowerCase());let a=n!==this.fieldOptions[t].length;return a&&await this.saveFieldOptions(),a}async removeAllFieldOptions(t){this.fieldOptions[t]&&(delete this.fieldOptions[t],await this.saveFieldOptions())}getFieldsWithCustomOptions(){return this.getFields().filter(t=>(t.type==="dropdown"||t.type==="multiselect")&&t.allowCreateOptions)}};var ma=require("obsidian");Ja();So();var Ge=_(B()),Wv=require("obsidian");Ja();Iu();yo();Cu();Ft();var cZ=({accountInfo:e,existingAccounts:t=[],availableAccountTypes:r=[],onLink:n,onCancel:a})=>{let[o,i]=(0,Ge.useState)("new"),[s,l]=(0,Ge.useState)(""),[c,d]=(0,Ge.useState)(""),[u,p]=(0,Ge.useState)(r.length>0?r[0]:"demo"),[m,h]=(0,Ge.useState)(!1),f=(0,Ge.useMemo)(()=>t.length>0,[t]),b=(0,Ge.useMemo)(()=>f?"new":"default",[f]),v=g=>{i(g),g!=="existing"&&d("")};Ge.default.useEffect(()=>{r.length>0&&!r.includes(u)&&p(r[0])},[r,u]);let y=async()=>{var g;h(!0);try{let w="",C,k;switch(o){case"new":w=s||`Account-${e.accountId}`,k=u;break;case"existing":if(!c){new Wv.Notice("Please select an existing account"),h(!1);return}C=c,w=((g=t.find(x=>x.path===c))==null?void 0:g.name)||"";break;case"default":w=`Account-${e.accountId}`,k=u;break}await n(e.accountId,w,C,k)}catch(w){console.error("Failed to link account:",w),new Wv.Notice("Failed to link account: "+w.message)}finally{h(!1)}};return Ge.default.createElement("div",{className:"account-link-modal"},Ge.default.createElement("h3",null,"New Trading Account Detected"),Ge.default.createElement("div",{className:"account-info"},Ge.default.createElement("p",null,Ge.default.createElement("strong",null,"Account ID:")," ",e.accountId),e.brokerName&&Ge.default.createElement("p",null,Ge.default.createElement("strong",null,"Broker:")," ",e.brokerName),e.firstSeen&&Ge.default.createElement("p",null,Ge.default.createElement("strong",null,"First Seen:")," ",Fe(new Date(e.firstSeen),Ot()))),Ge.default.createElement("div",{className:"link-options"},Ge.default.createElement("div",{className:"modal-field"},Ge.default.createElement("label",{className:"section-label"},"How would you like to handle this account?"),Ge.default.createElement("div",{className:"link-option-group"},Ge.default.createElement("label",{className:"link-option"},Ge.default.createElement("input",{type:"radio",name:"linkOption",value:"new",checked:o==="new",onChange:()=>v("new")}),Ge.default.createElement("span",null,"Create new account with custom name")),o==="new"&&Ge.default.createElement("div",{className:"custom-name-input"},Ge.default.createElement("input",{type:"text",value:s,onChange:g=>l(g.target.value),placeholder:"e.g., FTMO Challenge",className:"modal-input"}),Ge.default.createElement("div",{className:"account-type-select"},Ge.default.createElement("label",{className:"field-label"},"Account Type:"),Ge.default.createElement("select",{value:u,onChange:g=>p(g.target.value),className:"modal-select"},r.map(g=>Ge.default.createElement("option",{key:g,value:g},g.charAt(0).toUpperCase()+g.slice(1)))))),Ge.default.createElement("label",{className:"link-option"},Ge.default.createElement("input",{type:"radio",name:"linkOption",value:"existing",checked:o==="existing",onChange:()=>v("existing"),disabled:!f}),Ge.default.createElement("span",null,"Link to existing account ",f?"":"(no accounts available)")),o==="existing"&&f&&Ge.default.createElement("div",{className:"existing-account-select"},Ge.default.createElement("select",{value:c,onChange:g=>{d(g.target.value)},className:"modal-select"},Ge.default.createElement("option",{value:""},"Select an account..."),t.map(g=>Ge.default.createElement("option",{key:g.path,value:g.path},g.name))),t.length===0&&Ge.default.createElement("div",{className:"no-accounts-message"},"No existing accounts found. Create a new account instead.")),Ge.default.createElement("label",{className:"link-option"},Ge.default.createElement("input",{type:"radio",name:"linkOption",value:"default",checked:o==="default",onChange:()=>v("default")}),Ge.default.createElement("span",null,"Use default name: Account-",e.accountId)),o==="default"&&Ge.default.createElement("div",{className:"account-type-select"},Ge.default.createElement("label",{className:"field-label"},"Account Type:"),Ge.default.createElement("select",{value:u,onChange:g=>p(g.target.value),className:"modal-select"},r.map(g=>Ge.default.createElement("option",{key:g,value:g},g.charAt(0).toUpperCase()+g.slice(1)))))))),Ge.default.createElement("div",{className:"modal-actions"},Ge.default.createElement(De,{onClick:y,disabled:m,variant:"primary"},m?"Linking...":"Confirm"),Ge.default.createElement(De,{onClick:a,disabled:m,variant:"secondary"},"Cancel")))},h0=class extends Wv.Modal{constructor(r,n,a,o){super(r);this.existingAccounts=[];this.availableAccountTypes=[];this.accountInfo=n,this.onLink=a,this.onCancel=o}async onOpen(){let{contentEl:r}=this;r.empty(),await this.loadExistingAccounts(),await this.loadAvailableAccountTypes();let{injectAccountLinkModalStyles:n}=(KE(),Wb(JR));n();let a=r.createDiv(),{createRoot:o}=vo();o(a).render(Ge.default.createElement(cZ,{accountInfo:this.accountInfo,existingAccounts:this.existingAccounts,availableAccountTypes:this.availableAccountTypes,onLink:async(s,l,c,d)=>{await this.onLink(s,l,c,d),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}async loadExistingAccounts(){try{let r=br().plugins.plugins.journalit,n=r==null?void 0:r.accountPageService;if(!n){console.warn("AccountPageService not available for loading existing accounts"),this.existingAccounts=[];return}let a=await n.getAllEnhancedAccounts();if(!a||!Array.isArray(a)){console.warn("Invalid accounts data received:",a),this.existingAccounts=[];return}this.existingAccounts=a.map(o=>{let i=o.accountName||o.name||`Account-${o.id||"Unknown"}`;return{path:o.notePath||"",name:i}})}catch(r){console.error("Failed to load existing accounts:",r),this.existingAccounts=[]}}async loadAvailableAccountTypes(){try{let r=br().plugins.plugins.journalit,n=r==null?void 0:r.optionsService;if(!n){console.warn("Options service not available - using default account types"),this.availableAccountTypes=["demo","evaluation","funded"];return}let a=n.getOptions("account_type");a&&a.length>0?this.availableAccountTypes=a:(console.warn("No custom account types found. Using default account types."),this.availableAccountTypes=["demo","evaluation","funded"])}catch(r){console.error("Failed to load available account types:",r),this.availableAccountTypes=["demo","evaluation","funded"]}}onClose(){let{contentEl:r}=this;r.empty()}};sc();var Ym=require("obsidian");sc();var Uv=class{constructor(t,r){this.tradeSyncMapping={};this.tradeFileCache=new Map;this.cacheBuilt=!1;this.plugin=t,this.settings=r}async loadSyncMapping(){let t=this.settings.tradeSyncMapping;t&&(this.tradeSyncMapping=t),await this.rebuildSyncMapping()}async buildTradeFileCache(){this.tradeFileCache.clear();try{let r=this.plugin.app.vault.getMarkdownFiles().filter(o=>this.isTradeFile(o));console.log(`Found ${r.length} trade files to cache`);let n=20,a=[];for(let o=0;o<r.length;o+=n)a.push(r.slice(o,o+n));for(let[o,i]of a.entries()){let s=i.map(async l=>{try{let c=await this.plugin.app.vault.read(l),d=this.parseTradeFromMarkdown(c);if(d&&d.instrument&&d.entryTime&&d.entryPrice){let u=new Date(d.entryTime),p=`${d.instrument}-${u.getTime()}-${d.entryPrice}`;this.tradeFileCache.set(p,{path:l.path,metadata:d,symbol:d.instrument,entryTime:u,entryPrice:parseFloat(d.entryPrice)})}}catch(c){console.warn(`Error caching trade file ${l.path}:`,c)}});await Promise.all(s),o<a.length-1&&await new Promise(l=>setTimeout(l,10))}this.cacheBuilt=!0}catch(t){console.error("Error building trade file cache:",t),this.cacheBuilt=!1}}clearTradeFileCache(){this.tradeFileCache.clear(),this.cacheBuilt=!1}async rebuildSyncMapping(){let t=this.plugin.app.vault.getMarkdownFiles().filter(n=>this.isTradeFile(n));if(t.length===0){this.tradeSyncMapping={},await this.saveSyncMapping();return}let r={};for(let n of t)try{let a=await this.plugin.app.vault.read(n),o=this.parseTradeFromMarkdown(a);o&&o.backendTradeId&&(r[o.backendTradeId]=n.path)}catch(a){console.error("Error reading trade file for sync mapping:",a)}this.tradeSyncMapping=r,await this.saveSyncMapping()}async saveSyncMapping(){this.settings.tradeSyncMapping=this.tradeSyncMapping,await this.plugin.saveSettings()}getSyncMapping(){return this.tradeSyncMapping}addMapping(t,r){this.tradeSyncMapping[t]=r}removeMapping(t){delete this.tradeSyncMapping[t]}getFilePathForTrade(t){return this.tradeSyncMapping[t]}async fetchAllTrades(t){var i;let r=[],n=0,a=100,o=!0;for(;o;){let s=Le.buildUrl("/api/v1/trades",{limit:a,offset:n}),l=await Le.makeRequest(s,{method:"GET"},"fetch trades");if(!l||!l.trades){console.warn("Invalid response from trades API:",l);break}Array.isArray(l.trades)&&r.push(...l.trades),o=((i=l.pagination)==null?void 0:i.has_more)||!1,n+=a}return r}isTradeFile(t){return t.path.includes("!Journalit/")&&t.path.includes("/trades/")&&t.extension==="md"}parseTradeFromMarkdown(t){try{let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)return null;let n=r[1],a={},o=n.split(`
`);for(let i of o){let s=i.indexOf(":");if(s===-1)continue;let l=i.substring(0,s).trim(),c=i.substring(s+1).trim();if(!(!l||!c))if(c.startsWith("[")&&c.endsWith("]")){let d=c.substring(1,c.length-1).trim();d?a[l]=d.split(",").map(u=>u.trim()):a[l]=[]}else a[l]=c}return a.type==="trade"&&a.instrument&&a.direction?(a.backendTradeId&&(a.backendTradeId=parseInt(a.backendTradeId)),a):null}catch(r){return console.error("Error parsing trade markdown:",r),null}}async findExistingTradeFile(t,r,n,a,o){return this.cacheBuilt?this.findExistingTradeFileFromCache(t):this.findExistingTradeFileFromDisk(t,r,n,a,o)}findExistingTradeFileFromCache(t){let r=this.getFilePathForTrade(t.id);if(r){let l=this.plugin.app.vault.getAbstractFileByPath(r);if(l instanceof Ym.TFile)return l.path;this.removeMapping(t.id)}let n=new Date(t.entry_time),a=`${t.symbol}-${n.getTime()}-${t.entry_price}`,o=this.tradeFileCache.get(a);if(o)return o.path;let i=6e4,s=1e-5;for(let[l,c]of this.tradeFileCache.entries())if(c.symbol===t.symbol){let d=Math.abs(c.entryTime.getTime()-n.getTime()),u=Math.abs(c.entryPrice-t.entry_price);if(d<i&&u<s)return c.path}return null}async findExistingTradeFileFromDisk(t,r,n,a,o){let i=`!Journalit/${n}/${a}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(i);if(s&&s instanceof Ym.TFolder){let l=`${t.symbol}-${r}-T`,c=this.getFilePathForTrade(t.id);if(c){let m=this.plugin.app.vault.getAbstractFileByPath(c);if(m instanceof Ym.TFile)return m.path;this.removeMapping(t.id)}let d=s.children.filter(m=>m instanceof Ym.TFile&&m.name.startsWith(l));if(d.length===0)return null;let u=d.map(async m=>{try{let h=await this.plugin.app.vault.read(m),f=this.parseTradeFromMarkdown(h);if(f){if(f.backendTradeId&&f.backendTradeId===t.id)return m.path;let b=new Date(f.entryTime),v=new Date(t.entry_time),y=Math.abs(b.getTime()-v.getTime()),g=Math.abs(parseFloat(f.entryPrice)-t.entry_price)<1e-5,w=f.instrument===t.symbol;if(y<6e4&&g&&w)return m.path}}catch(h){console.warn(`Error checking trade file ${m.path}:`,h)}return null});return(await Promise.all(u)).find(m=>m!==null)||null}return null}};sc();var qv=class{constructor(t,r){this.plugin=t,this.settings=r}getAccountDisplayName(t){return this.settings.accountMapping&&this.settings.accountMapping[t]?this.settings.accountMapping[t]:`Account-${t}`}async createAccountMapping(t,r){this.settings.accountMapping||(this.settings.accountMapping={}),this.settings.accountMapping[t]=r,await this.plugin.saveSettings()}async updateAccountMappings(t){this.settings.accountMapping||(this.settings.accountMapping={});let r=!1;for(let n of t)n.displayName&&(!this.settings.accountMapping[n.accountId]||this.settings.accountMapping[n.accountId]!==n.displayName)&&(this.settings.accountMapping[n.accountId]=n.displayName,r=!0);r&&await this.plugin.saveSettings()}async fetchUserAccounts(){try{let t=Le.buildUrl("/api/v1/mt-accounts"),r=await Le.makeRequest(t,{method:"GET"},"fetch user accounts");if(!r)return[];let a=(r.accounts||[]).map(o=>({accountId:o.accountId||o.account_id||o.mt_account_id||"",displayName:o.displayName||o.display_name||`Account-${o.account_id||o.mt_account_id||"Unknown"}`,brokerName:o.brokerName||o.broker_name,firstSeen:o.firstSeen||o.first_seen,lastSeen:o.lastSeen||o.last_seen}));return a.length>0&&console.log(`\u2705 Found ${a.length} MT accounts`),a}catch(t){throw console.error("\u274C Failed to fetch MT accounts:",t instanceof Error?t.message:String(t)),new Error(`Failed to fetch MT accounts: ${t instanceof Error?t.message:String(t)}`)}}async updateAccountDisplayName(t,r,n){try{let a=Le.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}`);return await Le.makeRequest(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:r})},"update account display name"),await this.createAccountMapping(t,r),!0}catch(a){throw console.error("Failed to update account display name:",a),a}}async getAccountTrades(t,r,n=100,a=0){try{let o=Le.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}/trades`,{limit:n,offset:a}),i=await Le.makeRequest(o,{method:"GET"},"fetch account trades");return i?i.trades||[]:[]}catch(o){throw console.error("Failed to fetch account trades:",o),o}}checkForNewAccounts(t){let r=[];for(let n of t)(!this.settings.accountMapping||!this.settings.accountMapping[n])&&r.push(n);return r}};var JE=require("obsidian");sc();var Hv=class{constructor(t,r){this.plugin=t,this.settings=r}async getFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,a={};n&&(a.Authorization=`Bearer ${n}`);let o=Le.buildUrl(`/api/v1/ftp-users/${t}`),i=await Le.makeRequest(o,{method:"GET",headers:a},"get FTP credentials");return i?{user_id:i.user_id,username:i.username,server:i.server||"sync.journalit.co",port:i.port||2121,lastPasswordReset:i.last_password_reset}:null}catch(n){if(console.error("Failed to get FTP credentials:",n),this.settings.ftpUsername)return null;if(n instanceof Error&&n.message.includes("404"))return await this.createFTPUser(t);throw n}}async createOrGetFTPUser(){var t;try{let r=(t=this.plugin.authManager.getAuthState().token)==null?void 0:t.access_token,n={"Content-Type":"application/json"};r&&(n.Authorization=`Bearer ${r}`);let a=Le.buildUrl("/api/v1/ftp-users/auto-create"),o=await Le.makeRequest(a,{method:"POST",headers:n,body:JSON.stringify({username:`journalit${Date.now()}${Math.floor(Math.random()*1e3)}`})},"create or get FTP user");if(!o)return null;let i={user_id:o.user_id,username:o.username,password:o.password,server:o.server||"sync.journalit.co",port:o.port||2121,lastPasswordReset:o.last_password_reset||new Date().toISOString()};return o.user_id&&this.settings&&(this.settings.ftpUserId=o.user_id,await this.plugin.saveSettings()),i}catch(r){return console.error("Failed to create or get FTP user:",r),null}}async autoCreateFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,a={"Content-Type":"application/json"};n&&(a.Authorization=`Bearer ${n}`);let o=Le.buildUrl("/api/v1/ftp-users/auto-create"),i=await Le.makeRequest(o,{method:"POST",headers:a,body:JSON.stringify({username:t})},"auto-create FTP user");return i?{username:i.username,password:i.password,server:i.server||"sync.journalit.co",port:i.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){return console.error("Failed to auto-create FTP user:",n),new JE.Notice("\u274C Failed to create FTP credentials"),null}}async createFTPUser(t){var r;try{let n=await this.getFTPUserAccountId();if(!n)return console.error("Could not determine account ID for FTP user creation"),null;let a=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,o={"Content-Type":"application/json"};a&&(o.Authorization=`Bearer ${a}`);let i=Le.buildUrl("/api/v1/ftp-users/create"),s=await Le.makeRequest(i,{method:"POST",headers:o,body:JSON.stringify({user_id:n})},"create FTP user");return s?{username:s.username,password:s.password,server:s.server||"sync.journalit.co",port:s.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){return console.error("Failed to create FTP user:",n),null}}async resetFTPPassword(t){var r;try{let n=this.settings.ftpUsername||t,a=this.settings.ftpUserId;if(!a&&n){let c=await this.getFTPCredentials(n);c&&c.user_id&&(a=c.user_id,this.settings.ftpUserId=a,await this.plugin.saveSettings())}if(!a)return console.error("Could not determine FTP user ID. Username:",n),new JE.Notice("\u274C Could not find FTP user. Please try creating new credentials."),null;let o=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={"Content-Type":"application/json"};o&&(i.Authorization=`Bearer ${o}`);let s=Le.buildUrl(`/api/v1/ftp-users/${a}/password`),l=await Le.makeRequest(s,{method:"PUT",headers:i},"reset FTP password");return l?{user_id:a,username:n,password:l.password,server:"sync.journalit.co",port:2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){throw console.error("Failed to reset FTP password:",n),n}}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.plugin.saveSettings(),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}};var XR=require("obsidian");So();var Vv=class{constructor(t,r){this.accountCache=new Map;this.accountCacheTime=0;this.CACHE_TTL=5*60*1e3;this.plugin=t}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(r),i=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,i,n,a,o);return`!Journalit/${n}/${a}/W${o}/trades/${t.symbol}-${i}-T${s}.md`}getNextTradeNumber(t,r,n,a,o){let i=`!Journalit/${n}/${a}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(i),l=0;if(s&&s instanceof XR.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}clearAccountCache(){this.accountCache.clear(),this.accountCacheTime=0}async refreshAccountCache(){let t=Date.now();if(!(this.accountCacheTime>0&&t-this.accountCacheTime<this.CACHE_TTL))try{this.accountCache.clear();let r=this.plugin.settings.backendIntegration;if(r!=null&&r.accountMapping)for(let[a,o]of Object.entries(r.accountMapping))this.accountCache.set(a,o);let n=this.plugin.accountPageService;if(n)try{let a=await n.getAllEnhancedAccounts();for(let o of a){let i=o.accountName||o.name||o.id;if(o.id&&!this.accountCache.has(o.id)&&this.accountCache.set(o.id,i),i.includes("Account-")){let s=i.replace("Account-","");/^\d+$/.test(s)&&!this.accountCache.has(s)&&this.accountCache.set(s,i)}}}catch(a){console.warn("Error loading accounts from AccountPageService:",a)}this.accountCacheTime=t,console.log(`Account cache refreshed with ${this.accountCache.size} mappings`)}catch(r){console.error("Error refreshing account cache:",r)}}async resolveAccountDisplayName(t,r){try{await this.refreshAccountCache();let n=this.accountCache.get(t);if(n)return n;let a=r||`Account-${t}`;return this.accountCache.has(`_notfound_${t}`)||(console.log(`No matching account found for MT account ${t}, using fallback: ${a}`),this.accountCache.set(`_notfound_${t}`,a)),a}catch(n){return console.error("Error resolving account display name:",n),r||`Account-${t}`}}async generateTradeMarkdown(t,r){let n=new Date(t.entry_time),a=t.exit_time?new Date(t.exit_time):null,o=t.direction.toUpperCase()==="BUY"?"long":"short",i=this.determineAssetType(t.symbol),s={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:o,instrument:t.symbol,assetType:i};try{let d=this.plugin.optionsService||new Hn(this.plugin);d.getInstrumentsForAssetType(i).includes(t.symbol)||await d.addOption("instrument",t.symbol,i)}catch(d){console.error(`Failed to add instrument '${t.symbol}' to options:`,d)}if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(s.exitTime=this.formatDateForFrontmatter(t.exit_time),s.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null)){let d=t.profit_loss,u=t.commission||0,p=t.swap||0,m=t.fees||0;s.pnl=d+u+p+m}if(t.entries&&t.entries.length>0?s.entries=t.entries.map(d=>({time:this.formatDateForFrontmatter(d.time),price:d.price,size:d.size})):s.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?s.exits=t.exits.map(d=>({time:this.formatDateForFrontmatter(d.time),price:d.price,size:d.size})):s.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),t.commission!==void 0&&t.commission!==null?s.commission=t.commission:s.commission=0,t.swap!==void 0&&t.swap!==null?s.swap=t.swap:s.swap=0,t.fees!==void 0&&t.fees!==null?s.fees=t.fees:s.fees=0,s.setupIds=[],s.mistakeIds=[],t.mt_account_number){s.accountId=t.mt_account_number;let d=await this.resolveAccountDisplayName(t.mt_account_number,r||t.mt_account_display_name);s.account=[d],s.accountIds=[d]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),s.accountIds=["Unknown Account"],s.account=["Unknown Account"];s.setup=[],s.mistake=[],s.images=[],s.tags=[],s.thesis="",s.lotSize=1e5,s.pipValue=1;let l=`---
`;for(let[d,u]of Object.entries(s))if(u!=null)if(Array.isArray(u))if(u.length===0)l+=`${d}: []
`;else if(d==="entries"||d==="exits"){l+=`${d}:
`;for(let p of u)l+=`  - time: ${p.time}
`,l+=`    price: ${p.price}
`,l+=`    size: ${p.size}
`}else d==="images"?l+=`${d}: [${u.map(p=>`"${p}"`).join(", ")}]
`:l+=`${d}: [${u.map(p=>`${p}`).join(", ")}]
`;else u===""?l+=`${d}: ""
`:l+=`${d}: ${u}
`;l+=`---

`;let c=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;return c+=`Entry: ${t.entry_price} at ${n.toLocaleString()}
`,a?(c+=`Exit: ${t.exit_price} at ${a.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null&&(t.profit_loss>0?c+=`\u2705 Profit: $${t.profit_loss.toFixed(2)}
`:t.profit_loss<0&&(c+=`\u274C Loss: $${Math.abs(t.profit_loss).toFixed(2)}
`))):c+=`Status: Open
`,l+c}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${a}${o}`;case"MMDDYY":return`${a}${n}${o}`;default:return`${o}${a}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let a=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-a.getTime())/864e5+1)/7)}async ensureDirectoryExists(t){var a;let r=t.split("/"),n="";for(let o of r)if(o&&(n+=(n?"/":"")+o,!this.plugin.app.vault.getAbstractFileByPath(n)))try{await this.plugin.app.vault.createFolder(n)}catch(i){if(!((a=i.message)!=null&&a.includes("already exists")))throw i}}determineAssetType(t){let r=t.toUpperCase();return r.includes("/")||r.length===6&&this.isForexCurrency(r.substring(0,3))&&this.isForexCurrency(r.substring(3,6))?"forex":r.endsWith("USDT")||r.endsWith("BTC")||r.endsWith("ETH")||r.includes("CRYPTO")?"crypto":/[0-9]/.test(r)&&(r.startsWith("ES")||r.startsWith("NQ")||r.startsWith("CL")||r.startsWith("GC"))?"futures":"stock"}isForexCurrency(t){return["EUR","USD","GBP","JPY","CHF","CAD","AUD","NZD"].includes(t)}};var Mu=require("obsidian"),Gv=class{constructor(t,r,n){this.lastProcessedFiles=new Set;this.fileCleanupIntervalId=null;this.MAX_TRACKED_FILES=1e3;this.MAX_FILE_AGE_MS=24*60*60*1e3;this.fileProcessTimestamps=new Map;this.plugin=t,this.settings=r,this.tradeSyncService=n}setupFileWatcher(){this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{t instanceof Mu.TFile&&this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{t instanceof Mu.TFile&&this.tradeSyncService.isTradeFile(t)&&!this.lastProcessedFiles.has(t.path)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{t instanceof Mu.TFile&&this.removeFileFromTracking(t.path)})),this.plugin.registerEvent(this.plugin.app.vault.on("rename",(t,r)=>{t instanceof Mu.TFile&&(this.removeFileFromTracking(r),this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t))})),this.startPeriodicCleanup()}async processNewTradeFile(t){var r,n;try{if((n=(r=this.plugin.tradeService)==null?void 0:r.recentlyCreatedFiles)!=null&&n.has(t.path))return;let a=await this.plugin.app.vault.read(t),o=this.tradeSyncService.parseTradeFromMarkdown(a);if(o){this.addFileToTracking(t.path);let i=o.backendTradeId!==void 0;if(!i&&o.pnl&&(o.account||o.accountIds)&&this.plugin.accountPageService)try{let s=o.account||o.accountIds;Array.isArray(s)||(s=s?[s]:[]);for(let l of s)l&&typeof l=="string"&&l.trim()&&await this.plugin.accountPageService.refreshAccountData(l.trim())}catch(s){console.error("Error refreshing account data from manual trade:",s)}this.settings.showNewTradeNotifications&&o.instrument&&o.direction&&!i&&new Mu.Notice(`\u{1F4C8} New trade created: ${o.instrument} ${o.direction}`),this.plugin.app.workspace.trigger("journalit:trade-file-added",o)}}catch(a){console.error("Error processing new trade file:",a)}}async checkForNewTradeFiles(){let t=this.plugin.app.vault.getMarkdownFiles().filter(r=>this.tradeSyncService.isTradeFile(r));for(let r of t)this.lastProcessedFiles.has(r.path)||await this.processNewTradeFile(r)}addFileToTracking(t){this.lastProcessedFiles.add(t),this.fileProcessTimestamps.set(t,Date.now()),this.lastProcessedFiles.size>this.MAX_TRACKED_FILES&&this.performCleanup()}removeFileFromTracking(t){this.lastProcessedFiles.delete(t),this.fileProcessTimestamps.delete(t)}startPeriodicCleanup(){this.fileCleanupIntervalId=window.setInterval(()=>{this.performCleanup()},36e5)}stopPeriodicCleanup(){this.fileCleanupIntervalId!==null&&(window.clearInterval(this.fileCleanupIntervalId),this.fileCleanupIntervalId=null)}performCleanup(){let t=Date.now(),r=[];for(let[n,a]of this.fileProcessTimestamps){if(t-a>this.MAX_FILE_AGE_MS){r.push(n);continue}this.plugin.app.vault.getAbstractFileByPath(n)||r.push(n)}for(let n of r)this.removeFileFromTracking(n);if(this.lastProcessedFiles.size>this.MAX_TRACKED_FILES){let n=Array.from(this.fileProcessTimestamps.entries()).sort((o,i)=>o[1]-i[1]),a=this.lastProcessedFiles.size-Math.floor(this.MAX_TRACKED_FILES*.8);for(let o=0;o<a&&o<n.length;o++)this.removeFileFromTracking(n[o][0])}r.length>0||this.lastProcessedFiles.size>this.MAX_TRACKED_FILES}clearProcessedFiles(){this.lastProcessedFiles.clear(),this.fileProcessTimestamps.clear(),this.stopPeriodicCleanup()}};Dw();Ss();var XE=60,Yv=class{constructor(t){this.syncIntervalId=null;this.isSyncing=!1;this.syncCancelled=!1;this.totalTradesToSync=0;this.tradesProcessedSoFar=0;this.autoContinueTimeoutId=null;this.plugin=t,this.settings=t.settings.backendIntegration,this.tradeSyncService=new Uv(t,this.settings),this.accountManagementService=new qv(t,this.settings),this.ftpManagementService=new Hv(t,this.settings),this.tradeFileGenerator=new Vv(t,this.settings),this.fileWatcherService=new Gv(t,this.settings,this.tradeSyncService),this.tradeSyncService.loadSyncMapping(),this.fileWatcherService.setupFileWatcher(),this.debouncedForceSync=$D(this.forceSync.bind(this),5e3),this.debouncedCheckForNewTrades=$D(this.checkForNewTrades.bind(this),3e4),this.settings.syncEnabled&&XE>0&&this.startAutoSync()}getUserId(){try{let t=this.plugin.app.vault.getName();if(t&&t!=="Obsidian Vault")return t.toLowerCase().replace(/[^a-z0-9]/g,"");let r=this.plugin.app.vault.adapter,n="";if(r&&r.basePath)n=r.basePath;else if(r&&r.path)n=r.path;else return"cursive";return(n.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,"")}catch(t){return this.settings.userId||"cursive"}}getVaultPath(){try{let t=this.plugin.app.vault.adapter;return t&&t.basePath?t.basePath:t&&t.path?t.path:this.plugin.app.vault.getName()||"Unknown Vault"}catch(t){return console.warn("Could not get vault path:",t),"Unknown Vault"}}async registerVault(){var c;let t=(c=this.plugin.authManager.getAuthState().token)==null?void 0:c.access_token;if(!t)return!1;let r=t,n=this.settings.ftpUsername||this.getUserId(),a=this.getVaultPath(),o={vault_path:a,user_id:n,settings:{date_format:this.plugin.settings.trade.dateFormat,enabled:this.settings.syncEnabled}},i={"Content-Type":"application/json"};r&&(i.Authorization=`Bearer ${r}`);let s=Le.buildUrl("/api/v1/obsidian/register-vault");return await Le.makeRequest(s,{method:"POST",headers:i,body:JSON.stringify(o)},"vault registration")?(this.settings.userId=n,this.settings.vaultPath=a,await this.plugin.saveSettings(),this.settings.showSyncNotifications&&new ma.Notice("\u2705 Vault registered with trading server"),!0):!1}cancelSync(){this.isSyncing&&(this.syncCancelled=!0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.settings.showSyncNotifications&&new ma.Notice("\u23F9\uFE0F Sync cancelled"))}async forceSync(t=!1){var r,n;if(!t&&this.isSyncing)return console.warn("Sync already in progress, skipping concurrent sync request"),this.settings.showSyncNotifications&&new ma.Notice("\u26A0\uFE0F Sync already in progress"),null;t||(this.isSyncing=!0,this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.syncCancelled=!1);try{if(!t)try{let k=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,x={};k&&(x.Authorization=`Bearer ${k}`);let S=Le.buildUrl("/api/v1/sync/ftp"),T=await Le.makeRequest(S,{method:"POST",headers:x},"FTP sync trigger");T!=null&&T.success||console.warn("FTP sync failed:",T==null?void 0:T.error)}catch(k){console.warn("Failed to trigger FTP sync:",k)}let a=await this.getFTPUserAccountId();if(!a)return new ma.Notice("\u274C Failed to get account information"),null;let o=await this.tradeSyncService.fetchAllTrades(a),i=[],s=100;for(let k=0;k<o.length;k+=s){let S=o.slice(k,k+s).filter(T=>{let P=this.tradeSyncService.getFilePathForTrade(T.id);return P?!this.plugin.app.vault.getAbstractFileByPath(P):!0});i.push(...S),k+s<o.length&&await new Promise(T=>setTimeout(T,0))}this.totalTradesToSync===0&&(this.totalTradesToSync=i.length);let l=500,c=i.length>l?i.slice(0,l):i,d=i.length>l;if(d){let k=i.length-l;if(console.log(`Processing batch: ${l} trades (${k} remaining)`),this.settings.showSyncNotifications){let x=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new ma.Notice(`\u23F3 Syncing batch: ${l} trades (${x}% complete, ${k} remaining)`)}}else i.length===0&&o.length>0&&(console.log(`All ${o.length} trades are already synced.`),this.settings.showSyncNotifications&&new ma.Notice(`\u2705 All ${o.length} trades are already synced`));await this.tradeSyncService.buildTradeFileCache();let u=[];if(this.syncCancelled)return this.isSyncing=!1,null;let p=new Set;for(let k of c)k.mt_account_number&&typeof k.mt_account_number=="string"&&p.add(k.mt_account_number);let m=this.accountManagementService.checkForNewAccounts(p);if(m.length>0)for(let k of m){let x=c.find(D=>D.mt_account_number===k),S=(x==null?void 0:x.mt_account_display_name)||`Account-${k}`,T={accountId:k,displayName:S,brokerName:"MetaTrader",firstSeen:(x==null?void 0:x.entry_time)||new Date().toISOString()},P=await new Promise(D=>{new h0(this.plugin.app,T,async(L,N,E,I)=>{D(E?{action:"link",linkToPath:E}:N&&N!==S?{action:"create",displayName:N,accountType:I}:{action:"default",accountType:I})},()=>{D({action:"cancel"})}).open()});if(P.action==="cancel")continue;let M=S;if(P.action==="link"&&P.linkToPath){await this.accountManagementService.createAccountMapping(k,P.linkToPath);continue}else P.action==="create"&&P.displayName&&(M=P.displayName);if(await this.accountManagementService.createAccountMapping(k,M),this.plugin.accountPageService)try{T.displayName=M;let D=((n=this.plugin.optionsService)==null?void 0:n.getOptions("account_type"))||[],A=D.length>0?D[0]:"demo";await this.plugin.accountPageService.updateAccountMetadata(M,{name:M,accountType:P.accountType||A,createdDate:new Date,initialBalance:0}),this.settings.showSyncNotifications&&new ma.Notice(`\u{1F4CA} Created account: ${M}`)}catch(D){console.error(`Failed to create Account metadata for ${k}:`,D),u.push(`Failed to create account ${M}: ${D.message}`)}}let h=0,f=0,b=0,v=Date.now(),y=0,g=0,w=0;for(let k=0;k<c.length;k++){let x=c[k];try{let S=Date.now(),T=await this.createTradeFile(x),P=Date.now()-S;T==="created"?(h++,g+=P):T==="updated"?(f++,w+=P):T==="skipped"&&(b++,y+=P),P>1e3&&console.warn(`Slow trade processing: ${x.symbol} ${x.id} took ${P}ms (result: ${T})`)}catch(S){u.push(`Failed to create file for trade ${x.id}: ${S.message}`),console.error(`Failed to create file for trade ${x.id}:`,S)}}if(this.settings.lastSyncTime=new Date().toISOString(),this.settings.syncCount=(this.settings.syncCount||0)+1,await this.plugin.saveSettings(),this.plugin.accountPageService&&c.length>0)try{let k=Date.now();this.tradeFileGenerator.clearAccountCache(),this.tradeSyncService.clearTradeFileCache();let x=new Set;for(let D of c)if(D.mt_account_number){let A=D.mt_account_display_name||this.accountManagementService.getAccountDisplayName(D.mt_account_number)||`Account-${D.mt_account_number}`;x.add(A)}else console.warn(`Trade ${D.id} missing mt_account_number - using fallback account name`),x.add("Unknown Account");console.log(`Batch refreshing ${x.size} accounts after sync of ${c.length} trades`);let S=Array.from(x).map(async D=>{try{return await this.plugin.accountPageService.refreshAccountData(D),D}catch(A){return console.error(`Failed to refresh account ${D}:`,A),null}}),T=(await Promise.all(S)).filter(D=>D!==null),P=Date.now()-k;console.log(`Account refresh completed in ${P}ms for ${T.length} accounts`);let M=new CustomEvent("journalit:accounts-batch-updated",{detail:{accountNames:T,syncedTradeCount:c.length,timestamp:Date.now()}});document.dispatchEvent(M)}catch(k){console.error("Error recalculating account metrics after sync:",k),u.push(`Failed to recalculate metrics: ${k.message}`)}this.tradesProcessedSoFar+=c.length;let C={status:"success",synced_trades:c.length,new_files:h,updated_files:f,errors:u};if(d&&!this.syncCancelled){if(this.settings.showSyncNotifications){let k=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new ma.Notice(`\u23F3 Batch complete: ${this.tradesProcessedSoFar}/${this.totalTradesToSync} trades (${k}%). Continuing...`)}return this.autoContinueTimeoutId=setTimeout(()=>{this.autoContinueTimeoutId=null,this.syncCancelled||(console.log("Auto-continuing sync with next batch..."),this.forceSync(!0))},1e3),C}if(this.settings.showSyncNotifications)if(c.length>0||this.tradesProcessedSoFar>0){let k=this.tradesProcessedSoFar>0?this.tradesProcessedSoFar:c.length,x=new Set(c.map(S=>S.mt_account_number).filter(S=>S!=null)).size;new ma.Notice(`\u2705 Sync complete: ${k} trades processed (${h} new, ${f} updated) across ${x} account(s)`)}else new ma.Notice("\u2705 Sync complete - no new trades found");return this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.isSyncing=!1,C}catch(a){return console.error("Force sync failed:",a),new ma.Notice("\u274C Sync failed: "+a.message),this.isSyncing=!1,this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),null}}async getSyncStatus(){let t=Le.buildUrl("/api/v1/obsidian/status"),r=await Le.makeRequest(t,{method:"GET"},"sync status");return r||null}async checkForNewTrades(){if(this.settings.syncEnabled){if(!this.plugin.authManager.isAuthenticated()){console.warn("Auto-sync skipped: User not authenticated");return}await this.forceSync()}}startAutoSync(){this.syncIntervalId&&window.clearInterval(this.syncIntervalId);let t=XE*60*1e3;this.syncIntervalId=window.setInterval(()=>{this.debouncedCheckForNewTrades()},t)}stopAutoSync(){this.syncIntervalId&&(window.clearInterval(this.syncIntervalId),this.syncIntervalId=null),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel()}async updateSettings(t){let r={...this.settings};Object.assign(this.settings,t),this.plugin.settings.backendIntegration=this.settings,await this.plugin.saveSettings(),r.syncEnabled!==this.settings.syncEnabled&&(this.stopAutoSync(),this.settings.syncEnabled&&XE>0&&this.startAutoSync())}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.ftpManagementService.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.updateSettings({ftpUserId:r.user_id}),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}async createTradeFile(t){let r=this.tradeSyncService.getFilePathForTrade(t.id);if(r){let b=this.plugin.app.vault.getAbstractFileByPath(r);if(b instanceof ma.TFile)return await this.updateExistingTradeFile(b,t);this.tradeSyncService.removeMapping(t.id)}let n=new Date(t.entry_time),a=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),i=this.getWeekNumber(n),s=this.tradeFileGenerator.formatDateForUser(n),l=await this.tradeSyncService.findExistingTradeFile(t,s,a,o,i);if(l){this.tradeSyncService.addMapping(t.id,l),await this.tradeSyncService.saveSyncMapping();let b=this.plugin.app.vault.getAbstractFileByPath(l),v=await this.plugin.app.vault.read(b),y=this.tradeSyncService.parseTradeFromMarkdown(v);if(y&&!y.backendTradeId){let g=v.match(/^---\n([\s\S]*?)\n---/);if(g){let C=g[1].replace(/type: trade/,`type: trade
backendTradeId: ${t.id}`),k=v.replace(g[0],`---
${C}
---`);await this.plugin.app.vault.modify(b,k),await Wt(this.plugin.app,b);let x=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:b.path,timestamp:Date.now()}});document.dispatchEvent(x)}}return await this.updateExistingTradeFile(b,t)}let c=this.tradeFileGenerator.generateTradeFilePath(t);if(this.plugin.app.vault.getAbstractFileByPath(c))return this.tradeSyncService.addMapping(t.id,c),await this.tradeSyncService.saveSyncMapping(),"skipped";let u=t.mt_account_number?this.accountManagementService.getAccountDisplayName(t.mt_account_number):void 0,p=await this.tradeFileGenerator.generateTradeMarkdown(t,u),m=c.substring(0,c.lastIndexOf("/"));await this.tradeFileGenerator.ensureDirectoryExists(m);let h=await this.plugin.app.vault.create(c,p);await Wt(this.plugin.app,h);let f=this.plugin.tradeService;return f&&f.addRecentlyCreatedFile&&f.addRecentlyCreatedFile(c),this.tradeSyncService.addMapping(t.id,c),await this.tradeSyncService.saveSyncMapping(),await this.autoCreateReviewsForSyncedTrade(t),setTimeout(async()=>{let b=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:c,timestamp:Date.now()}});document.dispatchEvent(b)},500),"created"}async updateExistingTradeFile(t,r){let n=await this.plugin.app.vault.read(t),a=this.tradeSyncService.parseTradeFromMarkdown(n);if(!a)return console.warn("Could not parse current trade from markdown"),"skipped";let o=!a.exitTime||a.exitTime==="",i=r.status==="CLOSED"&&r.exit_time;if(o&&i){let s=r.mt_account_number?this.accountManagementService.getAccountDisplayName(r.mt_account_number):void 0,l=await this.tradeFileGenerator.generateTradeMarkdown(r,s);await this.plugin.app.vault.modify(t,l),await Wt(this.plugin.app,t);let c=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:t.path,timestamp:Date.now()}});return document.dispatchEvent(c),"updated"}return"skipped"}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(r),i=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,i,n,a,o);return`!Journalit/${n}/${a}/W${o}/trades/${t.symbol}-${i}-T${s}.md`}getNextTradeNumber(t,r,n,a,o){let i=`!Journalit/${n}/${a}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(i),l=0;if(s&&s instanceof ma.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d instanceof ma.TFile&&d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}generateTradeMarkdown(t){let r=new Date(t.entry_time),n=t.exit_time?new Date(t.exit_time):null,a=t.direction.toUpperCase()==="BUY"?"long":"short",o={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:a,instrument:t.symbol,assetType:"forex",tradeStatus:t.status};if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(o.exitTime=this.formatDateForFrontmatter(t.exit_time),o.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(o.pnl=t.profit_loss)),t.entries&&t.entries.length>0?o.entries=t.entries.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})):o.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?o.exits=t.exits.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})):o.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),o.setupIds=[],o.mistakeIds=[],t.mt_account_number){o.accountId=t.mt_account_number;let l=t.mt_account_display_name||this.getAccountDisplayName(t.mt_account_number)||`Account-${t.mt_account_number}`;o.account=[l],o.accountIds=[l]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),o.accountIds=["Unknown Account"],o.account=["Unknown Account"];o.setup=[],o.mistake=[],o.images=[],o.tags=[],o.lotSize=1e5,o.pipValue=1;let i=`---
`;for(let[l,c]of Object.entries(o))if(c!=null)if(Array.isArray(c))if(c.length===0)i+=`${l}: []
`;else if(l==="entries"||l==="exits"){i+=`${l}:
`;for(let d of c)i+=`  - time: ${d.time}
`,i+=`    price: ${d.price}
`,i+=`    size: ${d.size}
`}else l==="images"?i+=`${l}: [${c.map(d=>`"${d}"`).join(", ")}]
`:i+=`${l}: [${c.map(d=>`${d}`).join(", ")}]
`;else i+=`${l}: ${c}
`;i+=`---

`;let s=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;return s+=`Entry: ${t.entry_price} at ${r.toLocaleString()}
`,n?(s+=`Exit: ${t.exit_price} at ${n.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null&&(t.profit_loss>0?s+=`\u2705 Profit: $${t.profit_loss.toFixed(2)}
`:t.profit_loss<0&&(s+=`\u274C Loss: $${Math.abs(t.profit_loss).toFixed(2)}
`))):s+=`Status: Open
`,i+s}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${a}${o}`;case"MMDDYY":return`${a}${n}${o}`;default:return`${o}${a}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let a=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-a.getTime())/864e5+1)/7)}async getFTPCredentials(t){return this.ftpManagementService.getFTPCredentials(t)}async autoCreateFTPCredentials(t){return this.ftpManagementService.autoCreateFTPCredentials(t)}async resetFTPPassword(t){return this.ftpManagementService.resetFTPPassword(t)}async fetchUserAccounts(){return await this.accountManagementService.fetchUserAccounts()}async updateAccountDisplayName(t,r){var o;let n=this.plugin.authManager.getAuthState(),a=n.isAuthenticated&&((o=n.cache)!=null&&o.userId)?String(n.cache.userId):this.settings.ftpUserId!==void 0&&this.settings.ftpUserId!==null?String(this.settings.ftpUserId):this.settings.userId||this.getUserId();return this.accountManagementService.updateAccountDisplayName(t,r,a)}getAccountDisplayName(t){return this.accountManagementService.getAccountDisplayName(t)}async getAccountTrades(t,r=100,n=0){let a=this.settings.ftpUsername||this.getUserId();return this.accountManagementService.getAccountTrades(t,a,r,n)}async createOrGetFTPUser(){return this.ftpManagementService.createOrGetFTPUser()}getTradeSyncMapping(){return this.tradeSyncService.getSyncMapping()}setTradeSyncMapping(t,r){this.tradeSyncService.addMapping(t,r)}async saveSyncMapping(){await this.tradeSyncService.saveSyncMapping()}async updateAccountMapping(t,r){await this.accountManagementService.createAccountMapping(t,r)}async updateAccountMappings(t){await this.accountManagementService.updateAccountMappings(t)}async relinkAccountTrades(t,r,n){let a=[],o=0;if(r===n)return{updatedCount:0,errors:[]};try{let i=this.plugin.app.vault.getMarkdownFiles().filter(s=>s.path.includes("!Journalit/")&&s.path.includes("/trades/"));for(let s of i)try{let l=await this.plugin.app.vault.read(s),c=this.tradeSyncService.parseTradeFromMarkdown(l);if(!c)continue;if((Array.isArray(c.account)?c.account:c.account?[c.account]:[]).includes(r)){let u=l;if(c.account&&c.account.length>0){let p=l.match(/account:\s*\[(.*?)\]/);if(p){let m=p[0],h=`account: [${n}]`;u=u.replace(m,h)}}if(c.accountIds&&c.accountIds.length>0){let p=l.match(/accountIds:\s*\[(.*?)\]/);if(p){let m=p[0],h=`accountIds: [${n}]`;u=u.replace(m,h)}}if(await this.plugin.app.vault.modify(s,u),await Wt(this.plugin.app,s),o++,this.plugin.accountPageService&&c.pnl!==void 0)try{await this.plugin.accountPageService.refreshAccountData(r),await this.plugin.accountPageService.refreshAccountData(n)}catch(p){console.error("Error refreshing account data after relinking:",p),a.push(`Failed to refresh account data for ${s.path}: ${p.message}`)}}}catch(l){console.error(`Error processing file ${s.path}:`,l),a.push(`${s.path}: ${l.message}`)}if(this.plugin.accountPageService)try{await this.plugin.accountPageService.refreshAccountData(r);let s=new CustomEvent("journalit:account-updated",{detail:{accountName:r,timestamp:Date.now()}});document.dispatchEvent(s),await this.plugin.accountPageService.refreshAccountData(n);let l=new CustomEvent("journalit:account-updated",{detail:{accountName:n,timestamp:Date.now()}});document.dispatchEvent(l)}catch(s){console.error("Error refreshing account data after relinking:",s),a.push(`Failed to refresh account data: ${s.message}`)}}catch(i){throw console.error("Error relinking account trades:",i),i}return{updatedCount:o,errors:a}}async requestForceSync(){return this.debouncedForceSync()}async requestCheckForNewTrades(){return this.debouncedCheckForNewTrades()}async forceSyncImmediate(){return this.debouncedForceSync.cancel(),this.forceSync()}async autoCreateReviewsForSyncedTrade(t){var r,n,a,o,i,s,l;try{let c=new Date(t.entry_time);if((a=(n=(r=this.plugin)==null?void 0:r.settings)==null?void 0:n.drc)!=null&&a.autoCreateOnFirstTrade)try{if(this.plugin.drcService){let d=this.plugin.drcService.getDRCNotePath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.drcService.createDRC(c)}}catch(d){console.error("Failed to auto-create DRC for synced trade:",d)}if((i=(o=this.plugin)==null?void 0:o.settings.weekly)!=null&&i.autoCreateOnFirstTrade)try{if(this.plugin.weeklyReviewService){let d=this.plugin.weeklyReviewService.getWeeklyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.weeklyReviewService.createWeeklyReview(c)}}catch(d){console.error("Failed to auto-create Weekly Review for synced trade:",d)}if((l=(s=this.plugin)==null?void 0:s.settings.monthly)!=null&&l.autoCreateOnFirstTrade)try{if(this.plugin.monthlyReviewService){let d=this.plugin.monthlyReviewService.getMonthlyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.monthlyReviewService.createMonthlyReview(c)}}catch(d){console.error("Failed to auto-create Monthly Review for synced trade:",d)}}catch(c){console.error("Error in auto-create reviews for synced trade:",c)}}cleanup(){this.stopAutoSync(),this.fileWatcherService.clearProcessedFiles(),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel(),this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.isSyncing=!1}};sc();var QR=require("obsidian");v0();var dZ=1,Jv=class extends QR.Component{constructor(r,n){super();this.callbacks={};this.checklist=[];this.saveTimeout=null;this.isSaving=!1;this.app=r,this.plugin=n,this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...QE]}async initialize(){await this.loadData(),this.updateState()}getDefaultData(){return{version:1,completed:!1,currentStep:"welcome",checklist:{},skipped:!1}}getDefaultState(){return{isActive:!1,currentStep:"welcome",canSkip:!0,canGoBack:!1,canGoForward:!0}}async loadData(){var r;try{let n=await this.plugin.loadData(),a=n==null?void 0:n.localMeta;a!=null&&a.onboarding?a.onboarding.version!==1?a.onboarding.version>1&&a.onboarding.version>=dZ?(console.warn(`Onboarding version downgrade detected: ${a.onboarding.version} -> ${1}`),this.data={...this.getDefaultData(),...a.onboarding,version:1}):this.data=this.migrateData(a.onboarding):this.data={...this.getDefaultData(),...a.onboarding}:this.data=this.getDefaultData(),(r=a==null?void 0:a.onboarding)!=null&&r.checklist&&this.updateChecklistFromData(a.onboarding.checklist)}catch(n){console.error("Error loading onboarding data:",n),this.data=this.getDefaultData()}}async saveData(){this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.saveTimeout=window.setTimeout(async()=>{await this.performSave()},100)}async performSave(){if(this.isSaving){this.saveTimeout=window.setTimeout(()=>this.performSave(),50);return}this.isSaving=!0;try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.onboarding=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving onboarding data:",r)}finally{this.isSaving=!1}}migrateData(r){let n=this.getDefaultData();return r.completed!==void 0&&(n.completed=r.completed),r.completedAt!==void 0&&(n.completedAt=r.completedAt),r.selectedGoal!==void 0&&(n.selectedGoal=r.selectedGoal),r.skipped!==void 0&&(n.skipped=r.skipped),r.skippedAt!==void 0&&(n.skippedAt=r.skippedAt),r.checklist!==void 0&&(n.checklist={...r.checklist}),n}updateChecklistFromData(r){this.checklist=this.checklist.map(n=>({...n,completed:r[n.id]||!1,completedAt:r[n.id]?Date.now():void 0}))}updateState(){this.state={isActive:!this.data.completed&&!this.data.skipped,currentStep:this.data.currentStep||"welcome",selectedGoal:this.data.selectedGoal,canSkip:this.canSkipCurrentStep(),canGoBack:this.canGoBackFromCurrentStep(),canGoForward:this.canGoForwardFromCurrentStep()}}canSkipCurrentStep(){let r=$t.find(n=>n.id===this.state.currentStep);return(r==null?void 0:r.isOptional)||this.state.currentStep!=="completion"}canGoBackFromCurrentStep(){return $t.findIndex(n=>n.id===this.state.currentStep)>0}canGoForwardFromCurrentStep(){return $t.findIndex(n=>n.id===this.state.currentStep)<$t.length-1}getState(){return{...this.state}}getData(){return{...this.data}}getChecklist(){return[...this.checklist]}shouldShowOnboarding(){return!this.data.completed&&!this.data.skipped}isCompleted(){return this.data.completed}async startOnboarding(){var r,n;this.data.currentStep="welcome",this.data.completed=!1,this.data.skipped=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onStepChange)==null||n.call(r,"welcome")}async goToStep(r){var a,o;let n=this.state.currentStep;if(!this.isValidStepTransition(this.state.currentStep,r))throw new Error(`Invalid step transition from ${this.state.currentStep} to ${r}`);this.data.currentStep=r,this.updateState(),await this.saveData(),(o=(a=this.callbacks).onStepChange)==null||o.call(a,r,n)}async nextStep(){if(!this.state.canGoForward)throw new Error("Cannot go forward from current step");let n=$t.findIndex(a=>a.id===this.state.currentStep)+1;for(;n<$t.length;){let a=$t[n];if(!a.shouldShow||a.shouldShow(this.data.selectedGoal))break;n++}n<$t.length&&await this.goToStep($t[n].id)}async previousStep(){if(!this.state.canGoBack)throw new Error("Cannot go back from current step");let n=$t.findIndex(a=>a.id===this.state.currentStep)-1;for(;n>=0;){let a=$t[n];if(!a.shouldShow||a.shouldShow(this.data.selectedGoal))break;n--}n>=0&&await this.goToStep($t[n].id)}async setGoal(r){var n,a;this.data.selectedGoal=r,this.updateState(),await this.saveData(),(a=(n=this.callbacks).onGoalSelected)==null||a.call(n,r)}async skipOnboarding(){var n,a;let r=this.state.currentStep;this.data.skipped=!0,this.data.skippedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(a=(n=this.callbacks).onSkipped)==null||a.call(n,r)}async completeOnboarding(){var r,n;this.data.completed=!0,this.data.completedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onCompleted)==null||n.call(r,this.data)}async resetOnboarding(){this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...QE],await this.saveData()}async completeChecklistTask(r){let n=this.checklist.find(a=>a.id===r);if(!n){console.warn(`Checklist task not found: ${r}`);return}n.completed||(n.completed=!0,n.completedAt=Date.now(),this.data.checklist[r]=!0,await this.saveData())}isValidStepTransition(r,n){let a=$t.findIndex(i=>i.id===r),o=$t.findIndex(i=>i.id===n);return o<=a?!0:o===a+1}setCallbacks(r){this.callbacks={...this.callbacks,...r}}clearCallbacks(){this.callbacks={}}onunload(){this.clearCallbacks(),this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.isSaving&&this.performSave().catch(r=>{console.error("Error during final save in onunload:",r)})}};v0();var eW=require("obsidian");var ZR={maxQueueSize:100,batchSize:10,flushInterval:15e3,retryAttempts:3};var Ou=require("crypto");sc();var uZ="https://stg-api.journalit.co",pZ=!1;function ZE(e,t){if(pZ){let r=new URL(`${uZ}${e}`);return t&&Object.entries(t).forEach(([n,a])=>{a!=null&&r.searchParams.append(n,String(a))}),r.toString()}return Le.buildUrl(e,t)}var Xv=class extends eW.Component{constructor(r,n,a){super();this.eventQueue=[];this.flushTimer=null;this.isInitialized=!1;this.app=r,this.plugin=n,this.options={...ZR,...a},this.data={installId:"",enabled:!1}}async initialize(){if(this.isInitialized)return;await this.loadTelemetryData();let r=!1;this.data.installId?this.isValidUUID(this.data.installId)||(this.data.installId=this.convertToUUID(this.data.installId),r=!0):(this.data.installId=await this.generateInstallId(),r=!0),r&&await this.saveTelemetryData(),this.data.persistedQueue&&this.data.persistedQueue.length>0&&(this.eventQueue=[...this.data.persistedQueue],console.debug("TelemetryService: Loaded persisted events:",this.eventQueue.length),this.data.persistedQueue=[],await this.saveTelemetryData(),this.scheduleFlush()),this.registerLifecycleEvents(),this.isInitialized=!0}registerLifecycleEvents(){this.app.workspace.onLayoutReady(()=>{this.eventQueue.length>0&&(console.debug("TelemetryService: Flushing events on layout ready"),this.flush())})}async generateInstallId(){try{let r=this.generateUUID(),n=(0,Ou.createHash)("sha256");n.update(r+this.app.vault.getName());let a=n.digest("hex");return[a.substring(0,8),a.substring(8,12),a.substring(12,16),a.substring(16,20),a.substring(20,32)].join("-")}catch(r){return console.error("Error generating installId:",r),this.generateFallbackId()}}generateUUID(){try{let r=(0,Ou.randomBytes)(16);r[6]=r[6]&15|64,r[8]=r[8]&63|128;let n=r.toString("hex");return[n.substring(0,8),n.substring(8,12),n.substring(12,16),n.substring(16,20),n.substring(20,32)].join("-")}catch(r){return this.generateFallbackId()}}generateFallbackId(){let r=Date.now().toString(36),n=Math.random().toString(36).substring(2),a=(0,Ou.createHash)("sha256").update(r+n).digest("hex");return[a.substring(0,8),a.substring(8,12),a.substring(12,16),a.substring(16,20),a.substring(20,32)].join("-")}isValidUUID(r){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)}convertToUUID(r){let n=(0,Ou.createHash)("sha256").update(r).digest("hex");return[n.substring(0,8),n.substring(8,12),n.substring(12,16),n.substring(16,20),n.substring(20,32)].join("-")}async loadTelemetryData(){try{let r=await this.plugin.loadData(),n=r==null?void 0:r.localMeta;n!=null&&n.telemetry&&(this.data={...this.data,...n.telemetry})}catch(r){console.error("Error loading telemetry data:",r)}}async saveTelemetryData(){try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.telemetry=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving telemetry data:",r)}}async persistQueue(){if(this.eventQueue.length!==0)try{this.data.persistedQueue=[...this.eventQueue],await this.saveTelemetryData(),console.debug("TelemetryService: Persisted queue with",this.eventQueue.length,"events")}catch(r){console.error("Error persisting telemetry queue:",r)}}async track(r,n={}){if(this.isInitialized||await this.initialize(),!this.data.enabled)return;let a={installId:this.data.installId,timestamp:Date.now(),pluginVersion:this.plugin.manifest.version,event:r,properties:this.sanitizeProperties(n)};this.eventQueue.push(a),this.eventQueue.length>this.options.maxQueueSize&&(this.eventQueue=this.eventQueue.slice(-this.options.maxQueueSize)),this.scheduleFlush()}async trackBusinessMetric(r,n={}){this.isInitialized||await this.initialize();let a={installId:this.data.installId,timestamp:Date.now(),pluginVersion:this.plugin.manifest.version,event:r,properties:this.sanitizeProperties(n),isBusinessMetric:!0};this.eventQueue.push(a),this.eventQueue.length>this.options.maxQueueSize&&(this.eventQueue=this.eventQueue.slice(-this.options.maxQueueSize)),this.scheduleFlush()}sanitizeProperties(r){let n={};for(let[a,o]of Object.entries(r))this.isPotentialPII(a,o)||(n[a]=o);return n}isPotentialPII(r,n){let a=["email","username","name","path","file","content","note"],o=r.toLowerCase();return!!(a.some(i=>o.includes(i))||typeof n=="string"&&n.includes("@"))}scheduleFlush(){this.flushTimer||(this.flushTimer=window.setTimeout(()=>{this.flush()},this.options.flushInterval),this.persistQueue().catch(r=>{console.error("Error during scheduled queue persistence:",r)}))}async flush(){var l;if(this.flushTimer=null,this.eventQueue.length===0)return;let r=[...this.eventQueue],n=this.plugin.authManager,a=n==null?void 0:n.isAuthenticated(),o=(l=n==null?void 0:n.getAuthState())==null?void 0:l.cache,i=a&&(o!=null&&o.userId)?o.userId:null,s=this.generateSessionId();try{let c=r.filter(m=>m.isBusinessMetric),d=r.filter(m=>!m.isBusinessMetric);if(!this.data.enabled){if(console.debug("TelemetryService: Telemetry disabled, discarding regular events but keeping business metrics"),c.length===0){this.eventQueue=[];return}r.splice(0,r.length,...c),this.eventQueue=this.eventQueue.filter(m=>m.isBusinessMetric)}if(i){let m=await this.getTelemetryPreferences(i);if(m&&!m.telemetry_enabled){console.debug("TelemetryService: Backend telemetry disabled for user, discarding regular events but keeping business metrics");let h=r.filter(f=>f.isBusinessMetric);if(h.length===0){this.eventQueue=[];return}r.splice(0,r.length,...h),this.eventQueue=this.eventQueue.filter(f=>f.isBusinessMetric)}}let u=r.map(m=>({event_type:m.event,event_data:m.properties,client_timestamp:new Date(m.timestamp).toISOString(),session_id:s,plugin_version:m.pluginVersion,anonymous_id:m.installId})),p=await Le.makeRequest(ZE("/api/v1/telemetry/events"),{method:"POST",headers:{"Content-Type":"application/json",...(n==null?void 0:n.getAuthToken())&&{Authorization:`Bearer ${n.getAuthToken()}`}},body:JSON.stringify({events:u})},"Telemetry event submission",5);p&&p.success?(console.debug("TelemetryService: Successfully sent events:",p.events_processed),this.eventQueue=this.eventQueue.slice(r.length)):console.warn("TelemetryService: Failed to send events, keeping in queue for retry")}catch(c){console.error("TelemetryService: Error sending events:",c)}this.eventQueue.length<r.length&&this.data.persistedQueue&&this.data.persistedQueue.length>0&&(this.data.persistedQueue=[],await this.saveTelemetryData().catch(c=>{console.error("Error clearing persisted queue after flush:",c)}))}async enableTelemetry(){this.data.enabled=!0,this.data.optInDate=Date.now(),delete this.data.optOutDate,await this.saveTelemetryData(),await this.updateTelemetryPreferences(!0)}async disableTelemetry(){this.data.enabled=!1,this.data.optOutDate=Date.now(),delete this.data.optInDate,this.eventQueue=this.eventQueue.filter(r=>r.isBusinessMetric),await this.saveTelemetryData(),await this.updateTelemetryPreferences(!1)}isEnabled(){return this.data.enabled}getInstallId(){return this.data.installId}getQueueSize(){return this.eventQueue.length}generateSessionId(){let r=(0,Ou.createHash)("sha256").update(Date.now()+Math.random().toString()).digest("hex");return[r.substring(0,8),r.substring(8,12),r.substring(12,16),r.substring(16,20),r.substring(20,32)].join("-")}async getTelemetryPreferences(r){try{let n=this.plugin.authManager;return await Le.makeRequest(ZE("/api/v1/telemetry/preferences"),{method:"GET",headers:{"Content-Type":"application/json",...(n==null?void 0:n.getAuthToken())&&{Authorization:`Bearer ${n.getAuthToken()}`}}},"Get telemetry preferences",3)}catch(n){return console.warn("TelemetryService: Could not fetch telemetry preferences:",n),null}}async updateTelemetryPreferences(r,n){try{let a=this.plugin.authManager;if(!(a!=null&&a.isAuthenticated())){console.warn("TelemetryService: Cannot update preferences - not authenticated");return}await Le.makeRequest(ZE("/api/v1/telemetry/preferences"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.getAuthToken()}`},body:JSON.stringify({telemetry_enabled:r,telemetry_settings:n?JSON.stringify(n):null})},"Update telemetry preferences",4)&&console.debug("TelemetryService: Updated backend telemetry preferences")}catch(a){console.error("TelemetryService: Failed to update telemetry preferences:",a)}}async clearAllData(){this.data={installId:"",enabled:!1},this.eventQueue=[],this.data.installId=await this.generateInstallId(),await this.saveTelemetryData()}onunload(){this.flushTimer&&(clearTimeout(this.flushTimer),this.flushTimer=null),this.eventQueue.length>0&&(console.debug("TelemetryService: Persisting",this.eventQueue.length,"events on unload"),this.persistQueue().catch(r=>{console.error("Error persisting queue on unload:",r)})),this.eventQueue=[]}};var Km=require("obsidian");Lu();Za();Ft();var y0=class extends si{constructor(r,n,a={}){super(r,{folder:"Journalit",extension:".md",namespace:"missed-trade",enableIndexing:!0,...a});this.recentlyCreatedFiles=new Set;this.journalitFolder="!Journalit";this.tradesFolder="trades";this.plugin=n}async createMissedTrade(r,n){var a,o;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");if(!r.instrument)throw new Error("Instrument is required");r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let i=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(i)}catch(p){}let s=await this.getMissedTradeFilePath(r);if(await this.app.vault.adapter.exists(s))throw console.error(`Cannot create missed trade - File already exists at path: ${s}`),new Error(`File already exists: ${s}`);let c=this.generateMissedTradeContent(r);this.recentlyCreatedFiles.add(s),setTimeout(()=>{var p;(p=this.recentlyCreatedFiles)==null||p.delete(s)},1e4);let d=await this.app.vault.create(s,c);this.app.metadataCache.trigger("resolve",d);let u=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"created",filePath:s,timestamp:Date.now()}});if(document.dispatchEvent(u),this.clearCache(),(a=this.plugin)!=null&&a.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){let p=null;(o=this.plugin)!=null&&o.processorManager&&(p=await this.plugin.processorManager.getMissedTradeNoteProcessor());try{await this.plugin.openFile(s,!0),setTimeout(()=>{p==null||p.renderActiveComponent()},50)}catch(m){console.warn("Failed to auto-open created missed trade:",m)}}return console.log(`Missed trade created successfully: ${s}`),s}catch(i){throw console.error("Error creating missed trade:",i),i}}async updateMissedTrade(r,n){var a,o,i,s,l,c,d,u;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");if(!r.instrument)throw new Error("Instrument is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Missed trade file does not exist: ${n}`);let m=this.app.vault.getAbstractFileByPath(n);if(!m||!(m instanceof Km.TFile))throw new Error(`Invalid file path: ${n}`);r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let h=r.pnl;r.useDirectPnLInput&&r.directPnL!==void 0&&(h=r.directPnL);let f={type:"missed-trade",isMissedTrade:!0,entryTime:this.formatDateForFrontmatter(r.entryTime),exitTime:this.formatDateForFrontmatter(r.exitTime||r.entryTime),entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,instrument:r.instrument};h!==void 0&&(f.pnl=h),r.assetType&&(f.assetType=r.assetType),r.thesis!==void 0&&(f.thesis=JSON.stringify(r.thesis||"")),r.missedReason!==void 0&&(f.missedReason=JSON.stringify(r.missedReason||"")),r.commission!==void 0&&(f.commission=r.commission),r.fees!==void 0&&(f.fees=r.fees),(a=r.setupIds)!=null&&a.length&&(f.setupIds=r.setupIds),(o=r.mistakeIds)!=null&&o.length&&(f.mistakeIds=r.mistakeIds),(i=r.accountIds)!=null&&i.length&&(f.accountIds=r.accountIds),(s=r.account)!=null&&s.length&&(f.account=r.account),(l=r.setup)!=null&&l.length&&(f.setup=r.setup),(c=r.mistake)!=null&&c.length&&(f.mistake=r.mistake),(d=r.ctags)!=null&&d.length&&(f.ctags=r.ctags),(u=r.images)!=null&&u.length&&(f.images=r.images),r.useDirectPnLInput!==void 0&&(f.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(f.directPnL=r.directPnL),r.reviewed!==void 0&&(f.reviewed=r.reviewed),r.reviewedAt&&(f.reviewedAt=r.reviewedAt);let b=this.generateAutomaticTags(r);b.length>0&&(f.tags=b),await this.updateFrontmatter(m,f);let v=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});return document.dispatchEvent(v),this.clearCache(),console.log(`Missed trade updated successfully: ${n}`),n}catch(p){throw console.error("Error updating missed trade:",p),p}}async updateMissedTradeReviewStatus(r,n,a){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Km.TFile))throw new Error(`Invalid file path: ${r}`);let i={reviewed:n,reviewedAt:a||new Date().toISOString()};await this.updateFrontmatter(o,i);let s=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"reviewed",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s),console.log(`Missed trade review status updated: ${r}`)}catch(o){throw console.error("Error updating missed trade review status:",o),o}}async getMissedTradeFilePath(r){var h;let n=xt(r.entryTime,this.plugin),a=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((h=this.plugin)==null?void 0:h.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${i}${o}${String(a).slice(2)}`:c==="MMDDYY"?d=`${o}${i}${String(a).slice(2)}`:c==="YYMMDD"?d=`${String(a).slice(2)}${o}${i}`:d=`${i}${o}${String(a).slice(2)}`;let u=await this.getMissedTradeNumberForDay(l,n),p=`${l}-${d}-M${u}.md`;return(0,Km.normalizePath)(`${this.journalitFolder}/${a}/${o}/${s}/${this.tradesFolder}/${p}`)}async getMissedTradeNumberForDay(r,n){var u;let a=this.getTargetFolderPath(n),o=await this.listFilesInFolder(a),i=((u=this.plugin)==null?void 0:u.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,i),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-M(\\d+)\\.md$`),d=0;for(let p of o){let m=p.split("/").pop()||"",h=c.exec(m);if(h){let f=parseInt(h[1],10);d=Math.max(d,f)}}return d+1}getAllMissedTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>!(!n.path.includes("Journalit")||!n.path.includes("/trades/")||!n.path.match(/-M\d+\.md$/)))}async getMissedTrades(r,n){await new Promise(l=>setTimeout(l,50)),this.invalidateCache();let a=xt(r,this.plugin),o=xt(n,this.plugin);return o.setHours(23,59,59,999),this.getAllMissedTradeFiles().filter(l=>{if(!l.path.includes("/trades/")||!l.path.includes("Journalit")||!l.path.match(/-M\d+\.md$/))return!1;let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if(!d||d.type!=="missed-trade")return!1;let u=d.entryTime?new Date(d.entryTime):null;if(!u)return!1;let p=xt(u,this.plugin);return p>=a&&p<=o})}generateAutomaticTags(r){let n=[];if(n.push(["missed-trade"]),r.instrument&&n.push([r.instrument.trim()]),r.assetType&&n.push([t0(r.assetType)]),r.direction&&n.push([e0(r.direction)]),r.setup&&Array.isArray(r.setup)&&r.setup.length>0){let a=Qw(r.setup);a.length>0&&n.push(a)}if(r.mistake&&Array.isArray(r.mistake)&&r.mistake.length>0){let a=Zw(r.mistake);a.length>0&&n.push(a)}if(r.account&&Array.isArray(r.account)&&r.account.length>0){let a=r.account.filter(o=>o==null?void 0:o.trim()).map(o=>`account/${yd(o.trim())}`);a.length>0&&n.push(a)}if(r.entryTime&&r.entryTime instanceof Date){let a=vl(r.entryTime);a.length>0&&n.push(a)}return yl(...n)}generateMissedTradeContent(r){var s,l,c,d,u,p,m,h;let n=this.generateAutomaticTags(r),a=["---","type: missed-trade","isMissedTrade: true",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`exitTime: ${this.formatDateForFrontmatter(r.exitTime||r.entryTime)}`,`entryPrice: ${r.entryPrice||0}`,`exitPrice: ${r.exitPrice||0}`,`positionSize: ${r.positionSize||0}`,`direction: ${r.direction}`,`instrument: ${r.instrument}`,r.pnl!==void 0?`pnl: ${r.pnl}`:null,r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,r.assetType?`assetType: ${r.assetType}`:null,r.thesis!==void 0?`thesis: ${JSON.stringify(r.thesis||"")}`:null,r.missedReason!==void 0?`missedReason: ${JSON.stringify(r.missedReason||"")}`:null,(s=r.setupIds)!=null&&s.length?`setupIds: [${r.setupIds.map(f=>`"${f}"`).join(", ")}]`:null,(l=r.mistakeIds)!=null&&l.length?`mistakeIds: [${r.mistakeIds.map(f=>`"${f}"`).join(", ")}]`:null,(c=r.accountIds)!=null&&c.length?`accountIds: [${r.accountIds.map(f=>`"${f}"`).join(", ")}]`:null,(d=r.setup)!=null&&d.length?`setup: [${r.setup.map(f=>`"${f}"`).join(", ")}]`:null,(u=r.mistake)!=null&&u.length?`mistake: [${r.mistake.map(f=>`"${f}"`).join(", ")}]`:null,(p=r.account)!=null&&p.length?`account: [${r.account.map(f=>`"${f}"`).join(", ")}]`:null,(m=r.ctags)!=null&&m.length?`ctags: [${r.ctags.map(f=>`"${f}"`).join(", ")}]`:null,(h=r.images)!=null&&h.length?`images: [${r.images.map(f=>`"${f.trim()}"`).join(", ")}]`:null,n.length>0?`tags: [${n.map(f=>`"${f}"`).join(", ")}]`:null],o=new Set(["type","isMissedTrade","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","instrument","pnl","useDirectPnLInput","directPnL","commission","fees","assetType","thesis","missedReason","setupIds","mistakeIds","accountIds","setup","mistake","account","ctags","images","tags","notes"]);return Object.keys(r).forEach(f=>{if(!o.has(f)&&r[f]!==void 0&&r[f]!==null){let b=r[f];Array.isArray(b)?a.push(`${f}: [${b.map(v=>JSON.stringify(v)).join(", ")}]`):typeof b=="string"?a.push(`${f}: ${JSON.stringify(b)}`):a.push(`${f}: ${b}`)}}),a.push("---"),[...a,"","# Missed Trade Notes","",r.notes||"Add any additional notes about this missed trade here."].filter(f=>f!==null).join(`
`)}getTargetFolderPath(r){let n=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r);return(0,Km.normalizePath)(`${this.journalitFolder}/${n}/${a}/${o}/${this.tradesFolder}`)}getWeekOfMonth(r){return Ts(r)}formatDateForFilename(r,n){let a=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");switch(n){case"DDMMYY":return`${i}${o}${String(a).slice(2)}`;case"MMDDYY":return`${o}${i}${String(a).slice(2)}`;case"YYMMDD":return`${String(a).slice(2)}${o}${i}`;default:return`${i}${o}${String(a).slice(2)}`}}sanitizeTickerForFilename(r){return r.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").toUpperCase()}async listFilesInFolder(r){try{return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return[]}}formatDateForFrontmatter(r){return r.toISOString()}};Lu();Ja();Ea();mv();var Qv=class extends si{constructor(r,n={}){super(r,{cacheTTL:2*60*1e3,persistCache:!0,namespace:n.namespace||"accountPage",...n});this.plugin=null;this.tradeDataChangeHandler=a=>{this.clearCache()},document.addEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler)}setPlugin(r){this.plugin=r}safeParseDate(r){if(r instanceof Date&&!isNaN(r.getTime()))return r;if(r!=null&&r!=="")try{let n=new Date(r);if(!isNaN(n.getTime()))return n}catch(n){}return null}getAccountMetadata(r){var o,i;if(!((i=(o=this.plugin)==null?void 0:o.settings.account)!=null&&i.accountMetadata))return;let n=this.plugin.settings.account.accountMetadata[r];if(!n){console.log(`AccountPageService.getAccountMetadata: No metadata found for "${r}"`);return}return{...n,createdDate:n.createdDate instanceof Date?n.createdDate:this.safeParseDate(n.createdDate)||new Date,profitTargetDate:n.profitTargetDate?n.profitTargetDate instanceof Date?n.profitTargetDate:this.safeParseDate(n.profitTargetDate)||void 0:void 0,lastUpdated:n.lastUpdated instanceof Date?n.lastUpdated:this.safeParseDate(n.lastUpdated)||new Date,manualTransactions:n.manualTransactions?n.manualTransactions.map(s=>({...s,date:s.date instanceof Date?s.date:this.safeParseDate(s.date)||new Date})):void 0}}async saveAccountMetadata(r,n){var a,o;if(!((a=this.plugin)!=null&&a.settings.account)){if(!((o=this.plugin)!=null&&o.settings))return;this.plugin.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}}}this.plugin.settings.account.accountMetadata||(this.plugin.settings.account.accountMetadata={}),this.plugin.settings.account.accountMetadata[r]=n,await this.plugin.saveSettings()}createAccountDataFromTrades(r,n,a){let o=n.filter(u=>!ct({tradeStatus:u.tradeStatus,exitTime:u.exitTime,pnl:u._originalPnlWasNull?null:u.pnl,useDirectPnLInput:u.useDirectPnLInput,exits:u.exits})),i=this.calculateAccountMetrics(o),s=(a==null?void 0:a.initialBalance)||this.estimateInitialBalance(n),l=(a==null?void 0:a.createdDate)||this.estimateCreationDate(n),c=s+i.totalPnL;return{id:`account-${r.replace(/[^a-zA-Z0-9]/g,"-")}`,name:r,accountType:(a==null?void 0:a.accountType)||"demo",initialBalance:s,currentBalance:c,drawdownType:(a==null?void 0:a.drawdownType)||"none",drawdownAmount:(a==null?void 0:a.drawdownAmount)||0,maxDrawdownReached:c<s?c:s,hasProfitTarget:(a==null?void 0:a.hasProfitTarget)||!1,profitTarget:(a==null?void 0:a.profitTarget)||0,profitTargetType:(a==null?void 0:a.profitTargetType)||"absolute",profitTargetDate:a==null?void 0:a.profitTargetDate,monthlyCost:(a==null?void 0:a.monthlyCost)||0,createdDate:l,lastUpdated:new Date,metrics:{totalTrades:i.totalTrades,winningTrades:i.winningTrades,losingTrades:i.losingTrades,breakEvenTrades:i.totalTrades-i.winningTrades-i.losingTrades,winRate:i.winRate,totalPnL:i.totalPnL,bestTrade:n.length>0?Math.max(...n.map(u=>u.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(u=>u.pnl)):0,profitFactor:i.profitFactor,averageWin:i.avgWin,averageLoss:i.avgLoss,maxDrawdown:s-(c<s?c:s),totalWithdrawals:0},transactions:[],dailyBalances:[],notePath:""}}estimateCreationDate(r){if(r.length===0)return new Date;let n=r.reduce((o,i)=>{let s=i.entryTime instanceof Date?i.entryTime:this.safeParseDate(i.entryTime),l=o.entryTime instanceof Date?o.entryTime:this.safeParseDate(o.entryTime);return s?l?s<l?i:o:i:o}),a=n.entryTime instanceof Date?new Date(n.entryTime):this.safeParseDate(n.entryTime);if(!a){let o=new Date;return o.setMonth(0,1),o.setHours(0,0,0,0),console.warn("AccountPageService: Could not determine account creation date, using fallback"),o}return a.setDate(a.getDate()-1),a.setHours(0,0,0,0),a}async getAccountPageData(r){let n=`accountPage:${r}`;try{return await this.query(async()=>{var p,m,h;if(!((p=this.plugin)!=null&&p.tradeService)){let f=0;for(;!((m=this.plugin)!=null&&m.tradeService)&&f<3;)await new Promise(b=>setTimeout(b,300)),f++;if(!((h=this.plugin)!=null&&h.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let a=await this.getAccountTrades(r),o=this.getAccountMetadata(r);if(a.length===0&&!o)return null;let i=this.createAccountDataFromTrades(r,a,o),s=a.filter(f=>!ct({tradeStatus:f.tradeStatus,exitTime:f.exitTime,pnl:f._originalPnlWasNull?null:f.pnl,useDirectPnLInput:f.useDirectPnLInput,exits:f.exits})),l=this.calculateAccountMetrics(s),c=await this.enhanceAccountWithTransactions(i,a,l),d=c.currentBalance-c.initialBalance,u={...l,totalPnL:d};return{account:c,trades:a,metrics:u}},n,{offlineCapable:!0})}catch(a){return console.error(`Error getting account page data for ${r}:`,a),null}}async getAccountTrades(r){let n=`accountTrades:${r}`;try{return await this.query(async()=>{var u,p;let a=[],o=0,i=5;for(;o<i;){if(!((u=this.plugin)!=null&&u.tradeService)){await new Promise(v=>setTimeout(v,300)),o++;continue}await this.plugin.tradeService.clearCache(),await new Promise(v=>setTimeout(v,300));try{let v=this.plugin.app.vault.adapter;v&&v.list&&await v.list("!Journalit").catch(()=>{})}catch(v){}let m=new Date("2000-01-01"),h=new Date("2099-12-31"),f=await this.plugin.tradeService.getTrades(m,h);a=[];for(let v of f){let y=await this.plugin.tradeService.extractTradeData(v);if(y){let g=((p=this.plugin.app.metadataCache.getFileCache(v))==null?void 0:p.frontmatter)||{},w=g.pnl===null||g.pnl===void 0;a.push({...y,path:v.path,_originalPnlWasNull:w})}}let b=a.filter(v=>v.path&&v.path.trim()!=="");if(a.length>0&&b.length===0){await new Promise(v=>setTimeout(v,500)),o++;continue}o>0&&await this.clearCache();break}if(o>=i)throw new Error(`TradeService failed to load properly after ${i} attempts`);let c=a.filter(m=>{let h=f=>f?Array.isArray(f)?f.includes(r):typeof f=="string"?f===r:!1:!1;return h(m.account)||h(m.accountIds)}).filter((m,h)=>m.entryTime!==null&&m.entryTime!==void 0&&m.entryTime!==""?this.safeParseDate(m.entryTime)?m.exitTime!==null&&m.exitTime!==void 0&&m.exitTime!==""&&!this.safeParseDate(m.exitTime)?(console.warn(`AccountPageService: Skipping trade (${m.path}) - unparseable exit time`),!1):!0:(console.warn(`AccountPageService: Skipping trade (${m.path}) - unparseable entry time`),!1):(console.warn(`AccountPageService: Skipping trade (${m.path}) - missing entry time`),!1)).map(m=>{let h=this.safeParseDate(m.entryTime),f=m.exitTime?this.safeParseDate(m.exitTime):null;return{path:m.path||"",instrument:m.instrument||"Unknown",direction:m.direction||"Unknown",entryPrice:parseFloat(m.entryPrice)||0,exitPrice:f&&parseFloat(m.exitPrice)||0,positionSize:parseFloat(m.positionSize)||0,pnl:f&&parseFloat(m.pnl)||0,commission:parseFloat(m.commission)||0,swap:parseFloat(m.swap)||0,fees:parseFloat(m.fees)||0,entryTime:h,exitTime:f,setup:m.setup||[],mistake:m.mistake||[],tags:m.ctags||[],reviewed:m.reviewed||!1}});if(c.filter(m=>!m.path||m.path.trim()==="").length>0)throw new Error(`Refusing to cache trades without paths for account "${r}". This prevents UI issues.`);return c},n,{offlineCapable:!0})}catch(a){return console.error(`Error getting trades for account ${r}:`,a),[]}}calculateAccountMetrics(r){if(r.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0};let n=r.length,a=r.reduce((b,v)=>b+v.commission,0),o=r.reduce((b,v)=>b+v.swap,0),i=r.reduce((b,v)=>b+v.fees,0),s=r.reduce((b,v)=>{let y=Aa(v);return b+y},0),l=r.filter(b=>Aa(b)>0),c=r.filter(b=>Aa(b)<0),d=n>0?l.length/n*100:0,u=l.reduce((b,v)=>{let y=Aa(v);return b+y},0),p=Math.abs(c.reduce((b,v)=>{let y=Aa(v);return b+y},0)),m=l.length>0?u/l.length:0,h=c.length>0?p/c.length:0,f=0;return p>0?f=u/p:u>0?f=999:f=0,{totalTrades:n,winningTrades:l.length,losingTrades:c.length,winRate:d,totalPnL:s,avgWin:m,avgLoss:h,profitFactor:f,totalCommission:a,totalSwap:o,totalFees:i}}async getAccountTradesInRange(r,n,a){return(await this.getAccountTrades(r)).filter(i=>{let s=i.entryTime;return s>=n&&s<=a})}async getAccountInstruments(r){let n=await this.getAccountTrades(r);return[...new Set(n.map(o=>o.instrument))].filter(Boolean)}async getAccountSetups(r){let n=await this.getAccountTrades(r);return[...new Set(n.flatMap(o=>o.setup))].filter(Boolean)}estimateInitialBalance(r){if(r.length===0)return 1e4;let n=Math.max(...r.map(o=>Math.abs(o.positionSize)));if(n>0){let o=n*50,i=r.reduce((c,d)=>{let u=Aa(d);return c+u},0),s=1e4;i>0?s=Math.max(5e3,o):s=Math.max(1e4,o-i);let l=Math.max(o,s);return Math.min(1e6,Math.max(1e3,l))}let a=r.reduce((o,i)=>o+i.pnl,0);return a<-5e3?Math.abs(a)+1e4:a>5e3?Math.max(5e3,a*.5):1e4}async enhanceAccountWithTransactions(r,n,a){let o={...r},i=!1;if(r.transactions&&r.transactions.length>0){let g=r.transactions.find(w=>w.type==="deposit"&&w.description==="Initial deposit");if(g){let w=new Date(r.createdDate),C=new Date(g.date);Math.abs(w.getTime()-C.getTime())/(1e3*60*60*24)>2&&(i=!0)}}if(r.transactions&&r.transactions.length>1&&!i){let g=r.transactions.map(P=>{let M=P.date instanceof Date?P.date:this.safeParseDate(P.date);return M?{...P,date:M}:(console.warn("AccountPageService: Skipping existing transaction with invalid date:",P),null)}).filter(P=>P!==null),w=this.getAccountMetadata(r.name);if(w!=null&&w.manualTransactions){let P=new Set(r.transactions.map(D=>D.id)),M=w.manualTransactions.filter(D=>!P.has(D.id)).map(D=>{let A=D.date instanceof Date?D.date:this.safeParseDate(D.date);return A?{...D,date:A}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",D),null)}).filter(D=>D!==null);g.push(...M)}let C=g.sort((P,M)=>new Date(P.date).getTime()-new Date(M.date).getTime()),k=0;for(let P of C)k+=P.amount,P.balanceAfter=k;o.transactions=C,o.currentBalance=k;let x={totalTrades:a.totalTrades,winningTrades:a.winningTrades,losingTrades:a.losingTrades,breakEvenTrades:a.totalTrades-a.winningTrades-a.losingTrades,winRate:a.winRate,totalPnL:a.totalPnL,bestTrade:n.length>0?Math.max(...n.map(P=>P.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(P=>P.pnl)):0,profitFactor:a.profitFactor,averageWin:a.avgWin,averageLoss:a.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:C.filter(P=>P.type==="withdrawal"||P.type==="deposit"&&P.amount<0).reduce((P,M)=>P+Math.abs(M.amount),0)};o.metrics=x;let S=[];if(C.length>0){let P=new Map;for(let D of C){let A=new Date(D.date),L=A.toISOString().split("T")[0],N=A.getFullYear();if(N<1970||N>2100){console.warn(`AccountPageService: Skipping existing transaction with corrupted date ${L} - year ${N} outside valid range`);continue}P.set(L,D.balanceAfter)}let M=Array.from(P.keys()).sort();for(let D of M){let A=P.get(D),L=r.initialBalance||0,N=Math.max(0,L-A);S.push({date:new Date(D),balance:A,drawdownLevel:N})}}let T=new Map;for(let P of S){let M=P.date.toISOString().split("T")[0];T.set(M,P)}return o.dailyBalances=Array.from(T.values()).sort((P,M)=>P.date.getTime()-M.date.getTime()),o}let s=[],l=this.getAccountMetadata(r.name),c=l!=null&&l.manualTransactions?l.manualTransactions.map(g=>{let w=g.date instanceof Date?g.date:this.safeParseDate(g.date);return w?{...g,date:w,balanceAfter:0}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",g),null)}).filter(g=>g!==null):[],d=c.some(g=>g.type==="deposit"&&g.description==="Initial deposit");if((!r.transactions||r.transactions.length===0||i)&&!d){let g=new Date(r.createdDate);g.setHours(0,0,0,0),s.push({id:`${r.id}-initial`,date:g,type:"deposit",amount:r.initialBalance,description:"Initial deposit",balanceAfter:0})}else!i&&r.transactions&&r.transactions.length>0&&s.push(...r.transactions);s.push(...c);let p=n.filter(g=>g.exitTime!==null&&g.exitTime!==void 0).map(g=>{let w=g.entryTime instanceof Date?g.entryTime:this.safeParseDate(g.entryTime),C=g.exitTime instanceof Date?g.exitTime:this.safeParseDate(g.exitTime);if(!w||!C)return console.warn(`AccountPageService: Skipping trade (${g.path}) - invalid dates`),null;let k=w.getFullYear(),x=C.getFullYear();return k<1970||k>2100||x<1970||x>2100?(console.warn(`AccountPageService: Skipping trade with corrupted dates (${g.path}) - year ${k}/${x} outside valid range`),null):{...g,entryTime:w,exitTime:C}}).filter(g=>g!==null);for(let g of p){let w=Aa(g);s.push({id:`${r.id}-trade-${g.path.replace(/[^a-zA-Z0-9]/g,"-")}`,date:g.exitTime,type:"trade",amount:w,description:`Trade P&L: ${g.path}`,tradeId:g.path,balanceAfter:0})}let m=s.sort((g,w)=>new Date(g.date).getTime()-new Date(w.date).getTime()),h=0,f=m.findIndex(g=>g.type==="deposit"&&g.description==="Initial deposit");if(f>=0)for(let g=0;g<m.length;g++){let w=m[g];g===f?(h=r.initialBalance,w.balanceAfter=h):g<f?(g<=2&&console.warn(`AccountPageService: ${m.length-f} transactions before initial deposit (showing first few)`),h+=w.amount,w.balanceAfter=h):(h+=w.amount,w.balanceAfter=h)}else{console.warn("AccountPageService: No initial deposit found, using zero-based balance calculation");for(let g of m)h+=g.amount,g.balanceAfter=h}o.transactions=m,o.currentBalance=h;let b={totalTrades:a.totalTrades,winningTrades:a.winningTrades,losingTrades:a.losingTrades,breakEvenTrades:a.totalTrades-a.winningTrades-a.losingTrades,winRate:a.winRate,totalPnL:a.totalPnL,bestTrade:n.length>0?Math.max(...n.map(g=>g.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(g=>g.pnl)):0,profitFactor:a.profitFactor,averageWin:a.avgWin,averageLoss:a.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:m.filter(g=>g.type==="withdrawal"||g.type==="deposit"&&g.amount<0).reduce((g,w)=>g+Math.abs(w.amount),0)};o.metrics=b;let v=[];if(s.length>0){let g=[...s].sort((k,x)=>new Date(k.date).getTime()-new Date(x.date).getTime()),w=new Map;for(let k of g){let x=new Date(k.date),S=x.toISOString().split("T")[0],T=x.getFullYear();if(T<1970||T>2100){console.warn(`AccountPageService: Skipping transaction with corrupted date ${S} - year ${T} outside valid range`);continue}w.set(S,k.balanceAfter)}let C=Array.from(w.keys()).sort();for(let k of C){let x=w.get(k),S=r.initialBalance||0,T=Math.max(0,S-x);v.push({date:new Date(k),balance:x,drawdownLevel:T})}}let y=new Map;for(let g of v){let w=g.date.toISOString().split("T")[0];y.set(w,g)}return o.dailyBalances=Array.from(y.values()).sort((g,w)=>g.date.getTime()-w.date.getTime()),o}async refreshAccountData(r){var n;await this.clearCacheWithPrefix(`accountPage:${r}`),await this.clearCacheWithPrefix(`accountTrades:${r}`),await this.clearCacheWithPrefix("allEnhancedAccounts"),(n=this.plugin)!=null&&n.tradeService&&await this.plugin.tradeService.clearCache()}async getAllEnhancedAccounts(){let r="allEnhancedAccounts";try{return await this.query(async()=>{var s,l,c,d,u;if(!((s=this.plugin)!=null&&s.tradeService)){let p=0;for(;!((l=this.plugin)!=null&&l.tradeService)&&p<3;)await new Promise(m=>setTimeout(m,300)),p++;if(!((c=this.plugin)!=null&&c.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let n=await this.plugin.tradeService.getUniqueAccounts(),a=Object.keys(((u=(d=this.plugin)==null?void 0:d.settings.account)==null?void 0:u.accountMetadata)||{}),o=[...new Set([...n,...a])];return await Promise.all(o.map(async p=>{try{let m=await this.getAccountTrades(p),h=this.getAccountMetadata(p),f=this.createAccountDataFromTrades(p,m,h),b=m.filter(w=>!ct({tradeStatus:w.tradeStatus,exitTime:w.exitTime,pnl:w._originalPnlWasNull?null:w.pnl,useDirectPnLInput:w.useDirectPnLInput,exits:w.exits})),v=this.calculateAccountMetrics(b),y=await this.enhanceAccountWithTransactions(f,m,v),g=y.currentBalance-y.initialBalance;return y.metrics&&(y.metrics.totalPnL=g),y}catch(m){console.warn(`Failed to enhance account ${p}:`,m);let h=this.getAccountMetadata(p);return this.createAccountDataFromTrades(p,[],h)}}))},r,{offlineCapable:!0})}catch(n){return console.error("Error getting all enhanced accounts:",n),[]}}getCachedAccountNames(){return[]}async updateAccountMetadata(r,n){let a=this.getAccountMetadata(r),o=await this.getAccountTrades(r),i={name:r,accountType:n.accountType||(a==null?void 0:a.accountType)||"demo",createdDate:n.createdDate||(a==null?void 0:a.createdDate)||this.estimateCreationDate(o),initialBalance:n.initialBalance||(a==null?void 0:a.initialBalance)||this.estimateInitialBalance(o),drawdownType:n.drawdownType!==void 0?n.drawdownType:(a==null?void 0:a.drawdownType)||"none",drawdownAmount:n.drawdownAmount!==void 0?n.drawdownAmount:(a==null?void 0:a.drawdownAmount)||0,hasProfitTarget:n.hasProfitTarget!==void 0?n.hasProfitTarget:(a==null?void 0:a.hasProfitTarget)||!1,profitTarget:n.profitTarget!==void 0?n.profitTarget:(a==null?void 0:a.profitTarget)||0,profitTargetType:n.profitTargetType||(a==null?void 0:a.profitTargetType)||"absolute",profitTargetDate:n.profitTargetDate||(a==null?void 0:a.profitTargetDate),monthlyCost:n.monthlyCost!==void 0?n.monthlyCost:(a==null?void 0:a.monthlyCost)||0,manualTransactions:n.manualTransactions!==void 0?n.manualTransactions:(a==null?void 0:a.manualTransactions)||[],lastUpdated:new Date};await this.saveAccountMetadata(r,i),await this.refreshAccountData(r)}async deleteAccount(r){var s,l,c;if(!this.plugin)throw new Error("Plugin not initialized");if((l=(s=this.plugin.settings.account)==null?void 0:s.accountMetadata)!=null&&l[r]&&(delete this.plugin.settings.account.accountMetadata[r],await this.plugin.saveSettings()),!this.plugin.tradeService)throw new Error("TradeService not available");let o=this.app.vault.getFiles().filter(d=>{var p;if(!d.path.endsWith(".md"))return!1;let u=(p=this.app.metadataCache.getFileCache(d))==null?void 0:p.frontmatter;return u!=null&&u.isMissedTrade?!1:(u==null?void 0:u.type)==="trade"?!0:d.path.includes("/trades/")&&d.path.includes("/!Journalit/")}),i=`account/${this.formatTagForYAML(r)}`;for(let d of o)try{await this.app.fileManager.processFrontMatter(d,u=>{let p=!1;if(u.account&&Array.isArray(u.account)){let m=u.account.length;u.account=u.account.filter(h=>h&&h.trim()&&h.trim()!==r),u.account.length!==m&&(p=!0),u.account.length===0&&delete u.account}if(u.accountIds&&Array.isArray(u.accountIds)){let m=u.accountIds.length;u.accountIds=u.accountIds.filter(h=>h&&h.trim()&&h.trim()!==r),u.accountIds.length!==m&&(p=!0),u.accountIds.length===0&&delete u.accountIds}if(u.tags&&Array.isArray(u.tags)){let m=u.tags.length;u.tags=u.tags.filter(h=>h&&h.trim()&&h.trim()!==i),u.tags.length!==m&&(p=!0)}p&&console.debug(`Updated trade note references for deleted account: ${r}`)})}catch(u){console.error(`Error updating trade file ${d.path} during account deletion:`,u)}await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(c=this.plugin)!=null&&c.tradeService&&(await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-accounts"),await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-values")),console.log(`Account "${r}" has been successfully deleted and all references removed`)}formatTagForYAML(r){return r.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}async refreshAllAccountData(){var r;await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(r=this.plugin)!=null&&r.tradeService&&await this.plugin.tradeService.clearCache()}async addManualDeposit(r,n,a,o){if(n<=0)throw new Error("Deposit amount must be positive");let s={id:this.generateTransactionId(),date:new Date(a),type:"deposit",amount:n,description:o||"Manual deposit",balanceAfter:0};await this.addManualTransaction(r,s)}async addManualWithdrawal(r,n,a,o){if(n<=0)throw new Error("Withdrawal amount must be positive");let s={id:this.generateTransactionId(),date:new Date(a),type:"withdrawal",amount:-n,description:o||"Manual withdrawal",balanceAfter:0};await this.addManualTransaction(r,s)}async updateManualTransaction(r,n,a){let o=this.getAccountMetadata(r);if(!(o!=null&&o.manualTransactions))throw new Error("No manual transactions found for this account");let i=o.manualTransactions.findIndex(c=>c.id===n);if(i===-1)throw new Error("Transaction not found");let s=o.manualTransactions[i],l={...s,...a,date:a.date?new Date(a.date):s.date,balanceAfter:0};if(a.amount!==void 0){if(s.type==="deposit"&&a.amount<=0)throw new Error("Deposit amount must be positive");if(s.type==="withdrawal"&&a.amount<=0)throw new Error("Withdrawal amount must be positive");s.type==="withdrawal"&&(l.amount=-Math.abs(a.amount))}o.manualTransactions[i]=l,await this.saveAccountMetadata(r,{...o,lastUpdated:new Date}),await this.refreshAccountData(r)}async deleteManualTransaction(r,n){let a=this.getAccountMetadata(r);if(!(a!=null&&a.manualTransactions))throw new Error("No manual transactions found for this account");let o=a.manualTransactions.findIndex(i=>i.id===n);if(o===-1)throw new Error("Transaction not found");a.manualTransactions.splice(o,1),await this.saveAccountMetadata(r,{...a,lastUpdated:new Date}),await this.refreshAccountData(r)}getManualTransactions(r){let n=this.getAccountMetadata(r);return(n==null?void 0:n.manualTransactions)||[]}async addManualTransaction(r,n){let a=this.getAccountMetadata(r)||{name:r,accountType:"demo",createdDate:new Date,initialBalance:1e4,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",monthlyCost:0,lastUpdated:new Date};a.manualTransactions||(a.manualTransactions=[]),a.manualTransactions.push(n),a.lastUpdated=new Date,await this.saveAccountMetadata(r,a),await this.refreshAccountData(r)}generateTransactionId(){return`manual-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}destroy(){this.tradeDataChangeHandler&&(document.removeEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler))}};var wd=class e{constructor(t,r){this._authManager=null;this._tradeService=null;this._setupService=null;this._drcService=null;this._weeklyReviewService=null;this._monthlyReviewService=null;this._optionsService=null;this._customFieldsService=null;this._missedTradeService=null;this._backendIntegrationService=null;this._onboardingService=null;this._telemetryService=null;this._accountPageService=null;this.initializedServices=new Set;this.serviceInitQueue=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}initializeCoreServices(){this._authManager=new Gm(this.app,WE()),this.initializedServices.add("authManager"),this._tradeService=new $v(this.app,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService"),this._customFieldsService=new g0(this.plugin),this.initializedServices.add("customFieldsService")}async initializeRemainingServices(){await Bv([async()=>await this.getSetupService(),async()=>await this.getDRCService(),async()=>await this.getWeeklyReviewService(),async()=>await this.getMonthlyReviewService(),async()=>await this.getOptionsService(),async()=>await this.getAccountPageService()],50)}getAuthManager(){return this._authManager||(this._authManager=new Gm(this.app,WE()),this.initializedServices.add("authManager")),this._authManager}getTradeService(){return this._tradeService||(this._tradeService=new $v(this.app,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService")),this._tradeService}async getSetupService(){if(this._setupService)return this._setupService;let t=this.serviceInitQueue.get("setupService");if(t)return t;let r=(async()=>{let n=this.getTradeService(),a=await pa(()=>new d0(this.app,n,{namespace:"setup"}),"SetupService");return this._setupService=a,this.initializedServices.add("setupService"),this.serviceInitQueue.delete("setupService"),a})();return this.serviceInitQueue.set("setupService",r),r}async getDRCService(){if(this._drcService)return this._drcService;let t=this.serviceInitQueue.get("drcService");if(t)return t;let r=(async()=>{let n=await pa(()=>new u0(this.app,this.plugin,{namespace:"drc"}),"DRCService");return this._drcService=n,this.initializedServices.add("drcService"),this.serviceInitQueue.delete("drcService"),n})();return this.serviceInitQueue.set("drcService",r),r}async getWeeklyReviewService(){if(this._weeklyReviewService)return this._weeklyReviewService;let t=this.serviceInitQueue.get("weeklyReviewService");if(t)return t;let r=(async()=>{let n=await pa(()=>new m0(this.app,this.plugin,{namespace:"weekly"}),"WeeklyReviewService");return this._weeklyReviewService=n,this.initializedServices.add("weeklyReviewService"),this.serviceInitQueue.delete("weeklyReviewService"),n})();return this.serviceInitQueue.set("weeklyReviewService",r),r}async getMissedTradeService(){if(this._missedTradeService)return this._missedTradeService;let t=this.serviceInitQueue.get("missedTradeService");if(t)return t;let r=(async()=>{let n=await pa(()=>new y0(this.app,this.plugin,{namespace:"missed-trade"}),"MissedTradeService");return this._missedTradeService=n,this.initializedServices.add("missedTradeService"),this.serviceInitQueue.delete("missedTradeService"),n})();return this.serviceInitQueue.set("missedTradeService",r),r}async getMonthlyReviewService(){if(this._monthlyReviewService)return this._monthlyReviewService;let t=this.serviceInitQueue.get("monthlyReviewService");if(t)return t;let r=(async()=>{let n=await pa(()=>new f0(this.app,this.plugin,{namespace:"monthly"}),"MonthlyReviewService");return this._monthlyReviewService=n,this.initializedServices.add("monthlyReviewService"),this.serviceInitQueue.delete("monthlyReviewService"),n})();return this.serviceInitQueue.set("monthlyReviewService",r),r}async getOptionsService(){if(this._optionsService)return this._optionsService;let t=this.serviceInitQueue.get("optionsService");if(t)return t;let r=(async()=>{let n=await pa(()=>new Hn(this.plugin,{namespace:"options"}),"CustomOptionsService");return this._optionsService=n,this.initializedServices.add("optionsService"),this.serviceInitQueue.delete("optionsService"),n})();return this.serviceInitQueue.set("optionsService",r),r}getCustomFieldsService(){if(!this._customFieldsService)throw new Error("CustomFieldsService not initialized. Make sure initializeCoreServices() was called.");return this._customFieldsService}isServiceInitialized(t){return this.initializedServices.has(t)}isServiceInitializing(t){return this.serviceInitQueue.has(t)}async getAccountPageService(){if(this._accountPageService)return this._accountPageService;let t=this.serviceInitQueue.get("accountPageService");if(t)return t;let r=(async()=>{let n=await pa(()=>{let a=new Qv(this.app,{namespace:"accountPage"});return a.setPlugin(this.plugin),a},"AccountPageService");return this._accountPageService=n,this.initializedServices.add("accountPageService"),this.serviceInitQueue.delete("accountPageService"),n})();return this.serviceInitQueue.set("accountPageService",r),r}async getBackendIntegrationService(){if(this._backendIntegrationService)return this._backendIntegrationService;let t=this.serviceInitQueue.get("backendIntegrationService");if(t)return t;let r=(async()=>{let n=await pa(()=>new Yv(this.plugin),"BackendIntegrationService");return this._backendIntegrationService=n,this.initializedServices.add("backendIntegrationService"),this.serviceInitQueue.delete("backendIntegrationService"),n})();return this.serviceInitQueue.set("backendIntegrationService",r),r}async getOnboardingService(){if(this._onboardingService)return this._onboardingService;let t=this.serviceInitQueue.get("onboardingService");if(t)return t;let r=(async()=>{let n=await pa(()=>new Jv(this.app,this.plugin),"OnboardingService");return await n.initialize(),this._onboardingService=n,this.initializedServices.add("onboardingService"),this.serviceInitQueue.delete("onboardingService"),n})();return this.serviceInitQueue.set("onboardingService",r),r}async getTelemetryService(){if(this._telemetryService)return this._telemetryService;let t=this.serviceInitQueue.get("telemetryService");if(t)return t;let r=(async()=>{let n=await pa(()=>new Xv(this.app,this.plugin),"TelemetryService");return await n.initialize(),this._telemetryService=n,this.initializedServices.add("telemetryService"),this.serviceInitQueue.delete("telemetryService"),n})();return this.serviceInitQueue.set("telemetryService",r),r}preInitializeServices(t){t.length!==0&&n0(()=>{let r=t.map(n=>async()=>{switch(n){case"setupService":await this.getSetupService();break;case"drcService":await this.getDRCService();break;case"weeklyReviewService":await this.getWeeklyReviewService();break;case"monthlyReviewService":await this.getMonthlyReviewService();break;case"optionsService":await this.getOptionsService();break;case"accountPageService":await this.getAccountPageService();break;case"onboardingService":await this.getOnboardingService();break;case"telemetryService":await this.getTelemetryService();break}});Bv(r,100)})}cleanupServices(){try{let t=(Lu(),Wb(UR)).CustomDataService;t.sharedIndexManager&&(t.sharedIndexManager.unload(),t.sharedIndexManager=null)}catch(t){console.error("Error cleaning up IndexManager:",t)}this._authManager=null,this._tradeService=null,this._setupService=null,this._drcService=null,this._weeklyReviewService=null,this._monthlyReviewService=null,this._optionsService=null,this._accountPageService&&(this._accountPageService.destroy(),this._accountPageService=null),this._backendIntegrationService&&(this._backendIntegrationService.cleanup(),this._backendIntegrationService=null),this._onboardingService&&(this._onboardingService.onunload(),this._onboardingService=null),this._telemetryService&&(this._telemetryService.onunload(),this._telemetryService=null),this.initializedServices.clear(),this.serviceInitQueue.clear()}};var b0=require("obsidian");var tW=_(B());var Je=_(B());Yn();Zt();var Vt=_(B());var eA=Vt.default.memo(({settings:e,data:t,onUpdate:r,filePath:n})=>{(0,Vt.useEffect)(()=>{},[e,n]);let[a,o]=(0,Vt.useState)(()=>{let p={};return e.sections.forEach(m=>{p[m.id]={checkboxes:{},textAreas:{}}}),t?{...t,sections:{...p,...t.sections}}:{sections:p,reviewed:!1}});(0,Vt.useEffect)(()=>{o(p=>{let m={...p.sections};return e.sections.forEach(h=>{m[h.id]||(m[h.id]={checkboxes:{},textAreas:{}})}),t?{...t,sections:{...m,...t.sections}}:{...p,sections:m}})},[t,e.sections]);let i=(0,Vt.useCallback)(p=>{o(p),r(p)},[r]),s=(p,m)=>{var f,b,v;let h={...a,sections:{...a.sections,[p]:{...a.sections[p],checkboxes:{...(f=a.sections[p])==null?void 0:f.checkboxes,[m]:!((v=(b=a.sections[p])==null?void 0:b.checkboxes)!=null&&v[m])}}}};i(h)},l=(p,m)=>{var f;let h={...a,sections:{...a.sections,[p]:{...a.sections[p],textAreas:{...(f=a.sections[p])==null?void 0:f.textAreas,[p]:m}}}};i(h)},c=p=>{var h,f;let m=a.sections[p.id];switch(p.type){case"header":return Vt.default.createElement("div",{className:"loss-review-header",key:p.id},p.title&&Vt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),p.content&&Vt.default.createElement("div",{className:"loss-review-content",dangerouslySetInnerHTML:{__html:d(p.content)}}));case"checkbox":let b=p.content||p.id,v=((h=m==null?void 0:m.checkboxes)==null?void 0:h[b])||!1;return Vt.default.createElement("div",{className:"loss-review-checkbox",key:p.id},Vt.default.createElement("label",{className:"checkbox-label"},Vt.default.createElement("input",{type:"checkbox",checked:v,onChange:()=>s(p.id,b)}),Vt.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(p.content||"")}})));case"checkboxList":return Vt.default.createElement("div",{className:"loss-review-checkbox-list",key:p.id},p.title&&Vt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),Vt.default.createElement("div",{className:"checkbox-items"},(p.items||[]).map((g,w)=>{var x;let C=`${p.id}-item-${w}`,k=((x=m==null?void 0:m.checkboxes)==null?void 0:x[C])||!1;return Vt.default.createElement("label",{key:C,className:"checkbox-label"},Vt.default.createElement("input",{type:"checkbox",checked:k,onChange:()=>s(p.id,C)}),Vt.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(g)}}))})));case"textarea":let y=((f=m==null?void 0:m.textAreas)==null?void 0:f[p.id])||"";return Vt.default.createElement("div",{className:"loss-review-textarea",key:p.id},p.title&&Vt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),Vt.default.createElement("textarea",{value:y,onChange:g=>l(p.id,g.target.value),placeholder:p.placeholder||"",rows:4,className:"loss-review-textarea-input"}));default:return null}},d=p=>{let m=p.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>");return m=m.replace(/__([^_]+)__/g,"<strong>$1</strong>"),m=m.replace(/(^|[^*])\*([^*]+)\*(?!\*)/g,"$1<em>$2</em>"),m=m.replace(/(^|[^_])_([^_]+)_(?!_)/g,"$1<em>$2</em>"),m=m.replace(/\n/g,"<br>"),m};if(!e.enabled)return null;let u=Vt.default.createElement("div",{className:"loss-review-sections"},e.sections.map(p=>{try{return Vt.default.createElement("div",{className:"loss-review-section",key:p.id},c(p))}catch(m){return console.error(`Error rendering loss review section ${p.id}:`,m),null}}));return Vt.default.createElement("div",{className:"loss-review-container"},Vt.default.createElement(Cr,{title:"Loss Review",defaultExpanded:!0},u))});eA.displayName="LossReview";AD();Za();Ea();var tA=Je.default.memo(({data:e,onEditClick:t})=>{let[r,n]=(0,Je.useState)(e.filePath||"unknown"),[a,o]=(0,Je.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Je.useEffect)(()=>{o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let i=(0,Je.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=zv({data:e}),d=Ee(),u=d?VB({plugin:d,initialData:e.lossReview,onUpdate:y=>{d!=null&&d.tradeService&&r&&r!=="unknown"&&d.tradeService.updateLossReview(r,y,"user-input").then(()=>{}).catch(g=>console.error("[TradeNote] Error updating loss review:",g))}}):{settings:{enabled:!1,sections:[]},updateLossReview:()=>{}},{settings:p,updateLossReview:m}=u;(0,Je.useEffect)(()=>{if(Pu(),i.current){i.current.classList.add("trade-note-mounted"),i.current.setAttribute("data-mounted-at",Date.now().toString());let y=i.current.closest(".journalit-trade-view");y&&y.classList.add("trade-note-mounted")}},[]);let h=(0,Je.useCallback)(y=>{if(i.current=y,y&&(!r||r==="unknown")){let g=y.getAttribute("data-displaying-file");if(g){n(g);return}let w=y.parentElement;for(;w;){let C=w.getAttribute("data-displaying-file")||w.getAttribute("data-file-path");if(C){n(C);break}w=w.parentElement}}},[r]),f=async y=>{if(!(d!=null&&d.viewManager)){console.error("Cannot navigate to account: ViewManager not available");return}try{let g=y;if(d.accountPageService)try{let C=(await d.accountPageService.getAllEnhancedAccounts()).find(k=>k.id===y||k.name===y);C&&C.name&&(g=C.name)}catch(w){console.warn("Could not resolve account via AccountPageService, using provided value:",w)}await d.viewManager.openAccountPageView(g)}catch(g){console.error("Error navigating to account page:",g)}},b=(0,Je.useCallback)(()=>{t&&t(e)},[e,t]),v=(0,Je.useCallback)(()=>{if(d!=null&&d.tradeService&&r&&r!=="unknown"){let y=new Date().toISOString();o({reviewed:!0,reviewedAt:y}),d.tradeService.updateTradeReviewStatus(r,!0,y,"user-input").then(()=>{}).catch(g=>{console.error("[TradeNote] Error updating review status:",g),o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})})}},[d,r,e.reviewed,e.reviewedAt]);return Je.default.createElement("div",{className:"trade-note-container",ref:h,"data-file-path":r,style:{margin:0}},Je.default.createElement(jv,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:e.isMissedTrade,exitTime:e.exitTime,tradeStatus:e.tradeStatus,exits:e.exits}),(e.entryTime||e.useDirectPnLInput)&&Je.default.createElement(mZ,{data:e,filePath:r,onEditClick:t,handleEditClick:b}),Je.default.createElement("div",{className:"trade-note-content"},Je.default.createElement(Mv,{images:e.images,onEditClick:b}),Je.default.createElement(Ov,{data:e,onAccountClick:f}),Je.default.createElement(Fv,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:b}),!ct({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits})&&s.pnl<0&&Je.default.createElement(eA,{settings:p,data:e.lossReview,onUpdate:m,filePath:r}),Je.default.createElement("div",{className:"trade-note-review-section"},Je.default.createElement(hl,{reviewed:a.reviewed,reviewedAt:a.reviewedAt,onMarkReviewed:v}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.commission===t.data.commission&&e.data.swap===t.data.swap&&e.data.fees===t.data.fees&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&JSON.stringify(e.data.lossReview)===JSON.stringify(t.data.lossReview)&&e.onEditClick===t.onEditClick),mZ=Je.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let a=Ee(),[o,i]=(0,Je.useState)([]),[s,l]=(0,Je.useState)([]),[c,d]=(0,Je.useState)(!1),[u,p]=(0,Je.useState)(!1),[m,h]=(0,Je.useState)(0),f=Je.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(e.useDirectPnLInput){let S=t.match(/(\d{2})(\d{2})(\d{2})-T\d+\.md$/);if(S){let[,T,P,M]=S,D=2e3+parseInt(M,10);return new Date(D,parseInt(P,10)-1,parseInt(T,10))}return new Date}return null},[e.entryTime,e.useDirectPnLInput,t]),b=Je.default.useMemo(()=>{if(!f||!a)return null;let{start:S,end:T}=Vw(f,a);return{startDate:S,endDate:T}},[f,a]),v=Je.default.useMemo(()=>!f||!a?"":oc(f,a),[f,a]),y=Je.default.useRef(null);(0,Je.useEffect)(()=>{let S=y.current;if(!S)return;let T=new IntersectionObserver(P=>{let[M]=P;M.isIntersecting&&(p(!0),T.disconnect())},{rootMargin:"50px",threshold:.1});return T.observe(S),()=>T.disconnect()},[]),(0,Je.useEffect)(()=>{let S=T=>{let{action:P,timestamp:M}=T.detail;(P==="created"||P==="updated")&&v&&setTimeout(()=>{Object.keys(sessionStorage).forEach(D=>{D.startsWith("trade-nav-")&&sessionStorage.removeItem(D)}),i([]),l([]),d(!1),h(D=>D+1)},200)};return document.addEventListener("journalit:trade-data-changed",S),document.addEventListener("journalit:missed-trade-data-changed",S),()=>{document.removeEventListener("journalit:trade-data-changed",S),document.removeEventListener("journalit:missed-trade-data-changed",S)}},[v]),(0,Je.useEffect)(()=>{if(!u||!b||!(a!=null&&a.tradeService)||!v)return;let S=!0;return(async()=>{try{let P=sessionStorage.getItem(`trade-nav-${v}`);if(P){let M=JSON.parse(P);if(S){let D=[],A=[];Array.isArray(M)?D=M:M&&typeof M=="object"&&(D=M.trades||[],A=M.missedTrades||[]);let L=D.map(j=>a.app.vault.getAbstractFileByPath(j)).filter(Boolean),N=A.map(j=>a.app.vault.getAbstractFileByPath(j)).filter(Boolean),E=[...D,...A],I=E.includes(t);if(a.app.vault.getAbstractFileByPath(t)&&!I||L.length===0&&N.length===0&&E.length>0)sessionStorage.removeItem(`trade-nav-${v}`);else{i(L),l(N);return}}}if(c)return;d(!0),setTimeout(async()=>{var M,D,A;try{let[L,N]=await Promise.all([a.tradeService.getTrades(b.startDate,b.endDate),((A=(D=(M=a.missedTradeService)==null?void 0:M.getMissedTrades)==null?void 0:D.call(M,b.startDate,b.endDate))==null?void 0:A.catch(E=>(console.warn("[TradeNote] Failed to fetch missed trades:",E),[])))||Promise.resolve([])]);if(S){i(L),l(N);try{let E=L.map(O=>O.path),I=N.map(O=>O.path);sessionStorage.setItem(`trade-nav-${v}`,JSON.stringify({trades:E,missedTrades:I}))}catch(E){console.warn("Error caching trades:",E)}}}catch(L){console.error("Error fetching trades for day:",L)}finally{S&&d(!1)}},100)}catch(P){console.error("Error in trade fetch setup:",P),S&&d(!1)}})(),()=>{S=!1}},[u,b,a==null?void 0:a.tradeService,v,a,m]);let g=(0,Je.useCallback)((S,T=!1)=>{try{a&&a.openFile?a.openFile(S,T):a!=null&&a.app?a.app.workspace.openLinkText(S,"",T):console.error("Cannot navigate: Plugin and App context not available.")}catch(P){console.error("Navigation error:",P)}},[a]),w=(0,Je.useCallback)(S=>a!=null&&a.drcService?a.drcService.getDRCNotePath(S):"",[a==null?void 0:a.drcService]),C=(0,Je.useCallback)(S=>a!=null&&a.weeklyReviewService?a.weeklyReviewService.getWeeklyReviewPath(S):"",[a==null?void 0:a.weeklyReviewService]),k=(0,Je.useCallback)(S=>a!=null&&a.drcService?a.drcService.getMonthlyReviewPath(S):null,[a==null?void 0:a.drcService]),x=(0,Je.useCallback)(()=>null,[]);return!f||!(a!=null&&a.drcService)||!(a!=null&&a.weeklyReviewService)?null:Je.default.createElement("div",{ref:y},u?Je.default.createElement(Je.default.Fragment,null,Je.default.createElement(Jw,{currentDate:f,trades:o,missedTrades:s,currentTradePath:t,navigateTo:g,getDRCPath:w,getWeeklyReviewPath:C,getMonthlyReviewPath:k,getYearlyReviewPath:x,onEditClick:r,handleEditClick:n})):Je.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Je.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))});Yn();var ty=class extends qi{constructor(t){super(t)}renderComponent(t,r,n,a,o){t.querySelector(".trade-note-container.trade-note-mounted")||this.renderTradeNote(t,r,n,a,o)}renderTradeNote(t,r,n,a,o){try{if(Pu(),!t||!t.isConnected){console.error(`[TradeNote] Cannot render into disconnected container for ${n}`);return}let i=o?`${n}-${a}-${o}`:`${n}-${a}`,s=a.startsWith("leaf-")?a.substring(5):a,l=this.processTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-trade-note-wrapper");if(d){if(d.querySelector(".trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let f=c.view.containerEl,b=c.containerEl;f&&f.id?u=f.id:b&&b.id&&(u=b.id)}let p=this.reactRoots.get(i);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(i);if(m&&(c&&u&&m.leafId!==u||o&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==o)){let f=o?`${n}-context-${o}`:`${n}-${a}-${u}`;if(m=this.reactRoots.get(f),!m){this.createReactRoot(t,f,u||void 0,o,l,n);return}}if(!m)this.createReactRoot(t,i,u||void 0,o,l,n);else{let f=m.domContainer;t.contains(f)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,i,u||void 0,o,l,n)}}catch(i){console.error("[TradeNote] Error rendering trade note:",i),t.setText("Error rendering trade note: "+(i instanceof Error?i.message:String(i)))}}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}createReactElement(t,r,n){let a=i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}if(s.openTradeFormInEditMode){try{let d=document.activeElement;d&&typeof d.blur=="function"&&d.blur();let u=document.querySelector(".cm-editor");u&&typeof u.blur=="function"&&u.blur()}catch(d){}try{requestAnimationFrame(()=>{setTimeout(()=>{try{s.openTradeFormInEditMode(i,r)}catch(d){console.error("Failed to open trade form in edit mode:",d)}},0)})}catch(d){try{s.openTradeFormInEditMode(i,r)}catch(u){console.error(u)}}}else console.warn("Edit mode not available - plugin method missing")},o=async i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.tradeService){console.error("Cannot access plugin instance for data update");return}try{await s.tradeService.updateTrade(i,r,"user-input")}catch(d){console.error("[TradeNote] Error updating trade data:",d)}};return tW.default.createElement(tA,{data:{...t,filePath:r},onEditClick:a,onDataUpdate:o})}unmountTradeNote(t,r,n,a){return this.unmountComponent(t,r,n)}unmountAllTradeNotes(){this.unmountAllComponents()}unmountLeafTradeNotes(t){this.unmountLeafComponents(t)}processTradeData(t){var n,a;let r={...t};t.images,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","ctags"].forEach(o=>{if(r[o]&&!Array.isArray(r[o]))if(typeof r[o]=="string"&&r[o].startsWith("[")&&r[o].endsWith("]"))try{let i=r[o].slice(1,-1).trim();i?r[o]=i.split(",").map(s=>s.trim()):r[o]=[]}catch(i){console.error(`[TradeNote] Failed to parse array string: ${o}`,i),r[o]=[r[o]]}else r[o]=[r[o]]}),t.entries&&Array.isArray(t.entries)&&(r.entries=t.entries.map(o=>({time:o.time?new Date(o.time):null,price:parseFloat(o.price)||0,size:parseFloat(o.size)||0}))),t.exits&&Array.isArray(t.exits)&&(r.exits=t.exits.map(o=>({time:o.time?new Date(o.time):null,price:parseFloat(o.price)||0,size:parseFloat(o.size)||0}))),["entryTime","exitTime"].forEach(o=>{if(r[o]&&typeof r[o]=="string")try{r[o]=new Date(r[o])}catch(i){console.error(`[TradeNote] Failed to parse date: ${o}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(o=>{if(r[o]!==void 0&&typeof r[o]!="number")try{r[o]=parseFloat(r[o])}catch(i){console.error(`[TradeNote] Failed to parse number: ${o}`,i)}}),r.pnl!==void 0&&r.pnl!==null&&(r.originalPnl=r.pnl),["useDirectPnLInput"].forEach(o=>{if(r[o]!==void 0&&typeof r[o]!="boolean")try{r[o]=!!r[o]}catch(i){console.error(`[TradeNote] Failed to parse boolean: ${o}`,i)}}),r.thesis=_v(t.thesis)||"";try{let o=(a=(n=window.app)==null?void 0:n.plugins)==null?void 0:a.plugins.journalit;if(o&&o.customFieldsService){let i=o.customFieldsService.getFields(),s={};i.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(o){console.error("[TradeNote] Error reconstructing custom fields:",o)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map(r=>typeof r!="string"?String(r):r.replace(/['"`]/g,"").trim()).filter(Boolean);if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[TradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}return typeof t=="string"?[t.replace(/['"`]/g,"").trim()]:[]}};var ry=class extends Hi{constructor(r,n){super(r,n,new ty(r));this._tradeUpdateListener=null;this.setupTradeUpdateListener()}isValidComponentType(r){return r&&r.type==="trade"}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}getComponentTypeIdentifier(){return"trade"}async getAdditionalDataForComponent(r,n){return{}}handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let a=this.app.metadataCache.getFileCache(r),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;let i=document.body,s=new MutationObserver((l,c)=>{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;d.forEach(p=>{var T;let m=p.querySelector(".metadata-container");if(!m)return;let h=m.closest(".workspace-leaf-content");if(!h)return;let f=this.findContainingLeaf(h),b=(T=f==null?void 0:f.view)==null?void 0:T.containerEl,v=m.closest(".workspace-leaf"),g=(v==null?void 0:v.id)||(b==null?void 0:b.id)||null,w=this.getUniqueElementId(p),C=g?`leaf-${g}`:w,k=!0;if(f){let P=f.view,M=null;(P&&"file"in P||P&&"getViewType"in P&&P.getViewType()==="markdown")&&(M=P.file),M&&(k=M.path===r.path)}if(!k)return;let x=this.getComponentClassName();p.querySelectorAll(`.${x}`).forEach(P=>{let M=P.getAttribute("data-file-path");if(M&&M!==r.path){let D=P.getAttribute("data-view-id"),A=P.getAttribute("data-leaf-id");D&&this.renderer.unmountComponent(M,D,A||void 0),P.remove()}});let S=Array.from(p.querySelectorAll(`.${x}`)).find(P=>P.getAttribute("data-file-path")===r.path);S||(S=document.createElement("div"),S.className=x,S.style.marginTop="0px",S.style.marginBottom="0px",S.style.padding="0px",S.setAttribute("data-file-path",r.path),S.setAttribute("data-view-id",C),S.setAttribute("data-editor-id",w),g&&S.setAttribute("data-leaf-id",g),S.setAttribute("data-inserted-at",Date.now().toString()),m.after(S)),setTimeout(()=>{this.renderer.renderComponent(S,o,r.path,C,w)},500),this.markFileRenderedInMode(r.path,"source")}),c.disconnect();let u=this.activeObservers.indexOf(c);u>-1&&this.activeObservers.splice(u,1)});this.activeObservers.push(s),s.observe(i,{childList:!0,subtree:!0}),setTimeout(()=>{s.disconnect();let l=this.activeObservers.indexOf(s);l>-1&&this.activeObservers.splice(l,1)},3e3)}renderAllActiveTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let a=n.view.file;if(!a||r.has(a.path))return;let o=this.app.metadataCache.getFileCache(a),i=o==null?void 0:o.frontmatter;if(!i||!this.isValidComponentType(i))return;r.add(a.path),setTimeout(()=>{this.handleFileOpen(a,!0)},300)}catch(a){console.error("[TradeNote] Error rendering active trade note at startup:",a)}})}renderActiveComponent(){this.renderActiveTradeNote()}setupTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let a=n.detail.filePath,o=this.app.vault.getAbstractFileByPath(a);if(!(o instanceof b0.TFile)){console.warn(`[TradeNote] Cannot find file for path: ${a}`);return}await this.refreshTradeNote(o)}catch(a){console.error("[TradeNote] Error handling trade update event:",a)}};document.addEventListener("journalit:trade-data-changed",r),this._tradeUpdateListener=r}async refreshTradeNote(r){try{let{forceMetadataCacheRefresh:n}=await Promise.resolve().then(()=>(Ss(),mB));await n(this.app,r,200);let a=this.app.metadataCache.getFileCache(r),o=(a==null?void 0:a.frontmatter)||{};if(o.type!=="trade"){console.warn(`[TradeNote] File is not a valid trade note: ${r.path}`);return}this.cleanupDuplicateComponents(r.path);let i=this.getComponentClassName(),s=document.querySelectorAll(`.${i}[data-file-path="${r.path}"]`);if(s.length===0)return;for(let l of Array.from(s)){let c=l,d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.style.display="block",c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>{setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:o,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"trade-note-mounted",contentSelector:".trade-note-container"}),m()}catch(h){console.error("[TradeNote] Error during re-render:",h),m()}},50)}))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[TradeNote] Error refreshing trade note for ${r.path}:`,n)}}cleanup(){super.cleanup(),this._tradeUpdateListener&&(document.removeEventListener("journalit:trade-data-changed",this._tradeUpdateListener),this._tradeUpdateListener=null)}renderActiveTradeNote(){var m;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;let o=this.app.workspace.getActiveViewOfType(b0.MarkdownView);if(!o){console.error("[TradeNote] No active markdown view found");return}let i=o.containerEl.closest(".workspace-leaf-content");if(!i){console.error("[TradeNote] Cannot find containing leaf for active view");return}let s=this.findContainingLeaf(i),l=(m=s==null?void 0:s.view)==null?void 0:m.containerEl,c=(l==null?void 0:l.id)||null,d=c?`leaf-${c}`:this.generateViewId(i),u=o.getMode()==="source",p=this.getComponentClassName();if(u){let h=o.containerEl.querySelector(".metadata-container");if(h){let f=Array.from(i.querySelectorAll(`.${p}`)).find(b=>{let v=b.getAttribute("data-file-path")===r.path,y=b.getAttribute("data-view-id")===d,g=!c||b.getAttribute("data-leaf-id")===c;return v&&y&&g});f||(f=document.createElement("div"),f.className=p,f.style.marginTop="0px",f.style.marginBottom="0px",f.style.padding="0px",f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),h.after(f)),this.renderer.renderComponent(f,a,r.path,d),this.markFileRenderedInMode(r.path,"source")}}else{let h=o.containerEl.querySelector(".markdown-preview-view");if(h){let f=Array.from(h.querySelectorAll(`.${p}`)).find(b=>{let v=b.getAttribute("data-file-path")===r.path,y=b.getAttribute("data-view-id")===d,g=!c||b.getAttribute("data-leaf-id")===c;return v&&y&&g});f||(f=document.createElement("div"),f.className=p,f.style.marginTop="0px",f.style.marginBottom="0px",f.style.padding="0px",f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),h.prepend(f)),this.renderer.renderComponent(f,a,r.path,d),this.markFileRenderedInMode(r.path,"preview")}}}};var fG=require("obsidian");var mG=_(B());var Or=_(B());Iu();Yn();var ye=_(B());var x0=_(B()),w0=({tabs:e,activeTab:t,onTabChange:r,className:n={}})=>{let{container:a="shared-tabs-container",tabList:o="shared-tabs",tab:i="shared-tab",activeTab:s="active"}=n;return x0.default.createElement("div",{className:a},x0.default.createElement("div",{className:o},e.map(l=>x0.default.createElement("button",{key:l.id,className:`${i} ${t===l.id?s:""}`,onClick:()=>r(l.id)},l.label,l.count!==void 0&&` (${l.count})`))))};var ny=_(B()),rW=({title:e,dateDisplay:t,navigationComponent:r,className:n={}})=>{let{container:a="shared-header",title:o="shared-header-title",dateContainer:i="shared-header-date"}=n;return ny.default.createElement("div",{className:a},ny.default.createElement("div",{className:i},ny.default.createElement("h2",{className:o},e," ",ny.default.createElement("span",null,t))),r)};var La=_(B());var S0=({goals:e,goalStatus:t,onToggleGoal:r,onAddGoal:n,onRemoveGoal:a,className:o={},title:i="Goals",emptyMessage:s="No goals found",emptyActionLabel:l,onEmptyAction:c,readOnly:d=!1})=>{let{container:u="shared-goal-tracker",goalItem:p="shared-goal-item",goalCheckbox:m="shared-goal-checkbox",goalText:h="shared-goal-text",completed:f="completed"}=o,[b,v]=(0,La.useState)(""),y=()=>{b.trim()&&n&&(n(b),v(""))};return!e||e.length===0?La.default.createElement("div",{className:u},La.default.createElement("h3",null,i),La.default.createElement(Ie,{message:s,actionButtonText:l,onActionButtonClick:c})):La.default.createElement("div",{className:u},La.default.createElement("h3",null,i),La.default.createElement("div",{className:`${u}-list`},e.map((g,w)=>La.default.createElement("div",{key:`goal-${w}`,className:p,onClick:C=>{let k=C.target;k.tagName!=="INPUT"&&k.tagName!=="LABEL"&&!d&&r(w)}},La.default.createElement("input",{type:"checkbox",className:m,checked:!!t[`goal_${w}`],onChange:()=>r(w),disabled:d,id:`goal-checkbox-${w}`}),La.default.createElement("label",{htmlFor:`goal-checkbox-${w}`,className:`${h} ${t[`goal_${w}`]?f:""}`},g),a&&!d&&La.default.createElement("button",{onClick:C=>{C.stopPropagation(),a(w)},className:`${u}-remove-button`,title:"Remove goal"},"\xD7")))),n&&!d&&La.default.createElement("div",{className:`${u}-add-container`},La.default.createElement("input",{type:"text",value:b,onChange:g=>v(g.target.value),placeholder:"Add a new goal",onKeyDown:g=>g.key==="Enter"&&y(),className:`${u}-add-input`}),La.default.createElement("button",{onClick:y,className:`${u}-add-button`},"Add")))};var Ao=_(B());DE();EE();Uw();var k0=({sectionName:e,sectionTitle:t,notes:r,imagePath:n,images:a=[],onNotesChange:o,onImageUploaded:i,onMultipleImagesUploaded:s,onImageDeleted:l,saveImageFunction:c,isCustom:d=!1,className:u={}})=>{let{container:p="shared-forecast-section",sectionTitle:m="shared-forecast-title",notesContainer:h="shared-forecast-notes",imageContainer:f="shared-forecast-image"}=u,b=a.length>0||!n&&s,v=n||!b,y=async S=>{try{let T=await c(S);return i(T),T}catch(T){return ve.error(`Error uploading image for ${e}:`,T),""}},g=async S=>{try{let P=(await Promise.all(S.map(M=>c(M)))).filter(M=>M!=="");return s&&P.length>1?s(P):P.length>0&&i(P[0]),P}catch(T){return ve.error(`Error uploading multiple images for ${e}:`,T),[]}},w=S=>typeof S=="function"&&S.length===0,C=S=>typeof S=="function"&&S.length===2,k=()=>{w(l)&&l()},x=(S,T)=>{C(l)&&l(S,T)};return Ao.default.createElement("div",{className:p,"data-section-name":e,"data-is-custom":d?"true":"false"},Ao.default.createElement("h4",{className:m},t," Chart"),Ao.default.createElement("div",{className:f},b?Ao.default.createElement(Ao.default.Fragment,null,Ao.default.createElement(fd,{onImageUploaded:i,onMultipleImagesUploaded:s,saveImageFunction:y,label:`Upload ${t} Chart${a.length>0?"s":""}`,enableDragDrop:!0,multiple:!0,enablePaste:!0}),a&&a.length>0&&Ao.default.createElement(ac,{images:a,showThumbnails:a.length>1,showCounter:a.length>1,enableDelete:!0,onDeleteImage:x,enableFullscreen:!0,className:a.length===1?"single-image-carousel":""})):Ao.default.createElement(Ao.default.Fragment,null,n?Ao.default.createElement(Nv,{imagePath:n,alt:`${t} Forecast`,enableFullscreen:!0,description:`${t} Forecast`,showDeleteButton:!0,onDelete:k}):Ao.default.createElement(fd,{onImageUploaded:i,saveImageFunction:y,label:`Upload ${t} Chart`,enableDragDrop:!0,multiple:!1,enablePaste:!0}))),Ao.default.createElement("div",{className:h},Ao.default.createElement("textarea",{value:r||"",onChange:S=>o(S.target.value),placeholder:`Add your ${t.toLowerCase()} notes here...`,rows:4,style:{width:"100%",boxSizing:"border-box"}})))};var Ds=_(B());Zt();Tw();Tm();dv();pv();Ft();function C0({data:e,filePath:t,openNote:r,plugin:n,serviceName:a,componentName:o,navigationOptions:i,tabConfig:s,updateMethodName:l,className:c={},topElement:d,bottomElement:u}){var D;let[p,m]=(0,Ds.useState)(e),[h,f]=(0,Ds.useState)(((D=s[0])==null?void 0:D.id)||""),b=Em(o,"general"),v=Ee(),y=n||v,{service:g,status:w}=Cs(a),{currentDate:C,getAdjacentReview:k,getRelatedReviewPaths:x}=i,S=r||((A,L=!0)=>{var N;try{let E=window.app;(N=E==null?void 0:E.workspace)==null||N.openLinkText(A,"",L)}catch(E){b(E,"Failed to navigate to path")}}),T=Cw({currentDate:C,navigateTo:S,getAdjacentReview:k,getRelatedReviewPaths:x,serviceName:a}),P=A=>{try{if(m(L=>a$(L,A)),g&&t&&l&&typeof g[l]=="function"){let L=BD(A);g[l](t,L).then(()=>{}).catch(N=>{Bi({message:`Failed to update ${o} in file`,error:N,component:o,operation:"updateData",severity:"error"})})}}catch(L){b(L,`Error updating ${o}`),m(N=>({...N,...A}))}},M=A=>{f(A)};return w==="loading"?Ds.default.createElement("div",{className:c.container||"review-base-container"},"Loading ",o,"..."):w==="error"?Ds.default.createElement("div",{className:c.container||"review-base-container"},Ds.default.createElement("div",{className:"error-state"},"Failed to load ",o,". Please try refreshing the page.")):Ds.default.createElement("div",{className:c.container||"review-base-container","data-component":o},d,Ds.default.createElement(rW,{title:`${o}`,dateDisplay:(()=>{if(o.toLowerCase().includes("w")&&o.toLowerCase().includes("review")&&o.match(/w\d+\s+review/i))return"";try{let A=Ot(),L=p.date instanceof Date?p.date:new Date(p.date);return Fe(L,A)}catch(A){return(p.date instanceof Date?p.date:new Date(p.date)).toLocaleDateString()}})(),navigationComponent:Ds.default.createElement(_m,{buttons:(()=>{let A=[],L=o.toLowerCase().includes("weekly")||o.match(/w\d+\s+review/i)!==null;return A.push({text:L?"Previous Week":"Previous Day",action:()=>T.handleNavigation(-1),icon:"left",disabled:T.isNavigating}),o.toLowerCase().includes("daily")||o.toLowerCase().includes("drc")?A.push({text:"Weekly Review",action:()=>T.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>T.navigateToRelatedReview("monthly")}):L?A.push({text:"Monthly Review",action:()=>T.navigateToRelatedReview("monthly")},{text:"Yearly Review",action:()=>T.navigateToRelatedReview("yearly")}):A.push({text:"Weekly Review",action:()=>T.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>T.navigateToRelatedReview("monthly")}),A.push({text:L?"Next Week":"Next Day",action:()=>T.handleNavigation(1),icon:"right",disabled:T.isNavigating}),A})(),className:`${o.toLowerCase().replace(/\s+/g,"-")}-navigation`}),className:c.header}),Ds.default.createElement(w0,{tabs:s,activeTab:h,onTabChange:M,className:c.tabContainer}),(()=>{try{let A=s.find(L=>L.id===h);return!A||typeof A.content!="function"?null:A.content({data:p,updateData:P,plugin:y,openNote:S})}catch(A){return console.error("Error rendering tab content:",A),null}})(),u)}var Dr=_(B()),aW=_(Yl()),Jm=Dr.default.memo(({content:e,children:t,className:r="",delay:n=300,preferredPosition:a="auto"})=>{let[o,i]=(0,Dr.useState)(!1),[s,l]=(0,Dr.useState)({top:-9999,left:-9999}),[c,d]=(0,Dr.useState)(!1),u=(0,Dr.useRef)({x:0,y:0}),p=(0,Dr.useRef)(null),m=(0,Dr.useRef)(null),h=(0,Dr.useRef)(null),f=(0,Dr.useRef)(null),b=(0,Dr.useCallback)(()=>{if(!f.current||!h.current)return;let w=f.current.getBoundingClientRect(),C=h.current.getBoundingClientRect(),k=window.innerWidth,x=window.innerHeight,S=8,T=0,P=0;switch(w.width<50&&w.height<50&&a==="auto"?"top":a){case"right":T=w.top+(w.height-C.height)/2,P=w.right+S,P+C.width>k-16&&(P=w.left-C.width-S);break;case"left":T=w.top+(w.height-C.height)/2,P=w.left-C.width-S,P<16&&(P=w.right+S);break;case"bottom":T=w.bottom+S,P=w.left+(w.width-C.width)/2;break;case"top":T=w.top-C.height-S,P=w.left+(w.width-C.width)/2,T<16&&(T=w.bottom+S);break;default:T=w.top-C.height-S,P=w.left+(w.width-C.width)/2,T<16&&(T=w.bottom+S)}let A=16;P<A&&(P=A),P+C.width>k-A&&(P=k-C.width-A),T<A&&(T=A),T+C.height>x-A&&(T=x-C.height-A),l({top:T,left:P})},[a]),v=(0,Dr.useCallback)(w=>{u.current={x:w.clientX,y:w.clientY},p.current&&cancelAnimationFrame(p.current),m.current=setTimeout(()=>{i(!0),d(!0)},n)},[n]),y=(0,Dr.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null),p.current&&(cancelAnimationFrame(p.current),p.current=null),i(!1),setTimeout(()=>d(!1),200)},[]);(0,Dr.useEffect)(()=>{o&&c&&(p.current=requestAnimationFrame(()=>{b()}))},[o,c,b]),(0,Dr.useEffect)(()=>()=>{m.current&&clearTimeout(m.current),p.current&&cancelAnimationFrame(p.current)},[]);let g=(0,Dr.useCallback)(w=>{o&&(Math.abs(w.clientX-u.current.x)>5||Math.abs(w.clientY-u.current.y)>5)&&(u.current={x:w.clientX,y:w.clientY},p.current&&cancelAnimationFrame(p.current),p.current=requestAnimationFrame(()=>{b()}))},[o,b]);return Dr.default.createElement(Dr.default.Fragment,null,Dr.default.createElement("div",{ref:f,onMouseEnter:v,onMouseLeave:y,onMouseMove:g,className:"tooltip-trigger"},t),c&&(0,aW.createPortal)(Dr.default.createElement("div",{ref:h,className:`journalit-tooltip ${r}`,style:{position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:9999,opacity:o?1:0,transition:"opacity 150ms ease-in-out",pointerEvents:"none"}},e),document.body))});Jm.displayName="Tooltip";ec();rd();gE();yo();var fZ=({forecast:e,updateData:t})=>{let r=({color:x,size:S=16})=>ye.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:S,height:S,viewBox:"0 0 24 24",fill:"none",stroke:x,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ye.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),ye.default.createElement("line",{x1:"4",y1:"22",x2:"4",y2:"15"})),n=[{value:null,icon:ye.default.createElement(r,{color:"var(--text-muted)"}),label:"None"},{value:"High",icon:ye.default.createElement(r,{color:"var(--color-error, #e53935)"}),label:"High"},{value:"Medium",icon:ye.default.createElement(r,{color:"var(--color-orange, #ef6c00)"}),label:"Medium"},{value:"Low",icon:ye.default.createElement(r,{color:"var(--interactive-accent, #4a90e2)"}),label:"Low"}],a=ye.default.createElement(r,{color:"var(--text-muted)"}),[o,i]=(0,ye.useState)(""),[s,l]=(0,ye.useState)(""),[c,d]=(0,ye.useState)(null),[u,p]=(0,ye.useState)(null),h=(()=>{if(e.levels&&!e.keyLevels)try{let x=e.levels.split(`
`).filter(M=>M.trim().length>0),S=/(low|medium|high)\s*:\s*(.*)/i,T=[],P=[];return x.forEach(M=>{let D=M.trim(),A=D.toLowerCase(),L=A.includes("support"),N=A.includes("resistance"),E=A.match(S);if(E){let I=E[1].charAt(0).toUpperCase()+E[1].slice(1).toLowerCase(),O=E[2].trim();L?T.push({price:O,importance:I}):N?P.push({price:O,importance:I}):P.push({price:O,importance:I})}else if(D.length>0)if(L){let I=A.replace(/support/i,"").trim();T.push({price:I||D,importance:null})}else if(N){let I=A.replace(/resistance/i,"").trim();P.push({price:I||D,importance:null})}else P.push({price:D,importance:null})}),{support:T,resistance:P}}catch(x){return console.error("Error migrating legacy levels:",x),{support:[],resistance:[]}}return e.keyLevels||{support:[],resistance:[]}})(),f=()=>{if(!o.trim())return;let x={...h,support:[...h.support,{price:o,importance:c}]};g(x),i(""),d(null)},b=()=>{if(!s.trim())return;let x={...h,resistance:[...h.resistance,{price:s,importance:u}]};g(x),l(""),p(null)},v=x=>{let S=[...h.support];S.splice(x,1),g({...h,support:S})},y=x=>{let S=[...h.resistance];S.splice(x,1),g({...h,resistance:S})},g=x=>{let S={...e,keyLevels:x};t({forecast:S})},w=x=>{x.key==="Enter"&&(x.preventDefault(),f())},C=x=>{x.key==="Enter"&&(x.preventDefault(),b())},k=x=>{switch(x){case"High":return"importance-high";case"Medium":return"importance-medium";case"Low":return"importance-low";default:return""}};return ye.default.createElement("div",{className:"drc-key-levels"},ye.default.createElement("div",{className:"drc-levels-container"},ye.default.createElement("div",{className:"drc-level-section support-section"},ye.default.createElement("h4",{className:"drc-level-header support-header"},"Support Levels"),ye.default.createElement("div",{className:"drc-level-add-container"},ye.default.createElement("div",{className:"drc-level-input-group"},ye.default.createElement("input",{type:"text",value:o,onChange:x=>i(x.target.value),onKeyDown:w,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),ye.default.createElement(fE,{options:n,value:c,onChange:x=>d(x),placeholderIcon:a,title:"Select importance level"}),ye.default.createElement(De,{variant:"primary",onClick:f,title:"Add support level",className:"drc-level-add-button"},"Add"))),ye.default.createElement("div",{className:"drc-levels-list"},h.support.length>0?h.support.map((x,S)=>ye.default.createElement("div",{key:`support-${S}`,className:`drc-level-item support-level ${k(x.importance)}`},ye.default.createElement("div",{className:"drc-level-price"},x.price),x.importance&&ye.default.createElement("div",{className:"drc-level-importance"},x.importance),ye.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>v(S),title:"Remove level"},ye.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):ye.default.createElement("div",{className:"drc-empty-levels"},"No support levels defined"))),ye.default.createElement("div",{className:"drc-level-section resistance-section"},ye.default.createElement("h4",{className:"drc-level-header resistance-header"},"Resistance Levels"),ye.default.createElement("div",{className:"drc-level-add-container"},ye.default.createElement("div",{className:"drc-level-input-group"},ye.default.createElement("input",{type:"text",value:s,onChange:x=>l(x.target.value),onKeyDown:C,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),ye.default.createElement(fE,{options:n,value:u,onChange:x=>p(x),placeholderIcon:a,title:"Select importance level"}),ye.default.createElement(De,{variant:"primary",onClick:b,title:"Add resistance level",className:"drc-level-add-button"},"Add"))),ye.default.createElement("div",{className:"drc-levels-list"},h.resistance.length>0?h.resistance.map((x,S)=>ye.default.createElement("div",{key:`resistance-${S}`,className:`drc-level-item resistance-level ${k(x.importance)}`},ye.default.createElement("div",{className:"drc-level-price"},x.price),x.importance&&ye.default.createElement("div",{className:"drc-level-importance"},x.importance),ye.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>y(S),title:"Remove level"},ye.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):ye.default.createElement("div",{className:"drc-empty-levels"},"No resistance levels defined")))),ye.default.createElement("style",null,`
        .drc-key-levels {
          margin-top: 16px;
        }

        .drc-levels-container {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }

        .drc-level-section {
          border-radius: 8px;
          padding: 16px;
          background-color: var(--background-secondary);
        }

        .support-section {
          border-left: 3px solid rgba(102, 187, 106, 0.7);
        }

        .resistance-section {
          border-left: 3px solid rgba(229, 57, 53, 0.7);
        }

        .drc-level-header {
          margin: 0 0 12px 0;
          padding-bottom: 8px;
          border-bottom: 1px solid var(--background-modifier-border);
          font-size: 14px;
          font-weight: 600;
          text-align: center;
        }

        .support-header {
          color: var(--color-success, #43a047);
        }

        .resistance-header {
          color: var(--color-error, #e53935);
        }

        .drc-level-add-container {
          margin-bottom: 12px;
        }

        .drc-level-input-group {
          display: flex;
          gap: 8px;
          width: 100%;
        }

        .drc-level-input {
          flex: 2;
          min-width: 0;
          padding: 8px 12px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
        }

        .drc-level-importance-select {
          width: 40px;
          position: relative;
          display: flex;
          align-items: center;
        }

        .importance-icon-wrapper {
          position: absolute;
          left: 4px;
          z-index: 1;
          pointer-events: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .importance-flag-icon {
          color: var(--text-muted);
        }

        .drc-importance-select {
          width: 40px;
          padding: 8px 0 8px 24px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          background-image: none; /* Remove dropdown arrow */
          text-align: center;
        }

        .drc-level-add-button {
          padding: 6px 12px !important;
          height: 32px !important; /* Reduced height */
          box-sizing: border-box !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }

        .drc-levels-list {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .drc-level-item {
          display: flex;
          align-items: center;
          padding: 8px 12px;
          background-color: var(--background-primary);
          border-radius: 4px;
          position: relative;
          justify-content: flex-start;
        }

        .support-level {
          border-left: 3px solid rgba(102, 187, 106, 0.5);
        }

        .resistance-level {
          border-left: 3px solid rgba(229, 57, 53, 0.5);
        }

        .drc-level-price {
          font-weight: 500;
          margin-right: 8px;
        }

        .drc-level-importance {
          font-size: 12px;
          padding: 2px 6px;
          border-radius: 3px;
        }

        .importance-high {
          background-color: rgba(229, 57, 53, 0.1);
        }

        .importance-high .drc-level-importance {
          background-color: rgba(229, 57, 53, 0.2);
          color: var(--color-error, #e53935);
        }

        .importance-medium {
          background-color: rgba(255, 152, 0, 0.1);
        }

        .importance-medium .drc-level-importance {
          background-color: rgba(255, 152, 0, 0.2);
          color: var(--color-orange, #ef6c00);
        }

        .importance-low {
          background-color: rgba(33, 150, 243, 0.1);
        }

        .importance-low .drc-level-importance {
          background-color: rgba(33, 150, 243, 0.2);
          color: var(--interactive-accent);
        }

        .drc-level-remove-button {
          padding: 0;
          width: 24px;
          height: 24px;
          background-color: rgba(229, 57, 53, 0.1);
          color: var(--color-error, #e53935);
          border: none;
          border-radius: 50%;
          cursor: pointer;
          font-size: 16px;
          line-height: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-left: auto; /* Always push to the right */
          text-align: center;
          vertical-align: middle;
        }

        .drc-empty-levels {
          color: var(--text-muted);
          font-style: italic;
          padding: 8px;
          text-align: center;
        }

        @media (min-width: 768px) {
          .drc-levels-container {
            flex-direction: row !important;
            gap: 16px !important;
          }

          .drc-level-section {
            width: calc(50% - 8px) !important;
          }
        }
      `))},oW=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:a,previousDayGoals:o})=>{let i=e,s=t,l=F=>{let z=i.preTradeChecklist||{},W={...z,[F]:!z[F]};s({preTradeChecklist:W})},c=F=>{let z={...i.dailyGoalStatus||{}},W=`goal_${F}`;z[W]=!z[W],s({dailyGoalStatus:z})},d=()=>{var F;try{let z=window.app;return(F=z==null?void 0:z.plugins)==null?void 0:F.plugins.journalit}catch(z){return console.error("Could not access plugin instance:",z),null}},u=()=>{var F,z;try{let W=d();return((z=(F=W==null?void 0:W.settings)==null?void 0:F.drc)==null?void 0:z.customTimeframes)||["Daily","4H","1H","30M"]}catch(W){return console.error("Error getting timeframes:",W),["Daily","4H","1H","30M"]}},p=()=>{let F=u(),z={},W={};return F.forEach(U=>{let K=U.replace(/\s+/g,"_").toLowerCase();z[K]=!1,W[K]=!1,U==="Daily"&&(z.daily=!1),U==="4H"&&(z.fourHour=!1),U==="1H"&&(z.oneHour=!1),U==="30M"&&(z.thirtyMin=!1),U==="Daily"&&(W.daily=!1),U==="4H"&&(W.fourHour=!1),U==="1H"&&(W.oneHour=!1),U==="30M"&&(W.thirtyMin=!1)}),{initialDragState:z,initialErrorState:W}},{initialDragState:m,initialErrorState:h}=p(),[f,b]=(0,ye.useState)(m),[v,y]=(0,ye.useState)(h),[g,w]=(0,ye.useState)([]),[C,k]=(0,ye.useState)({isOpen:!1,imagePath:"",description:""});(0,ye.useEffect)(()=>{async function F(){try{let z=d();if(!(z!=null&&z.drcService))return;let W=new Date(i.date),U=await z.drcService.getWeeklyEventsForDate(W);w(U)}catch(z){console.error("Error fetching weekly events for date:",i.date,z)}}i.date&&F()},[i.date]);let x=F=>{y(z=>({...z,[F]:!0}))},S=F=>{y(z=>({...z,[F]:!1}))},T=async(F,z,W=!1)=>{S(z);try{let U=d();if(!(U!=null&&U.drcService))throw new Error("DRC Service not available");let K=new Date(i.date),R=await U.drcService.saveDRCForecastImage(F,K,z);await L(z,R,W)}catch(U){console.error("Error uploading image:",U)}},P=(F,z=!1)=>async W=>(await T(W,F,z),""),M=(F,z,W=!1)=>{let K={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W)K.customTimeframes||(K.customTimeframes={}),K.customTimeframes[F]={...K.customTimeframes[F],notes:z};else{let R=F;R in K&&(K[R].notes=z)}s({forecast:K})},D=(F,z)=>{s({[F]:z})},A=()=>{var F,z,W;if(!i.preTradeChecklist||Object.keys(i.preTradeChecklist).length===0){let U=d(),K=((W=(z=(F=U==null?void 0:U.settings)==null?void 0:F.drc)==null?void 0:z.checklistItems)==null?void 0:W.length)>0;return ye.default.createElement(Ie,{message:"No pre-trade checklist items",subMessage:K?"Apply checklist items from plugin settings":"Add checklist items in the plugin settings",actionButtonText:K?"Apply Settings":void 0,onActionButtonClick:K?()=>{let R=U.settings.drc.checklistItems||[],q={};R.forEach(X=>{q[X]=!1}),s({preTradeChecklist:q})}:void 0,iconSize:36})}return ye.default.createElement("div",{className:"drc-checklist"},Object.entries(i.preTradeChecklist).map(([U,K],R)=>{let q=`checklist-${R}-${U.replace(/\s+/g,"-")}`;return ye.default.createElement("div",{key:q,className:"drc-checklist-item",onClick:X=>{let G=X.target;G.tagName!=="INPUT"&&G.tagName!=="LABEL"&&l(U)}},ye.default.createElement("input",{type:"checkbox",id:q,checked:K||!1,onChange:()=>l(U),className:"drc-checkbox"}),ye.default.createElement("label",{htmlFor:q},U))}))},L=async(F,z,W=!1)=>{var K,R;let U={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W){U.customTimeframes||(U.customTimeframes={});let q=Array.isArray((K=U.customTimeframes[F])==null?void 0:K.images)?[...U.customTimeframes[F].images]:[];U.customTimeframes[F]={...U.customTimeframes[F],images:[...q,z]}}else{let q=Array.isArray((R=U[F])==null?void 0:R.images)?[...U[F].images]:[];U[F]={...U[F],images:[...q,z]}}s({forecast:U})},N=async(F,z,W=!1)=>{var K,R;let U={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W){U.customTimeframes||(U.customTimeframes={});let q=Array.isArray((K=U.customTimeframes[F])==null?void 0:K.images)?[...U.customTimeframes[F].images]:[];U.customTimeframes[F]={...U.customTimeframes[F],images:[...q,...z]}}else{let q=Array.isArray((R=U[F])==null?void 0:R.images)?[...U[F].images]:[];U[F]={...U[F],images:[...q,...z]}}s({forecast:U})},E=async(F,z,W,U=!1)=>{var K,R,q;try{let X=d();X!=null&&X.drcService&&await X.drcService.deleteImage(W);let G={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(U){if((R=(K=G.customTimeframes)==null?void 0:K[F])!=null&&R.images){let H=[...G.customTimeframes[F].images];H.splice(z,1),G.customTimeframes[F]={...G.customTimeframes[F],images:H}}}else if((q=G[F])!=null&&q.images){let H=[...G[F].images];H.splice(z,1),G[F]={...G[F],images:H}}s({forecast:G})}catch(X){console.error("Error deleting image from section:",X)}},I=(F,z=!1)=>({getSectionData:()=>{var K;let W=i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""},U;if(z)U=((K=W.customTimeframes)==null?void 0:K[F])||{notes:""};else{let R=W[F];U=typeof R=="object"&&R!==null?R:{notes:""}}return U&&U.imagePath&&!U.images?{...U,images:[U.imagePath]}:{...U,images:(U==null?void 0:U.images)||[]}},handleImageUpload:async W=>{L(F,W,z),S(F)},handleMultipleImagesUpload:async W=>{N(F,W,z),S(F)},handleNotesChange:W=>{M(F,W,z)},handleImageDelete:(W,U)=>{E(F,W,U,z)}}),O=(F,z,W=!1)=>{let U=I(F,W),K=U.getSectionData();return ye.default.createElement(k0,{key:F,sectionName:F,sectionTitle:z,notes:K.notes||"",images:K.images||[],onNotesChange:U.handleNotesChange,onImageUploaded:U.handleImageUpload,onMultipleImagesUploaded:U.handleMultipleImagesUpload,onImageDeleted:U.handleImageDelete,saveImageFunction:async R=>{try{let q=d();if(!(q!=null&&q.drcService))throw new Error("DRC Service not available");let X=new Date(i.date);return await q.drcService.saveDRCForecastImage(R,X,F)}catch(q){throw console.error(`Error uploading image for ${F}:`,q),x(F),q}},isCustom:W,className:{container:"drc-forecast-section",sectionTitle:"drc-forecast-title",notesContainer:"drc-forecast-notes",imageContainer:"drc-image-container"}})},j=()=>{let F=i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""},z=u(),W={Daily:"daily","4H":"fourHour","1H":"oneHour","30M":"thirtyMin"};return ye.default.createElement("div",{className:"drc-note-forecast"},z.map(U=>{let K=U.replace(/\s+/g,"_").toLowerCase(),R=Object.keys(W).includes(U),q=R?W[U]:K;return O(q,U,!R)}),ye.default.createElement("div",{className:"drc-input-group"},ye.default.createElement("div",{style:{position:"relative",marginBottom:"4px"}},ye.default.createElement(la,{label:"Market Bias",value:F.bias||"",onChange:U=>{let K={...F,bias:U};s({forecast:K})},options:[{value:"Bullish",label:"Bullish"},{value:"Bearish",label:"Bearish"},{value:"Neutral",label:"Neutral"}],className:"drc-select",placeholder:"Select market bias"}),ye.default.createElement("style",null,`
              .drc-container .drc-input-group .select,
              .drc-container select {
                height: 38px !important;
                min-height: 38px !important;
                box-sizing: border-box !important;
                padding-top: 0 !important;
                padding-bottom: 0 !important;
                line-height: 38px !important;
              }

              .drc-container .drc-input-group .select option,
              .drc-container select option {
                height: auto !important;
                min-height: 24px !important;
                padding: 8px !important;
                line-height: normal !important;
              }`))),ye.default.createElement(fZ,{forecast:F,updateData:s}))};return ye.default.createElement("div",{className:"drc-note-preparation"},ye.default.createElement("div",{className:"drc-section"},ye.default.createElement(S0,{goals:o||null,goalStatus:i.dailyGoalStatus||{},onToggleGoal:c,title:"Daily Goals",emptyMessage:"No daily goals from previous day",emptyActionLabel:"",className:{container:"drc-weekly-goals",goalItem:"drc-checklist-item",goalCheckbox:"drc-checkbox",goalText:"drc-goal-text",completed:"completed"}})),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Pre-Trade Checklist"),A()),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Key Events"),g.length>0?ye.default.createElement("div",{className:"drc-weekly-events"},g.map((F,z)=>{let W=F.color?`event-color-${F.color}`:"event-color-gray";return ye.default.createElement("div",{key:`event-${z}`,className:`drc-weekly-event-item ${W}`},ye.default.createElement("div",{className:"drc-weekly-event-header"},ye.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},ye.default.createElement("h4",null,F.event),!F.day&&ye.default.createElement("span",{className:"drc-weekly-event-badge"},"All Week"))),F.notes&&ye.default.createElement("p",null,F.notes))})):ye.default.createElement(Ie,{message:"No key events for today",subMessage:"Events can be added in the weekly review",iconSize:36})),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Daily Forecast"),j()),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Media Links"),ye.default.createElement("div",{className:"drc-media"},ye.default.createElement("div",{className:"drc-input-group"},ye.default.createElement("label",null,"YouTube Link"),ye.default.createElement("input",{type:"text",value:i.youtubeLink||"",onChange:F=>D("youtubeLink",F.target.value),placeholder:"Link to your trading stream",className:"drc-input"})))))};var we=_(B());var Xm=_(B()),T0=({size:e=24,className:t=""})=>Xm.default.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t},Xm.default.createElement("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),Xm.default.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),Xm.default.createElement("path",{d:"M20.4 14.5L16 10 4 20"}),Xm.default.createElement("line",{x1:"4",y1:"4",x2:"20",y2:"20"}));Mm();Iv();tc();er();Ft();var Xe=_(B());er();var R0=_(B()),SW=_(B());function iW(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=iW(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function We(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=iW(e))&&(n&&(n+=" "),n+=t);return n}var fA=_(Qm()),$0=_(B()),xW=_(mW());var fW=_(Qm()),rn=e=>e===0?0:e>0?1:-1,Er=e=>typeof e=="number"&&e!=+e,cc=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,be=e=>(typeof e=="number"||e instanceof Number)&&!Er(e),Qn=e=>be(e)||typeof e=="string",TZ=0,li=e=>{var t=++TZ;return"".concat(e||"").concat(t)},Ma=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!be(t)&&typeof t!="string")return n;var o;if(cc(t)){if(r==null)return n;var i=t.indexOf("%");o=r*parseFloat(t.slice(0,i))/100}else o=+t;return Er(o)&&(o=n),a&&r!=null&&o>r&&(o=r),o},pA=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},ci=(e,t)=>be(e)&&be(t)?r=>e+r*(t-e):()=>t;function Fu(e,t,r){return be(e)&&be(t)?e+r*(t-e):t}function Zm(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):(0,fW.default)(n,t))===r)}var st=e=>e===null||typeof e=="undefined",Sd=e=>st(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));var hW=_(B()),PZ=["viewBox","children"],vW=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],gW=["points","pathLength"],_0={svg:PZ,polygon:gW,polyline:gW},B0=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ef=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if((0,hW.isValidElement)(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{B0.includes(a)&&(n[a]=t||(o=>r[a](r,o)))}),n},DZ=(e,t,r)=>n=>(e(t,r,n),null),ay=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var o=e[a];B0.includes(a)&&typeof o=="function"&&(n||(n={}),n[a]=DZ(o,t,r))}),n};var yW=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",bW=null,mA=null,wW=e=>{if(e===bW&&Array.isArray(mA))return mA;var t=[];return $0.Children.forEach(e,r=>{st(r)||((0,xW.isFragment)(r)?t=t.concat(wW(r.props.children)):t.push(r))}),mA=t,bW=e,t};function tf(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>yW(a)):n=[yW(t)],wW(e).forEach(a=>{var o=(0,fA.default)(a,"type.displayName")||(0,fA.default)(a,"type.name");n.indexOf(o)!==-1&&r.push(a)}),r}var rf=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,EZ=(e,t,r,n)=>{var a,o=(a=n&&(_0===null||_0===void 0?void 0:_0[n]))!==null&&a!==void 0?a:[];return t.startsWith("data-")||typeof e!="function"&&(n&&o.includes(t)||vW.includes(t))||r&&B0.includes(t)},Me=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if((0,$0.isValidElement)(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(o=>{var i;EZ((i=n)===null||i===void 0?void 0:i[o],o,t,r)&&(a[o]=n[o])}),a};var AZ=["children","width","height","viewBox","className","style","title","desc"];function gA(){return gA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gA.apply(null,arguments)}function IZ(e,t){if(e==null)return{};var r,n,a=NZ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function NZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hA=(0,SW.forwardRef)((e,t)=>{var{children:r,width:n,height:a,viewBox:o,className:i,style:s,title:l,desc:c}=e,d=IZ(e,AZ),u=o||{width:n,height:a,x:0,y:0},p=We("recharts-surface",i);return R0.createElement("svg",gA({},Me(d,!0,"svg"),{className:p,width:n,height:a,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),R0.createElement("title",null,l),R0.createElement("desc",null,c),r)});var W0=_(B());var LZ=["children","className"];function vA(){return vA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vA.apply(null,arguments)}function MZ(e,t){if(e==null)return{};var r,n,a=OZ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tr=W0.forwardRef((e,t)=>{var{children:r,className:n}=e,a=MZ(e,LZ),o=We("recharts-layer",n);return W0.createElement("g",vA({className:o},Me(a,!0),{ref:t}),r)});var yA=_(B()),kW=(0,yA.createContext)(null);var WW=_(B());function qt(e){return function(){return e}}var bA=Math.cos;var oy=Math.sin,Zn=Math.sqrt;var ju=Math.PI,fOe=ju/2,nf=2*ju;var xA=Math.PI,wA=2*xA,zu=1e-6,FZ=wA-zu;function CW(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function jZ(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return CW;let r=10**t;return function(n){this._+=n[0];for(let a=1,o=n.length;a<o;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}var _u=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?CW:jZ(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,o,i){this._append`C${+t},${+r},${+n},${+a},${this._x1=+o},${this._y1=+i}`}arcTo(t,r,n,a,o){if(t=+t,r=+r,n=+n,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,s=this._y1,l=n-t,c=a-r,d=i-t,u=s-r,p=d*d+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>zu)if(!(Math.abs(u*l-c*d)>zu)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-i,h=a-s,f=l*l+c*c,b=m*m+h*h,v=Math.sqrt(f),y=Math.sqrt(p),g=o*Math.tan((xA-Math.acos((f+p-b)/(2*v*y)))/2),w=g/y,C=g/v;Math.abs(w-1)>zu&&this._append`L${t+w*d},${r+w*u}`,this._append`A${o},${o},0,0,${+(u*m>d*h)},${this._x1=t+C*l},${this._y1=r+C*c}`}}arc(t,r,n,a,o,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(a),l=n*Math.sin(a),c=t+s,d=r+l,u=1^i,p=i?a-o:o-a;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>zu||Math.abs(this._y1-d)>zu)&&this._append`L${c},${d}`,n&&(p<0&&(p=p%wA+wA),p>FZ?this._append`A${n},${n},0,1,${u},${t-s},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=d}`:p>zu&&this._append`A${n},${n},0,${+(p>=xA)},${u},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}};function TW(){return new _u}TW.prototype=_u.prototype;function af(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new _u(t)}var SOe=Array.prototype.slice;function of(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function PW(e){this._context=e}PW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function kd(e){return new PW(e)}function U0(e){return e[0]}function q0(e){return e[1]}function iy(e,t){var r=qt(!0),n=null,a=kd,o=null,i=af(s);e=typeof e=="function"?e:e===void 0?U0:qt(e),t=typeof t=="function"?t:t===void 0?q0:qt(t);function s(l){var c,d=(l=of(l)).length,u,p=!1,m;for(n==null&&(o=a(m=i())),c=0;c<=d;++c)!(c<d&&r(u=l[c],c,l))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(u,c,l),+t(u,c,l));if(m)return o=null,m+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:qt(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:qt(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:qt(!!l),s):r},s.curve=function(l){return arguments.length?(a=l,n!=null&&(o=a(n)),s):a},s.context=function(l){return arguments.length?(l==null?n=o=null:o=a(n=l),s):n},s}function sf(e,t,r){var n=null,a=qt(!0),o=null,i=kd,s=null,l=af(c);e=typeof e=="function"?e:e===void 0?U0:qt(+e),t=typeof t=="function"?t:t===void 0?qt(0):qt(+t),r=typeof r=="function"?r:r===void 0?q0:qt(+r);function c(u){var p,m,h,f=(u=of(u)).length,b,v=!1,y,g=new Array(f),w=new Array(f);for(o==null&&(s=i(y=l())),p=0;p<=f;++p){if(!(p<f&&a(b=u[p],p,u))===v)if(v=!v)m=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=p-1;h>=m;--h)s.point(g[h],w[h]);s.lineEnd(),s.areaEnd()}v&&(g[p]=+e(b,p,u),w[p]=+t(b,p,u),s.point(n?+n(b,p,u):g[p],r?+r(b,p,u):w[p]))}if(y)return s=null,y+""||null}function d(){return iy().defined(a).curve(i).context(o)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:qt(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:qt(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:qt(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:qt(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:qt(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:qt(+u),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(n).y(t)},c.defined=function(u){return arguments.length?(a=typeof u=="function"?u:qt(!!u),c):a},c.curve=function(u){return arguments.length?(i=u,o!=null&&(s=i(o)),c):i},c.context=function(u){return arguments.length?(u==null?o=s=null:s=i(o=u),c):o},c}var H0=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}};function SA(e){return new H0(e,!0)}function kA(e){return new H0(e,!1)}var lf={draw(e,t){let r=Zn(t/ju);e.moveTo(r,0),e.arc(0,0,r,0,nf)}};var CA={draw(e,t){let r=Zn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var DW=Zn(1/3),zZ=DW*2,TA={draw(e,t){let r=Zn(t/zZ),n=r*DW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}};var PA={draw(e,t){let r=Zn(t),n=-r/2;e.rect(n,n,r,r)}};var _Z=.8908130915292852,EW=oy(ju/10)/oy(7*ju/10),BZ=oy(nf/10)*EW,$Z=-bA(nf/10)*EW,DA={draw(e,t){let r=Zn(t*_Z),n=BZ*r,a=$Z*r;e.moveTo(0,-r),e.lineTo(n,a);for(let o=1;o<5;++o){let i=nf*o/5,s=bA(i),l=oy(i);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*a,l*n+s*a)}e.closePath()}};var EA=Zn(3),AA={draw(e,t){let r=-Zn(t/(EA*3));e.moveTo(0,r*2),e.lineTo(-EA*r,-r),e.lineTo(EA*r,-r),e.closePath()}};var Ki=-.5,Ji=Zn(3)/2,IA=1/Zn(12),RZ=(IA/2+1)*3,NA={draw(e,t){let r=Zn(t/RZ),n=r/2,a=r*IA,o=n,i=r*IA+r,s=-o,l=i;e.moveTo(n,a),e.lineTo(o,i),e.lineTo(s,l),e.lineTo(Ki*n-Ji*a,Ji*n+Ki*a),e.lineTo(Ki*o-Ji*i,Ji*o+Ki*i),e.lineTo(Ki*s-Ji*l,Ji*s+Ki*l),e.lineTo(Ki*n+Ji*a,Ki*a-Ji*n),e.lineTo(Ki*o+Ji*i,Ki*i-Ji*o),e.lineTo(Ki*s+Ji*l,Ki*l-Ji*s),e.closePath()}};function V0(e,t){let r=null,n=af(a);e=typeof e=="function"?e:qt(e||lf),t=typeof t=="function"?t:qt(t===void 0?64:+t);function a(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:qt(o),a):e},a.size=function(o){return arguments.length?(t=typeof o=="function"?o:qt(+o),a):t},a.context=function(o){return arguments.length?(r=o==null?null:o,a):r},a}function cf(){}function df(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function AW(e){this._context=e}AW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:df(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:df(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function LA(e){return new AW(e)}function IW(e){this._context=e}IW.prototype={areaStart:cf,areaEnd:cf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:df(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function MA(e){return new IW(e)}function NW(e){this._context=e}NW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:df(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OA(e){return new NW(e)}function LW(e){this._context=e}LW.prototype={areaStart:cf,areaEnd:cf,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function FA(e){return new LW(e)}function MW(e){return e<0?-1:1}function OW(e,t,r){var n=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(n||a<0&&-0),i=(r-e._y1)/(a||n<0&&-0),s=(o*a+i*n)/(n+a);return(MW(o)+MW(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function FW(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function jA(e,t,r){var n=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-n)/3;e._context.bezierCurveTo(n+s,a+s*t,o-s,i-s*r,o,i)}function G0(e){this._context=e}G0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jA(this,this._t0,FW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,jA(this,FW(this,r=OW(this,e,t)),r);break;default:jA(this,this._t0,r=OW(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function jW(e){this._context=new zW(e)}(jW.prototype=Object.create(G0.prototype)).point=function(e,t){G0.prototype.point.call(this,t,e)};function zW(e){this._context=e}zW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,o){this._context.bezierCurveTo(t,e,n,r,o,a)}};function zA(e){return new G0(e)}function _A(e){return new jW(e)}function BW(e){this._context=e}BW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=_W(e),a=_W(t),o=0,i=1;i<r;++o,++i)this._context.bezierCurveTo(n[0][o],a[0][o],n[1][o],a[1][o],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function _W(e){var t,r=e.length-1,n,a=new Array(r),o=new Array(r),i=new Array(r);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,o[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/o[t-1],o[t]-=n,i[t]-=n*i[t-1];for(a[r-1]=i[r-1]/o[r-1],t=r-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function BA(e){return new BW(e)}function Y0(e,t){this._context=e,this._t=t}Y0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function $A(e){return new Y0(e,.5)}function RA(e){return new Y0(e,0)}function WA(e){return new Y0(e,1)}function Xi(e,t){if((i=e.length)>1)for(var r=1,n,a,o=e[t[0]],i,s=o.length;r<i;++r)for(a=o,o=e[t[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function uf(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function WZ(e,t){return e[t]}function UZ(e){let t=[];return t.key=e,t}function UA(){var e=qt([]),t=uf,r=Xi,n=WZ;function a(o){var i=Array.from(e.apply(this,arguments),UZ),s,l=i.length,c=-1,d;for(let u of o)for(s=0,++c;s<l;++s)(i[s][c]=[0,+n(u,i[s].key,c,o)]).data=u;for(s=0,d=of(t(i));s<l;++s)i[d[s]].index=s;return r(i,d),i}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:qt(Array.from(o)),a):e},a.value=function(o){return arguments.length?(n=typeof o=="function"?o:qt(+o),a):n},a.order=function(o){return arguments.length?(t=o==null?uf:typeof o=="function"?o:qt(Array.from(o)),a):t},a.offset=function(o){return arguments.length?(r=o==null?Xi:o,a):r},a}function qA(e,t){if((n=e.length)>0){for(var r,n,a=0,o=e[0].length,i;a<o;++a){for(i=r=0;r<n;++r)i+=e[r][a][1]||0;if(i)for(r=0;r<n;++r)e[r][a][1]/=i}Xi(e,t)}}function HA(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,o=n.length;r<o;++r){for(var i=0,s=0;i<a;++i)s+=e[i][r][1]||0;n[r][1]+=n[r][0]=-s/2}Xi(e,t)}}function VA(e,t){if(!(!((i=e.length)>0)||!((o=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,o,i;n<o;++n){for(var s=0,l=0,c=0;s<i;++s){for(var d=e[t[s]],u=d[n][1]||0,p=d[n-1][1]||0,m=(u-p)/2,h=0;h<s;++h){var f=e[t[h]],b=f[n][1]||0,v=f[n-1][1]||0;m+=b-v}l+=u,c+=m*u}a[n-1][1]+=a[n-1][0]=r,l&&(r-=c/l)}a[n-1][1]+=a[n-1][0]=r,Xi(e,t)}}var HZ=["type","size","sizeType"];function GA(){return GA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GA.apply(null,arguments)}function $W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$W(Object(r),!0).forEach(function(n){VZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$W(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VZ(e,t,r){return(t=GZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GZ(e){var t=YZ(e,"string");return typeof t=="symbol"?t:t+""}function YZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KZ(e,t){if(e==null)return{};var r,n,a=JZ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UW={symbolCircle:lf,symbolCross:CA,symbolDiamond:TA,symbolSquare:PA,symbolStar:DA,symbolTriangle:AA,symbolWye:NA},XZ=Math.PI/180,QZ=e=>{var t="symbol".concat(Sd(e));return UW[t]||lf},ZZ=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*XZ;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},eee=(e,t)=>{UW["symbol".concat(Sd(e))]=t},YA=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=KZ(e,HZ),o=RW(RW({},a),{},{type:t,size:r,sizeType:n}),i=()=>{var u=QZ(t),p=V0().type(u).size(ZZ(r,n,t));return p()},{className:s,cx:l,cy:c}=o,d=Me(o,!0);return l===+l&&c===+c&&r===+r?WW.createElement("path",GA({},d,{className:We("recharts-symbols",s),transform:"translate(".concat(l,", ").concat(c,")"),d:i()})):null};YA.registerSymbol=eee;var DI=_(d5());function u5(e,t,r){return t===!0?(0,DI.default)(e,r):typeof t=="function"?(0,DI.default)(e,t):e}var w5=_(b5()),AI=_(B());var x5=_(B()),ly=(0,x5.createContext)(null);var ere=e=>e,wt=()=>{var e=(0,AI.useContext)(ly);return e?e.store.dispatch:ere},nS=()=>{},tre=()=>nS,rre=(e,t)=>e===t;function xe(e){var t=(0,AI.useContext)(ly);return(0,w5.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:tre,t?t.store.getState:nS,t?t.store.getState:nS,t?e:nS,rre)}function nre(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function are(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function ore(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var S5=e=>Array.isArray(e)?e:[e];function ire(e){let t=Array.isArray(e[0])?e[0]:e;return ore(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function sre(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var H2e=Symbol();var V2e=Object.getPrototypeOf({});var lre=class{constructor(e){this.value=e}deref(){return this.value}},cre=typeof WeakRef!="undefined"?WeakRef:lre,dre=0,k5=1;function aS(){return{s:dre,v:void 0,o:null,p:null}}function C5(e,t={}){let r=aS(),{resultEqualityCheck:n}=t,a,o=0;function i(){var u,p;let s=r,{length:l}=arguments;for(let m=0,h=l;m<h;m++){let f=arguments[m];if(typeof f=="function"||typeof f=="object"&&f!==null){let b=s.o;b===null&&(s.o=b=new WeakMap);let v=b.get(f);v===void 0?(s=aS(),b.set(f,s)):s=v}else{let b=s.p;b===null&&(s.p=b=new Map);let v=b.get(f);v===void 0?(s=aS(),b.set(f,s)):s=v}}let c=s,d;if(s.s===k5)d=s.v;else if(d=e.apply(null,arguments),o++,n){let m=(p=(u=a==null?void 0:a.deref)==null?void 0:u.call(a))!=null?p:a;m!=null&&n(m,d)&&(d=m,o!==0&&o--),a=typeof d=="object"&&d!==null||typeof d=="function"?new cre(d):d}return c.s=k5,c.v=d,d}return i.clearCache=()=>{r=aS(),i.resetResultsCount()},i.resultsCount=()=>o,i.resetResultsCount=()=>{o=0},i}function ure(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let o=0,i=0,s,l={},c=a.pop();typeof c=="object"&&(l=c,c=a.pop()),nre(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let d={...r,...l},{memoize:u,memoizeOptions:p=[],argsMemoize:m=C5,argsMemoizeOptions:h=[],devModeChecks:f={}}=d,b=S5(p),v=S5(h),y=ire(a),g=u(function(){return o++,c.apply(null,arguments)},...b),w=!0,C=m(function(){i++;let x=sre(y,arguments);return s=g.apply(null,x),s},...v);return Object.assign(C,{resultFunc:c,memoizedResultFunc:g,dependencies:y,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>s,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:u,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var ne=ure(C5),pre=Object.assign((e,t=ne)=>{are(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(o=>e[o]);return t(n,(...o)=>o.reduce((i,s,l)=>(i[r[l]]=s,i),{}))},{withTypes:()=>pre});var M5=_(cy()),BI=e=>e.legend.settings,O5=e=>e.legend.size,Lre=e=>e.legend.payload,oje=ne([Lre,BI],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?(0,M5.default)(n,r):n});var iS=_(B()),oS=1;function F5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=(0,iS.useState)({height:0,left:0,top:0,width:0}),n=(0,iS.useCallback)(a=>{if(a!=null){var o=a.getBoundingClientRect(),i={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(i.height-t.height)>oS||Math.abs(i.left-t.left)>oS||Math.abs(i.top-t.top)>oS||Math.abs(i.width-t.width)>oS)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}var Jne=_(B());function fa(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Mre=typeof Symbol=="function"&&Symbol.observable||"@@observable",j5=Mre,$I=()=>Math.random().toString(36).substring(7).split("").join("."),Ore={INIT:`@@redux/INIT${$I()}`,REPLACE:`@@redux/REPLACE${$I()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${$I()}`},sS=Ore;function lS(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function RI(e,t,r){if(typeof e!="function")throw new Error(fa(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(fa(0));if(typeof t=="function"&&typeof r=="undefined"&&(r=t,t=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(fa(1));return r(RI)(e,t)}let n=e,a=t,o=new Map,i=o,s=0,l=!1;function c(){i===o&&(i=new Map,o.forEach((b,v)=>{i.set(v,b)}))}function d(){if(l)throw new Error(fa(3));return a}function u(b){if(typeof b!="function")throw new Error(fa(4));if(l)throw new Error(fa(5));let v=!0;c();let y=s++;return i.set(y,b),function(){if(v){if(l)throw new Error(fa(6));v=!1,c(),i.delete(y),o=null}}}function p(b){if(!lS(b))throw new Error(fa(7));if(typeof b.type=="undefined")throw new Error(fa(8));if(typeof b.type!="string")throw new Error(fa(17));if(l)throw new Error(fa(9));try{l=!0,a=n(a,b)}finally{l=!1}return(o=i).forEach(y=>{y()}),b}function m(b){if(typeof b!="function")throw new Error(fa(10));n=b,p({type:sS.REPLACE})}function h(){let b=u;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(fa(11));function y(){let w=v;w.next&&w.next(d())}return y(),{unsubscribe:b(y)}},[j5](){return this}}}return p({type:sS.INIT}),{dispatch:p,subscribe:u,getState:d,replaceReducer:m,[j5]:h}}function Fre(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:sS.INIT})=="undefined")throw new Error(fa(12));if(typeof r(void 0,{type:sS.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(fa(13))})}function cS(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),a,o;try{Fre(r)}catch(i){o=i}return function(s={},l){if(o)throw o;let c=!1,d={};for(let u=0;u<n.length;u++){let p=n[u],m=r[p],h=s[p],f=m(h,l);if(typeof f=="undefined"){let b=l&&l.type;throw new Error(fa(14))}d[p]=f,c=c||f!==h}return c=c||n.length!==Object.keys(s).length,c?d:s}}function ff(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function z5(...e){return t=>(r,n)=>{let a=t(r,n),o=()=>{throw new Error(fa(15))},i={getState:a.getState,dispatch:(l,...c)=>o(l,...c)},s=e.map(l=>l(i));return o=ff(...s)(a.dispatch),{...a,dispatch:o}}}function dS(e){return lS(e)&&"type"in e&&typeof e.type=="string"}var U5=Symbol.for("immer-nothing"),_5=Symbol.for("immer-draftable"),di=Symbol.for("immer-state");function Es(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var gf=Object.getPrototypeOf;function dc(e){return!!e&&!!e[di]}function As(e){var t;return e?q5(e)||Array.isArray(e)||!!e[_5]||!!((t=e.constructor)!=null&&t[_5])||gS(e)||hS(e):!1}var jre=Object.prototype.constructor.toString();function q5(e){if(!e||typeof e!="object")return!1;let t=gf(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===jre}function uS(e,t){fS(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function fS(e){let t=e[di];return t?t.type_:Array.isArray(e)?1:gS(e)?2:hS(e)?3:0}function qI(e,t){return fS(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function H5(e,t,r){let n=fS(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function zre(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function gS(e){return e instanceof Map}function hS(e){return e instanceof Set}function $u(e){return e.copy_||e.base_}function HI(e,t){if(gS(e))return new Map(e);if(hS(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=q5(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[di];let a=Reflect.ownKeys(n);for(let o=0;o<a.length;o++){let i=a[o],s=n[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(gf(e),n)}else{let n=gf(e);if(n!==null&&r)return{...e};let a=Object.create(n);return Object.assign(a,e)}}function vS(e,t=!1){return yS(e)||dc(e)||!As(e)||(fS(e)>1&&(e.set=e.add=e.clear=e.delete=_re),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>vS(n,!0))),e}function _re(){Es(2)}function yS(e){return Object.isFrozen(e)}var Bre={};function Ru(e){let t=Bre[e];return t||Es(0,e),t}var dy;function V5(){return dy}function $re(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function B5(e,t){t&&(Ru("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function VI(e){GI(e),e.drafts_.forEach(Rre),e.drafts_=null}function GI(e){e===dy&&(dy=e.parent_)}function $5(e){return dy=$re(dy,e)}function Rre(e){let t=e[di];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function R5(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[di].modified_&&(VI(t),Es(4)),As(e)&&(e=pS(t,e),t.parent_||mS(t,e)),t.patches_&&Ru("Patches").generateReplacementPatches_(r[di].base_,e,t.patches_,t.inversePatches_)):e=pS(t,r,[]),VI(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==U5?e:void 0}function pS(e,t,r){if(yS(t))return t;let n=t[di];if(!n)return uS(t,(a,o)=>W5(e,n,t,a,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return mS(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,o=a,i=!1;n.type_===3&&(o=new Set(a),a.clear(),i=!0),uS(o,(s,l)=>W5(e,n,a,s,l,r,i)),mS(e,a,!1),r&&e.patches_&&Ru("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function W5(e,t,r,n,a,o,i){if(dc(a)){let s=o&&t&&t.type_!==3&&!qI(t.assigned_,n)?o.concat(n):void 0,l=pS(e,a,s);if(H5(r,n,l),dc(l))e.canAutoFreeze_=!1;else return}else i&&r.add(a);if(As(a)&&!yS(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;pS(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&mS(e,a)}}function mS(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&vS(t,r)}function Wre(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:V5(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,o=JI;r&&(a=[n],o=uy);let{revoke:i,proxy:s}=Proxy.revocable(a,o);return n.draft_=s,n.revoke_=i,s}var JI={get(e,t){if(t===di)return e;let r=$u(e);if(!qI(r,t))return Ure(e,r,t);let n=r[t];return e.finalized_||!As(n)?n:n===WI(e.base_,t)?(UI(e),e.copy_[t]=KI(n,e)):n},has(e,t){return t in $u(e)},ownKeys(e){return Reflect.ownKeys($u(e))},set(e,t,r){let n=G5($u(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=WI($u(e),t),o=a==null?void 0:a[di];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(zre(r,a)&&(r!==void 0||qI(e.base_,t)))return!0;UI(e),YI(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return WI(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,UI(e),YI(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=$u(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Es(11)},getPrototypeOf(e){return gf(e.base_)},setPrototypeOf(){Es(12)}},uy={};uS(JI,(e,t)=>{uy[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});uy.deleteProperty=function(e,t){return uy.set.call(this,e,t,void 0)};uy.set=function(e,t,r){return JI.set.call(this,e[0],t,r,e[0])};function WI(e,t){let r=e[di];return(r?$u(r):e)[t]}function Ure(e,t,r){var a;let n=G5(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function G5(e,t){if(!(t in e))return;let r=gf(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=gf(r)}}function YI(e){e.modified_||(e.modified_=!0,e.parent_&&YI(e.parent_))}function UI(e){e.copy_||(e.copy_=HI(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qre=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let o=r;r=t;let i=this;return function(l=o,...c){return i.produce(l,d=>r.call(this,d,...c))}}typeof r!="function"&&Es(6),n!==void 0&&typeof n!="function"&&Es(7);let a;if(As(t)){let o=$5(this),i=KI(t,void 0),s=!0;try{a=r(i),s=!1}finally{s?VI(o):GI(o)}return B5(o,n),R5(a,o)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===U5&&(a=void 0),this.autoFreeze_&&vS(a,!0),n){let o=[],i=[];Ru("Patches").generateReplacementPatches_(t,a,o,i),n(o,i)}return a}else Es(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...s)=>this.produceWithPatches(i,l=>t(l,...s));let n,a;return[this.produce(t,r,(i,s)=>{n=i,a=s}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){As(e)||Es(8),dc(e)&&(e=pi(e));let t=$5(this),r=KI(e,void 0);return r[di].isManual_=!0,GI(t),r}finishDraft(e,t){let r=e&&e[di];(!r||!r.isManual_)&&Es(9);let{scope_:n}=r;return B5(n,t),R5(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));let n=Ru("Patches").applyPatches_;return dc(e)?n(e,t):this.produce(e,a=>n(a,t))}};function KI(e,t){let r=gS(e)?Ru("MapSet").proxyMap_(e,t):hS(e)?Ru("MapSet").proxySet_(e,t):Wre(e,t);return(t?t.scope_:V5()).drafts_.push(r),r}function pi(e){return dc(e)||Es(10,e),Y5(e)}function Y5(e){if(!As(e)||yS(e))return e;let t=e[di],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=HI(e,t.scope_.immer_.useStrictShallowCopy_)}else r=HI(e,!0);return uS(r,(n,a)=>{H5(r,n,Y5(a))}),t&&(t.finalized_=!1),r}var ui=new qre,py=ui.produce,cje=ui.produceWithPatches.bind(ui),dje=ui.setAutoFreeze.bind(ui),uje=ui.setUseStrictShallowCopy.bind(ui),pje=ui.applyPatches.bind(ui),mje=ui.createDraft.bind(ui),fje=ui.finishDraft.bind(ui);function K5(e){return({dispatch:r,getState:n})=>a=>o=>typeof o=="function"?o(r,n,e):a(o)}var J5=K5(),X5=K5;var Hre=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ff:ff.apply(null,arguments)},Sje=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},Vre=e=>e&&typeof e.match=="function";function Nn(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(mi(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>dS(n)&&n.type===e,r}var o4=class my extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,my.prototype)}static get[Symbol.species](){return my}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new my(...t[0].concat(this)):new my(...t.concat(this))}};function Q5(e){return As(e)?py(e,()=>{}):e}function bS(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Gre(e){return typeof e=="boolean"}var Yre=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:o=!0}=t!=null?t:{},i=new o4;return r&&(Gre(r)?i.push(J5):i.push(X5(r.extraArgument))),i},Kre="RTK_autoBatch";var Z5=e=>t=>{setTimeout(t,e)},Jre=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,o=!1,i=!1,s=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:Z5(10):e.type==="callback"?e.queueNotification:Z5(e.timeout),c=()=>{i=!1,o&&(o=!1,s.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let u=()=>a&&d(),p=n.subscribe(u);return s.add(d),()=>{p(),s.delete(d)}},dispatch(d){var u;try{return a=!((u=d==null?void 0:d.meta)!=null&&u[Kre]),o=!a,o&&(i||(i=!0,l(c))),n.dispatch(d)}finally{a=!0}}})},Xre=e=>function(r){let{autoBatch:n=!0}=r!=null?r:{},a=new o4(e);return n&&a.push(Jre(typeof n=="object"?n:void 0)),a};function i4(e){let t=Yre(),{reducer:r=void 0,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:o=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{},l;if(typeof r=="function")l=r;else if(lS(r))l=cS(r);else throw new Error(mi(1));let c;typeof n=="function"?c=n(t):c=t();let d=ff;a&&(d=Hre({trace:!1,...typeof a=="object"&&a}));let u=z5(...c),p=Xre(u),m=typeof s=="function"?s(p):p(),h=d(...m);return RI(l,i,h)}function s4(e){let t={},r=[],n,a={addCase(o,i){let s=typeof o=="string"?o:o.type;if(!s)throw new Error(mi(28));if(s in t)throw new Error(mi(29));return t[s]=i,a},addMatcher(o,i){return r.push({matcher:o,reducer:i}),a},addDefaultCase(o){return n=o,a}};return e(a),[t,r,n]}function Qre(e){return typeof e=="function"}function Zre(e,t){let[r,n,a]=s4(t),o;if(Qre(e))o=()=>Q5(e());else{let s=Q5(e);o=()=>s}function i(s=o(),l){let c=[r[l.type],...n.filter(({matcher:d})=>d(l)).map(({reducer:d})=>d)];return c.filter(d=>!!d).length===0&&(c=[a]),c.reduce((d,u)=>{if(u)if(dc(d)){let m=u(d,l);return m===void 0?d:m}else{if(As(d))return py(d,p=>u(p,l));{let p=u(d,l);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},s)}return i.getInitialState=o,i}var ene=(e,t)=>Vre(e)?e.match(t):e(t);function tne(...e){return t=>e.some(r=>ene(r,t))}var rne="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",l4=(e=21)=>{let t="",r=e;for(;r--;)t+=rne[Math.random()*64|0];return t},nne=["name","message","stack","code"],XI=class{constructor(e,t){Rp(this,"_type");this.payload=e,this.meta=t}},e4=class{constructor(e,t){Rp(this,"_type");this.payload=e,this.meta=t}},ane=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of nne)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},t4="External signal was aborted",one=(()=>{function e(t,r,n){let a=Nn(t+"/fulfilled",(l,c,d,u)=>({payload:l,meta:{...u||{},arg:d,requestId:c,requestStatus:"fulfilled"}})),o=Nn(t+"/pending",(l,c,d)=>({payload:void 0,meta:{...d||{},arg:c,requestId:l,requestStatus:"pending"}})),i=Nn(t+"/rejected",(l,c,d,u,p)=>({payload:u,error:(n&&n.serializeError||ane)(l||"Rejected"),meta:{...p||{},arg:d,requestId:c,rejectedWithValue:!!u,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function s(l,{signal:c}={}){return(d,u,p)=>{let m=n!=null&&n.idGenerator?n.idGenerator(l):l4(),h=new AbortController,f,b;function v(g){b=g,h.abort()}c&&(c.aborted?v(t4):c.addEventListener("abort",()=>v(t4),{once:!0}));let y=async function(){var C,k;let g;try{let x=(C=n==null?void 0:n.condition)==null?void 0:C.call(n,l,{getState:u,extra:p});if(sne(x)&&(x=await x),x===!1||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let S=new Promise((T,P)=>{f=()=>{P({name:"AbortError",message:b||"Aborted"})},h.signal.addEventListener("abort",f)});d(o(m,l,(k=n==null?void 0:n.getPendingMeta)==null?void 0:k.call(n,{requestId:m,arg:l},{getState:u,extra:p}))),g=await Promise.race([S,Promise.resolve(r(l,{dispatch:d,getState:u,extra:p,requestId:m,signal:h.signal,abort:v,rejectWithValue:(T,P)=>new XI(T,P),fulfillWithValue:(T,P)=>new e4(T,P)})).then(T=>{if(T instanceof XI)throw T;return T instanceof e4?a(T.payload,m,l,T.meta):a(T,m,l)})])}catch(x){g=x instanceof XI?i(null,m,l,x.payload,x.meta):i(x,m,l)}finally{f&&h.signal.removeEventListener("abort",f)}return n&&!n.dispatchConditionRejection&&i.match(g)&&g.meta.condition||d(g),g}();return Object.assign(y,{abort:v,requestId:m,arg:l,unwrap(){return y.then(ine)}})}}return Object.assign(s,{pending:o,rejected:i,fulfilled:a,settled:tne(i,a),typePrefix:t})}return e.withTypes=()=>e,e})();function ine(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function sne(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var c4=Symbol.for("rtk-slice-createasyncthunk"),Dje={[c4]:one};function lne(e,t){return`${e}/${t}`}function cne({creators:e}={}){var r;let t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[c4];return function(a){let{name:o,reducerPath:i=o}=a;if(!o)throw new Error(mi(11));let s=(typeof a.reducers=="function"?a.reducers(une()):a.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,C){let k=typeof w=="string"?w:w.type;if(!k)throw new Error(mi(12));if(k in c.sliceCaseReducersByType)throw new Error(mi(13));return c.sliceCaseReducersByType[k]=C,d},addMatcher(w,C){return c.sliceMatchers.push({matcher:w,reducer:C}),d},exposeAction(w,C){return c.actionCreators[w]=C,d},exposeCaseReducer(w,C){return c.sliceCaseReducersByName[w]=C,d}};l.forEach(w=>{let C=s[w],k={reducerName:w,type:lne(o,w),createNotation:typeof a.reducers=="function"};mne(C)?gne(k,C,d,t):pne(k,C,d)});function u(){let[w={},C=[],k=void 0]=typeof a.extraReducers=="function"?s4(a.extraReducers):[a.extraReducers],x={...w,...c.sliceCaseReducersByType};return Zre(a.initialState,S=>{for(let T in x)S.addCase(T,x[T]);for(let T of c.sliceMatchers)S.addMatcher(T.matcher,T.reducer);for(let T of C)S.addMatcher(T.matcher,T.reducer);k&&S.addDefaultCase(k)})}let p=w=>w,m=new Map,h=new WeakMap,f;function b(w,C){return f||(f=u()),f(w,C)}function v(){return f||(f=u()),f.getInitialState()}function y(w,C=!1){function k(S){let T=S[w];return typeof T=="undefined"&&C&&(T=bS(h,k,v)),T}function x(S=p){let T=bS(m,C,()=>new WeakMap);return bS(T,S,()=>{var M;let P={};for(let[D,A]of Object.entries((M=a.selectors)!=null?M:{}))P[D]=dne(A,S,()=>bS(h,S,v),C);return P})}return{reducerPath:w,getSelectors:x,get selectors(){return x(k)},selectSlice:k}}let g={name:o,reducer:b,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...y(i),injectInto(w,{reducerPath:C,...k}={}){let x=C!=null?C:i;return w.inject({reducerPath:x,reducer:b},k),{...g,...y(x,!0)}}};return g}}function dne(e,t,r,n){function a(o,...i){let s=t(o);return typeof s=="undefined"&&n&&(s=r()),e(s,...i)}return a.unwrapped=e,a}var Ar=cne();function une(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function pne({type:e,reducerName:t,createNotation:r},n,a){let o,i;if("reducer"in n){if(r&&!fne(n))throw new Error(mi(17));o=n.reducer,i=n.prepare}else o=n;a.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,i?Nn(e,i):Nn(e))}function mne(e){return e._reducerDefinitionType==="asyncThunk"}function fne(e){return e._reducerDefinitionType==="reducerWithPrepare"}function gne({type:e,reducerName:t},r,n,a){if(!a)throw new Error(mi(18));let{payloadCreator:o,fulfilled:i,pending:s,rejected:l,settled:c,options:d}=r,u=a(e,o,d);n.exposeAction(t,u),i&&n.addCase(u.fulfilled,i),s&&n.addCase(u.pending,s),l&&n.addCase(u.rejected,l),c&&n.addMatcher(u.settled,c),n.exposeCaseReducer(t,{fulfilled:i||xS,pending:s||xS,rejected:l||xS,settled:c||xS})}function xS(){}var hne="task",d4="listener",u4="completed",eN="cancelled",vne=`task-${eN}`,yne=`task-${u4}`,QI=`${d4}-${eN}`,bne=`${d4}-${u4}`,kS=class{constructor(e){Rp(this,"name","TaskAbortError");Rp(this,"message");this.code=e,this.message=`${hne} ${eN} (reason: ${e})`}},tN=(e,t)=>{if(typeof e!="function")throw new TypeError(mi(32))},wS=()=>{},p4=(e,t=wS)=>(e.catch(t),e),m4=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Wu=(e,t)=>{let r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Uu=e=>{if(e.aborted){let{reason:t}=e;throw new kS(t)}};function f4(e,t){let r=wS;return new Promise((n,a)=>{let o=()=>a(new kS(e.reason));if(e.aborted){o();return}r=m4(e,o),t.finally(()=>r()).then(n,a)}).finally(()=>{r=wS})}var xne=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof kS?"cancelled":"rejected",error:r}}finally{t==null||t()}},SS=e=>t=>p4(f4(e,t).then(r=>(Uu(e),r))),g4=e=>{let t=SS(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:hf}=Object,r4={},CS="listenerMiddleware",wne=(e,t)=>{let r=n=>m4(e,()=>Wu(n,e.reason));return(n,a)=>{tN(n,"taskExecutor");let o=new AbortController;r(o);let i=xne(async()=>{Uu(e),Uu(o.signal);let s=await n({pause:SS(o.signal),delay:g4(o.signal),signal:o.signal});return Uu(o.signal),s},()=>Wu(o,yne));return a!=null&&a.autoJoin&&t.push(i.catch(wS)),{result:SS(e)(i),cancel(){Wu(o,vne)}}}},Sne=(e,t)=>{let r=async(n,a)=>{Uu(t);let o=()=>{},s=[new Promise((l,c)=>{let d=e({predicate:n,effect:(u,p)=>{p.unsubscribe(),l([u,p.getState(),p.getOriginalState()])}});o=()=>{d(),c()}})];a!=null&&s.push(new Promise(l=>setTimeout(l,a,null)));try{let l=await f4(t,Promise.race(s));return Uu(t),l}finally{o()}};return(n,a)=>p4(r(n,a))},h4=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:o}=e;if(t)a=Nn(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(mi(21));return tN(o,"options.listener"),{predicate:a,type:t,effect:o}},v4=hf(e=>{let{type:t,predicate:r,effect:n}=h4(e);return{id:l4(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(mi(22))}}},{withTypes:()=>v4}),n4=(e,t)=>{let{type:r,effect:n,predicate:a}=h4(t);return Array.from(e.values()).find(o=>(typeof r=="string"?o.type===r:o.predicate===a)&&o.effect===n)},ZI=e=>{e.pending.forEach(t=>{Wu(t,QI)})},kne=e=>()=>{e.forEach(ZI),e.clear()},a4=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},y4=hf(Nn(`${CS}/add`),{withTypes:()=>y4}),Cne=Nn(`${CS}/removeAll`),b4=hf(Nn(`${CS}/remove`),{withTypes:()=>b4}),Tne=(...e)=>{console.error(`${CS}/error`,...e)},uc=(e={})=>{let t=new Map,{extra:r,onError:n=Tne}=e;tN(n,"onError");let a=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),u=>{d.unsubscribe(),u!=null&&u.cancelActive&&ZI(d)}),o=d=>{var p;let u=(p=n4(t,d))!=null?p:v4(d);return a(u)};hf(o,{withTypes:()=>o});let i=d=>{let u=n4(t,d);return u&&(u.unsubscribe(),d.cancelActive&&ZI(u)),!!u};hf(i,{withTypes:()=>i});let s=async(d,u,p,m)=>{let h=new AbortController,f=Sne(o,h.signal),b=[];try{d.pending.add(h),await Promise.resolve(d.effect(u,hf({},p,{getOriginalState:m,condition:(v,y)=>f(v,y).then(Boolean),take:f,delay:g4(h.signal),pause:SS(h.signal),extra:r,signal:h.signal,fork:wne(h.signal,b),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((v,y,g)=>{v!==h&&(Wu(v,QI),g.delete(v))})},cancel:()=>{Wu(h,QI),d.pending.delete(h)},throwIfCancelled:()=>{Uu(h.signal)}})))}catch(v){v instanceof kS||a4(n,v,{raisedBy:"effect"})}finally{await Promise.all(b),Wu(h,bne),d.pending.delete(h)}},l=kne(t);return{middleware:d=>u=>p=>{if(!dS(p))return u(p);if(y4.match(p))return o(p.payload);if(Cne.match(p)){l();return}if(b4.match(p))return i(p.payload);let m=d.getState(),h=()=>{if(m===r4)throw new Error(mi(23));return m},f;try{if(f=u(p),t.size>0){let b=d.getState(),v=Array.from(t.values());for(let y of v){let g=!1;try{g=y.predicate(p,b,m)}catch(w){g=!1,a4(n,w,{raisedBy:"predicate"})}g&&s(y,p,d,h)}}}finally{m=r4}return f},startListening:o,stopListening:i,clearListeners:l}};var Aje=Symbol.for("rtk-state-proxy-original");function mi(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Pne={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},x4=Ar({name:"chartLayout",initialState:Pne,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:w4,setLayout:S4,setChartSize:k4,setScale:C4}=x4.actions,T4=x4.reducer;var Y4=_(Qm());var L4=_(cy()),M4=_(Qm());var Ine=_(B());function P4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P4(Object(r),!0).forEach(function(n){Dne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dne(e,t,r){return(t=Ene(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ene(e){var t=Ane(e,"string");return typeof t=="symbol"?t:t+""}function Ane(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fy=Math.PI/180;var Nne=e=>e*180/Math.PI,Kr=(e,t,r,n)=>({x:e+Math.cos(-fy*n)*r,y:t+Math.sin(-fy*n)*r}),E4=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Lne=(e,t)=>{var{x:r,y:n}=e,{x:a,y:o}=t;return Math.sqrt((r-a)**2+(n-o)**2)},Mne=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:o}=t,i=Lne({x:r,y:n},{x:a,y:o});if(i<=0)return{radius:i,angle:0};var s=(r-a)/i,l=Math.acos(s);return n>o&&(l=2*Math.PI-l),{radius:i,angle:Nne(l),angleInRadian:l}},One=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),o=Math.min(n,a);return{startAngle:t-o*360,endAngle:r-o*360}},Fne=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),o=Math.floor(n/360),i=Math.min(a,o);return e+i*360},A4=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:o}=Mne({x:r,y:n},t),{innerRadius:i,outerRadius:s}=t;if(a<i||a>s||a===0)return null;var{startAngle:l,endAngle:c}=One(t),d=o,u;if(l<=c){for(;d>c;)d-=360;for(;d<l;)d+=360;u=d>=l&&d<=c}else{for(;d>l;)d-=360;for(;d<c;)d+=360;u=d>=c&&d<=l}return u?D4(D4({},t),{},{radius:a,angle:Fne(d,t)}):null};function I4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I4(Object(r),!0).forEach(function(n){jne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jne(e,t,r){return(t=zne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zne(e){var t=_ne(e,"string");return typeof t=="symbol"?t:t+""}function _ne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ir(e,t,r){return st(e)||st(t)?r:Qn(t)?(0,M4.default)(e,t,r):typeof t=="function"?t(e):r}var O4=(e,t,r,n,a)=>{var o,i=-1,s=(o=t==null?void 0:t.length)!==null&&o!==void 0?o:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<s;l++){var c=l>0?r[l-1].coordinate:r[s-1].coordinate,d=r[l].coordinate,u=l>=s-1?r[0].coordinate:r[l+1].coordinate,p=void 0;if(rn(d-c)!==rn(u-d)){var m=[];if(rn(u-d)===rn(a[1]-a[0])){p=u;var h=d+a[1]-a[0];m[0]=Math.min(h,(h+c)/2),m[1]=Math.max(h,(h+c)/2)}else{p=c;var f=u+a[1]-a[0];m[0]=Math.min(d,(f+d)/2),m[1]=Math.max(d,(f+d)/2)}var b=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(e>b[0]&&e<=b[1]||e>=m[0]&&e<=m[1]){({index:i}=r[l]);break}}else{var v=Math.min(c,u),y=Math.max(c,u);if(e>(v+d)/2&&e<=(y+d)/2){({index:i}=r[l]);break}}}else if(t){for(var g=0;g<s;g++)if(g===0&&e<=(t[g].coordinate+t[g+1].coordinate)/2||g>0&&g<s-1&&e>(t[g].coordinate+t[g-1].coordinate)/2&&e<=(t[g].coordinate+t[g+1].coordinate)/2||g===s-1&&e>(t[g].coordinate+t[g-1].coordinate)/2){({index:i}=t[g]);break}}return i},F4=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:o,verticalAlign:i,layout:s}=t;if((s==="vertical"||s==="horizontal"&&i==="middle")&&o!=="center"&&be(e[o]))return Qi(Qi({},e),{},{[o]:e[o]+(n||0)});if((s==="horizontal"||s==="vertical"&&o==="center")&&i!=="middle"&&be(e[i]))return Qi(Qi({},e),{},{[i]:e[i]+(a||0)})}return e},Io=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",rN=(e,t,r,n)=>{if(n)return e.map(s=>s.coordinate);var a,o,i=e.map(s=>(s.coordinate===t&&(a=!0),s.coordinate===r&&(o=!0),s.coordinate));return a||i.push(t),o||i.push(r),i},nN=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:o,scale:i,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:p,axisType:m}=e;if(!i)return null;var h=s==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,f=(t||r)&&a==="category"&&i.bandwidth?i.bandwidth()/h:0;if(f=m==="angleAxis"&&o&&o.length>=2?rn(o[0]-o[1])*2*f:f,t&&(u||p)){var b=(u||p||[]).map((v,y)=>{var g=n?n.indexOf(v):v;return{coordinate:i(g)+f,value:v,offset:f,index:y}});return b.filter(v=>!Er(v.coordinate))}return l&&c?c.map((v,y)=>({coordinate:i(v)+f,value:v,index:y,offset:f})):i.ticks&&!r&&d!=null?i.ticks(d).map((v,y)=>({coordinate:i(v)+f,value:v,offset:f,index:y})):i.domain().map((v,y)=>({coordinate:i(v)+f,value:n?n[v]:v,index:y,offset:f}))},N4=1e-4,j4=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-N4,o=Math.max(n[0],n[1])+N4,i=e(t[0]),s=e(t[r-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[r-1]])}},z4=(e,t)=>{if(!t||t.length!==2||!be(t[0])||!be(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!be(e[0])||e[0]<r)&&(a[0]=r),(!be(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},Bne=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,o=0,i=0;i<t;++i){var s=Er(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=o,e[i][r][1]=o+s,o=e[i][r][1])}},$ne=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,o=0;o<t;++o){var i=Er(e[o][r][1])?e[o][r][0]:e[o][r][1];i>=0?(e[o][r][0]=a,e[o][r][1]=a+i,a=e[o][r][1]):(e[o][r][0]=0,e[o][r][1]=0)}},Rne={sign:Bne,expand:qA,none:Xi,silhouette:HA,wiggle:VA,positive:$ne},_4=(e,t,r)=>{var n=Rne[r],a=UA().keys(t).value((o,i)=>+Ir(o,i,0)).order(uf).offset(n);return a(e)};function vf(e){return e==null?void 0:String(e)}function yf(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:o,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!st(a[t.dataKey])){var s=Zm(r,"value",a[t.dataKey]);if(s)return s.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var l=Ir(a,st(i)?t.dataKey:i);return st(l)?null:t.scale(l)}var aN=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:o,index:i}=e;if(t.type==="category")return r[i]?r[i].coordinate+n:null;var s=Ir(o,t.dataKey,t.scale.domain()[i]);return st(s)?null:t.scale(s)-a/2+n},B4=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},Wne=e=>{var t=e.flat(2).filter(be);return[Math.min(...t),Math.max(...t)]},Une=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],$4=(e,t,r)=>{if(e!=null)return Une(Object.keys(e).reduce((n,a)=>{var o=e[a],{stackedData:i}=o,s=i.reduce((l,c)=>{var d=Wne(c.slice(t,r+1));return[Math.min(l[0],d[0]),Math.max(l[1],d[1])]},[1/0,-1/0]);return[Math.min(s[0],n[0]),Math.max(s[1],n[1])]},[1/0,-1/0]))},oN=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iN=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Is=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=(0,L4.default)(t,d=>d.coordinate),o=1/0,i=1,s=a.length;i<s;i++){var l=a[i],c=a[i-1];o=Math.min((l.coordinate||0)-(c.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0};function sN(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:o}=e;return Qi(Qi({},t),{},{dataKey:r,payload:n,value:a,name:o})}function pc(e,t){if(e)return String(e);if(typeof t=="string")return t}function R4(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var o=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return o?{x:e,y:t}:null}return n?A4({x:e,y:t},n):null}var W4=(e,t,r,n)=>{var a=t.find(c=>c&&c.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,{radius:i}=n;return Qi(Qi(Qi({},n),Kr(n.cx,n.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,{angle:l}=n;return Qi(Qi(Qi({},n),Kr(n.cx,n.cy,s,l)),{},{angle:l,radius:s})}return{x:0,y:0}},U4=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius;var No=e=>e.layout.width,Lo=e=>e.layout.height,q4=e=>e.layout.scale,TS=e=>e.layout.margin;var gy=ne(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),hy=ne(e=>e.cartesianAxis.yAxis,e=>Object.values(e));var H4="data-recharts-item-index",V4="data-recharts-item-data-key",bf=60;function G4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G4(Object(r),!0).forEach(function(n){qne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qne(e,t,r){return(t=Hne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hne(e){var t=Vne(e,"string");return typeof t=="symbol"?t:t+""}function Vne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gne=e=>e.brush.height,xr=ne([No,Lo,TS,Gne,gy,hy,BI,O5],(e,t,r,n,a,o,i,s)=>{var l=o.reduce((h,f)=>{var{orientation:b}=f;if(!f.mirror&&!f.hide){var v=typeof f.width=="number"?f.width:bf;return Cd(Cd({},h),{},{[b]:h[b]+v})}return h},{left:r.left||0,right:r.right||0}),c=a.reduce((h,f)=>{var{orientation:b}=f;return!f.mirror&&!f.hide?Cd(Cd({},h),{},{[b]:(0,Y4.default)(h,"".concat(b))+f.height}):h},{top:r.top||0,bottom:r.bottom||0}),d=Cd(Cd({},c),l),u=d.bottom;d.bottom+=n,d=F4(d,i,s);var p=e-d.left-d.right,m=t-d.top-d.bottom;return Cd(Cd({brushBottom:u},d),{},{width:Math.max(p,0),height:Math.max(m,0)})}),K4=ne(xr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),PS=ne(No,Lo,(e,t)=>({x:0,y:0,width:e,height:t}));var Yne=_(B()),DS=_(B()),Kne=(0,DS.createContext)(null),Et=()=>(0,DS.useContext)(Kne)!=null;var xf=e=>e.brush,qu=ne([xf,xr,TS],(e,t,r)=>({height:e.height,x:be(e.x)?e.x:t.left,y:be(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:be(e.width)?e.width:t.width}));var Td=()=>{var e,t=Et(),r=xe(K4),n=xe(qu),a=(e=xe(xf))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},Xne={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Zi=()=>{var e;return(e=xe(xr))!==null&&e!==void 0?e:Xne},ES=()=>xe(No),AS=()=>xe(Lo);var dt=e=>e.layout.layoutType,bl=()=>xe(dt);var Qne={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},J4=Ar({name:"legend",initialState:Qne,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=pi(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:mze,setLegendSettings:fze,addLegendPayload:X4,removeLegendPayload:Q4}=J4.actions,Z4=J4.reducer;var ns=_(B()),q8=_(B()),H8=_(Yl());var Ns=_(B()),t3=_(cy());function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}function e3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e3(Object(r),!0).forEach(function(n){Zne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zne(e,t,r){return(t=eae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eae(e){var t=tae(e,"string");return typeof t=="symbol"?t:t+""}function tae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rae(e){return Array.isArray(e)&&Qn(e[0])&&Qn(e[1])?e.join(" ~ "):e}var r3=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:o,formatter:i,itemSorter:s,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:p=!1}=e,m=()=>{if(o&&o.length){var C={padding:0,margin:0},k=(s?(0,t3.default)(o,s):o).map((x,S)=>{if(x.type==="none")return null;var T=x.formatter||i||rae,{value:P,name:M}=x,D=P,A=M;if(T){var L=T(P,M,x,S,o);if(Array.isArray(L))[D,A]=L;else if(L!=null)D=L;else return null}var N=lN({display:"block",paddingTop:4,paddingBottom:4,color:x.color||"#000"},n);return Ns.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:N},Qn(A)?Ns.createElement("span",{className:"recharts-tooltip-item-name"},A):null,Qn(A)?Ns.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Ns.createElement("span",{className:"recharts-tooltip-item-value"},D),Ns.createElement("span",{className:"recharts-tooltip-item-unit"},x.unit||""))});return Ns.createElement("ul",{className:"recharts-tooltip-item-list",style:C},k)}return null},h=lN({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),f=lN({margin:0},a),b=!st(d),v=b?d:"",y=We("recharts-default-tooltip",l),g=We("recharts-tooltip-label",c);b&&u&&o!==void 0&&o!==null&&(v=u(d,o));var w=p?{role:"status","aria-live":"assertive"}:{};return Ns.createElement("div",cN({className:y,style:h},w),Ns.createElement("p",{className:g,style:f},Ns.isValidElement(v)?v:"".concat(v)),m())};var i3=_(B()),s3=_(B());var vy="recharts-tooltip-wrapper",nae={visibility:"hidden"};function aae(e){var{coordinate:t,translateX:r,translateY:n}=e;return We(vy,{["".concat(vy,"-right")]:be(r)&&t&&be(t.x)&&r>=t.x,["".concat(vy,"-left")]:be(r)&&t&&be(t.x)&&r<t.x,["".concat(vy,"-bottom")]:be(n)&&t&&be(t.y)&&n>=t.y,["".concat(vy,"-top")]:be(n)&&t&&be(t.y)&&n<t.y})}function n3(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:o,reverseDirection:i,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(o&&be(o[n]))return o[n];var d=r[n]-s-(a>0?a:0),u=r[n]+a;if(t[n])return i[n]?d:u;var p=l[n];if(p==null)return 0;if(i[n]){var m=d,h=p;return m<h?Math.max(u,p):Math.max(d,p)}if(c==null)return 0;var f=u+s,b=p+c;return f>b?Math.max(d,p):Math.max(u,p)}function oae(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function a3(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:o,tooltipBox:i,useTranslate3d:s,viewBox:l}=e,c,d,u;return i.height>0&&i.width>0&&r?(d=n3({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:o,tooltipDimension:i.width,viewBox:l,viewBoxDimension:l.width}),u=n3({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:o,tooltipDimension:i.height,viewBox:l,viewBoxDimension:l.height}),c=oae({translateX:d,translateY:u,useTranslate3d:s})):c=nae,{cssProperties:c,cssClasses:aae({translateX:d,translateY:u,coordinate:r})}}function o3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function IS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o3(Object(r),!0).forEach(function(n){dN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dN(e,t,r){return(t=iae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iae(e){var t=sae(e,"string");return typeof t=="symbol"?t:t+""}function sae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NS=class extends s3.PureComponent{constructor(){super(...arguments),dN(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),dN(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:o,coordinate:i,hasPayload:s,isAnimationActive:l,offset:c,position:d,reverseDirection:u,useTranslate3d:p,viewBox:m,wrapperStyle:h,lastBoundingBox:f,innerRef:b,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:g}=a3({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:c,position:d,reverseDirection:u,tooltipBox:{height:f.height,width:f.width},useTranslate3d:p,viewBox:m}),w=v?{}:IS(IS({transition:l&&t?"transform ".concat(n,"ms ").concat(a):void 0},g),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&s?"visible":"hidden",position:"absolute",top:0,left:0}),C=IS(IS({},w),{},{visibility:!this.state.dismissed&&t&&s?"visible":"hidden"},h);return i3.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:C,ref:b},o)}};var lae=()=>!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout),Mo={isSsr:lae()};var LS=()=>xe(e=>e.rootProps.accessibilityLayer);var C8=_(B()),Hf=_(B());var u3=_(B());function Nr(e){return Number.isFinite(e)}function wf(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}function l3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function c3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l3(Object(r),!0).forEach(function(n){cae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cae(e,t,r){return(t=dae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dae(e){var t=uae(e,"string");return typeof t=="symbol"?t:t+""}function uae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d3={curveBasisClosed:MA,curveBasisOpen:OA,curveBasis:LA,curveBumpX:SA,curveBumpY:kA,curveLinearClosed:FA,curveLinear:kd,curveMonotoneX:zA,curveMonotoneY:_A,curveNatural:BA,curveStep:$A,curveStepAfter:WA,curveStepBefore:RA},MS=e=>Nr(e.x)&&Nr(e.y),yy=e=>e.x,by=e=>e.y,pae=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Sd(e));return(r==="curveMonotone"||r==="curveBump")&&t?d3["".concat(r).concat(t==="vertical"?"Y":"X")]:d3[r]||kd},mae=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:o=!1}=e,i=pae(t,a),s=o?r.filter(MS):r,l;if(Array.isArray(n)){var c=o?n.filter(u=>MS(u)):n,d=s.map((u,p)=>c3(c3({},u),{},{base:c[p]}));return a==="vertical"?l=sf().y(by).x1(yy).x0(u=>u.base.x):l=sf().x(yy).y1(by).y0(u=>u.base.y),l.defined(MS).curve(i),l(d)}return a==="vertical"&&be(n)?l=sf().y(by).x1(yy).x0(n):be(n)?l=sf().x(yy).y1(by).y0(n):l=iy().x(yy).y(by),l.defined(MS).curve(i),l(s)},Pd=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var o=r&&r.length?mae(e):n;return u3.createElement("path",uN({},Me(e,!1),ef(e),{className:We("recharts-curve",t),d:o===null?void 0:o,ref:a}))};var m3=_(B());var fae=["x","y","top","left","width","height","className"];function pN(){return pN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pN.apply(null,arguments)}function p3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p3(Object(r),!0).forEach(function(n){hae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hae(e,t,r){return(t=vae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vae(e){var t=yae(e,"string");return typeof t=="symbol"?t:t+""}function yae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bae(e,t){if(e==null)return{};var r,n,a=xae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wae=(e,t,r,n,a,o)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(o,",").concat(t,"h").concat(r),f3=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:o=0,height:i=0,className:s}=e,l=bae(e,fae),c=gae({x:t,y:r,top:n,left:a,width:o,height:i},l);return!be(t)||!be(r)||!be(o)||!be(i)||!be(n)||!be(a)?null:m3.createElement("path",pN({},Me(c,!0),{className:We("recharts-cross",s),d:wae(t,r,o,i,n,a)}))};function g3(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}var ky=_(B()),kf=_(B());function h3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h3(Object(r),!0).forEach(function(n){kae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kae(e,t,r){return(t=Cae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cae(e){var t=Tae(e,"string");return typeof t=="symbol"?t:t+""}function Tae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vn(e,t){var r=Sae({},e),n=t,a=Object.keys(t),o=a.reduce((i,s)=>(i[s]===void 0&&n[s]!==void 0&&(i[s]=n[s]),i),r);return o}var bN=_(B()),es=_(B()),$3=_(T3());function P3(e){var t={},r=()=>null,n=!1,a=null,o=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var s=i,[l,...c]=s;if(typeof l=="number"){a=e.setTimeout(o.bind(null,c),l);return}o(l),a=e.setTimeout(o.bind(null,c));return}typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,a&&(a(),a=null),o(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}var OS=1e-4,A3=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],I3=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),D3=(e,t)=>r=>{var n=A3(e,t);return I3(n,r)},Mae=(e,t)=>r=>{var n=A3(e,t),a=[...n.map((o,i)=>o*i).slice(1),0];return I3(a,r)},E3=function(){for(var t,r,n,a,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];if(i.length===1)switch(i[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var l=i[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,a]=l[1].split(")")[0].split(",").map(h=>parseFloat(h)))}}else i.length===4&&([t,n,r,a]=i);var c=D3(t,r),d=D3(n,a),u=Mae(t,r),p=h=>h>1?1:h<0?0:h,m=h=>{for(var f=h>1?1:h,b=f,v=0;v<8;++v){var y=c(b)-f,g=u(b);if(Math.abs(y-f)<OS||g<OS)return d(b);b=p(b-y/g)}return d(b)};return m.isStepper=!1,m},Oae=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,o=(i,s,l)=>{var c=-(i-s)*r,d=l*n,u=l+(c-d)*a/1e3,p=l*a/1e3+i;return Math.abs(p-s)<OS&&Math.abs(u)<OS?[s,0]:[p,u]};return o.isStepper=!0,o.dt=a,o},N3=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return E3(e);case"spring":return Oae();default:if(e.split("(")[0]==="cubic-bezier")return E3(e)}return typeof e=="function"?e:null};function L3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L3(Object(r),!0).forEach(function(n){Fae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fae(e,t,r){return(t=jae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jae(e){var t=zae(e,"string");return typeof t=="symbol"?t:t+""}function zae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ae=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),O3=(e,t,r)=>e.map(n=>"".concat(_ae(n)," ").concat(t,"ms ").concat(r)).join(","),F3=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Sf=(e,t)=>Object.keys(t).reduce((r,n)=>M3(M3({},r),{},{[n]:e(n,t[n])}),{});function j3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ga(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j3(Object(r),!0).forEach(function(n){Bae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bae(e,t,r){return(t=$ae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ae(e){var t=Rae(e,"string");return typeof t=="symbol"?t:t+""}function Rae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FS=(e,t,r)=>e+(t-e)*r,vN=e=>{var{from:t,to:r}=e;return t!==r},z3=(e,t,r)=>{var n=Sf((a,o)=>{if(vN(o)){var[i,s]=e(o.from,o.to,o.velocity);return ga(ga({},o),{},{from:i,velocity:s})}return o},t);return r<1?Sf((a,o)=>vN(o)?ga(ga({},o),{},{velocity:FS(o.velocity,n[a].velocity,r),from:FS(o.from,n[a].from,r)}):o,t):z3(e,n,r-1)};function Wae(e,t,r,n,a,o){var i,s=n.reduce((p,m)=>ga(ga({},p),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),l=()=>Sf((p,m)=>m.from,s),c=()=>!Object.values(s).filter(vN).length,d=null,u=p=>{i||(i=p);var m=p-i,h=m/r.dt;s=z3(r,s,h),a(ga(ga(ga({},e),t),l())),i=p,c()||(d=o.setTimeout(u))};return()=>(d=o.setTimeout(u),()=>{d()})}function Uae(e,t,r,n,a,o,i){var s=null,l=a.reduce((u,p)=>ga(ga({},u),{},{[p]:[e[p],t[p]]}),{}),c,d=u=>{c||(c=u);var p=(u-c)/n,m=Sf((f,b)=>FS(...b,r(p)),l);if(o(ga(ga(ga({},e),t),m)),p<1)s=i.setTimeout(d);else{var h=Sf((f,b)=>FS(...b,r(1)),l);o(ga(ga(ga({},e),t),h))}};return()=>(s=i.setTimeout(d),()=>{s()})}var _3=(e,t,r,n,a,o)=>{var i=F3(e,t);return r.isStepper===!0?Wae(e,t,r,i,a,o):Uae(e,t,r,n,i,a,o)};var jS=class{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,o=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(o))};return a=requestAnimationFrame(o),()=>{cancelAnimationFrame(a)}}};var qae=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function yN(){return yN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yN.apply(null,arguments)}function Hae(e,t){if(e==null)return{};var r,n,a=Vae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function B3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B3(Object(r),!0).forEach(function(n){Hu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hu(e,t,r){return(t=Gae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gae(e){var t=Yae(e,"string");return typeof t=="symbol"?t:t+""}function Yae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kae(){return P3(new jS)}var Sy=class extends es.PureComponent{constructor(t,r){super(t,r),Hu(this,"mounted",!1),Hu(this,"manager",null),Hu(this,"stopJSAnimation",null),Hu(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:o,to:i,children:s,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof s=="function"&&(this.state={style:i});return}if(o){if(typeof s=="function"){this.state={style:o};return}this.state={style:a?{[a]:o}:o}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:o,to:i,from:s}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:a?{[a]:i}:i};this.state&&l&&(a&&l[a]!==i||!a&&l!==i)&&this.setState(c);return}if(!((0,$3.default)(t.to,i)&&t.canBegin&&t.isActive)){var d=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var u=d||o?s:t.to;if(this.state&&l){var p={style:a?{[a]:u}:u};(a&&l[a]!==u||!a&&l!==u)&&this.setState(p)}this.runAnimation(Dd(Dd({},this.props),{},{from:u,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:o,begin:i,onAnimationEnd:s,onAnimationStart:l}=t,c=_3(r,n,N3(o),a,this.changeStyle,this.manager.getTimeoutController()),d=()=>{this.stopJSAnimation=c()};this.manager.start([l,i,d,a,s])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:o,easing:i,onAnimationStart:s,onAnimationEnd:l,children:c}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof i=="function"||typeof c=="function"||i==="spring"){this.runJSAnimation(t);return}var d=a?{[a]:o}:o,u=O3(Object.keys(d),n,i);this.manager.start([s,r,Dd(Dd({},d),{},{transition:u}),n,l])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:o,easing:i,isActive:s,from:l,to:c,canBegin:d,onAnimationEnd:u,shouldReAnimate:p,onAnimationReStart:m,animationManager:h}=t,f=Hae(t,qae),b=es.Children.count(r),v=this.state.style;if(typeof r=="function")return r(v);if(!s||b===0||a<=0)return r;var y=g=>{var{style:w={},className:C}=g.props,k=(0,es.cloneElement)(g,Dd(Dd({},f),{},{style:Dd(Dd({},w),v),className:C}));return k};return b===1?y(es.Children.only(r)):bN.createElement("div",null,es.Children.map(r,g=>y(g)))}};Hu(Sy,"displayName","Animate");Hu(Sy,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var Jae=(0,es.createContext)(null);function Oo(e){var t,r,n=(0,es.useContext)(Jae);return bN.createElement(Sy,yN({},e,{animationManager:(t=(r=e.animationManager)!==null&&r!==void 0?r:n)!==null&&t!==void 0?t:Kae()}))}function zS(){return zS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zS.apply(null,arguments)}var R3=(e,t,r,n,a)=>{var o=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,s=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(o>0&&a instanceof Array){for(var d=[0,0,0,0],u=0,p=4;u<p;u++)d[u]=a[u]>o?o:a[u];c="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(c+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(l,",").concat(e+s*d[0],",").concat(t)),c+="L ".concat(e+r-s*d[1],",").concat(t),d[1]>0&&(c+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+i*d[1])),c+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(c+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(l,`,
        `).concat(e+r-s*d[2],",").concat(t+n)),c+="L ".concat(e+s*d[3],",").concat(t+n),d[3]>0&&(c+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-i*d[3])),c+="Z"}else if(o>0&&a===+a&&a>0){var m=Math.min(o,a);c="M ".concat(e,",").concat(t+i*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+s*m,",").concat(t,`
            L `).concat(e+r-s*m,",").concat(t,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r,",").concat(t+i*m,`
            L `).concat(e+r,",").concat(t+n-i*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r-s*m,",").concat(t+n,`
            L `).concat(e+s*m,",").concat(t+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e,",").concat(t+n-i*m," Z")}else c="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},Xae={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_S=e=>{var t=vn(e,Xae),r=(0,kf.useRef)(null),[n,a]=(0,kf.useState)(-1);(0,kf.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var v=r.current.getTotalLength();v&&a(v)}catch(y){}},[]);var{x:o,y:i,width:s,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isAnimationActive:h,isUpdateAnimationActive:f}=t;if(o!==+o||i!==+i||s!==+s||l!==+l||s===0||l===0)return null;var b=We("recharts-rectangle",d);return f?ky.createElement(Oo,{canBegin:n>0,from:{width:s,height:l,x:o,y:i},to:{width:s,height:l,x:o,y:i},duration:p,animationEasing:u,isActive:f},v=>{var{width:y,height:g,x:w,y:C}=v;return ky.createElement(Oo,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:p,isActive:h,easing:u},ky.createElement("path",zS({},Me(t,!0),{className:b,d:R3(w,C,y,g,c),ref:r})))}):ky.createElement("path",zS({},Me(t,!0),{className:b,d:R3(o,i,s,l,c)}))};function BS(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:o}=e,i=Kr(t,r,n,a),s=Kr(t,r,n,o);return{points:[i,s],cx:t,cy:r,radius:n,startAngle:a,endAngle:o}}var W3=_(B());function xN(){return xN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xN.apply(null,arguments)}var Qae=(e,t)=>{var r=rn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},$S=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:o,isExternal:i,cornerRadius:s,cornerIsExternal:l}=e,c=s*(i?1:-1)+n,d=Math.asin(s/c)/fy,u=l?a:a+o*d,p=Kr(t,r,c,u),m=Kr(t,r,n,u),h=l?a-o*d:a,f=Kr(t,r,c*Math.cos(d*fy),h);return{center:p,circleTangency:m,lineTangency:f,theta:d}},U3=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:o,endAngle:i}=e,s=Qae(o,i),l=o+s,c=Kr(t,r,a,o),d=Kr(t,r,a,l),u="M ".concat(c.x,",").concat(c.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>l),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var p=Kr(t,r,n,o),m=Kr(t,r,n,l);u+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=l),`,
            `).concat(p.x,",").concat(p.y," Z")}else u+="L ".concat(t,",").concat(r," Z");return u},Zae=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:o,forceCornerRadius:i,cornerIsExternal:s,startAngle:l,endAngle:c}=e,d=rn(c-l),{circleTangency:u,lineTangency:p,theta:m}=$S({cx:t,cy:r,radius:a,angle:l,sign:d,cornerRadius:o,cornerIsExternal:s}),{circleTangency:h,lineTangency:f,theta:b}=$S({cx:t,cy:r,radius:a,angle:c,sign:-d,cornerRadius:o,cornerIsExternal:s}),v=s?Math.abs(l-c):Math.abs(l-c)-m-b;if(v<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):U3({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:c});var y="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(v>180),",").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
  `);if(n>0){var{circleTangency:g,lineTangency:w,theta:C}=$S({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),{circleTangency:k,lineTangency:x,theta:S}=$S({cx:t,cy:r,radius:n,angle:c,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),T=s?Math.abs(l-c):Math.abs(l-c)-C-S;if(T<0&&o===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+="L".concat(x.x,",").concat(x.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(T>180),",").concat(+(d>0),",").concat(g.x,",").concat(g.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,"Z")}else y+="L".concat(t,",").concat(r,"Z");return y},eoe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},RS=e=>{var t=vn(e,eoe),{cx:r,cy:n,innerRadius:a,outerRadius:o,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d,className:u}=t;if(o<a||c===d)return null;var p=We("recharts-sector",u),m=o-a,h=Ma(i,m,0,!0),f;return h>0&&Math.abs(c-d)<360?f=Zae({cx:r,cy:n,innerRadius:a,outerRadius:o,cornerRadius:Math.min(h,m/2),forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d}):f=U3({cx:r,cy:n,innerRadius:a,outerRadius:o,startAngle:c,endAngle:d}),W3.createElement("path",xN({},Me(t,!0),{className:p,d:f}))};function q3(e,t,r){var n,a,o,i;if(e==="horizontal")n=t.x,o=n,a=r.top,i=r.top+r.height;else if(e==="vertical")a=t.y,i=a,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:s,cy:l,innerRadius:c,outerRadius:d,angle:u}=t,p=Kr(s,l,c,u),m=Kr(s,l,d,u);n=p.x,a=p.y,o=m.x,i=m.y}else return BS(t);return[{x:n,y:a},{x:o,y:i}]}var bL=_(K3());var op={};Zs(op,{scaleBand:()=>Dy,scaleDiverging:()=>Sk,scaleDivergingLog:()=>aL,scaleDivergingPow:()=>kk,scaleDivergingSqrt:()=>vU,scaleDivergingSymlog:()=>oL,scaleIdentity:()=>ik,scaleImplicit:()=>YS,scaleLinear:()=>ok,scaleLog:()=>sk,scaleOrdinal:()=>Pf,scalePoint:()=>r6,scalePow:()=>zy,scaleQuantile:()=>dk,scaleQuantize:()=>uk,scaleRadial:()=>ck,scaleSequential:()=>yk,scaleSequentialLog:()=>rL,scaleSequentialPow:()=>bk,scaleSequentialQuantile:()=>xk,scaleSequentialSqrt:()=>hU,scaleSequentialSymlog:()=>nL,scaleSqrt:()=>_6,scaleSymlog:()=>lk,scaleThreshold:()=>pk,scaleTime:()=>eL,scaleUtc:()=>tL,tickFormat:()=>Ly});function eo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function TN(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Vu(e){let t,r,n;e.length!==2?(t=eo,r=(s,l)=>eo(e(s),l),n=(s,l)=>e(s)-l):(t=e===eo||e===TN?e:soe,r=e,n=e);function a(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<0?c=u+1:d=u}while(c<d)}return c}function o(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<=0?c=u+1:d=u}while(c<d)}return c}function i(s,l,c=0,d=s.length){let u=a(s,l,c,d-1);return u>c&&n(s[u-1],l)>-n(s[u],l)?u-1:u}return{left:a,center:i,right:o}}function soe(){return 0}function Cy(e){return e===null?NaN:+e}function*J3(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var X3=Vu(eo),Q3=X3.right,loe=X3.left,coe=Vu(Cy).center,Ls=Q3;var Cf=class extends Map{constructor(t,r=poe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,a]of t)this.set(n,a)}get(t){return super.get(Z3(this,t))}has(t){return super.has(Z3(this,t))}set(t,r){return super.set(doe(this,t),r)}delete(t){return super.delete(uoe(this,t))}};function Z3({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function doe({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function uoe({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function poe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function e6(e=eo){if(e===eo)return PN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function PN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var moe=Math.sqrt(50),foe=Math.sqrt(10),goe=Math.sqrt(2);function WS(e,t,r){let n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),o=n/Math.pow(10,a),i=o>=moe?10:o>=foe?5:o>=goe?2:1,s,l,c;return a<0?(c=Math.pow(10,-a)/i,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*i,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=r&&r<2?WS(e,t,r*2):[s,l,c]}function Gu(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[a,o,i]=n?WS(t,e,r):WS(e,t,r);if(!(o>=a))return[];let s=o-a+1,l=new Array(s);if(n)if(i<0)for(let c=0;c<s;++c)l[c]=(o-c)/-i;else for(let c=0;c<s;++c)l[c]=(o-c)*i;else if(i<0)for(let c=0;c<s;++c)l[c]=(a+c)/-i;else for(let c=0;c<s;++c)l[c]=(a+c)*i;return l}function Ty(e,t,r){return t=+t,e=+e,r=+r,WS(e,t,r)[2]}function Tf(e,t,r){t=+t,e=+e,r=+r;let n=t<e,a=n?Ty(t,e,r):Ty(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function US(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function qS(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function HS(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?PN:e6(a);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,d=Math.log(l),u=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*u*(l-u)/l)*(c-l/2<0?-1:1),m=Math.max(r,Math.floor(t-c*u/l+p)),h=Math.min(n,Math.floor(t+(l-c)*u/l+p));HS(e,t,m,h,a)}let o=e[t],i=r,s=n;for(Py(e,r,t),a(e[n],o)>0&&Py(e,r,n);i<s;){for(Py(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}a(e[r],o)===0?Py(e,r,s):(++s,Py(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function Py(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function VS(e,t,r){if(e=Float64Array.from(J3(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return qS(e);if(t>=1)return US(e);var n,a=(n-1)*t,o=Math.floor(a),i=US(HS(e,o).subarray(0,o+1)),s=qS(e.subarray(o+1));return i+(s-i)*(a-o)}}function DN(e,t,r=Cy){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,o=Math.floor(a),i=+r(e[o],o,e),s=+r(e[o+1],o+1,e);return i+(s-i)*(a-o)}}function GS(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(a);++n<a;)o[n]=e+n*r;return o}function Lr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ts(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var YS=Symbol("implicit");function Pf(){var e=new Cf,t=[],r=[],n=YS;function a(o){let i=e.get(o);if(i===void 0){if(n!==YS)return n;e.set(o,i=t.push(o)-1)}return r[i%r.length]}return a.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Cf;for(let i of o)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(o){return arguments.length?(r=Array.from(o),a):r.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return Pf(t,r).unknown(n)},Lr.apply(a,arguments),a}function Dy(){var e=Pf().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,o,i,s=!1,l=0,c=0,d=.5;delete e.unknown;function u(){var p=t().length,m=a<n,h=m?a:n,f=m?n:a;o=(f-h)/Math.max(1,p-l+c*2),s&&(o=Math.floor(o)),h+=(f-h-o*(p-l))*d,i=o*(1-l),s&&(h=Math.round(h),i=Math.round(i));var b=GS(p).map(function(v){return h+o*v});return r(m?b.reverse():b)}return e.domain=function(p){return arguments.length?(t(p),u()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,u()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,s=!0,u()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(p){return arguments.length?(s=!!p,u()):s},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),u()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),u()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,u()):c},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),u()):d},e.copy=function(){return Dy(t(),[n,a]).round(s).paddingInner(l).paddingOuter(c).align(d)},Lr.apply(u(),arguments)}function t6(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t6(t())},e}function r6(){return t6(Dy.apply(null,arguments).paddingInner(1))}function KS(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function EN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Iy(){}var Ey=.7,QS=1/Ey,Df="\\s*([+-]?\\d+)\\s*",Ay="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hoe=/^#([0-9a-f]{3,8})$/,voe=new RegExp(`^rgb\\(${Df},${Df},${Df}\\)$`),yoe=new RegExp(`^rgb\\(${xl},${xl},${xl}\\)$`),boe=new RegExp(`^rgba\\(${Df},${Df},${Df},${Ay}\\)$`),xoe=new RegExp(`^rgba\\(${xl},${xl},${xl},${Ay}\\)$`),woe=new RegExp(`^hsl\\(${Ay},${xl},${xl}\\)$`),Soe=new RegExp(`^hsla\\(${Ay},${xl},${xl},${Ay}\\)$`),n6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};KS(Iy,Ed,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:a6,formatHex:a6,formatHex8:koe,formatHsl:Coe,formatRgb:o6,toString:o6});function a6(){return this.rgb().formatHex()}function koe(){return this.rgb().formatHex8()}function Coe(){return u6(this).formatHsl()}function o6(){return this.rgb().formatRgb()}function Ed(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=hoe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?i6(t):r===3?new Fo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?JS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?JS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=voe.exec(e))?new Fo(t[1],t[2],t[3],1):(t=yoe.exec(e))?new Fo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=boe.exec(e))?JS(t[1],t[2],t[3],t[4]):(t=xoe.exec(e))?JS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=woe.exec(e))?c6(t[1],t[2]/100,t[3]/100,1):(t=Soe.exec(e))?c6(t[1],t[2]/100,t[3]/100,t[4]):n6.hasOwnProperty(e)?i6(n6[e]):e==="transparent"?new Fo(NaN,NaN,NaN,0):null}function i6(e){return new Fo(e>>16&255,e>>8&255,e&255,1)}function JS(e,t,r,n){return n<=0&&(e=t=r=NaN),new Fo(e,t,r,n)}function Toe(e){return e instanceof Iy||(e=Ed(e)),e?(e=e.rgb(),new Fo(e.r,e.g,e.b,e.opacity)):new Fo}function Ef(e,t,r,n){return arguments.length===1?Toe(e):new Fo(e,t,r,n==null?1:n)}function Fo(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}KS(Fo,Ef,EN(Iy,{brighter(e){return e=e==null?QS:Math.pow(QS,e),new Fo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ey:Math.pow(Ey,e),new Fo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fo(Ku(this.r),Ku(this.g),Ku(this.b),ZS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s6,formatHex:s6,formatHex8:Poe,formatRgb:l6,toString:l6}));function s6(){return`#${Yu(this.r)}${Yu(this.g)}${Yu(this.b)}`}function Poe(){return`#${Yu(this.r)}${Yu(this.g)}${Yu(this.b)}${Yu((isNaN(this.opacity)?1:this.opacity)*255)}`}function l6(){let e=ZS(this.opacity);return`${e===1?"rgb(":"rgba("}${Ku(this.r)}, ${Ku(this.g)}, ${Ku(this.b)}${e===1?")":`, ${e})`}`}function ZS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ku(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Yu(e){return e=Ku(e),(e<16?"0":"")+e.toString(16)}function c6(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ms(e,t,r,n)}function u6(e){if(e instanceof Ms)return new Ms(e.h,e.s,e.l,e.opacity);if(e instanceof Iy||(e=Ed(e)),!e)return new Ms;if(e instanceof Ms)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),o=Math.max(t,r,n),i=NaN,s=o-a,l=(o+a)/2;return s?(t===o?i=(r-n)/s+(r<n)*6:r===o?i=(n-t)/s+2:i=(t-r)/s+4,s/=l<.5?o+a:2-o-a,i*=60):s=l>0&&l<1?0:i,new Ms(i,s,l,e.opacity)}function p6(e,t,r,n){return arguments.length===1?u6(e):new Ms(e,t,r,n==null?1:n)}function Ms(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}KS(Ms,p6,EN(Iy,{brighter(e){return e=e==null?QS:Math.pow(QS,e),new Ms(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ey:Math.pow(Ey,e),new Ms(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Fo(AN(e>=240?e-240:e+120,a,n),AN(e,a,n),AN(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ms(d6(this.h),XS(this.s),XS(this.l),ZS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ZS(this.opacity);return`${e===1?"hsl(":"hsla("}${d6(this.h)}, ${XS(this.s)*100}%, ${XS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function d6(e){return e=(e||0)%360,e<0?e+360:e}function XS(e){return Math.max(0,Math.min(1,e||0))}function AN(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function IN(e,t,r,n,a){var o=e*e,i=o*e;return((1-3*e+3*o-i)*t+(4-6*o+3*i)*r+(1+3*e+3*o-3*i)*n+i*a)/6}function m6(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),a=e[n],o=e[n+1],i=n>0?e[n-1]:2*a-o,s=n<t-1?e[n+2]:2*o-a;return IN((r-n/t)*t,i,a,o,s)}}function f6(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),a=e[(n+t-1)%t],o=e[n%t],i=e[(n+1)%t],s=e[(n+2)%t];return IN((r-n/t)*t,a,o,i,s)}}var Ny=e=>()=>e;function Doe(e,t){return function(r){return e+r*t}}function Eoe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function g6(e){return(e=+e)==1?ek:function(t,r){return r-t?Eoe(t,r,e):Ny(isNaN(t)?r:t)}}function ek(e,t){var r=t-e;return r?Doe(e,r):Ny(isNaN(e)?t:e)}var NN=function e(t){var r=g6(t);function n(a,o){var i=r((a=Ef(a)).r,(o=Ef(o)).r),s=r(a.g,o.g),l=r(a.b,o.b),c=ek(a.opacity,o.opacity);return function(d){return a.r=i(d),a.g=s(d),a.b=l(d),a.opacity=c(d),a+""}}return n.gamma=e,n}(1);function h6(e){return function(t){var r=t.length,n=new Array(r),a=new Array(r),o=new Array(r),i,s;for(i=0;i<r;++i)s=Ef(t[i]),n[i]=s.r||0,a[i]=s.g||0,o[i]=s.b||0;return n=e(n),a=e(a),o=e(o),s.opacity=1,function(l){return s.r=n(l),s.g=a(l),s.b=o(l),s+""}}}var DBe=h6(m6),EBe=h6(f6);function v6(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(o){for(a=0;a<r;++a)n[a]=e[a]*(1-o)+t[a]*o;return n}}function y6(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b6(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),o=new Array(r),i;for(i=0;i<n;++i)a[i]=fi(e[i],t[i]);for(;i<r;++i)o[i]=t[i];return function(s){for(i=0;i<n;++i)o[i]=a[i](s);return o}}function x6(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ad(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function w6(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=fi(e[a],t[a]):n[a]=t[a];return function(o){for(a in r)n[a]=r[a](o);return n}}var MN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LN=new RegExp(MN.source,"g");function Aoe(e){return function(){return e}}function Ioe(e){return function(t){return e(t)+""}}function S6(e,t){var r=MN.lastIndex=LN.lastIndex=0,n,a,o,i=-1,s=[],l=[];for(e=e+"",t=t+"";(n=MN.exec(e))&&(a=LN.exec(t));)(o=a.index)>r&&(o=t.slice(r,o),s[i]?s[i]+=o:s[++i]=o),(n=n[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,l.push({i,x:Ad(n,a)})),r=LN.lastIndex;return r<t.length&&(o=t.slice(r),s[i]?s[i]+=o:s[++i]=o),s.length<2?l[0]?Ioe(l[0].x):Aoe(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)s[(u=l[d]).i]=u.x(c);return s.join("")})}function fi(e,t){var r=typeof t,n;return t==null||r==="boolean"?Ny(t):(r==="number"?Ad:r==="string"?(n=Ed(t))?(t=n,NN):S6:t instanceof Ed?NN:t instanceof Date?x6:y6(t)?v6:Array.isArray(t)?b6:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?w6:Ad)(e,t)}function Ju(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function tk(e,t){t===void 0&&(t=e,e=fi);for(var r=0,n=t.length-1,a=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(a,a=t[++r]);return function(i){var s=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return o[s](i-s)}}function ON(e){return function(){return e}}function Id(e){return+e}var k6=[0,1];function Ln(e){return e}function FN(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:ON(isNaN(t)?NaN:.5)}function Noe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Loe(e,t,r){var n=e[0],a=e[1],o=t[0],i=t[1];return a<n?(n=FN(a,n),o=r(i,o)):(n=FN(n,a),o=r(o,i)),function(s){return o(n(s))}}function Moe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),o=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)a[i]=FN(e[i],e[i+1]),o[i]=r(t[i],t[i+1]);return function(s){var l=Ls(e,s,1,n)-1;return o[l](a[l](s))}}function wl(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xu(){var e=k6,t=k6,r=fi,n,a,o,i=Ln,s,l,c;function d(){var p=Math.min(e.length,t.length);return i!==Ln&&(i=Noe(e[0],e[p-1])),s=p>2?Moe:Loe,l=c=null,u}function u(p){return p==null||isNaN(p=+p)?o:(l||(l=s(e.map(n),t,r)))(n(i(p)))}return u.invert=function(p){return i(a((c||(c=s(t,e.map(n),Ad)))(p)))},u.domain=function(p){return arguments.length?(e=Array.from(p,Id),d()):e.slice()},u.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},u.rangeRound=function(p){return t=Array.from(p),r=Ju,d()},u.clamp=function(p){return arguments.length?(i=p?!0:Ln,d()):i!==Ln},u.interpolate=function(p){return arguments.length?(r=p,d()):r},u.unknown=function(p){return arguments.length?(o=p,u):o},function(p,m){return n=p,a=m,d()}}function Qu(){return Xu()(Ln,Ln)}function C6(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Zu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Sl(e){return e=Zu(Math.abs(e)),e?e[1]:NaN}function T6(e,t){return function(r,n){for(var a=r.length,o=[],i=0,s=e[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(a-=s,a+s)),!((l+=s+1)>n));)s=e[i=(i+1)%e.length];return o.reverse().join(t)}}function P6(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Ooe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kl(e){if(!(t=Ooe.exec(e)))throw new Error("invalid format: "+e);var t;return new rk({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}kl.prototype=rk.prototype;function rk(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}rk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function D6(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var jN;function E6(e,t){var r=Zu(e,t);if(!r)return e+"";var n=r[0],a=r[1],o=a-(jN=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=n.length;return o===i?n:o>i?n+new Array(o-i+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Zu(e,Math.max(0,t+o-1))[0]}function zN(e,t){var r=Zu(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}var _N={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:C6,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>zN(e*100,t),r:zN,s:E6,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function BN(e){return e}var A6=Array.prototype.map,I6=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function N6(e){var t=e.grouping===void 0||e.thousands===void 0?BN:T6(A6.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?BN:P6(A6.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=kl(u);var p=u.fill,m=u.align,h=u.sign,f=u.symbol,b=u.zero,v=u.width,y=u.comma,g=u.precision,w=u.trim,C=u.type;C==="n"?(y=!0,C="g"):_N[C]||(g===void 0&&(g=12),w=!0,C="g"),(b||p==="0"&&m==="=")&&(b=!0,p="0",m="=");var k=f==="$"?r:f==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",x=f==="$"?n:/[%p]/.test(C)?i:"",S=_N[C],T=/[defgprs%]/.test(C);g=g===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function P(M){var D=k,A=x,L,N,E;if(C==="c")A=S(M)+A,M="";else{M=+M;var I=M<0||1/M<0;if(M=isNaN(M)?l:S(Math.abs(M),g),w&&(M=D6(M)),I&&+M==0&&h!=="+"&&(I=!1),D=(I?h==="("?h:s:h==="-"||h==="("?"":h)+D,A=(C==="s"?I6[8+jN/3]:"")+A+(I&&h==="("?")":""),T){for(L=-1,N=M.length;++L<N;)if(E=M.charCodeAt(L),48>E||E>57){A=(E===46?a+M.slice(L+1):M.slice(L))+A,M=M.slice(0,L);break}}}y&&!b&&(M=t(M,1/0));var O=D.length+M.length+A.length,j=O<v?new Array(v-O+1).join(p):"";switch(y&&b&&(M=t(j+M,j.length?v-A.length:1/0),j=""),m){case"<":M=D+M+A+j;break;case"=":M=D+j+M+A;break;case"^":M=j.slice(0,O=j.length>>1)+D+M+A+j.slice(O);break;default:M=j+D+M+A;break}return o(M)}return P.toString=function(){return u+""},P}function d(u,p){var m=c((u=kl(u),u.type="f",u)),h=Math.max(-8,Math.min(8,Math.floor(Sl(p)/3)))*3,f=Math.pow(10,-h),b=I6[8+h/3];return function(v){return m(f*v)+b}}return{format:c,formatPrefix:d}}var nk,Af,ak;$N({thousands:",",grouping:[3],currency:["$",""]});function $N(e){return nk=N6(e),Af=nk.format,ak=nk.formatPrefix,nk}function RN(e){return Math.max(0,-Sl(Math.abs(e)))}function WN(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Sl(t)/3)))*3-Sl(Math.abs(e)))}function UN(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Sl(t)-Sl(e))+1}function Ly(e,t,r,n){var a=Tf(e,t,r),o;switch(n=kl(n==null?",f":n),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=WN(a,i))&&(n.precision=o),ak(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=UN(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=RN(a))&&(n.precision=o-(n.type==="%")*2);break}}return Af(n)}function to(e){var t=e.domain;return e.ticks=function(r){var n=t();return Gu(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var a=t();return Ly(a[0],a[a.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,o=n.length-1,i=n[a],s=n[o],l,c,d=10;for(s<i&&(c=i,i=s,s=c,c=a,a=o,o=c);d-- >0;){if(c=Ty(i,s,r),c===l)return n[a]=i,n[o]=s,t(n);if(c>0)i=Math.floor(i/c)*c,s=Math.ceil(s/c)*c;else if(c<0)i=Math.ceil(i*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function ok(){var e=Qu();return e.copy=function(){return wl(e,ok())},Lr.apply(e,arguments),to(e)}function ik(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Id),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return ik(e).unknown(t)},e=arguments.length?Array.from(e,Id):[0,1],to(r)}function My(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],o=e[n],i;return o<a&&(i=r,r=n,n=i,i=a,a=o,o=i),e[r]=t.floor(a),e[n]=t.ceil(o),e}function L6(e){return Math.log(e)}function M6(e){return Math.exp(e)}function Foe(e){return-Math.log(-e)}function joe(e){return-Math.exp(-e)}function zoe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _oe(e){return e===10?zoe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Boe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function O6(e){return(t,r)=>-e(-t,r)}function Oy(e){let t=e(L6,M6),r=t.domain,n=10,a,o;function i(){return a=Boe(n),o=_oe(n),r()[0]<0?(a=O6(a),o=O6(o),e(Foe,joe)):e(L6,M6),t}return t.base=function(s){return arguments.length?(n=+s,i()):n},t.domain=function(s){return arguments.length?(r(s),i()):r()},t.ticks=s=>{let l=r(),c=l[0],d=l[l.length-1],u=d<c;u&&([c,d]=[d,c]);let p=a(c),m=a(d),h,f,b=s==null?10:+s,v=[];if(!(n%1)&&m-p<b){if(p=Math.floor(p),m=Math.ceil(m),c>0){for(;p<=m;++p)for(h=1;h<n;++h)if(f=p<0?h/o(-p):h*o(p),!(f<c)){if(f>d)break;v.push(f)}}else for(;p<=m;++p)for(h=n-1;h>=1;--h)if(f=p>0?h/o(-p):h*o(p),!(f<c)){if(f>d)break;v.push(f)}v.length*2<b&&(v=Gu(c,d,b))}else v=Gu(p,m,Math.min(m-p,b)).map(o);return u?v.reverse():v},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=kl(l)).precision==null&&(l.trim=!0),l=Af(l)),s===1/0)return l;let c=Math.max(1,n*s/t.ticks().length);return d=>{let u=d/o(Math.round(a(d)));return u*n<n-.5&&(u*=n),u<=c?l(d):""}},t.nice=()=>r(My(r(),{floor:s=>o(Math.floor(a(s))),ceil:s=>o(Math.ceil(a(s)))})),t}function sk(){let e=Oy(Xu()).domain([1,10]);return e.copy=()=>wl(e,sk()).base(e.base()),Lr.apply(e,arguments),e}function F6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function j6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Fy(e){var t=1,r=e(F6(t),j6(t));return r.constant=function(n){return arguments.length?e(F6(t=+n),j6(t)):t},to(r)}function lk(){var e=Fy(Xu());return e.copy=function(){return wl(e,lk()).constant(e.constant())},Lr.apply(e,arguments)}function z6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $oe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Roe(e){return e<0?-e*e:e*e}function jy(e){var t=e(Ln,Ln),r=1;function n(){return r===1?e(Ln,Ln):r===.5?e($oe,Roe):e(z6(r),z6(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},to(t)}function zy(){var e=jy(Xu());return e.copy=function(){return wl(e,zy()).exponent(e.exponent())},Lr.apply(e,arguments),e}function _6(){return zy.apply(null,arguments).exponent(.5)}function B6(e){return Math.sign(e)*e*e}function Woe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ck(){var e=Qu(),t=[0,1],r=!1,n;function a(o){var i=Woe(e(o));return isNaN(i)?n:r?Math.round(i):i}return a.invert=function(o){return e.invert(B6(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((t=Array.from(o,Id)).map(B6)),a):t.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(r=!!o,a):r},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return ck(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Lr.apply(a,arguments),to(a)}function dk(){var e=[],t=[],r=[],n;function a(){var i=0,s=Math.max(1,t.length);for(r=new Array(s-1);++i<s;)r[i-1]=DN(e,i/s);return o}function o(i){return i==null||isNaN(i=+i)?n:t[Ls(r,i)]}return o.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(eo),a()},o.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},o.unknown=function(i){return arguments.length?(n=i,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return dk().domain(e).range(t).unknown(n)},Lr.apply(o,arguments)}function uk(){var e=0,t=1,r=1,n=[.5],a=[0,1],o;function i(l){return l!=null&&l<=l?a[Ls(n,l,0,r)]:o}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return i}return i.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},i.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,s()):a.slice()},i.invertExtent=function(l){var c=a.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},i.unknown=function(l){return arguments.length&&(o=l),i},i.thresholds=function(){return n.slice()},i.copy=function(){return uk().domain([e,t]).range(a).unknown(o)},Lr.apply(to(i),arguments)}function pk(){var e=[.5],t=[0,1],r,n=1;function a(o){return o!=null&&o<=o?t[Ls(e,o,0,n)]:r}return a.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return pk().domain(e).range(t).unknown(r)},Lr.apply(a,arguments)}var qN=new Date,HN=new Date;function lr(e,t,r,n){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),a.round=o=>{let i=a(o),s=a.ceil(o);return o-i<s-o?i:s},a.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),a.range=(o,i,s)=>{let l=[];if(o=a.ceil(o),s=s==null?1:Math.floor(s),!(o<i)||!(s>0))return l;let c;do l.push(c=new Date(+o)),t(o,s),e(o);while(c<o&&o<i);return l},a.filter=o=>lr(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!o(i););else for(;--s>=0;)for(;t(i,1),!o(i););}),r&&(a.count=(o,i)=>(qN.setTime(+o),HN.setTime(+i),e(qN),e(HN),Math.floor(r(qN,HN))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(n?i=>n(i)%o===0:i=>a.count(0,i)%o===0):a)),a}var _y=lr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_y.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?lr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):_y);var _Re=_y.range;var rs=lr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),$6=rs.range;var If=lr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),Uoe=If.range,Nf=lr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),qoe=Nf.range;var Lf=lr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),Hoe=Lf.range,Mf=lr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),Voe=Mf.range;var mc=lr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),Goe=mc.range,rp=lr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),Yoe=rp.range,mk=lr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),Koe=mk.range;function np(e){return lr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var fc=np(0),Of=np(1),W6=np(2),U6=np(3),Nd=np(4),q6=np(5),H6=np(6),V6=fc.range,Joe=Of.range,Xoe=W6.range,Qoe=U6.range,Zoe=Nd.range,eie=q6.range,tie=H6.range;function ap(e){return lr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var gc=ap(0),Ff=ap(1),G6=ap(2),Y6=ap(3),Ld=ap(4),K6=ap(5),J6=ap(6),X6=gc.range,rie=Ff.range,nie=G6.range,aie=Y6.range,oie=Ld.range,iie=K6.range,sie=J6.range;var jf=lr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),lie=jf.range,zf=lr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),cie=zf.range;var gi=lr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());gi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:lr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var die=gi.range,hi=lr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());hi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:lr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var uie=hi.range;function Z6(e,t,r,n,a,o){let i=[[rs,1,1e3],[rs,5,5*1e3],[rs,15,15*1e3],[rs,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[a,1,36e5],[a,3,3*36e5],[a,6,6*36e5],[a,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function s(c,d,u){let p=d<c;p&&([c,d]=[d,c]);let m=u&&typeof u.range=="function"?u:l(c,d,u),h=m?m.range(c,+d+1):[];return p?h.reverse():h}function l(c,d,u){let p=Math.abs(d-c)/u,m=Vu(([,,b])=>b).right(i,p);if(m===i.length)return e.every(Tf(c/31536e6,d/31536e6,u));if(m===0)return _y.every(Math.max(Tf(c,d,u),1));let[h,f]=i[p/i[m-1][2]<i[m][2]/p?m-1:m];return h.every(f)}return[s,l]}var[VN,GN]=Z6(hi,zf,gc,mk,Mf,Nf),[YN,KN]=Z6(gi,jf,fc,mc,Lf,If);function JN(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function XN(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function $y(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function QN(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,l=e.shortMonths,c=Ry(a),d=Wy(a),u=Ry(o),p=Wy(o),m=Ry(i),h=Wy(i),f=Ry(s),b=Wy(s),v=Ry(l),y=Wy(l),g={a:I,A:O,b:j,B:$,c:null,d:oU,e:oU,f:Fie,g:Hie,G:Gie,H:Lie,I:Mie,j:Oie,L:dU,m:jie,M:zie,p:F,q:z,Q:lU,s:cU,S:_ie,u:Bie,U:$ie,V:Rie,w:Wie,W:Uie,x:null,X:null,y:qie,Y:Vie,Z:Yie,"%":sU},w={a:W,A:U,b:K,B:R,c:null,d:iU,e:iU,f:Qie,g:lse,G:dse,H:Kie,I:Jie,j:Xie,L:pU,m:Zie,M:ese,p:q,q:X,Q:lU,s:cU,S:tse,u:rse,U:nse,V:ase,w:ose,W:ise,x:null,X:null,y:sse,Y:cse,Z:use,"%":sU},C={a:P,A:M,b:D,B:A,c:L,d:nU,e:nU,f:Eie,g:rU,G:tU,H:aU,I:aU,j:Cie,L:Die,m:kie,M:Tie,p:T,q:Sie,Q:Iie,s:Nie,S:Pie,u:vie,U:yie,V:bie,w:hie,W:xie,x:N,X:E,y:rU,Y:tU,Z:wie,"%":Aie};g.x=k(r,g),g.X=k(n,g),g.c=k(t,g),w.x=k(r,w),w.X=k(n,w),w.c=k(t,w);function k(G,H){return function(Y){var V=[],Q=-1,Z=0,se=G.length,ie,Se,qe;for(Y instanceof Date||(Y=new Date(+Y));++Q<se;)G.charCodeAt(Q)===37&&(V.push(G.slice(Z,Q)),(Se=eU[ie=G.charAt(++Q)])!=null?ie=G.charAt(++Q):Se=ie==="e"?" ":"0",(qe=H[ie])&&(ie=qe(Y,Se)),V.push(ie),Z=Q+1);return V.push(G.slice(Z,Q)),V.join("")}}function x(G,H){return function(Y){var V=$y(1900,void 0,1),Q=S(V,G,Y+="",0),Z,se;if(Q!=Y.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(H&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(Z=XN($y(V.y,0,1)),se=Z.getUTCDay(),Z=se>4||se===0?Ff.ceil(Z):Ff(Z),Z=rp.offset(Z,(V.V-1)*7),V.y=Z.getUTCFullYear(),V.m=Z.getUTCMonth(),V.d=Z.getUTCDate()+(V.w+6)%7):(Z=JN($y(V.y,0,1)),se=Z.getDay(),Z=se>4||se===0?Of.ceil(Z):Of(Z),Z=mc.offset(Z,(V.V-1)*7),V.y=Z.getFullYear(),V.m=Z.getMonth(),V.d=Z.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),se="Z"in V?XN($y(V.y,0,1)).getUTCDay():JN($y(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(se+5)%7:V.w+V.U*7-(se+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,XN(V)):JN(V)}}function S(G,H,Y,V){for(var Q=0,Z=H.length,se=Y.length,ie,Se;Q<Z;){if(V>=se)return-1;if(ie=H.charCodeAt(Q++),ie===37){if(ie=H.charAt(Q++),Se=C[ie in eU?H.charAt(Q++):ie],!Se||(V=Se(G,Y,V))<0)return-1}else if(ie!=Y.charCodeAt(V++))return-1}return V}function T(G,H,Y){var V=c.exec(H.slice(Y));return V?(G.p=d.get(V[0].toLowerCase()),Y+V[0].length):-1}function P(G,H,Y){var V=m.exec(H.slice(Y));return V?(G.w=h.get(V[0].toLowerCase()),Y+V[0].length):-1}function M(G,H,Y){var V=u.exec(H.slice(Y));return V?(G.w=p.get(V[0].toLowerCase()),Y+V[0].length):-1}function D(G,H,Y){var V=v.exec(H.slice(Y));return V?(G.m=y.get(V[0].toLowerCase()),Y+V[0].length):-1}function A(G,H,Y){var V=f.exec(H.slice(Y));return V?(G.m=b.get(V[0].toLowerCase()),Y+V[0].length):-1}function L(G,H,Y){return S(G,t,H,Y)}function N(G,H,Y){return S(G,r,H,Y)}function E(G,H,Y){return S(G,n,H,Y)}function I(G){return i[G.getDay()]}function O(G){return o[G.getDay()]}function j(G){return l[G.getMonth()]}function $(G){return s[G.getMonth()]}function F(G){return a[+(G.getHours()>=12)]}function z(G){return 1+~~(G.getMonth()/3)}function W(G){return i[G.getUTCDay()]}function U(G){return o[G.getUTCDay()]}function K(G){return l[G.getUTCMonth()]}function R(G){return s[G.getUTCMonth()]}function q(G){return a[+(G.getUTCHours()>=12)]}function X(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var H=k(G+="",g);return H.toString=function(){return G},H},parse:function(G){var H=x(G+="",!1);return H.toString=function(){return G},H},utcFormat:function(G){var H=k(G+="",w);return H.toString=function(){return G},H},utcParse:function(G){var H=x(G+="",!0);return H.toString=function(){return G},H}}}var eU={"-":"",_:" ",0:"0"},ea=/^\s*\d+/,mie=/^%/,fie=/[\\^$*+?|[\]().{}]/g;function jt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",o=a.length;return n+(o<r?new Array(r-o+1).join(t)+a:a)}function gie(e){return e.replace(fie,"\\$&")}function Ry(e){return new RegExp("^(?:"+e.map(gie).join("|")+")","i")}function Wy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function hie(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function vie(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function yie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function bie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function xie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function tU(e,t,r){var n=ea.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function rU(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function wie(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Sie(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function kie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function nU(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Cie(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function aU(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Tie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Pie(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Die(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Eie(e,t,r){var n=ea.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Aie(e,t,r){var n=mie.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Iie(e,t,r){var n=ea.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Nie(e,t,r){var n=ea.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function oU(e,t){return jt(e.getDate(),t,2)}function Lie(e,t){return jt(e.getHours(),t,2)}function Mie(e,t){return jt(e.getHours()%12||12,t,2)}function Oie(e,t){return jt(1+mc.count(gi(e),e),t,3)}function dU(e,t){return jt(e.getMilliseconds(),t,3)}function Fie(e,t){return dU(e,t)+"000"}function jie(e,t){return jt(e.getMonth()+1,t,2)}function zie(e,t){return jt(e.getMinutes(),t,2)}function _ie(e,t){return jt(e.getSeconds(),t,2)}function Bie(e){var t=e.getDay();return t===0?7:t}function $ie(e,t){return jt(fc.count(gi(e)-1,e),t,2)}function uU(e){var t=e.getDay();return t>=4||t===0?Nd(e):Nd.ceil(e)}function Rie(e,t){return e=uU(e),jt(Nd.count(gi(e),e)+(gi(e).getDay()===4),t,2)}function Wie(e){return e.getDay()}function Uie(e,t){return jt(Of.count(gi(e)-1,e),t,2)}function qie(e,t){return jt(e.getFullYear()%100,t,2)}function Hie(e,t){return e=uU(e),jt(e.getFullYear()%100,t,2)}function Vie(e,t){return jt(e.getFullYear()%1e4,t,4)}function Gie(e,t){var r=e.getDay();return e=r>=4||r===0?Nd(e):Nd.ceil(e),jt(e.getFullYear()%1e4,t,4)}function Yie(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jt(t/60|0,"0",2)+jt(t%60,"0",2)}function iU(e,t){return jt(e.getUTCDate(),t,2)}function Kie(e,t){return jt(e.getUTCHours(),t,2)}function Jie(e,t){return jt(e.getUTCHours()%12||12,t,2)}function Xie(e,t){return jt(1+rp.count(hi(e),e),t,3)}function pU(e,t){return jt(e.getUTCMilliseconds(),t,3)}function Qie(e,t){return pU(e,t)+"000"}function Zie(e,t){return jt(e.getUTCMonth()+1,t,2)}function ese(e,t){return jt(e.getUTCMinutes(),t,2)}function tse(e,t){return jt(e.getUTCSeconds(),t,2)}function rse(e){var t=e.getUTCDay();return t===0?7:t}function nse(e,t){return jt(gc.count(hi(e)-1,e),t,2)}function mU(e){var t=e.getUTCDay();return t>=4||t===0?Ld(e):Ld.ceil(e)}function ase(e,t){return e=mU(e),jt(Ld.count(hi(e),e)+(hi(e).getUTCDay()===4),t,2)}function ose(e){return e.getUTCDay()}function ise(e,t){return jt(Ff.count(hi(e)-1,e),t,2)}function sse(e,t){return jt(e.getUTCFullYear()%100,t,2)}function lse(e,t){return e=mU(e),jt(e.getUTCFullYear()%100,t,2)}function cse(e,t){return jt(e.getUTCFullYear()%1e4,t,4)}function dse(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ld(e):Ld.ceil(e),jt(e.getUTCFullYear()%1e4,t,4)}function use(){return"+0000"}function sU(){return"%"}function lU(e){return+e}function cU(e){return Math.floor(+e/1e3)}var _f,fk,fU,gk,gU;ZN({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ZN(e){return _f=QN(e),fk=_f.format,fU=_f.parse,gk=_f.utcFormat,gU=_f.utcParse,_f}function pse(e){return new Date(e)}function mse(e){return e instanceof Date?+e:+new Date(+e)}function hk(e,t,r,n,a,o,i,s,l,c){var d=Qu(),u=d.invert,p=d.domain,m=c(".%L"),h=c(":%S"),f=c("%I:%M"),b=c("%I %p"),v=c("%a %d"),y=c("%b %d"),g=c("%B"),w=c("%Y");function C(k){return(l(k)<k?m:s(k)<k?h:i(k)<k?f:o(k)<k?b:n(k)<k?a(k)<k?v:y:r(k)<k?g:w)(k)}return d.invert=function(k){return new Date(u(k))},d.domain=function(k){return arguments.length?p(Array.from(k,mse)):p().map(pse)},d.ticks=function(k){var x=p();return e(x[0],x[x.length-1],k==null?10:k)},d.tickFormat=function(k,x){return x==null?C:c(x)},d.nice=function(k){var x=p();return(!k||typeof k.range!="function")&&(k=t(x[0],x[x.length-1],k==null?10:k)),k?p(My(x,k)):d},d.copy=function(){return wl(d,hk(e,t,r,n,a,o,i,s,l,c))},d}function eL(){return Lr.apply(hk(YN,KN,gi,jf,fc,mc,Lf,If,rs,fk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function tL(){return Lr.apply(hk(VN,GN,hi,zf,gc,rp,Mf,Nf,rs,gk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vk(){var e=0,t=1,r,n,a,o,i=Ln,s=!1,l;function c(u){return u==null||isNaN(u=+u)?l:i(a===0?.5:(u=(o(u)-r)*a,s?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=o(e=+e),n=o(t=+t),a=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(s=!!u,c):s},c.interpolator=function(u){return arguments.length?(i=u,c):i};function d(u){return function(p){var m,h;return arguments.length?([m,h]=p,i=u(m,h),c):[i(0),i(1)]}}return c.range=d(fi),c.rangeRound=d(Ju),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return o=u,r=u(e),n=u(t),a=r===n?0:1/(n-r),c}}function hc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yk(){var e=to(vk()(Ln));return e.copy=function(){return hc(e,yk())},ts.apply(e,arguments)}function rL(){var e=Oy(vk()).domain([1,10]);return e.copy=function(){return hc(e,rL()).base(e.base())},ts.apply(e,arguments)}function nL(){var e=Fy(vk());return e.copy=function(){return hc(e,nL()).constant(e.constant())},ts.apply(e,arguments)}function bk(){var e=jy(vk());return e.copy=function(){return hc(e,bk()).exponent(e.exponent())},ts.apply(e,arguments)}function hU(){return bk.apply(null,arguments).exponent(.5)}function xk(){var e=[],t=Ln;function r(n){if(n!=null&&!isNaN(n=+n))return t((Ls(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(eo),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,o)=>VS(e,o/n))},r.copy=function(){return xk(t).domain(e)},ts.apply(r,arguments)}function wk(){var e=0,t=.5,r=1,n=1,a,o,i,s,l,c=Ln,d,u=!1,p;function m(f){return isNaN(f=+f)?p:(f=.5+((f=+d(f))-o)*(n*f<n*o?s:l),c(u?Math.max(0,Math.min(1,f)):f))}m.domain=function(f){return arguments.length?([e,t,r]=f,a=d(e=+e),o=d(t=+t),i=d(r=+r),s=a===o?0:.5/(o-a),l=o===i?0:.5/(i-o),n=o<a?-1:1,m):[e,t,r]},m.clamp=function(f){return arguments.length?(u=!!f,m):u},m.interpolator=function(f){return arguments.length?(c=f,m):c};function h(f){return function(b){var v,y,g;return arguments.length?([v,y,g]=b,c=tk(f,[v,y,g]),m):[c(0),c(.5),c(1)]}}return m.range=h(fi),m.rangeRound=h(Ju),m.unknown=function(f){return arguments.length?(p=f,m):p},function(f){return d=f,a=f(e),o=f(t),i=f(r),s=a===o?0:.5/(o-a),l=o===i?0:.5/(i-o),n=o<a?-1:1,m}}function Sk(){var e=to(wk()(Ln));return e.copy=function(){return hc(e,Sk())},ts.apply(e,arguments)}function aL(){var e=Oy(wk()).domain([.1,1,10]);return e.copy=function(){return hc(e,aL()).base(e.base())},ts.apply(e,arguments)}function oL(){var e=Fy(wk());return e.copy=function(){return hc(e,oL()).constant(e.constant())},ts.apply(e,arguments)}function kk(){var e=jy(wk());return e.copy=function(){return hc(e,kk()).exponent(e.exponent())},ts.apply(e,arguments)}function vU(){return kk.apply(null,arguments).exponent(.5)}var vc=e=>e.chartData,fse=ne([vc],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Md=(e,t,r,n)=>n?fse(e):vc(e);function ip(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Nr(t)&&Nr(r))return!0}return!1}function yU(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function bU(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,o;if(Nr(r))a=r;else if(typeof r=="function")return;if(Nr(n))o=n;else if(typeof n=="function")return;var i=[a,o];if(ip(i))return i}}function xU(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ip(n))return yU(n,t,r)}catch(m){}if(Array.isArray(e)&&e.length===2){var[a,o]=e,i,s;if(a==="auto")t!=null&&(i=Math.min(...t));else if(be(a))i=a;else if(typeof a=="function")try{t!=null&&(i=a(t==null?void 0:t[0]))}catch(m){}else if(typeof a=="string"&&oN.test(a)){var l=oN.exec(a);if(l==null||t==null)i=void 0;else{var c=+l[1];i=t[0]-c}}else i=t==null?void 0:t[0];if(o==="auto")t!=null&&(s=Math.max(...t));else if(be(o))s=o;else if(typeof o=="function")try{t!=null&&(s=o(t==null?void 0:t[1]))}catch(m){}else if(typeof o=="string"&&iN.test(o)){var d=iN.exec(o);if(d==null||t==null)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=t==null?void 0:t[1];var p=[i,s];if(ip(p))return t==null?p:yU(p,t,r)}}}var Kt=_(iL());var gse=e=>e,kU={"@@functional/placeholder":!0},CU=e=>e===kU,SU=e=>function t(){return arguments.length===0||arguments.length===1&&CU(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},TU=(e,t)=>e===1?t:SU(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var o=n.filter(i=>i!==kU).length;return o>=e?t(...n):TU(e-o,SU(function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];var c=n.map(d=>CU(d)?s.shift():d);return t(...c,...s)}))}),Uy=e=>TU(e.length,e),Tk=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},PU=Uy((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),DU=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return gse;var a=r.reverse(),o=a[0],i=a.slice(1);return function(){return i.reduce((s,l)=>l(s),o(...arguments))}},Pk=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),sL=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t&&a.every((i,s)=>{var l;return i===((l=t)===null||l===void 0?void 0:l[s])})||(t=a,r=e(...a)),r}};var lL=_(iL());function cL(e){var t;return e===0?t=1:t=Math.floor(new lL.default(e).abs().log(10).toNumber())+1,t}function dL(e,t,r){for(var n=new lL.default(e),a=0,o=[];n.lt(t)&&a<1e5;)o.push(n.toNumber()),n=n.add(r),a++;return o}var I5e=Uy((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)}),N5e=Uy((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n}),L5e=Uy((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var EU=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},AU=(e,t,r)=>{if(e.lte(0))return new Kt.default(0);var n=cL(e.toNumber()),a=new Kt.default(10).pow(n),o=e.div(a),i=n!==1?.05:.1,s=new Kt.default(Math.ceil(o.div(i).toNumber())).add(r).mul(i),l=s.mul(a);return t?new Kt.default(l.toNumber()):new Kt.default(Math.ceil(l.toNumber()))},hse=(e,t,r)=>{var n=new Kt.default(1),a=new Kt.default(e);if(!a.isint()&&r){var o=Math.abs(e);o<1?(n=new Kt.default(10).pow(cL(e)-1),a=new Kt.default(Math.floor(a.div(n).toNumber())).mul(n)):o>1&&(a=new Kt.default(Math.floor(e)))}else e===0?a=new Kt.default(Math.floor((t-1)/2)):r||(a=new Kt.default(Math.floor(e)));var i=Math.floor((t-1)/2),s=DU(PU(l=>a.add(new Kt.default(l-i).mul(n)).toNumber()),Tk);return s(0,t)},IU=function(t,r,n,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Kt.default(0),tickMin:new Kt.default(0),tickMax:new Kt.default(0)};var i=AU(new Kt.default(r).sub(t).div(n-1),a,o),s;t<=0&&r>=0?s=new Kt.default(0):(s=new Kt.default(t).add(r).div(2),s=s.sub(new Kt.default(s).mod(i)));var l=Math.ceil(s.sub(t).div(i).toNumber()),c=Math.ceil(new Kt.default(r).sub(s).div(i).toNumber()),d=l+c+1;return d>n?IU(t,r,n,a,o+1):(d<n&&(c=r>0?c+(n-d):c,l=r>0?l:l+(n-d)),{step:i,tickMin:s.sub(new Kt.default(l).mul(i)),tickMax:s.add(new Kt.default(c).mul(i))})};function vse(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(n,2),[i,s]=EU([t,r]);if(i===-1/0||s===1/0){var l=s===1/0?[i,...Tk(0,n-1).map(()=>1/0)]:[...Tk(0,n-1).map(()=>-1/0),s];return t>r?Pk(l):l}if(i===s)return hse(i,n,a);var{step:c,tickMin:d,tickMax:u}=IU(i,s,o,a,0),p=dL(d,u.add(new Kt.default(.1).mul(c)),c);return t>r?Pk(p):p}function yse(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,i]=EU([r,n]);if(o===-1/0||i===1/0)return[r,n];if(o===i)return[o];var s=Math.max(t,2),l=AU(new Kt.default(i).sub(o).div(s-1),a,0),c=[...dL(new Kt.default(o),new Kt.default(i).sub(new Kt.default(.99).mul(l)),l),i];return r>n?Pk(c):c}var uL=sL(vse),pL=sL(yse);var mL=e=>e.rootProps.maxBarSize,NU=e=>e.rootProps.barGap,Dk=e=>e.rootProps.barCategoryGap,LU=e=>e.rootProps.barSize,Bf=e=>e.rootProps.stackOffset,$f=e=>e.options.chartName,Ek=e=>e.rootProps.syncId,fL=e=>e.rootProps.syncMethod,Ak=e=>e.options.eventEmitter;var Tl={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"};var jo={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"};var sp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};var bse={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:Tl.reversed,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:Tl.type,unit:void 0},xse={allowDataOverflow:jo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:jo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:jo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:jo.scale,tick:jo.tick,tickCount:jo.tickCount,ticks:void 0,type:jo.type,unit:void 0},wse={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Tl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Tl.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Tl.scale,tick:Tl.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Sse={allowDataOverflow:jo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:jo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:jo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:jo.scale,tick:jo.tick,tickCount:jo.tickCount,ticks:void 0,type:"category",unit:void 0},Ik=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?wse:bse,Nk=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Sse:xse,Lk=e=>e.polarOptions,gL=ne([No,Lo,xr],E4),MU=ne([Lk,gL],(e,t)=>{if(e!=null)return Ma(e.innerRadius,t,0)}),OU=ne([Lk,gL],(e,t)=>{if(e!=null)return Ma(e.outerRadius,t,t*.8)}),kse=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},hL=ne([Lk],kse),Q5e=ne([Ik,hL],sp),vL=ne([gL,MU,OU],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),Z5e=ne([Nk,vL],sp),FU=ne([dt,Lk,MU,OU,No,Lo],(e,t,r,n,a,o)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:s,startAngle:l,endAngle:c}=t;return{cx:Ma(i,a,a/2),cy:Ma(s,o,o/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}});var Mn=(e,t)=>t;var qy=(e,t,r)=>r;function jU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jU(Object(r),!0).forEach(function(n){Cse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cse(e,t,r){return(t=Tse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tse(e){var t=Pse(e,"string");return typeof t=="symbol"?t:t+""}function Pse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yL=[0,"auto"],ro={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},vi=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r==null?ro:r},no={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:yL,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:bf},Os=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r==null?no:r},Dse={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},xL=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r==null?Dse:r},zo=(e,t,r)=>{switch(t){case"xAxis":return vi(e,r);case"yAxis":return Os(e,r);case"zAxis":return xL(e,r);case"angleAxis":return Ik(e,r);case"radiusAxis":return Nk(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ese=(e,t,r)=>{switch(t){case"xAxis":return vi(e,r);case"yAxis":return Os(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Rf=(e,t,r)=>{switch(t){case"xAxis":return vi(e,r);case"yAxis":return Os(e,r);case"angleAxis":return Ik(e,r);case"radiusAxis":return Nk(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},wL=e=>e.graphicalItems.countOfBars>0;function SL(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Od=e=>e.graphicalItems.cartesianItems,Ase=ne([Mn,qy],SL),kL=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Hy=ne([Od,zo,Ase],kL),CL=e=>e.filter(t=>t.stackId===void 0),Ise=ne([Hy],CL),TL=e=>e.map(t=>t.data).filter(Boolean).flat(1),Nse=ne([Hy],TL),PL=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Ok=ne([Nse,Md],PL),DL=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ir(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Ir(a,n)}))):e.map(n=>({value:n})),Fk=ne([Ok,zo,Hy],DL);function zU(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function lp(e){return e.filter(t=>Qn(t)||t instanceof Date).map(Number).filter(t=>Er(t)===!1)}function Lse(e,t,r){return!r||typeof t!="number"||Er(t)?[]:r.length?lp(r.flatMap(n=>{var a=Ir(e,n.dataKey),o,i;if(Array.isArray(a)?[o,i]=a:o=i=a,!(!Nr(o)||!Nr(i)))return[t-o,t+i]})):[]}var EL=(e,t,r)=>{var n={},a=t.reduce((o,i)=>(i.stackId==null||(o[i.stackId]==null&&(o[i.stackId]=[]),o[i.stackId].push(i)),o),n);return Object.fromEntries(Object.entries(a).map(o=>{var[i,s]=o,l=s.map(c=>c.dataKey);return[i,{stackedData:_4(e,l,r),graphicalItems:s}]}))},cp=ne([Ok,Hy,Bf],EL),AL=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var o=$4(e,n,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},Mse=ne([cp,vc,Mn],AL),IL=(e,t,r,n)=>r.length>0?e.flatMap(a=>r.flatMap(o=>{var i,s,l=(i=o.errorBars)===null||i===void 0?void 0:i.filter(d=>zU(n,d)),c=Ir(a,(s=t.dataKey)!==null&&s!==void 0?s:o.dataKey);return{value:c,errorDomain:Lse(a,c,l)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:Ir(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),Ose=ne(Ok,zo,Ise,Mn,IL);function Fse(e){var{value:t}=e;if(Qn(t)||t instanceof Date)return t}var jse=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=lp(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},zse=(e,t,r)=>{var n=e.map(Fse).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&pA(n))?(0,bL.default)(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},jk=e=>{var t;if(e==null||!("domain"in e))return yL;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=lp(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:yL},zk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var o=a.flat(),i=Math.min(...o),s=Math.max(...o);return[i,s]}},NL=e=>e.referenceElements.dots,dp=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),_se=ne([NL,Mn,qy],dp),LL=e=>e.referenceElements.areas,Bse=ne([LL,Mn,qy],dp),ML=e=>e.referenceElements.lines,$se=ne([ML,Mn,qy],dp),OL=(e,t)=>{var r=lp(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Rse=ne(_se,Mn,OL),FL=(e,t)=>{var r=lp(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Wse=ne([Bse,Mn],FL),jL=(e,t)=>{var r=lp(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Use=ne($se,Mn,jL),qse=ne(Rse,Use,Wse,(e,t,r)=>zk(e,r,t)),Hse=ne([zo],jk),zL=(e,t,r,n,a)=>{var o=bU(t,e.allowDataOverflow);return o!=null?o:xU(t,zk(r,a,jse(n)),e.allowDataOverflow)},Vse=ne([zo,Hse,Mse,Ose,qse],zL),Gse=[0,1],_L=(e,t,r,n,a,o,i)=>{if(!(e==null||r==null||r.length===0)){var{dataKey:s,type:l}=e,c=Io(t,o);return c&&s==null?(0,bL.default)(0,r.length):l==="category"?zse(n,e,c):a==="expand"?Gse:i}},BL=ne([zo,dt,Ok,Fk,Bf,Mn,Vse],_L),$L=(e,t,r,n,a)=>{if(e!=null){var{scale:o,type:i}=e;if(o==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof o=="string"){var s="scale".concat(Sd(o));return s in op?s:"point"}}},Vy=ne([zo,dt,wL,$f,Mn],$L);function Yse(e){if(e!=null){if(e in op)return op[e]();var t="scale".concat(Sd(e));if(t in op)return op[t]()}}function _k(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=Yse(t);if(a!=null){var o=a.domain(r).range(n);return j4(o),o}}}var RL=(e,t,r)=>{var n=jk(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ip(e))return uL(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ip(e))return pL(e,t.tickCount,t.allowDecimals)}},WL=ne([BL,Rf,Vy],RL),UL=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&ip(t)&&Array.isArray(r)&&r.length>0){var a=t[0],o=r[0],i=t[1],s=r[r.length-1];return[Math.min(a,o),Math.max(i,s)]}return t},Kse=ne([zo,BL,WL,Mn],UL),Jse=ne(Fk,zo,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(lp(e.map(s=>s.value))).sort((s,l)=>s-l);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var o=0;o<n.length-1;o++){var i=n[o+1]-n[o];r=Math.min(r,i)}return r/a}}),_U=ne(Jse,dt,Dk,xr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Nr(e))return 0;var o=t==="vertical"?n.height:n.width;if(a==="gap")return e*o/2;if(a==="no-gap"){var i=Ma(r,e*o),s=e*o/2;return s-i-(s-i)/o*i}return 0}),Xse=(e,t)=>{var r=vi(e,t);return r==null||typeof r.padding!="string"?0:_U(e,"xAxis",t,r.padding)},Qse=(e,t)=>{var r=Os(e,t);return r==null||typeof r.padding!="string"?0:_U(e,"yAxis",t,r.padding)},Zse=ne(vi,Xse,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),ele=ne(Os,Qse,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),tle=ne([xr,Zse,qu,xf,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:o}=n;return a?[o.left,r.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),rle=ne([xr,dt,ele,qu,xf,(e,t,r)=>r],(e,t,r,n,a,o)=>{var{padding:i}=a;return o?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Wf=(e,t,r,n)=>{var a;switch(t){case"xAxis":return tle(e,r,n);case"yAxis":return rle(e,r,n);case"zAxis":return(a=xL(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return hL(e);case"radiusAxis":return vL(e,r);default:return}},BU=ne([zo,Wf],sp),Fs=ne([zo,Vy,Kse,BU],_k),w4e=ne(Hy,Mn,(e,t)=>e.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>zU(t,r)));function $U(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Bk=(e,t)=>t,$k=(e,t,r)=>r,nle=ne(gy,Bk,$k,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort($U)),ale=ne(hy,Bk,$k,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort($U)),RU=(e,t)=>({width:e.width,height:t.height}),ole=(e,t)=>{var r=typeof t.width=="number"?t.width:bf;return{width:r,height:e.height}},qL=ne(xr,vi,RU),ile=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},sle=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},lle=ne(Lo,xr,nle,Bk,$k,(e,t,r,n,a)=>{var o={},i;return r.forEach(s=>{var l=RU(t,s);i==null&&(i=ile(t,n,e));var c=n==="top"&&!a||n==="bottom"&&a;o[s.id]=i-Number(c)*l.height,i+=(c?-1:1)*l.height}),o}),cle=ne(No,xr,ale,Bk,$k,(e,t,r,n,a)=>{var o={},i;return r.forEach(s=>{var l=ole(t,s);i==null&&(i=sle(t,n,e));var c=n==="left"&&!a||n==="right"&&a;o[s.id]=i-Number(c)*l.width,i+=(c?-1:1)*l.width}),o}),WU=(e,t)=>{var r=xr(e),n=vi(e,t);if(n!=null){var a=lle(e,n.orientation,n.mirror),o=a[t];return o==null?{x:r.left,y:0}:{x:r.left,y:o}}},UU=(e,t)=>{var r=xr(e),n=Os(e,t);if(n!=null){var a=cle(e,n.orientation,n.mirror),o=a[t];return o==null?{x:0,y:r.top}:{x:o,y:r.top}}},HL=ne(xr,Os,(e,t)=>{var r=typeof t.width=="number"?t.width:bf;return{width:r,height:e.height}}),VL=(e,t,r)=>{switch(t){case"xAxis":return qL(e,r).width;case"yAxis":return HL(e,r).height;default:return}},GL=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:o,dataKey:i}=r,s=Io(e,n),l=t.map(c=>c.value);if(i&&s&&o==="category"&&a&&pA(l))return l}},YL=ne([dt,Fk,zo,Mn],GL),KL=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:o}=r,i=Io(e,n);if(i&&(a==="number"||o!=="auto"))return t.map(s=>s.value)}},JL=ne([dt,Fk,Rf,Mn],KL),XL=ne([dt,Ese,Vy,Fs,YL,JL,Wf,WL,Mn],(e,t,r,n,a,o,i,s,l)=>{if(t==null)return null;var c=Io(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:o,duplicateDomain:a,isCategorical:c,niceTicks:s,range:i,realScaleType:r,scale:n}}),dle=(e,t,r,n,a,o,i,s,l)=>{if(!(t==null||n==null)){var c=Io(e,l),{type:d,ticks:u,tickCount:p}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,h=d==="category"&&n.bandwidth?n.bandwidth()/m:0;h=l==="angleAxis"&&o!=null&&o.length>=2?rn(o[0]-o[1])*2*h:h;var f=u||a;if(f){var b=f.map((v,y)=>{var g=i?i.indexOf(v):v;return{index:y,coordinate:n(g)+h,value:v,offset:h}});return b.filter(v=>!Er(v.coordinate))}return c&&s?s.map((v,y)=>({coordinate:n(v)+h,value:v,index:y,offset:h})):n.ticks?n.ticks(p).map(v=>({coordinate:n(v)+h,value:v,offset:h})):n.domain().map((v,y)=>({coordinate:n(v)+h,value:i?i[v]:v,index:y,offset:h}))}},Rk=ne([dt,Rf,Vy,Fs,WL,Wf,YL,JL,Mn],dle),ule=(e,t,r,n,a,o,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var s=Io(e,i),{tickCount:l}=t,c=0;return c=i==="angleAxis"&&(n==null?void 0:n.length)>=2?rn(n[0]-n[1])*2*c:c,s&&o?o.map((d,u)=>({coordinate:r(d)+c,value:d,index:u,offset:c})):r.ticks?r.ticks(l).map(d=>({coordinate:r(d)+c,value:d,offset:c})):r.domain().map((d,u)=>({coordinate:r(d)+c,value:a?a[d]:d,index:u,offset:c}))}},yi=ne([dt,Rf,Fs,Wf,YL,JL,Mn],ule),Oa=ne(zo,Fs,(e,t)=>{if(!(e==null||t==null))return Mk(Mk({},e),{},{scale:t})}),ple=ne([zo,Vy,BL,BU],_k),S4e=ne((e,t,r)=>xL(e,r),ple,(e,t)=>{if(!(e==null||t==null))return Mk(Mk({},e),{},{scale:t})}),qU=ne([dt,gy,hy],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}});var QL=e=>e.options.defaultTooltipEventType,ZL=e=>e.options.validateTooltipEventTypes;function eM(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Gy(e,t){var r=QL(e),n=ZL(e);return eM(t,r,n)}function HU(e){return xe(t=>Gy(t,e))}var Wk=(e,t)=>{var r,n=Number(t);if(!(Er(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0};var VU=e=>e.tooltip.settings;var yc={active:!1,index:null,dataKey:void 0,coordinate:void 0},mle={itemInteraction:{click:yc,hover:yc},axisInteraction:{click:yc,hover:yc},keyboardInteraction:yc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},GU=Ar({name:"tooltip",initialState:mle,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=pi(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:YU,removeTooltipEntrySettings:KU,setTooltipSettingsState:JU,setActiveMouseOverItemIndex:Uk,mouseLeaveItem:XU,mouseLeaveChart:qk,setActiveClickItemIndex:QU,setMouseOverAxisIndex:Hk,setMouseClickAxisIndex:ZU,setSyncInteraction:Vk,setKeyboardInteraction:Gk}=GU.actions,e8=GU.reducer;function t8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t8(Object(r),!0).forEach(function(n){fle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fle(e,t,r){return(t=gle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gle(e){var t=hle(e,"string");return typeof t=="symbol"?t:t+""}function hle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vle(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function yle(e){return e.index!=null}var Kk=(e,t,r,n)=>{if(t==null)return yc;var a=vle(e,t,r);if(a==null)return yc;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(yle(a)){if(o)return Yk(Yk({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Yk(Yk({},yc),{},{coordinate:a.coordinate})};var Uf=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Nr(n))return r;var a=0,o=1/0;return t.length>0&&(o=t.length-1),String(Math.max(a,Math.min(n,o)))};var Jk=(e,t,r,n,a,o,i,s)=>{if(!(o==null||s==null)){var l=i[0],c=l==null?void 0:s(l.positions,o);if(c!=null)return c;var d=a==null?void 0:a[Number(o)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}};var Xk=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(o=>{var i;return((i=o.settings)===null||i===void 0?void 0:i.dataKey)===a})};var up=e=>e.options.tooltipPayloadSearcher;var bc=e=>e.tooltip;var On=e=>{var t=dt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},qf=e=>e.tooltip.settings.axisId,ta=e=>{var t=On(e),r=qf(e);return Rf(e,t,r)},tM=ne([ta,dt,wL,$f,On],$L),ble=ne([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),xle=ne([On,qf],SL),Qk=ne([ble,ta,xle],kL),wle=ne([Qk],TL),xc=ne([wle,vc],PL),rM=ne([xc,ta,Qk],DL),Sle=ne([ta],jk),kle=ne([xc,Qk,Bf],EL),Cle=ne([kle,vc,On],AL),Tle=ne([Qk],CL),Ple=ne([xc,ta,Tle,On],IL),Dle=ne([NL,On,qf],dp),Ele=ne([Dle,On],OL),Ale=ne([LL,On,qf],dp),Ile=ne([Ale,On],FL),Nle=ne([ML,On,qf],dp),Lle=ne([Nle,On],jL),Mle=ne([Ele,Lle,Ile],zk),Ole=ne([ta,Sle,Cle,Ple,Mle],zL),r8=ne([ta,dt,xc,rM,Bf,On,Ole],_L),Fle=ne([r8,ta,tM],RL),jle=ne([ta,r8,Fle,On],UL),n8=e=>{var t=On(e),r=qf(e),n=!1;return Wf(e,t,r,n)},nM=ne([ta,n8],sp),aM=ne([ta,tM,jle,nM],_k),zle=ne([dt,rM,ta,On],GL),_le=ne([dt,rM,ta,On],KL),Ble=(e,t,r,n,a,o,i,s)=>{if(t){var{type:l}=t,c=Io(e,s);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,u=l==="category"&&n.bandwidth?n.bandwidth()/d:0;return u=s==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?rn(a[0]-a[1])*2*u:u,c&&i?i.map((p,m)=>({coordinate:n(p)+u,value:p,index:m,offset:u})):n.domain().map((p,m)=>({coordinate:n(p)+u,value:o?o[p]:p,index:m,offset:u}))}}},_o=ne([dt,ta,tM,aM,n8,zle,_le,On],Ble),a8=ne([QL,ZL,VU],(e,t,r)=>eM(r.shared,e,t)),o8=e=>e.tooltip.settings.trigger,oM=e=>e.tooltip.settings.defaultIndex,Zk=ne([bc,a8,o8,oM],Kk),wc=ne([Zk,xc],Uf),eC=ne([_o,wc],Wk),tC=ne([Zk],e=>{if(e)return e.dataKey}),$le=ne([bc,a8,o8,oM],Xk),Rle=ne([No,Lo,dt,xr,_o,oM,$le,up],Jk),i8=ne([Zk,Rle],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),s8=ne([Zk],e=>e.active);function l8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function c8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l8(Object(r),!0).forEach(function(n){Wle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wle(e,t,r){return(t=Ule(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ule(e){var t=qle(e,"string");return typeof t=="symbol"?t:t+""}function qle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iM=()=>xe(ta),d8=()=>{var e=iM(),t=xe(_o),r=xe(aM);return Is(c8(c8({},e),{},{scale:r}),t)};var m8=_(cy());function u8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u8(Object(r),!0).forEach(function(n){Hle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hle(e,t,r){return(t=Vle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vle(e){var t=Gle(e,"string");return typeof t=="symbol"?t:t+""}function Gle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rC=()=>xe($f),sM=(e,t)=>t,f8=(e,t,r)=>r,lM=(e,t,r,n)=>n;function Yle(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}var g8=ne(_o,e=>(0,m8.default)(e,t=>t.coordinate)),cM=ne([bc,sM,f8,lM],Kk),h8=ne([cM,xc],Uf),v8=(e,t,r)=>{if(t!=null){var n=bc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},y8=ne([bc,sM,f8,lM],Xk),Yy=ne([No,Lo,dt,xr,_o,lM,y8,up],Jk),b8=ne([cM,Yy],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),dM=ne(_o,h8,Wk);function Kle(e,t){return e!=null?e:t}var Jle=(e,t,r,n,a,o,i)=>{if(!(t==null||o==null)){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:d}=r,u=[];return e.reduce((p,m)=>{var h,{dataDefinedOnItem:f,settings:b}=m,v=Kle(f,s),y=Yle(v,c,d),g=(h=b==null?void 0:b.dataKey)!==null&&h!==void 0?h:n==null?void 0:n.dataKey,w=b==null?void 0:b.nameKey,C;if(n!=null&&n.dataKey&&!(n!=null&&n.allowDuplicatedCategory)&&Array.isArray(y)&&i==="axis"?C=Zm(y,n.dataKey,a):C=o(y,t,l,w),Array.isArray(C))C.forEach(x=>{var S=p8(p8({},b),{},{name:x.name,unit:x.unit,color:void 0,fill:void 0});p.push(sN({tooltipEntrySettings:S,dataKey:x.dataKey,payload:x.payload,value:Ir(x.payload,x.dataKey),name:x.name}))});else{var k;p.push(sN({tooltipEntrySettings:b,dataKey:g,payload:C,value:Ir(C,g),name:(k=Ir(C,w))!==null&&k!==void 0?k:b==null?void 0:b.name}))}return p},u)}},x8=ne([y8,h8,vc,ta,dM,up,sM],Jle),w8=ne([cM],e=>({isActive:e.active,activeIndex:e.index})),S8=(e,t,r,n,a,o,i,s)=>{if(!(!e||!t||!n||!a||!o)){var l=R4(e.chartX,e.chartY,t,r,s);if(l){var c=U4(l,t),d=O4(c,i,o,n,a),u=W4(t,o,d,l);return{activeIndex:String(d),activeCoordinate:u}}}};function uM(){return uM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uM.apply(null,arguments)}function k8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k8(Object(r),!0).forEach(function(n){Xle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xle(e,t,r){return(t=Qle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qle(e){var t=Zle(e,"string");return typeof t=="symbol"?t:t+""}function Zle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ece(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:o,layout:i,cursor:s,tooltipEventType:l,chartName:c}=e,d=t,u=r,p=n;if(!s||!d||c!=="ScatterChart"&&l!=="axis")return null;var m,h;if(c==="ScatterChart")m=d,h=f3;else if(c==="BarChart")m=g3(i,d,a,o),h=_S;else if(i==="radial"){var{cx:f,cy:b,radius:v,startAngle:y,endAngle:g}=BS(d);m={cx:f,cy:b,startAngle:y,endAngle:g,innerRadius:v,outerRadius:v},h=RS}else m={points:q3(i,d,a)},h=Pd;var w=typeof s=="object"&&"className"in s?s.className:void 0,C=nC(nC(nC(nC({stroke:"#ccc",pointerEvents:"none"},a),m),Me(s,!1)),{},{payload:u,payloadIndex:p,className:We("recharts-tooltip-cursor",w)});return(0,Hf.isValidElement)(s)?(0,Hf.cloneElement)(s,C):(0,Hf.createElement)(h,C)}function T8(e){var t=d8(),r=Zi(),n=bl(),a=rC();return C8.createElement(ece,uM({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var aC=_(B()),pM=(0,aC.createContext)(null),P8=()=>(0,aC.useContext)(pM);var Jy=_(B());var A8=_(E8(),1);var I8=A8.default;var Vf=new I8;var iC="recharts.syncEvent.tooltip",fM="recharts.syncEvent.brush";function Gf(e,t){if(t){var r=Number.parseInt(t,10);if(!Er(r))return e==null?void 0:e[r]}}var nce={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},N8=Ar({name:"options",initialState:nce,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),L8=N8.reducer,{createEventEmitter:M8}=N8.actions;function O8(e){return e.tooltip.syncInteraction}var ace={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},F8=Ar({name:"chartData",initialState:ace,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:gM,setDataStartEndIndexes:j8,setComputedData:oce}=F8.actions,z8=F8.reducer;var _8=()=>{};function ice(){var e=xe(Ek),t=xe(Ak),r=wt(),n=xe(fL),a=xe(_o),o=bl(),i=Td(),s=xe(l=>l.rootProps.className);(0,Jy.useEffect)(()=>{if(e==null)return _8;var l=(c,d,u)=>{if(t!==u&&e===c){if(n==="index"){r(d);return}if(a!=null){var p;if(typeof n=="function"){var m={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},h=n(a,m);p=a[h]}else n==="value"&&(p=a.find(k=>String(k.value)===d.payload.label));var{coordinate:f}=d.payload;if(p==null||d.payload.active===!1||f==null||i==null){r(Vk({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:b,y:v}=f,y=Math.min(b,i.x+i.width),g=Math.min(v,i.y+i.height),w={x:o==="horizontal"?p.coordinate:y,y:o==="horizontal"?g:p.coordinate},C=Vk({active:d.payload.active,coordinate:w,dataKey:d.payload.dataKey,index:String(p.index),label:d.payload.label});r(C)}}};return Vf.on(iC,l),()=>{Vf.off(iC,l)}},[s,r,t,e,n,a,o,i])}function sce(){var e=xe(Ek),t=xe(Ak),r=wt();(0,Jy.useEffect)(()=>{if(e==null)return _8;var n=(a,o,i)=>{t!==i&&e===a&&r(j8(o))};return Vf.on(fM,n),()=>{Vf.off(fM,n)}},[r,t,e])}function B8(){var e=wt();(0,Jy.useEffect)(()=>{e(M8())},[e]),ice(),sce()}function $8(e,t,r,n,a,o){var i=xe(p=>v8(p,e,t)),s=xe(Ak),l=xe(Ek),c=xe(fL),d=xe(O8),u=d==null?void 0:d.active;(0,Jy.useEffect)(()=>{if(!u&&l!=null&&s!=null){var p=Vk({active:o,coordinate:r,dataKey:i,index:a,label:typeof n=="number"?String(n):n});Vf.emit(iC,l,p,s)}},[u,r,i,a,n,s,l,c,o])}function R8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function W8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R8(Object(r),!0).forEach(function(n){lce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lce(e,t,r){return(t=cce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cce(e){var t=dce(e,"string");return typeof t=="symbol"?t:t+""}function dce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uce(e){return e.dataKey}function pce(e,t){return ns.isValidElement(e)?ns.cloneElement(e,t):typeof e=="function"?ns.createElement(e,t):ns.createElement(r3,t)}var U8=[],mce={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Mo.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function oo(e){var t=vn(e,mce),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:o,content:i,filterNull:s,isAnimationActive:l,offset:c,payloadUniqBy:d,position:u,reverseDirection:p,useTranslate3d:m,wrapperStyle:h,cursor:f,shared:b,trigger:v,defaultIndex:y,portal:g,axisId:w}=t,C=wt(),k=typeof y=="number"?String(y):y;(0,q8.useEffect)(()=>{C(JU({shared:b,trigger:v,axisId:w,active:r,defaultIndex:k}))},[C,b,v,w,r,k]);var x=Td(),S=LS(),T=HU(b),{activeIndex:P,isActive:M}=xe(K=>w8(K,T,v,k)),D=xe(K=>x8(K,T,v,k)),A=xe(K=>dM(K,T,v,k)),L=xe(K=>b8(K,T,v,k)),N=D,E=P8(),I=r!=null?r:M,[O,j]=F5([N,I]),$=T==="axis"?A:void 0;$8(T,v,L,$,P,I);var F=g!=null?g:E;if(F==null)return null;var z=N!=null?N:U8;I||(z=U8),s&&z.length&&(z=u5(N.filter(K=>K.value!=null&&(K.hide!==!0||t.includeHidden)),d,uce));var W=z.length>0,U=ns.createElement(NS,{allowEscapeViewBox:n,animationDuration:a,animationEasing:o,isAnimationActive:l,active:I,coordinate:L,hasPayload:W,offset:c,position:u,reverseDirection:p,useTranslate3d:m,viewBox:x,wrapperStyle:h,lastBoundingBox:O,innerRef:j,hasPortalFromProps:!!g},pce(i,W8(W8({},t),{},{payload:z,label:$,active:I,coordinate:L,accessibilityLayer:S})));return ns.createElement(ns.Fragment,null,(0,H8.createPortal)(U,F),I&&ns.createElement(T8,{cursor:f,tooltipEventType:T,coordinate:L,payload:N,index:P}))}var sC=_(B()),ha=_(B()),Q8=_(J8());var bce=!1,pp=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),o=2;o<n;o++)a[o-2]=arguments[o];if(bce&&typeof console!="undefined"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;console.warn(r.replace(/%s/g,()=>a[i++]))}};function X8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X8(Object(r),!0).forEach(function(n){xce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xce(e,t,r){return(t=wce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wce(e){var t=Sce(e,"string");return typeof t=="symbol"?t:t+""}function Sce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var js=(0,ha.forwardRef)((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:o="100%",minWidth:i=0,minHeight:s,maxHeight:l,children:c,debounce:d=0,id:u,className:p,onResize:m,style:h={}}=e,f=(0,ha.useRef)(null),b=(0,ha.useRef)();b.current=m,(0,ha.useImperativeHandle)(t,()=>f.current);var[v,y]=(0,ha.useState)({containerWidth:n.width,containerHeight:n.height}),g=(0,ha.useCallback)((C,k)=>{y(x=>{var S=Math.round(C),T=Math.round(k);return x.containerWidth===S&&x.containerHeight===T?x:{containerWidth:S,containerHeight:T}})},[]);(0,ha.useEffect)(()=>{var C=T=>{var P,{width:M,height:D}=T[0].contentRect;g(M,D),(P=b.current)===null||P===void 0||P.call(b,M,D)};d>0&&(C=(0,Q8.default)(C,d,{trailing:!0,leading:!1}));var k=new ResizeObserver(C),{width:x,height:S}=f.current.getBoundingClientRect();return g(x,S),k.observe(f.current),()=>{k.disconnect()}},[g,d]);var w=(0,ha.useMemo)(()=>{var{containerWidth:C,containerHeight:k}=v;if(C<0||k<0)return null;pp(cc(a)||cc(o),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,o),pp(!r||r>0,"The aspect(%s) must be greater than zero.",r);var x=cc(a)?C:a,S=cc(o)?k:o;return r&&r>0&&(x?S=x/r:S&&(x=S*r),l&&S>l&&(S=l)),pp(x>0||S>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,x,S,a,o,i,s,r),sC.Children.map(c,T=>(0,ha.cloneElement)(T,{width:x,height:S,style:bM({height:"100%",width:"100%",maxHeight:S,maxWidth:x},T.props.style)}))},[r,c,o,l,s,i,v,a]);return sC.createElement("div",{id:u?"".concat(u):void 0,className:We("recharts-responsive-container",p),style:bM(bM({},h),{},{width:a,height:o,minWidth:i,minHeight:s,maxHeight:l}),ref:f},w)});var xM=e=>null;xM.displayName="Cell";var kM=_(B()),cC=_(B());function Z8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z8(Object(r),!0).forEach(function(n){kce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kce(e,t,r){return(t=Cce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cce(e){var t=Tce(e,"string");return typeof t=="symbol"?t:t+""}function Tce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yf={widthCache:{},cacheCount:0},Pce=2e3,Dce={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},eq="recharts_measurement_span";function Ece(e){var t=wM({},e);return Object.keys(t).forEach(r=>{t[r]||delete t[r]}),t}var mp=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Mo.isSsr)return{width:0,height:0};var n=Ece(r),a=JSON.stringify({text:t,copyStyle:n});if(Yf.widthCache[a])return Yf.widthCache[a];try{var o=document.getElementById(eq);o||(o=document.createElement("span"),o.setAttribute("id",eq),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var i=wM(wM({},Dce),n);Object.assign(o.style,i),o.textContent="".concat(t);var s=o.getBoundingClientRect(),l={width:s.width,height:s.height};return Yf.widthCache[a]=l,++Yf.cacheCount>Pce&&(Yf.cacheCount=0,Yf.widthCache={}),l}catch(c){return{width:0,height:0}}};var tq=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,rq=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ace=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Ice=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,aq={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Nce=Object.keys(aq),Kf="NaN";function Lce(e,t){return e*aq[t]}var Jf=class e{static parse(t){var r,[,n,a]=(r=Ice.exec(t))!==null&&r!==void 0?r:[];return new e(parseFloat(n),a!=null?a:"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Er(t)&&(this.unit=""),r!==""&&!Ace.test(r)&&(this.num=NaN,this.unit=""),Nce.includes(r)&&(this.num=Lce(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Er(this.num)}};function oq(e){if(e.includes(Kf))return Kf;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,o]=(r=tq.exec(t))!==null&&r!==void 0?r:[],i=Jf.parse(n!=null?n:""),s=Jf.parse(o!=null?o:""),l=a==="*"?i.multiply(s):i.divide(s);if(l.isNaN())return Kf;t=t.replace(tq,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,p]=(c=rq.exec(t))!==null&&c!==void 0?c:[],m=Jf.parse(d!=null?d:""),h=Jf.parse(p!=null?p:""),f=u==="+"?m.add(h):m.subtract(h);if(f.isNaN())return Kf;t=t.replace(rq,f.toString())}return t}var nq=/\(([^()]*)\)/;function Mce(e){for(var t=e,r;(r=nq.exec(t))!=null;){var[,n]=r;t=t.replace(nq,oq(n))}return t}function Oce(e){var t=e.replace(/\s+/g,"");return t=Mce(t),t=oq(t),t}function Fce(e){try{return Oce(e)}catch(t){return Kf}}function lC(e){var t=Fce(e.slice(5,-1));return t===Kf?"":t}var jce=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],zce=["dx","dy","angle","className","breakAll"];function SM(){return SM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},SM.apply(null,arguments)}function iq(e,t){if(e==null)return{};var r,n,a=_ce(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _ce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cq=/[ \f\n\r\t\v\u2028\u2029]+/,dq=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];st(t)||(r?a=t.toString().split(""):a=t.toString().split(cq));var o=a.map(s=>({word:s,width:mp(s,n).width})),i=r?0:mp("\xA0",n).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch(s){return null}},Bce=(e,t,r,n,a)=>{var{maxLines:o,children:i,style:s,breakAll:l}=e,c=be(o),d=i,u=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce((D,A)=>{var{word:L,width:N}=A,E=D[D.length-1];if(E&&(n==null||a||E.width+N+r<Number(n)))E.words.push(L),E.width+=N+r;else{var I={words:[L],width:N};D.push(I)}return D},[])},p=u(t),m=P=>P.reduce((M,D)=>M.width>D.width?M:D);if(!c||a)return p;var h=p.length>o||m(p).width>Number(n);if(!h)return p;for(var f="\u2026",b=P=>{var M=d.slice(0,P),D=dq({breakAll:l,style:s,children:M+f}).wordsWithComputedWidth,A=u(D),L=A.length>o||m(A).width>Number(n);return[L,A]},v=0,y=d.length-1,g=0,w;v<=y&&g<=d.length-1;){var C=Math.floor((v+y)/2),k=C-1,[x,S]=b(k),[T]=b(C);if(!x&&!T&&(v=C+1),x&&T&&(y=C-1),!x&&T){w=S;break}g++}return w||p},sq=e=>{var t=st(e)?[]:e.toString().split(cq);return[{words:t}]},$ce=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:o,maxLines:i}=e;if((t||r)&&!Mo.isSsr){var s,l,c=dq({breakAll:o,children:n,style:a});if(c){var{wordsWithComputedWidth:d,spaceWidth:u}=c;s=d,l=u}else return sq(n);return Bce({breakAll:o,children:n,maxLines:i,style:a},s,l,t,r)}return sq(n)},lq="#808080",Xy=(0,cC.forwardRef)((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:o="0.71em",scaleToFit:i=!1,textAnchor:s="start",verticalAnchor:l="end",fill:c=lq}=e,d=iq(e,jce),u=(0,cC.useMemo)(()=>$ce({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:p,dy:m,angle:h,className:f,breakAll:b}=d,v=iq(d,zce);if(!Qn(r)||!Qn(n))return null;var y=r+(be(p)?p:0),g=n+(be(m)?m:0),w;switch(l){case"start":w=lC("calc(".concat(o,")"));break;case"middle":w=lC("calc(".concat((u.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:w=lC("calc(".concat(u.length-1," * -").concat(a,")"));break}var C=[];if(i){var k=u[0].width,{width:x}=d;C.push("scale(".concat(be(x)?x/k:1,")"))}return h&&C.push("rotate(".concat(h,", ").concat(y,", ").concat(g,")")),C.length&&(v.transform=C.join(" ")),kM.createElement("text",SM({},Me(v,!0),{ref:t,x:y,y:g,className:We("recharts-text",f),textAnchor:s,fill:c.includes("url")?lq:c}),u.map((S,T)=>{var P=S.words.join(b?"":" ");return kM.createElement("tspan",{x:y,dy:T===0?w:a,key:"".concat(P,"-").concat(T)},P)}))});Xy.displayName="Text";var zs=_(B()),_s=_(B());var Rce=["offset"],Wce=["labelRef"];function uq(e,t){if(e==null)return{};var r,n,a=Uce(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Uce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(r),!0).forEach(function(n){qce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qce(e,t,r){return(t=Hce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hce(e){var t=Vce(e,"string");return typeof t=="symbol"?t:t+""}function Vce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sc(){return Sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sc.apply(null,arguments)}var Gce=e=>{var{value:t,formatter:r}=e,n=st(e.children)?t:e.children;return typeof r=="function"?r(n):n},Qy=e=>e!=null&&typeof e=="function",Yce=(e,t)=>{var r=rn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Kce=(e,t,r)=>{var{position:n,viewBox:a,offset:o,className:i}=e,{cx:s,cy:l,innerRadius:c,outerRadius:d,startAngle:u,endAngle:p,clockWise:m}=a,h=(c+d)/2,f=Yce(u,p),b=f>=0?1:-1,v,y;n==="insideStart"?(v=u+b*o,y=m):n==="insideEnd"?(v=p-b*o,y=!m):n==="end"&&(v=p+b*o,y=m),y=f<=0?y:!y;var g=Kr(s,l,h,v),w=Kr(s,l,h,v+(y?1:-1)*359),C="M".concat(g.x,",").concat(g.y,`
    A`).concat(h,",").concat(h,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),k=st(e.id)?li("recharts-radial-line-"):e.id;return zs.createElement("text",Sc({},r,{dominantBaseline:"central",className:We("recharts-radial-bar-label",i)}),zs.createElement("defs",null,zs.createElement("path",{id:k,d:C})),zs.createElement("textPath",{xlinkHref:"#".concat(k)},t))},Jce=e=>{var{viewBox:t,offset:r,position:n}=e,{cx:a,cy:o,innerRadius:i,outerRadius:s,startAngle:l,endAngle:c}=t,d=(l+c)/2;if(n==="outside"){var{x:u,y:p}=Kr(a,o,s+r,d);return{x:u,y:p,textAnchor:u>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"end"};var m=(i+s)/2,{x:h,y:f}=Kr(a,o,m,d);return{x:h,y:f,textAnchor:"middle",verticalAnchor:"middle"}},Xce=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,{x:o,y:i,width:s,height:l}=t,c=l>=0?1:-1,d=c*n,u=c>0?"end":"start",p=c>0?"start":"end",m=s>=0?1:-1,h=m*n,f=m>0?"end":"start",b=m>0?"start":"end";if(a==="top"){var v={x:o+s/2,y:i-c*n,textAnchor:"middle",verticalAnchor:u};return yn(yn({},v),r?{height:Math.max(i-r.y,0),width:s}:{})}if(a==="bottom"){var y={x:o+s/2,y:i+l+d,textAnchor:"middle",verticalAnchor:p};return yn(yn({},y),r?{height:Math.max(r.y+r.height-(i+l),0),width:s}:{})}if(a==="left"){var g={x:o-h,y:i+l/2,textAnchor:f,verticalAnchor:"middle"};return yn(yn({},g),r?{width:Math.max(g.x-r.x,0),height:l}:{})}if(a==="right"){var w={x:o+s+h,y:i+l/2,textAnchor:b,verticalAnchor:"middle"};return yn(yn({},w),r?{width:Math.max(r.x+r.width-w.x,0),height:l}:{})}var C=r?{width:s,height:l}:{};return a==="insideLeft"?yn({x:o+h,y:i+l/2,textAnchor:b,verticalAnchor:"middle"},C):a==="insideRight"?yn({x:o+s-h,y:i+l/2,textAnchor:f,verticalAnchor:"middle"},C):a==="insideTop"?yn({x:o+s/2,y:i+d,textAnchor:"middle",verticalAnchor:p},C):a==="insideBottom"?yn({x:o+s/2,y:i+l-d,textAnchor:"middle",verticalAnchor:u},C):a==="insideTopLeft"?yn({x:o+h,y:i+d,textAnchor:b,verticalAnchor:p},C):a==="insideTopRight"?yn({x:o+s-h,y:i+d,textAnchor:f,verticalAnchor:p},C):a==="insideBottomLeft"?yn({x:o+h,y:i+l-d,textAnchor:b,verticalAnchor:u},C):a==="insideBottomRight"?yn({x:o+s-h,y:i+l-d,textAnchor:f,verticalAnchor:u},C):a&&typeof a=="object"&&(be(a.x)||cc(a.x))&&(be(a.y)||cc(a.y))?yn({x:o+Ma(a.x,s),y:i+Ma(a.y,l),textAnchor:"end",verticalAnchor:"end"},C):yn({x:o+s/2,y:i+l/2,textAnchor:"middle",verticalAnchor:"middle"},C)},Qce=e=>"cx"in e&&be(e.cx);function va(e){var{offset:t=5}=e,r=uq(e,Rce),n=yn({offset:t},r),{viewBox:a,position:o,value:i,children:s,content:l,className:c="",textBreakAll:d,labelRef:u}=n,p=Td(),m=a||p;if(!m||st(i)&&st(s)&&!(0,_s.isValidElement)(l)&&typeof l!="function")return null;if((0,_s.isValidElement)(l)){var{labelRef:h}=n,f=uq(n,Wce);return(0,_s.cloneElement)(l,f)}var b;if(typeof l=="function"){if(b=(0,_s.createElement)(l,n),(0,_s.isValidElement)(b))return b}else b=Gce(n);var v=Qce(m),y=Me(n,!0);if(v&&(o==="insideStart"||o==="insideEnd"||o==="end"))return Kce(n,b,y);var g=v?Jce(n):Xce(n,m);return zs.createElement(Xy,Sc({ref:u,className:We("recharts-label",c)},y,g,{breakAll:d}),b)}va.displayName="Label";var mq=e=>{var{cx:t,cy:r,angle:n,startAngle:a,endAngle:o,r:i,radius:s,innerRadius:l,outerRadius:c,x:d,y:u,top:p,left:m,width:h,height:f,clockWise:b,labelViewBox:v}=e;if(v)return v;if(be(h)&&be(f)){if(be(d)&&be(u))return{x:d,y:u,width:h,height:f};if(be(p)&&be(m))return{x:p,y:m,width:h,height:f}}if(be(d)&&be(u))return{x:d,y:u,width:0,height:0};if(be(t)&&be(r))return{cx:t,cy:r,startAngle:a||n||0,endAngle:o||n||0,innerRadius:l||0,outerRadius:c||s||i||0,clockWise:b};if(e.viewBox)return e.viewBox},Zce=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?zs.createElement(va,Sc({key:"label-implicit"},n)):Qn(e)?zs.createElement(va,Sc({key:"label-implicit",value:e},n)):(0,_s.isValidElement)(e)?e.type===va?(0,_s.cloneElement)(e,yn({key:"label-implicit"},n)):zs.createElement(va,Sc({key:"label-implicit",content:e},n)):Qy(e)?zs.createElement(va,Sc({key:"label-implicit",content:e},n)):e&&typeof e=="object"?zs.createElement(va,Sc({},e,{key:"label-implicit"},n)):null},ede=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:a,labelRef:o}=t,i=mq(t),s=tf(a,va).map((c,d)=>(0,_s.cloneElement)(c,{viewBox:r||i,key:"label-".concat(d)}));if(!n)return s;var l=Zce(t.label,r||i,o);return[l,...s]};va.parseViewBox=mq;va.renderCallByParent=ede;var Fd=_(B()),Sq=_(B()),kq=_(yq());var sde=["valueAccessor"],lde=["data","dataKey","clockWise","id","textBreakAll"];function dC(){return dC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dC.apply(null,arguments)}function bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bq(Object(r),!0).forEach(function(n){cde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cde(e,t,r){return(t=dde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dde(e){var t=ude(e,"string");return typeof t=="symbol"?t:t+""}function ude(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wq(e,t){if(e==null)return{};var r,n,a=pde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mde=e=>Array.isArray(e.value)?(0,kq.default)(e.value):e.value;function as(e){var{valueAccessor:t=mde}=e,r=wq(e,sde),{data:n,dataKey:a,clockWise:o,id:i,textBreakAll:s}=r,l=wq(r,lde);return!n||!n.length?null:Fd.createElement(tr,{className:"recharts-label-list"},n.map((c,d)=>{var u=st(a)?t(c,d):Ir(c&&c.payload,a),p=st(i)?{}:{id:"".concat(i,"-").concat(d)};return Fd.createElement(va,dC({},Me(c,!0),l,p,{parentViewBox:c.parentViewBox,value:u,textBreakAll:s,viewBox:va.parseViewBox(st(o)?c:xq(xq({},c),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}as.displayName="LabelList";function fde(e,t){return e?e===!0?Fd.createElement(as,{key:"labelList-implicit",data:t}):Fd.isValidElement(e)||Qy(e)?Fd.createElement(as,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?Fd.createElement(as,dC({data:t},e,{key:"labelList-implicit"})):null:null}function gde(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,a=tf(n,as).map((i,s)=>(0,Sq.cloneElement)(i,{data:t,key:"labelList-".concat(s)}));if(!r)return a;var o=fde(e.label,t);return[o,...a]}as.renderCallByParent=gde;var Cq=_(B());function DM(){return DM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DM.apply(null,arguments)}var Xf=e=>{var{cx:t,cy:r,r:n,className:a}=e,o=We("recharts-dot",a);return t===+t&&r===+r&&n===+n?Cq.createElement("circle",DM({},Me(e,!1),ef(e),{className:o,cx:t,cy:r,r:n})):null};var hde={radiusAxis:{},angleAxis:{}},Tq=Ar({name:"polarAxis",initialState:hde,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:mUe,removeRadiusAxis:fUe,addAngleAxis:gUe,removeAngleAxis:hUe}=Tq.actions,Pq=Tq.reducer;var Fq=_(B());var vde={countOfBars:0,cartesianItems:[],polarItems:[]},Dq=Ar({name:"graphicalItems",initialState:vde,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},removeCartesianGraphicalItem(e,t){var r=pi(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=pi(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addBar:Eq,removeBar:Aq,addCartesianGraphicalItem:Iq,removeCartesianGraphicalItem:Nq,addPolarGraphicalItem:yde,removePolarGraphicalItem:bde}=Dq.actions,Lq=Dq.reducer;function Mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Oq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mq(Object(r),!0).forEach(function(n){xde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xde(e,t,r){return(t=wde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wde(e){var t=Sde(e,"string");return typeof t=="symbol"?t:t+""}function Sde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jq(e){var t=wt();return(0,Fq.useEffect)(()=>{var r=Oq(Oq({},e),{},{stackId:vf(e.stackId)});return t(Iq(r)),()=>{t(Nq(r))}},[t,e]),null}var jd=_(B()),Zy=_(B()),qq=_(Bq());var Qf=_(B()),Zf=_(B());function uC(){return uC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uC.apply(null,arguments)}var $q=(e,t,r,n,a)=>{var o=r-n,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+r,",").concat(t),i+="L ".concat(e+r-o/2,",").concat(t+a),i+="L ".concat(e+r-o/2-n,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z"),i},Cde={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rq=e=>{var t=vn(e,Cde),r=(0,Zf.useRef)(),[n,a]=(0,Zf.useState)(-1);(0,Zf.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&a(b)}catch(v){}},[]);var{x:o,y:i,upperWidth:s,lowerWidth:l,height:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isUpdateAnimationActive:h}=t;if(o!==+o||i!==+i||s!==+s||l!==+l||c!==+c||s===0&&l===0||c===0)return null;var f=We("recharts-trapezoid",d);return h?Qf.createElement(Oo,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:c,x:o,y:i},to:{upperWidth:s,lowerWidth:l,height:c,x:o,y:i},duration:p,animationEasing:u,isActive:h},b=>{var{upperWidth:v,lowerWidth:y,height:g,x:w,y:C}=b;return Qf.createElement(Oo,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:p,easing:u},Qf.createElement("path",uC({},Me(t,!0),{className:f,d:$q(w,C,v,y,g),ref:r})))}):Qf.createElement("g",null,Qf.createElement("path",uC({},Me(t,!0),{className:f,d:$q(o,i,s,l,c)})))};var Tde=["option","shapeType","propTransformer","activeClassName","isActive"];function Pde(e,t){if(e==null)return{};var r,n,a=Dde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Dde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){Ede(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ede(e,t,r){return(t=Ade(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ade(e){var t=Ide(e,"string");return typeof t=="symbol"?t:t+""}function Ide(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nde(e,t){return pC(pC({},t),e)}function Lde(e,t){return e==="symbols"}function Uq(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return jd.createElement(_S,r);case"trapezoid":return jd.createElement(Rq,r);case"sector":return jd.createElement(RS,r);case"symbols":if(Lde(t,r))return jd.createElement(YA,r);break;default:return null}}function Mde(e){return(0,Zy.isValidElement)(e)?e.props:e}function Hq(e){var{option:t,shapeType:r,propTransformer:n=Nde,activeClassName:a="recharts-active-shape",isActive:o}=e,i=Pde(e,Tde),s;if((0,Zy.isValidElement)(t))s=(0,Zy.cloneElement)(t,pC(pC({},i),Mde(t)));else if(typeof t=="function")s=t(i);else if((0,qq.default)(t)&&typeof t!="boolean"){var l=n(t,i);s=jd.createElement(Uq,{shapeType:r,elementProps:l})}else{var c=i;s=jd.createElement(Uq,{shapeType:r,elementProps:c})}return o?jd.createElement(tr,{className:a},s):s}var AM=(e,t)=>{var r=wt();return(n,a)=>o=>{e==null||e(n,a,o),r(Uk({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},IM=e=>{var t=wt();return(r,n)=>a=>{e==null||e(r,n,a),t(XU())}},NM=(e,t)=>{var r=wt();return(n,a)=>o=>{e==null||e(n,a,o),r(QU({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};var Vq=_(B());function eg(e){var{fn:t,args:r}=e,n=wt(),a=Et();return(0,Vq.useEffect)(()=>{if(!a){var o=t(r);return n(YU(o)),()=>{n(KU(o))}}},[t,r,n,a]),null}var Gq=_(B());var Ode=()=>{};function tg(e){var{legendPayload:t}=e,r=wt(),n=Et();return(0,Gq.useEffect)(()=>n?Ode:(r(X4(t)),()=>{r(Q4(t))}),[r,n,t]),null}var LM=_(B());function rg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=(0,LM.useRef)(li(t)),n=(0,LM.useRef)(e);return n.current!==e&&(r.current=li(t),n.current=e),r.current}var MM=_(B()),mC=_(B());function Yq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yq(Object(r),!0).forEach(function(n){Fde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fde(e,t,r){return(t=jde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jde(e){var t=zde(e,"string");return typeof t=="symbol"?t:t+""}function zde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _de=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:o}=e;if(a===!1||t.x==null||t.y==null)return null;var i=Kq(Kq({index:r,dataKey:o,cx:t.x,cy:t.y,r:4,fill:n!=null?n:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Me(a,!1)),ef(a)),s;return(0,mC.isValidElement)(a)?s=(0,mC.cloneElement)(a,i):typeof a=="function"?s=a(i):s=MM.createElement(Xf,i),MM.createElement(tr,{className:"recharts-active-dot"},s)};function eb(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,o=iM(),i=xe(wc),s=xe(eC);if(!i)return null;var l,c=o.dataKey;if(c&&!o.allowDuplicatedCategory){var d=typeof c=="function"?u=>c(u.payload):"payload.".concat(c);l=Zm(t,d,s)}else l=t==null?void 0:t[Number(i)];return st(l)?null:_de({point:l,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var Jq=_(B());var Xq=()=>{var e=wt();return(0,Jq.useEffect)(()=>(e(Eq()),()=>{e(Aq())})),null};var nr=_(B()),is=_(B());var os=_(B()),og=_(B());var ng=_(B()),Bs=_(B());var Bde=["children"];function $de(e,t){if(e==null)return{};var r,n,a=Rde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qq=()=>{},Zq=(0,Bs.createContext)({addErrorBar:Qq,removeErrorBar:Qq}),Wde={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},eH=(0,Bs.createContext)(Wde);function fC(e){var{children:t}=e,r=$de(e,Bde);return ng.createElement(eH.Provider,{value:r},t)}var tH=()=>(0,Bs.useContext)(eH),ag=e=>{var{children:t,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:o,data:i,stackId:s,hide:l,type:c,barSize:d}=e,[u,p]=ng.useState([]),m=(0,Bs.useCallback)(b=>{p(v=>[...v,b])},[p]),h=(0,Bs.useCallback)(b=>{p(v=>v.filter(y=>y!==b))},[p]),f=Et();return ng.createElement(Zq.Provider,{value:{addErrorBar:m,removeErrorBar:h}},ng.createElement(jq,{type:c,data:i,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:o,errorBars:u,stackId:s,hide:l,barSize:d,isPanorama:f}),t)};function rH(e){var{addErrorBar:t,removeErrorBar:r}=(0,Bs.useContext)(Zq);return(0,Bs.useEffect)(()=>(t(e),()=>{r(e)}),[t,r,e]),null}var nH=e=>{var t=Et();return xe(r=>Oa(r,"xAxis",e,t))},aH=e=>{var t=Et();return xe(r=>Oa(r,"yAxis",e,t))};var Ude=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function oH(e,t,r){return(t=qde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qde(e){var t=Hde(e,"string");return typeof t=="symbol"?t:t+""}function Hde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tb.apply(null,arguments)}function Vde(e,t){if(e==null)return{};var r,n,a=Gde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yde(e){var{direction:t,width:r,dataKey:n,isAnimationActive:a,animationBegin:o,animationDuration:i,animationEasing:s}=e,l=Vde(e,Ude),c=Me(l,!1),{data:d,dataPointFormatter:u,xAxisId:p,yAxisId:m,errorBarOffset:h}=tH(),f=nH(p),b=aH(m);if((f==null?void 0:f.scale)==null||(b==null?void 0:b.scale)==null||d==null||t==="x"&&f.type!=="number")return null;var v=d.map(y=>{var{x:g,y:w,value:C,errorVal:k}=u(y,n,t);if(!k)return null;var x=[],S,T;if(Array.isArray(k)?[S,T]=k:S=T=k,t==="x"){var{scale:P}=f,M=w+h,D=M+r,A=M-r,L=P(C-S),N=P(C+T);x.push({x1:N,y1:D,x2:N,y2:A}),x.push({x1:L,y1:M,x2:N,y2:M}),x.push({x1:L,y1:D,x2:L,y2:A})}else if(t==="y"){var{scale:E}=b,I=g+h,O=I-r,j=I+r,$=E(C-S),F=E(C+T);x.push({x1:O,y1:F,x2:j,y2:F}),x.push({x1:I,y1:$,x2:I,y2:F}),x.push({x1:O,y1:$,x2:j,y2:$})}var z="".concat(g+h,"px ").concat(w+h,"px");return os.createElement(tr,tb({className:"recharts-errorBar",key:"bar-".concat(x.map(W=>"".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)))},c),x.map(W=>{var U=a?{transformOrigin:"".concat(W.x1-5,"px")}:void 0;return os.createElement(Oo,{from:{transform:"scaleY(0)",transformOrigin:z},to:{transform:"scaleY(1)",transformOrigin:z},begin:o,easing:s,isActive:a,duration:i,key:"line-".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2),style:{transformOrigin:z}},os.createElement("line",tb({},W,{style:U})))}))});return os.createElement(tr,{className:"recharts-errorBars"},v)}var iH=(0,og.createContext)(void 0);function Kde(e){var t=(0,og.useContext)(iH);return e!=null?e:t!=null?t:"x"}function hC(e){var{direction:t,children:r}=e;return os.createElement(iH.Provider,{value:t},r)}var sH={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function Jde(e){var t=Kde(e.direction),{width:r,isAnimationActive:n,animationBegin:a,animationDuration:o,animationEasing:i}=vn(e,sH);return os.createElement(os.Fragment,null,os.createElement(rH,{dataKey:e.dataKey,direction:t}),os.createElement(Yde,tb({},e,{direction:t,width:r,isAnimationActive:n,animationBegin:a,animationDuration:o,animationEasing:i})))}var gC=class extends og.Component{render(){return os.createElement(Jde,this.props)}};oH(gC,"defaultProps",sH);oH(gC,"displayName","ErrorBar");var dH=_(B());var Xde=!0,OM="Invariant failed";function lH(e,t){if(!e){if(Xde)throw new Error(OM);var r=typeof t=="function"?t():t,n=r?"".concat(OM,": ").concat(r):OM;throw new Error(n)}}var Qde=["x","y"];function FM(){return FM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FM.apply(null,arguments)}function cH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cH(Object(r),!0).forEach(function(n){Zde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zde(e,t,r){return(t=eue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eue(e){var t=tue(e,"string");return typeof t=="symbol"?t:t+""}function tue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rue(e,t){if(e==null)return{};var r,n,a=nue(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function aue(e,t){var{x:r,y:n}=e,a=rue(e,Qde),o="".concat(r),i=parseInt(o,10),s="".concat(n),l=parseInt(s,10),c="".concat(t.height||a.height),d=parseInt(c,10),u="".concat(t.width||a.width),p=parseInt(u,10);return rb(rb(rb(rb(rb({},t),a),i?{x:i}:{}),l?{y:l}:{}),{},{height:d,width:p,name:t.name,radius:t.radius})}function jM(e){return dH.createElement(Hq,FM({shapeType:"rectangle",propTransformer:aue,activeClassName:"recharts-active-bar"},e))}var uH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(be(t))return t;var o=be(n)||st(n);return o?t(n,a):(o||lH(!1),r)}};var zM=_(B());function fp(e,t){var r,n,a=xe(c=>vi(c,e)),o=xe(c=>Os(c,t)),i=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:ro.allowDataOverflow,s=(n=o==null?void 0:o.allowDataOverflow)!==null&&n!==void 0?n:no.allowDataOverflow,l=i||s;return{needClip:l,needClipX:i,needClipY:s}}function ig(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Zi(),{needClipX:o,needClipY:i,needClip:s}=fp(t,r);if(!s)return null;var{left:l,top:c,width:d,height:u}=a;return zM.createElement("clipPath",{id:"clipPath-".concat(n)},zM.createElement("rect",{x:o?l:l-d/2,y:i?c:c-u/2,width:o?d:d*2,height:i?u:u*2}))}var oue=["onMouseEnter","onMouseLeave","onClick"],iue=["value","background","tooltipPosition"],sue=["onMouseEnter","onClick","onMouseLeave"];function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nb.apply(null,arguments)}function pH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pH(Object(r),!0).forEach(function(n){vC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vC(e,t,r){return(t=lue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lue(e){var t=cue(e,"string");return typeof t=="symbol"?t:t+""}function cue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _M(e,t){if(e==null)return{};var r,n,a=due(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function due(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uue=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:n,value:pc(r,t),payload:e}]};function pue(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:o,hide:i,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:pc(o,t),hide:i,type:e.tooltipType,color:e.fill,unit:s}}}function mue(e){var t=xe(wc),{data:r,dataKey:n,background:a,allOtherBarProps:o}=e,{onMouseEnter:i,onMouseLeave:s,onClick:l}=o,c=_M(o,oue),d=AM(i,n),u=IM(s),p=NM(l,n);if(!a||r==null)return null;var m=Me(a,!1);return nr.createElement(nr.Fragment,null,r.map((h,f)=>{var{value:b,background:v,tooltipPosition:y}=h,g=_M(h,iue);if(!v)return null;var w=d(h,f),C=u(h,f),k=p(h,f),x=ja(ja(ja(ja(ja({option:a,isActive:String(f)===t},g),{},{fill:"#eee"},v),m),ay(c,h,f)),{},{onMouseEnter:w,onMouseLeave:C,onClick:k,dataKey:n,index:f,className:"recharts-bar-background-rectangle"});return nr.createElement(jM,nb({key:"background-bar-".concat(f)},x))}))}function mH(e){var{data:t,props:r,showLabels:n}=e,a=Me(r,!1),{shape:o,dataKey:i,activeBar:s}=r,l=xe(wc),c=xe(tC),{onMouseEnter:d,onClick:u,onMouseLeave:p}=r,m=_M(r,sue),h=AM(d,i),f=IM(p),b=NM(u,i);return t?nr.createElement(nr.Fragment,null,t.map((v,y)=>{var g=s&&String(y)===l&&(c==null||i===c),w=g?s:o,C=ja(ja(ja({},a),v),{},{isActive:g,option:w,index:y,dataKey:i});return nr.createElement(tr,nb({className:"recharts-bar-rectangle"},ay(m,v,y),{onMouseEnter:h(v,y),onMouseLeave:f(v,y),onClick:b(v,y),key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y)}),nr.createElement(jM,C))}),n&&as.renderCallByParent(r,t)):null}function fue(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:o,animationBegin:i,animationDuration:s,animationEasing:l,onAnimationEnd:c,onAnimationStart:d}=t,u=r.current,p=rg(t,"recharts-bar-"),[m,h]=(0,is.useState)(!1),f=(0,is.useCallback)(()=>{typeof c=="function"&&c(),h(!1)},[c]),b=(0,is.useCallback)(()=>{typeof d=="function"&&d(),h(!0)},[d]);return nr.createElement(Oo,{begin:i,duration:s,isActive:o,easing:l,from:{t:0},to:{t:1},onAnimationEnd:f,onAnimationStart:b,key:p},v=>{var{t:y}=v,g=y===1?n:n.map((w,C)=>{var k=u&&u[C];if(k){var x=ci(k.x,w.x),S=ci(k.y,w.y),T=ci(k.width,w.width),P=ci(k.height,w.height);return ja(ja({},w),{},{x:x(y),y:S(y),width:T(y),height:P(y)})}if(a==="horizontal"){var M=ci(0,w.height),D=M(y);return ja(ja({},w),{},{y:w.y+w.height-D,height:D})}var A=ci(0,w.width),L=A(y);return ja(ja({},w),{},{width:L})});return y>0&&(r.current=g),nr.createElement(tr,null,nr.createElement(mH,{props:t,data:g,showLabels:!m}))})}function gue(e){var{data:t,isAnimationActive:r}=e,n=(0,is.useRef)(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?nr.createElement(fue,{previousRectanglesRef:n,props:e}):nr.createElement(mH,{props:e,data:t,showLabels:!0})}var fH=0,hue=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ir(e,t)}},BM=class extends is.PureComponent{constructor(){super(...arguments),vC(this,"id",li("recharts-bar-"))}render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:o,yAxisId:i,needClip:s,background:l,id:c,layout:d}=this.props;if(t)return null;var u=We("recharts-bar",a),p=st(c)?this.id:c;return nr.createElement(tr,{className:u},s&&nr.createElement("defs",null,nr.createElement(ig,{clipPathId:p,xAxisId:o,yAxisId:i})),nr.createElement(tr,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(p,")"):null},nr.createElement(mue,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),nr.createElement(gue,this.props)),nr.createElement(hC,{direction:d==="horizontal"?"y":"x"},this.props.children))}},gH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Mo.isSsr,legendType:"rect",minPointSize:fH,xAxisId:0,yAxisId:0};function vue(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:o,activeBar:i,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d}=vn(e,gH),{needClip:u}=fp(t,r),p=bl(),m=Et(),h=(0,is.useMemo)(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:o,stackId:vf(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,o,e.stackId]),f=tf(e.children,xM),b=xe(g=>vH(g,t,r,m,h,f));if(p!=="vertical"&&p!=="horizontal")return null;var v,y=b==null?void 0:b[0];return y==null||y.height==null||y.width==null?v=0:v=p==="vertical"?y.height/2:y.width/2,nr.createElement(fC,{xAxisId:t,yAxisId:r,data:b,dataPointFormatter:hue,errorBarOffset:v},nr.createElement(BM,nb({},e,{layout:p,needClip:u,data:b,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:o,activeBar:i,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d})))}function hH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:o,xAxis:i,yAxis:s,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:p,cells:m}=e,h=t==="horizontal"?s:i,f=d?h.scale.domain():null,b=B4({numericAxis:h});return u.map((v,y)=>{var g,w,C,k,x,S;d?g=z4(d[y],f):(g=Ir(v,r),Array.isArray(g)||(g=[b,g]));var T=uH(n,fH)(g[1],y);if(t==="horizontal"){var P,[M,D]=[s.scale(g[0]),s.scale(g[1])];w=aN({axis:i,ticks:l,bandSize:o,offset:a.offset,entry:v,index:y}),C=(P=D!=null?D:M)!==null&&P!==void 0?P:void 0,k=a.size;var A=M-D;if(x=Er(A)?0:A,S={x:w,y:p.top,width:k,height:p.height},Math.abs(T)>0&&Math.abs(x)<Math.abs(T)){var L=rn(x||T)*(Math.abs(T)-Math.abs(x));C-=L,x+=L}}else{var[N,E]=[i.scale(g[0]),i.scale(g[1])];if(w=N,C=aN({axis:s,ticks:c,bandSize:o,offset:a.offset,entry:v,index:y}),k=E-N,x=a.size,S={x:p.left,y:C,width:p.width,height:x},Math.abs(T)>0&&Math.abs(k)<Math.abs(T)){var I=rn(k||T)*(Math.abs(T)-Math.abs(k));k+=I}}return ja(ja({},v),{},{x:w,y:C,width:k,height:x,value:d?g:g[1],payload:v,background:S,tooltipPosition:{x:w+k/2,y:C+x/2}},m&&m[y]&&m[y].props)})}var $s=class extends is.PureComponent{render(){return nr.createElement(ag,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},nr.createElement(Xq,null),nr.createElement(tg,{legendPayload:uue(this.props)}),nr.createElement(eg,{fn:pue,args:this.props}),nr.createElement(vue,this.props))}};vC($s,"displayName","Bar");vC($s,"defaultProps",gH);function yH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yH(Object(r),!0).forEach(function(n){yue(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yue(e,t,r){return(t=bue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bue(e){var t=xue(e,"string");return typeof t=="symbol"?t:t+""}function xue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wue=(e,t)=>t,Sue=(e,t,r)=>r,kue=(e,t,r,n)=>n,$M=(e,t,r,n,a)=>a,Cue=(e,t,r,n,a)=>a.maxBarSize,Tue=(e,t,r,n,a,o)=>o,bH=(e,t,r)=>{var n=r!=null?r:e;if(!st(n))return Ma(n,t,0)},Pue=ne([dt,Od,wue,Sue,kue],(e,t,r,n,a)=>t.filter(o=>e==="horizontal"?o.xAxisId===r:o.yAxisId===n).filter(o=>o.isPanorama===a).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),Due=(e,t,r,n)=>{var a=dt(e);return a==="horizontal"?cp(e,"yAxis",r,n):cp(e,"xAxis",t,n)},Eue=(e,t,r)=>{var n=dt(e);return n==="horizontal"?VL(e,"xAxis",t):VL(e,"yAxis",r)};function Aue(e){return e.stackId!=null&&e.dataKey!=null}var Iue=(e,t,r)=>{var n={},a=e.filter(Aue),o=e.filter(c=>c.stackId==null),i=a.reduce((c,d)=>(c[d.stackId]||(c[d.stackId]=[]),c[d.stackId].push(d),c),n),s=Object.entries(i).map(c=>{var[d,u]=c,p=u.map(h=>h.dataKey),m=bH(t,r,u[0].barSize);return{stackId:d,dataKeys:p,barSize:m}}),l=o.map(c=>{var d=[c.dataKey].filter(p=>p!=null),u=bH(t,r,c.barSize);return{stackId:void 0,dataKeys:d,barSize:u}});return[...s,...l]},Nue=ne([Pue,LU,Eue],Iue),Lue=(e,t,r,n,a)=>{var o,i,s=dt(e),l=mL(e),{maxBarSize:c}=a,d=st(c)?l:c,u,p;return s==="horizontal"?(u=Oa(e,"xAxis",t,n),p=yi(e,"xAxis",t,n)):(u=Oa(e,"yAxis",r,n),p=yi(e,"yAxis",r,n)),(o=(i=Is(u,p,!0))!==null&&i!==void 0?i:d)!==null&&o!==void 0?o:0},xH=(e,t,r,n)=>{var a=dt(e),o,i;return a==="horizontal"?(o=Oa(e,"xAxis",t,n),i=yi(e,"xAxis",t,n)):(o=Oa(e,"yAxis",r,n),i=yi(e,"yAxis",r,n)),Is(o,i)};function Mue(e,t,r,n,a){var o=n.length;if(!(o<1)){var i=Ma(e,r,0,!0),s,l=[];if(Nr(n[0].barSize)){var c=!1,d=r/o,u=n.reduce((v,y)=>v+(y.barSize||0),0);u+=(o-1)*i,u>=r&&(u-=(o-1)*i,i=0),u>=r&&d>0&&(c=!0,d*=.9,u=o*d);var p=(r-u)/2>>0,m={offset:p-i,size:0};s=n.reduce((v,y)=>{var g,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m.offset+m.size+i,size:c?d:(g=y.barSize)!==null&&g!==void 0?g:0}},C=[...v,w];return m=C[C.length-1].position,C},l)}else{var h=Ma(t,r,0,!0);r-2*h-(o-1)*i<=0&&(i=0);var f=(r-2*h-(o-1)*i)/o;f>1&&(f>>=0);var b=Nr(a)?Math.min(f,a):f;s=n.reduce((v,y,g)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h+(f+i)*g+(f-b)/2,size:b}}],l)}return s}}var Oue=(e,t,r,n,a,o,i)=>{var s=st(i)?t:i,l=Mue(r,n,a!==o?a:o,e,s);return a!==o&&l!=null&&(l=l.map(c=>yC(yC({},c),{},{position:yC(yC({},c.position),{},{offset:c.position.offset-a/2})}))),l},Fue=ne([Nue,mL,NU,Dk,Lue,xH,Cue],Oue),jue=(e,t,r,n)=>Oa(e,"xAxis",t,n),zue=(e,t,r,n)=>Oa(e,"yAxis",r,n),_ue=(e,t,r,n)=>yi(e,"xAxis",t,n),Bue=(e,t,r,n)=>yi(e,"yAxis",r,n),$ue=ne([Fue,$M],(e,t)=>{if(e!=null){var r=e.find(n=>n.stackId===t.stackId&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Rue=(e,t)=>{if(!(!e||(t==null?void 0:t.dataKey)==null)){var{stackId:r}=t;if(r!=null){var n=e[r];if(n){var{stackedData:a}=n;if(a){var o=a.find(i=>i.key===t.dataKey);return o}}}}},Wue=ne([Od,$M],(e,t)=>{if(e.some(r=>r.type==="bar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId&&t.stackId===r.stackId))return t}),Uue=ne([Due,$M],Rue),vH=ne([xr,jue,zue,_ue,Bue,$ue,dt,Md,xH,Uue,Wue,Tue],(e,t,r,n,a,o,i,s,l,c,d,u)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:h}=s;if(!(d==null||o==null||i!=="horizontal"&&i!=="vertical"||t==null||r==null||n==null||a==null||l==null)){var{data:f}=d,b;if(f!=null&&f.length>0?b=f:b=p==null?void 0:p.slice(m,h+1),b!=null)return hH({layout:i,barSettings:d,pos:o,bandSize:l,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,stackedData:c,displayedData:b,offset:e,cells:u})}});var wH=_(B());var SH=e=>{var{chartData:t}=e,r=wt(),n=Et();return(0,wH.useEffect)(()=>n?()=>{}:(r(gM(t)),()=>{r(gM(void 0))}),[t,r,n]),null};var kH={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},CH=Ar({name:"brush",initialState:kH,reducers:{setBrushSettings(e,t){return t.payload==null?kH:t.payload}}}),{setBrushSettings:bqe}=CH.actions,TH=CH.reducer;var bi=_(B()),wC=_(B());function PH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PH(Object(r),!0).forEach(function(n){DH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DH(e,t,r){return(t=que(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function que(e){var t=Hue(e,"string");return typeof t=="symbol"?t:t+""}function Hue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vue=(e,t)=>{var{x:r,y:n}=e,{x:a,y:o}=t;return{x:Math.min(r,a),y:Math.min(n,o),width:Math.abs(a-r),height:Math.abs(o-n)}},EH=e=>{var{x1:t,y1:r,x2:n,y2:a}=e;return Vue({x:t,y:r},{x:n,y:a})},xC=class e{static create(t){return new e(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(t)+o}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}};DH(xC,"EPS",1e-4);var AH=e=>{var t=Object.keys(e).reduce((r,n)=>bC(bC({},r),{},{[n]:xC.create(e[n])}),{});return bC(bC({},t),{},{apply(r){var{bandAware:n,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.fromEntries(Object.entries(r).map(o=>{var[i,s]=o;return[i,t[i].apply(s,{bandAware:n,position:a})]}))},isInRange(r){return Object.keys(r).every(n=>t[n].isInRange(r[n]))}})};function Gue(e){return(e%180+180)%180}var IH=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=Gue(a),i=o*Math.PI/180,s=Math.atan(n/r),l=i>s&&i<Math.PI-s?n/Math.sin(i):r/Math.cos(i);return Math.abs(l)};var Yue={dots:[],areas:[],lines:[]},NH=Ar({name:"referenceElements",initialState:Yue,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=pi(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=pi(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=pi(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:kqe,removeDot:Cqe,addArea:Tqe,removeArea:Pqe,addLine:LH,removeLine:MH}=NH.actions,OH=NH.reducer;var ab=_(B()),sg=_(B());var FH=(0,sg.createContext)(void 0),jH=e=>{var{children:t}=e,[r]=(0,sg.useState)("".concat(li("recharts"),"-clip")),n=Zi();if(n==null)return null;var{left:a,top:o,height:i,width:s}=n;return ab.createElement(FH.Provider,{value:r},ab.createElement("defs",null,ab.createElement("clipPath",{id:r},ab.createElement("rect",{x:a,y:o,height:i,width:s}))),t)},zH=()=>(0,sg.useContext)(FH);function _H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function BH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(r),!0).forEach(function(n){WM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WM(e,t,r){return(t=Kue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kue(e){var t=Jue(e,"string");return typeof t=="symbol"?t:t+""}function Jue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RM(){return RM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RM.apply(null,arguments)}var Xue=(e,t)=>{var r;return bi.isValidElement(e)?r=bi.cloneElement(e,t):typeof e=="function"?r=e(t):r=bi.createElement("line",RM({},t,{className:"recharts-reference-line-line"})),r},Que=(e,t,r,n,a,o,i,s,l)=>{var{x:c,y:d,width:u,height:p}=a;if(r){var{y:m}=l,h=e.y.apply(m,{position:o});if(Er(h)||l.ifOverflow==="discard"&&!e.y.isInRange(h))return null;var f=[{x:c+u,y:h},{x:c,y:h}];return s==="left"?f.reverse():f}if(t){var{x:b}=l,v=e.x.apply(b,{position:o});if(Er(v)||l.ifOverflow==="discard"&&!e.x.isInRange(v))return null;var y=[{x:v,y:d+p},{x:v,y:d}];return i==="top"?y.reverse():y}if(n){var{segment:g}=l,w=g.map(C=>e.apply(C,{position:o}));return l.ifOverflow==="discard"&&w.some(C=>!e.isInRange(C))?null:w}return null};function Zue(e){var t=wt();return(0,wC.useEffect)(()=>(t(LH(e)),()=>{t(MH(e))})),null}function epe(e){var{x:t,y:r,segment:n,xAxisId:a,yAxisId:o,shape:i,className:s,ifOverflow:l}=e,c=Et(),d=zH(),u=xe(M=>vi(M,a)),p=xe(M=>Os(M,o)),m=xe(M=>Fs(M,"xAxis",a,c)),h=xe(M=>Fs(M,"yAxis",o,c)),f=Td(),b=Qn(t),v=Qn(r);if(!d||!f||u==null||p==null||m==null||h==null)return null;var y=AH({x:m,y:h}),g=n&&n.length===2,w=Que(y,b,v,g,f,e.position,u.orientation,p.orientation,e);if(!w)return null;var[{x:C,y:k},{x,y:S}]=w,T=l==="hidden"?"url(#".concat(d,")"):void 0,P=BH(BH({clipPath:T},Me(e,!0)),{},{x1:C,y1:k,x2:x,y2:S});return bi.createElement(tr,{className:We("recharts-reference-line",s)},Xue(i,P),va.renderCallByParent(e,EH({x1:C,y1:k,x2:x,y2:S})))}function tpe(e){return bi.createElement(bi.Fragment,null,bi.createElement(Zue,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),bi.createElement(epe,e))}var nn=class extends wC.Component{render(){return bi.createElement(tpe,this.props)}};WM(nn,"displayName","ReferenceLine");WM(nn,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});var xi=_(B()),GH=_(B()),UM=_(Qm());function SC(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function kC(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)if(r===void 0||r(e[a])===!0)n.push(e[a]);else return;return n}function $H(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return IH(n,r)}function RH(e,t,r){var n=r==="width",{x:a,y:o,width:i,height:s}=e;return t===1?{start:n?a:o,end:n?a+i:o+s}:{start:n?a+i:o+s,end:n?a:o}}function lg(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-a)<=0}function WH(e,t){return kC(e,t+1)}function UH(e,t,r,n,a){for(var o=(n||[]).slice(),{start:i,end:s}=t,l=0,c=1,d=i,u=function(){var h=n==null?void 0:n[l];if(h===void 0)return{v:kC(n,c)};var f=l,b,v=()=>(b===void 0&&(b=r(h,f)),b),y=h.coordinate,g=l===0||lg(e,y,v,d,s);g||(l=0,d=i,c+=1),g&&(d=y+e*(v()/2+a),l+=c)},p;c<=o.length;)if(p=u(),p)return p.v;return[]}function qH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qH(Object(r),!0).forEach(function(n){rpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rpe(e,t,r){return(t=npe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function npe(e){var t=ape(e,"string");return typeof t=="symbol"?t:t+""}function ape(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ope(e,t,r,n,a){for(var o=(n||[]).slice(),i=o.length,{start:s}=t,{end:l}=t,c=function(p){var m=o[p],h,f=()=>(h===void 0&&(h=r(m,p)),h);if(p===i-1){var b=e*(m.coordinate+e*f()/2-l);o[p]=m=za(za({},m),{},{tickCoord:b>0?m.coordinate-b*e:m.coordinate})}else o[p]=m=za(za({},m),{},{tickCoord:m.coordinate});var v=lg(e,m.tickCoord,f,s,l);v&&(l=m.tickCoord-e*(f()/2+a),o[p]=za(za({},m),{},{isShow:!0}))},d=i-1;d>=0;d--)c(d);return o}function ipe(e,t,r,n,a,o){var i=(n||[]).slice(),s=i.length,{start:l,end:c}=t;if(o){var d=n[s-1],u=r(d,s-1),p=e*(d.coordinate+e*u/2-c);i[s-1]=d=za(za({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate});var m=lg(e,d.tickCoord,()=>u,l,c);m&&(c=d.tickCoord-e*(u/2+a),i[s-1]=za(za({},d),{},{isShow:!0}))}for(var h=o?s-1:s,f=function(y){var g=i[y],w,C=()=>(w===void 0&&(w=r(g,y)),w);if(y===0){var k=e*(g.coordinate-e*C()/2-l);i[y]=g=za(za({},g),{},{tickCoord:k<0?g.coordinate-k*e:g.coordinate})}else i[y]=g=za(za({},g),{},{tickCoord:g.coordinate});var x=lg(e,g.tickCoord,C,l,c);x&&(l=g.tickCoord+e*(C()/2+a),i[y]=za(za({},g),{},{isShow:!0}))},b=0;b<h;b++)f(b);return i}function ob(e,t,r){var{tick:n,ticks:a,viewBox:o,minTickGap:i,orientation:s,interval:l,tickFormatter:c,unit:d,angle:u}=e;if(!a||!a.length||!n)return[];if(be(l)||Mo.isSsr){var p;return(p=WH(a,be(l)?l:0))!==null&&p!==void 0?p:[]}var m=[],h=s==="top"||s==="bottom"?"width":"height",f=d&&h==="width"?mp(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(g,w)=>{var C=typeof c=="function"?c(g.value,w):g.value;return h==="width"?$H(mp(C,{fontSize:t,letterSpacing:r}),f,u):mp(C,{fontSize:t,letterSpacing:r})[h]},v=a.length>=2?rn(a[1].coordinate-a[0].coordinate):1,y=RH(o,v,h);return l==="equidistantPreserveStart"?UH(v,y,b,a,i):(l==="preserveStart"||l==="preserveStartEnd"?m=ipe(v,y,b,a,i,l==="preserveStartEnd"):m=ope(v,y,b,a,i),m.filter(g=>g.isShow))}var spe=["viewBox"],lpe=["viewBox"];function cg(){return cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cg.apply(null,arguments)}function HH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HH(Object(r),!0).forEach(function(n){qM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VH(e,t){if(e==null)return{};var r,n,a=cpe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function cpe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qM(e,t,r){return(t=dpe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dpe(e){var t=upe(e,"string");return typeof t=="symbol"?t:t+""}function upe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rs=class e extends GH.Component{constructor(t){super(t),this.tickRefs=xi.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,a=VH(t,spe),o=this.props,{viewBox:i}=o,s=VH(o,lpe);return!SC(n,i)||!SC(a,s)||!SC(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:a,height:o,orientation:i,tickSize:s,mirror:l,tickMargin:c}=this.props,d,u,p,m,h,f,b=l?-1:1,v=t.tickSize||s,y=be(t.tickCoord)?t.tickCoord:t.coordinate;switch(i){case"top":d=u=t.coordinate,m=n+ +!l*o,p=m-b*v,f=p-b*c,h=y;break;case"left":p=m=t.coordinate,u=r+ +!l*a,d=u-b*v,h=d-b*c,f=y;break;case"right":p=m=t.coordinate,u=r+ +l*a,d=u+b*v,h=d+b*c,f=y;break;default:d=u=t.coordinate,m=n+ +l*o,p=m+b*v,f=p+b*c,h=y;break}return{line:{x1:d,y1:p,x2:u,y2:m},tick:{x:h,y:f}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:a,orientation:o,mirror:i,axisLine:s}=this.props,l=Fn(Fn(Fn({},Me(this.props,!1)),Me(s,!1)),{},{fill:"none"});if(o==="top"||o==="bottom"){var c=+(o==="top"&&!i||o==="bottom"&&i);l=Fn(Fn({},l),{},{x1:t,y1:r+c*a,x2:t+n,y2:r+c*a})}else{var d=+(o==="left"&&!i||o==="right"&&i);l=Fn(Fn({},l),{},{x1:t+d*n,y1:r,x2:t+d*n,y2:r+a})}return xi.createElement("line",cg({},l,{className:We("recharts-cartesian-axis-line",(0,UM.default)(s,"className"))}))}static renderTickItem(t,r,n){var a,o=We(r.className,"recharts-cartesian-axis-tick-value");if(xi.isValidElement(t))a=xi.cloneElement(t,Fn(Fn({},r),{},{className:o}));else if(typeof t=="function")a=t(Fn(Fn({},r),{},{className:o}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=We(i,t.className)),a=xi.createElement(Xy,cg({},r,{className:i}),n)}return a}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:a,stroke:o,tick:i,tickFormatter:s,unit:l}=this.props,c=ob(Fn(Fn({},this.props),{},{ticks:n}),t,r),d=this.getTickTextAnchor(),u=this.getTickVerticalAnchor(),p=Me(this.props,!1),m=Me(i,!1),h=Fn(Fn({},p),{},{fill:"none"},Me(a,!1)),f=c.map((b,v)=>{var{line:y,tick:g}=this.getTickLineCoord(b),w=Fn(Fn(Fn(Fn({textAnchor:d,verticalAnchor:u},p),{},{stroke:"none",fill:o},m),g),{},{index:v,payload:b,visibleTicksCount:c.length,tickFormatter:s});return xi.createElement(tr,cg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(b.value,"-").concat(b.coordinate,"-").concat(b.tickCoord)},ay(this.props,b,v)),a&&xi.createElement("line",cg({},h,y,{className:We("recharts-cartesian-axis-tick-line",(0,UM.default)(a,"className"))})),i&&e.renderTickItem(i,w,"".concat(typeof s=="function"?s(b.value,v):b.value).concat(l||"")))});return f.length>0?xi.createElement("g",{className:"recharts-cartesian-axis-ticks"},f):null}render(){var{axisLine:t,width:r,height:n,className:a,hide:o}=this.props;if(o)return null;var{ticks:i}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:xi.createElement(tr,{className:We("recharts-cartesian-axis",a),ref:s=>{if(s){var l=s.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var d=window.getComputedStyle(c).fontSize,u=window.getComputedStyle(c).letterSpacing;(d!==this.state.fontSize||u!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,i),va.renderCallByParent(this.props))}};qM(Rs,"displayName","CartesianAxis");qM(Rs,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var jn=_(B());var ppe=["x1","y1","x2","y2","key"],mpe=["offset"],fpe=["xAxisId","yAxisId"],gpe=["xAxisId","yAxisId"];function YH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YH(Object(r),!0).forEach(function(n){hpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hpe(e,t,r){return(t=vpe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vpe(e){var t=ype(e,"string");return typeof t=="symbol"?t:t+""}function ype(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gp.apply(null,arguments)}function CC(e,t){if(e==null)return{};var r,n,a=bpe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bpe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xpe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:o,height:i,ry:s}=e;return jn.createElement("rect",{x:n,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function KH(e,t){var r;if(jn.isValidElement(e))r=jn.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:o,y2:i,key:s}=t,l=CC(t,ppe),c=Me(l,!1),{offset:d}=c,u=CC(c,mpe);r=jn.createElement("line",gp({},u,{x1:n,y1:a,x2:o,y2:i,fill:"none",key:s}))}return r}function wpe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:o,yAxisId:i}=e,s=CC(e,fpe),l=a.map((c,d)=>{var u=_a(_a({},s),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(d),index:d});return KH(n,u)});return jn.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function Spe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:o,yAxisId:i}=e,s=CC(e,gpe),l=a.map((c,d)=>{var u=_a(_a({},s),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(d),index:d});return KH(n,u)});return jn.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function kpe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:o,height:i,horizontalPoints:s,horizontal:l=!0}=e;if(!l||!t||!t.length)return null;var c=s.map(u=>Math.round(u+a-a)).sort((u,p)=>u-p);a!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],h=m?a+i-u:c[p+1]-u;if(h<=0)return null;var f=p%t.length;return jn.createElement("rect",{key:"react-".concat(p),y:u,x:n,height:h,width:o,stroke:"none",fill:t[f],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return jn.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function Cpe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:o,width:i,height:s,verticalPoints:l}=e;if(!t||!r||!r.length)return null;var c=l.map(u=>Math.round(u+a-a)).sort((u,p)=>u-p);a!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],h=m?a+i-u:c[p+1]-u;if(h<=0)return null;var f=p%r.length;return jn.createElement("rect",{key:"react-".concat(p),x:u,y:o,width:h,height:s,stroke:"none",fill:r[f],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return jn.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Tpe=(e,t)=>{var{xAxis:r,width:n,height:a,offset:o}=e;return rN(ob(_a(_a(_a({},Rs.defaultProps),r),{},{ticks:nN(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),o.left,o.left+o.width,t)},Ppe=(e,t)=>{var{yAxis:r,width:n,height:a,offset:o}=e;return rN(ob(_a(_a(_a({},Rs.defaultProps),r),{},{ticks:nN(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),o.top,o.top+o.height,t)},Dpe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Ba(e){var t=ES(),r=AS(),n=Zi(),a=_a(_a({},vn(e,Dpe)),{},{x:be(e.x)?e.x:n.left,y:be(e.y)?e.y:n.top,width:be(e.width)?e.width:n.width,height:be(e.height)?e.height:n.height}),{xAxisId:o,yAxisId:i,x:s,y:l,width:c,height:d,syncWithTicks:u,horizontalValues:p,verticalValues:m}=a,h=Et(),f=xe(T=>XL(T,"xAxis",o,h)),b=xe(T=>XL(T,"yAxis",i,h));if(!be(c)||c<=0||!be(d)||d<=0||!be(s)||s!==+s||!be(l)||l!==+l)return null;var v=a.verticalCoordinatesGenerator||Tpe,y=a.horizontalCoordinatesGenerator||Ppe,{horizontalPoints:g,verticalPoints:w}=a;if((!g||!g.length)&&typeof y=="function"){var C=p&&p.length,k=y({yAxis:b?_a(_a({},b),{},{ticks:C?p:b.ticks}):void 0,width:t,height:r,offset:n},C?!0:u);pp(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(g=k)}if((!w||!w.length)&&typeof v=="function"){var x=m&&m.length,S=v({xAxis:f?_a(_a({},f),{},{ticks:x?m:f.ticks}):void 0,width:t,height:r,offset:n},x?!0:u);pp(Array.isArray(S),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(w=S)}return jn.createElement("g",{className:"recharts-cartesian-grid"},jn.createElement(xpe,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),jn.createElement(kpe,gp({},a,{horizontalPoints:g})),jn.createElement(Cpe,gp({},a,{verticalPoints:w})),jn.createElement(wpe,gp({},a,{offset:n,horizontalPoints:g,xAxis:f,yAxis:b})),jn.createElement(Spe,gp({},a,{offset:n,verticalPoints:w,xAxis:f,yAxis:b})))}Ba.displayName="CartesianGrid";var At=_(B()),io=_(B());var JH=(e,t,r,n)=>Oa(e,"xAxis",t,n),XH=(e,t,r,n)=>yi(e,"xAxis",t,n),QH=(e,t,r,n)=>Oa(e,"yAxis",r,n),ZH=(e,t,r,n)=>yi(e,"yAxis",r,n),Epe=ne([dt,JH,QH,XH,ZH],(e,t,r,n,a)=>Io(e,"xAxis")?Is(t,n,!1):Is(r,a,!1)),Ape=(e,t,r,n,a)=>a,Ipe=ne([Od,Ape],(e,t)=>{if(e.some(r=>r.type==="line"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),eV=ne([dt,JH,QH,XH,ZH,Ipe,Epe,Md],(e,t,r,n,a,o,i,s)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=s;if(!(o==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||i==null)){var{dataKey:u,data:p}=o,m;if(p!=null&&p.length>0?m=p:m=l==null?void 0:l.slice(c,d+1),m!=null)return tV({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:u,bandSize:i,displayedData:m})}});var Npe=["type","layout","connectNulls","needClip"],Lpe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function nV(e,t){if(e==null)return{};var r,n,a=Mpe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Mpe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ws(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rV(Object(r),!0).forEach(function(n){TC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TC(e,t,r){return(t=Ope(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ope(e){var t=Fpe(e,"string");return typeof t=="symbol"?t:t+""}function Fpe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dg.apply(null,arguments)}var jpe=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:n,value:pc(r,t),payload:e}]};function zpe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:o,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:o,dataKey:t,nameKey:void 0,name:pc(i,t),hide:s,type:e.tooltipType,color:e.stroke,unit:l}}}var aV=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function _pe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var Bpe=(e,t,r)=>{var n=r.reduce((u,p)=>u+p);if(!n)return aV(t,e);for(var a=Math.floor(e/n),o=e%n,i=t-e,s=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>o){s=[...r.slice(0,l),o-c];break}var d=s.length%2===0?[0,i]:[i];return[..._pe(r,a),...s,...d].map(u=>"".concat(u,"px")).join(", ")};function $pe(e,t){var r;if(At.isValidElement(e))r=At.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=We("recharts-line-dot",typeof e!="boolean"?e.className:"");r=At.createElement(Xf,dg({},t,{className:n}))}return r}function Rpe(e,t){return e==null?!1:t?!0:e.length===1}function Wpe(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:o,needClip:i}=n;if(!Rpe(r,a))return null;var s=rf(a),l=Me(n,!1),c=Me(a,!0),d=r.map((p,m)=>{var h=Ws(Ws(Ws({key:"dot-".concat(m),r:3},l),c),{},{index:m,cx:p.x,cy:p.y,dataKey:o,value:p.value,payload:p.payload,points:r});return $pe(a,h)}),u={clipPath:i?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):null};return At.createElement(tr,dg({className:"recharts-line-dots",key:"dots"},u),d)}function HM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:o,showLabels:i}=e,{type:s,layout:l,connectNulls:c,needClip:d}=o,u=nV(o,Npe),p=Ws(Ws({},Me(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):null,points:n,type:s,layout:l,connectNulls:c,strokeDasharray:a!=null?a:o.strokeDasharray});return At.createElement(At.Fragment,null,(n==null?void 0:n.length)>1&&At.createElement(Pd,dg({},p,{pathRef:r})),At.createElement(Wpe,{points:n,clipPathId:t,props:o}),i&&as.renderCallByParent(o,n))}function Upe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}function qpe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:o}=e,{points:i,strokeDasharray:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,animateNewValues:p,width:m,height:h,onAnimationEnd:f,onAnimationStart:b}=r,v=a.current,y=rg(r,"recharts-line-"),[g,w]=(0,io.useState)(!1),C=(0,io.useCallback)(()=>{typeof f=="function"&&f(),w(!1)},[f]),k=(0,io.useCallback)(()=>{typeof b=="function"&&b(),w(!0)},[b]),x=Upe(n.current),S=o.current;return At.createElement(Oo,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},onAnimationEnd:C,onAnimationStart:k,key:y},T=>{var{t:P}=T,M=ci(S,x+S),D=Math.min(M(P),x),A;if(s){var L="".concat(s).split(/[,\s]+/gim).map(I=>parseFloat(I));A=Bpe(D,x,L)}else A=aV(x,D);if(v){var N=v.length/i.length,E=P===1?i:i.map((I,O)=>{var j=Math.floor(O*N);if(v[j]){var $=v[j],F=ci($.x,I.x),z=ci($.y,I.y);return Ws(Ws({},I),{},{x:F(P),y:z(P)})}if(p){var W=ci(m*2,I.x),U=ci(h/2,I.y);return Ws(Ws({},I),{},{x:W(P),y:U(P)})}return Ws(Ws({},I),{},{x:I.x,y:I.y})});return a.current=E,At.createElement(HM,{props:r,points:E,clipPathId:t,pathRef:n,showLabels:!g,strokeDasharray:A})}return P>0&&x>0&&(a.current=i,o.current=D),At.createElement(HM,{props:r,points:i,clipPathId:t,pathRef:n,showLabels:!g,strokeDasharray:A})})}function Hpe(e){var{clipPathId:t,props:r}=e,{points:n,isAnimationActive:a}=r,o=(0,io.useRef)(null),i=(0,io.useRef)(0),s=(0,io.useRef)(null),l=o.current;return a&&n&&n.length&&l!==n?At.createElement(qpe,{props:r,clipPathId:t,previousPointsRef:o,longestAnimatedLengthRef:i,pathRef:s}):At.createElement(HM,{props:r,points:n,clipPathId:t,pathRef:s,showLabels:!0})}var Vpe=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Ir(e.payload,t)}),VM=class extends io.Component{constructor(){super(...arguments),TC(this,"id",li("recharts-line-"))}render(){var t,{hide:r,dot:n,points:a,className:o,xAxisId:i,yAxisId:s,top:l,left:c,width:d,height:u,id:p,needClip:m,layout:h}=this.props;if(r)return null;var f=We("recharts-line",o),b=st(p)?this.id:p,{r:v=3,strokeWidth:y=2}=(t=Me(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},g=rf(n),w=v*2+y;return At.createElement(At.Fragment,null,At.createElement(tr,{className:f},m&&At.createElement("defs",null,At.createElement(ig,{clipPathId:b,xAxisId:i,yAxisId:s}),!g&&At.createElement("clipPath",{id:"clipPath-dots-".concat(b)},At.createElement("rect",{x:c-w/2,y:l-w/2,width:d+w,height:u+w}))),At.createElement(Hpe,{props:this.props,clipPathId:b}),At.createElement(hC,{direction:h==="horizontal"?"y":"x"},At.createElement(fC,{xAxisId:i,yAxisId:s,data:a,dataPointFormatter:Vpe,errorBarOffset:0},this.props.children))),At.createElement(eb,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}},oV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Mo.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function Gpe(e){var t=vn(e,oV),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:o,animationEasing:i,connectNulls:s,dot:l,hide:c,isAnimationActive:d,label:u,legendType:p,xAxisId:m,yAxisId:h}=t,f=nV(t,Lpe),{needClip:b}=fp(m,h),{height:v,width:y,left:g,top:w}=Zi(),C=bl(),k=Et(),x=(0,io.useMemo)(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),S=xe(T=>eV(T,m,h,k,x));return C!=="horizontal"&&C!=="vertical"?null:At.createElement(VM,dg({},f,{connectNulls:s,dot:l,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:o,animationEasing:i,isAnimationActive:d,hide:c,label:u,legendType:p,xAxisId:m,yAxisId:h,points:S,layout:C,height:v,width:y,left:g,top:w,needClip:b}))}function tV(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:o,dataKey:i,bandSize:s,displayedData:l}=e;return l.map((c,d)=>{var u=Ir(c,i);return t==="horizontal"?{x:yf({axis:r,ticks:a,bandSize:s,entry:c,index:d}),y:st(u)?null:n.scale(u),value:u,payload:c}:{x:st(u)?null:r.scale(u),y:yf({axis:n,ticks:o,bandSize:s,entry:c,index:d}),value:u,payload:c}})}var Pl=class extends io.PureComponent{render(){return At.createElement(ag,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},At.createElement(tg,{legendPayload:jpe(this.props)}),At.createElement(eg,{fn:zpe,args:this.props}),At.createElement(Gpe,this.props))}};TC(Pl,"displayName","Line");TC(Pl,"defaultProps",oV);var at=_(B()),wi=_(B());var iV=(e,t,r,n)=>Oa(e,"xAxis",t,n),sV=(e,t,r,n)=>yi(e,"xAxis",t,n),lV=(e,t,r,n)=>Oa(e,"yAxis",r,n),cV=(e,t,r,n)=>yi(e,"yAxis",r,n),Ype=ne([dt,iV,lV,sV,cV],(e,t,r,n,a)=>Io(e,"xAxis")?Is(t,n,!1):Is(r,a,!1)),Kpe=(e,t,r,n,a)=>{var o,i=dt(e),s=Io(i,"xAxis"),l;if(s?l=cp(e,"yAxis",r,n):l=cp(e,"xAxis",t,n),l!=null){var{dataKey:c,stackId:d}=a;if(d!=null){var u=(o=l[d])===null||o===void 0?void 0:o.stackedData;return u==null?void 0:u.find(p=>p.key===c)}}},Jpe=(e,t,r,n,a)=>a,Xpe=ne([Od,Jpe],(e,t)=>{if(e.some(r=>r.type==="area"&&t.dataKey===r.dataKey&&vf(t.stackId)===r.stackId&&t.data===r.data))return t}),dV=ne([dt,iV,lV,sV,cV,Kpe,Md,Ype,Xpe],(e,t,r,n,a,o,i,s,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=i;if(!(l==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{data:p}=l,m;if(p&&p.length>0?m=p:m=c==null?void 0:c.slice(d,u+1),m!=null){var h=void 0;return uV({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataStartIndex:d,areaSettings:l,stackedData:o,displayedData:m,chartBaseValue:h,bandSize:s})}}});var Qpe=["layout","type","stroke","connectNulls","isRange"],Zpe=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function mV(e,t){if(e==null)return{};var r,n,a=eme(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eme(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function pV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pV(Object(r),!0).forEach(function(n){DC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DC(e,t,r){return(t=tme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tme(e){var t=rme(e,"string");return typeof t=="symbol"?t:t+""}function rme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zd(){return zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zd.apply(null,arguments)}function PC(e,t){return e&&e!=="none"?e:t}var nme=e=>{var{dataKey:t,name:r,stroke:n,fill:a,legendType:o,hide:i}=e;return[{inactive:i,dataKey:t,type:o,color:PC(n,a),value:pc(r,t),payload:e}]};function ame(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:o,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:o,dataKey:t,nameKey:void 0,name:pc(i,t),hide:s,type:e.tooltipType,color:PC(n,o),unit:l}}}var ome=(e,t)=>{var r;if(at.isValidElement(e))r=at.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=We("recharts-area-dot",typeof e!="boolean"?e.className:"");r=at.createElement(Xf,zd({},t,{className:n}))}return r};function ime(e,t){return e==null?!1:t?!0:e.length===1}function sme(e){var{clipPathId:t,points:r,props:n}=e,{needClip:a,dot:o,dataKey:i}=n;if(!ime(r,o))return null;var s=rf(o),l=Me(n,!1),c=Me(o,!0),d=r.map((p,m)=>{var h=hp(hp(hp({key:"dot-".concat(m),r:3},l),c),{},{index:m,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return ome(o,h)}),u={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):void 0};return at.createElement(tr,zd({className:"recharts-area-dots"},u),d)}function GM(e){var{points:t,baseLine:r,needClip:n,clipPathId:a,props:o,showLabels:i}=e,{layout:s,type:l,stroke:c,connectNulls:d,isRange:u}=o,p=mV(o,Qpe);return at.createElement(at.Fragment,null,(t==null?void 0:t.length)>1&&at.createElement(tr,{clipPath:n?"url(#clipPath-".concat(a,")"):void 0},at.createElement(Pd,zd({},Me(p,!0),{points:t,connectNulls:d,type:l,baseLine:r,layout:s,stroke:"none",className:"recharts-area-area"})),c!=="none"&&at.createElement(Pd,zd({},Me(o,!1),{className:"recharts-area-curve",layout:s,type:l,connectNulls:d,fill:"none",points:t})),c!=="none"&&u&&at.createElement(Pd,zd({},Me(o,!1),{className:"recharts-area-curve",layout:s,type:l,connectNulls:d,fill:"none",points:r}))),at.createElement(sme,{points:t,props:o,clipPathId:a}),i&&as.renderCallByParent(o,t))}function lme(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,o=n[0].y,i=n[n.length-1].y;if(!Nr(o)||!Nr(i))return null;var s=t*Math.abs(o-i),l=Math.max(...n.map(c=>c.x||0));return be(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.x||0),l)),be(l)?at.createElement("rect",{x:0,y:o<i?o:o-s,width:l+(a?parseInt("".concat(a),10):1),height:Math.floor(s)}):null}function cme(e){var{alpha:t,baseLine:r,points:n,strokeWidth:a}=e,o=n[0].x,i=n[n.length-1].x;if(!Nr(o)||!Nr(i))return null;var s=t*Math.abs(o-i),l=Math.max(...n.map(c=>c.y||0));return be(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.y||0),l)),be(l)?at.createElement("rect",{x:o<i?o:o-s,y:0,width:s,height:Math.floor(l+(a?parseInt("".concat(a),10):1))}):null}function dme(e){var{alpha:t,layout:r,points:n,baseLine:a,strokeWidth:o}=e;return r==="vertical"?at.createElement(lme,{alpha:t,points:n,baseLine:a,strokeWidth:o}):at.createElement(cme,{alpha:t,points:n,baseLine:a,strokeWidth:o})}function ume(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:a,previousBaselineRef:o}=e,{points:i,baseLine:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,onAnimationStart:p,onAnimationEnd:m}=n,h=rg(n,"recharts-area-"),[f,b]=(0,wi.useState)(!0),v=(0,wi.useCallback)(()=>{typeof m=="function"&&m(),b(!1)},[m]),y=(0,wi.useCallback)(()=>{typeof p=="function"&&p(),b(!0)},[p]),g=a.current,w=o.current;return at.createElement(Oo,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},onAnimationEnd:v,onAnimationStart:y,key:h},C=>{var{t:k}=C;if(g){var x=g.length/i.length,S=k===1?i:i.map((P,M)=>{var D=Math.floor(M*x);if(g[D]){var A=g[D];return hp(hp({},P),{},{x:Fu(A.x,P.x,k),y:Fu(A.y,P.y,k)})}return P}),T;return be(s)?T=Fu(w,s,k):st(s)||Er(s)?T=Fu(w,0,k):T=s.map((P,M)=>{var D=Math.floor(M*x);if(Array.isArray(w)&&w[D]){var A=w[D];return hp(hp({},P),{},{x:Fu(A.x,P.x,k),y:Fu(A.y,P.y,k)})}return P}),k>0&&(a.current=S,o.current=T),at.createElement(GM,{points:S,baseLine:T,needClip:t,clipPathId:r,props:n,showLabels:!f})}return k>0&&(a.current=i,o.current=s),at.createElement(tr,null,at.createElement("defs",null,at.createElement("clipPath",{id:"animationClipPath-".concat(r)},at.createElement(dme,{alpha:k,points:i,baseLine:s,layout:n.layout,strokeWidth:n.strokeWidth}))),at.createElement(tr,{clipPath:"url(#animationClipPath-".concat(r,")")},at.createElement(GM,{points:i,baseLine:s,needClip:t,clipPathId:r,props:n,showLabels:!0})))})}function pme(e){var{needClip:t,clipPathId:r,props:n}=e,{points:a,baseLine:o,isAnimationActive:i}=n,s=(0,wi.useRef)(null),l=(0,wi.useRef)(),c=s.current,d=l.current;return i&&a&&a.length&&(c!==a||d!==o)?at.createElement(ume,{needClip:t,clipPathId:r,props:n,previousPointsRef:s,previousBaselineRef:l}):at.createElement(GM,{points:a,baseLine:o,needClip:t,clipPathId:r,props:n,showLabels:!0})}var YM=class extends wi.PureComponent{constructor(){super(...arguments),DC(this,"id",li("recharts-area-"))}render(){var t,{hide:r,dot:n,points:a,className:o,top:i,left:s,needClip:l,xAxisId:c,yAxisId:d,width:u,height:p,id:m,baseLine:h}=this.props;if(r)return null;var f=We("recharts-area",o),b=st(m)?this.id:m,{r:v=3,strokeWidth:y=2}=(t=Me(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},g=rf(n),w=v*2+y;return at.createElement(at.Fragment,null,at.createElement(tr,{className:f},l&&at.createElement("defs",null,at.createElement(ig,{clipPathId:b,xAxisId:c,yAxisId:d}),!g&&at.createElement("clipPath",{id:"clipPath-dots-".concat(b)},at.createElement("rect",{x:s-w/2,y:i-w/2,width:u+w,height:p+w}))),at.createElement(pme,{needClip:l,clipPathId:b,props:this.props})),at.createElement(eb,{points:a,mainColor:PC(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(h)&&at.createElement(eb,{points:h,mainColor:PC(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}},fV={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Mo.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function mme(e){var t,r=vn(e,fV),{activeDot:n,animationBegin:a,animationDuration:o,animationEasing:i,connectNulls:s,dot:l,fill:c,fillOpacity:d,hide:u,isAnimationActive:p,legendType:m,stroke:h,xAxisId:f,yAxisId:b}=r,v=mV(r,Zpe),y=bl(),g=rC(),{needClip:w}=fp(f,b),C=Et(),k=(0,wi.useMemo)(()=>({baseValue:e.baseValue,stackId:e.stackId,connectNulls:s,data:e.data,dataKey:e.dataKey}),[e.baseValue,e.stackId,s,e.data,e.dataKey]),{points:x,isRange:S,baseLine:T}=(t=xe(L=>dV(L,f,b,C,k)))!==null&&t!==void 0?t:{},{height:P,width:M,left:D,top:A}=Zi();return y!=="horizontal"&&y!=="vertical"||g!=="AreaChart"&&g!=="ComposedChart"?null:at.createElement(YM,zd({},v,{activeDot:n,animationBegin:a,animationDuration:o,animationEasing:i,baseLine:T,connectNulls:s,dot:l,fill:c,fillOpacity:d,height:P,hide:u,layout:y,isAnimationActive:p,isRange:S,legendType:m,needClip:w,points:x,stroke:h,width:M,left:D,top:A,xAxisId:f,yAxisId:b}))}var fme=(e,t,r,n,a)=>{var o=r!=null?r:t;if(be(o))return o;var i=e==="horizontal"?a:n,s=i.scale.domain();if(i.type==="number"){var l=Math.max(s[0],s[1]),c=Math.min(s[0],s[1]);return o==="dataMin"?c:o==="dataMax"||l<0?l:Math.max(Math.min(s[0],s[1]),0)}return o==="dataMin"?s[0]:o==="dataMax"?s[1]:s[0]};function uV(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:a,layout:o,chartBaseValue:i,xAxis:s,yAxis:l,displayedData:c,dataStartIndex:d,xAxisTicks:u,yAxisTicks:p,bandSize:m}=e,h=a&&a.length,f=fme(o,i,r,s,l),b=o==="horizontal",v=!1,y=c.map((w,C)=>{var k;h?k=a[d+C]:(k=Ir(w,n),Array.isArray(k)?v=!0:k=[f,k]);var x=k[1]==null||h&&!t&&Ir(w,n)==null;return b?{x:yf({axis:s,ticks:u,bandSize:m,entry:w,index:C}),y:x?null:l.scale(k[1]),value:k,payload:w}:{x:x?null:s.scale(k[1]),y:yf({axis:l,ticks:p,bandSize:m,entry:w,index:C}),value:k,payload:w}}),g;return h||v?g=y.map(w=>{var C=Array.isArray(w.value)?w.value[0]:null;return b?{x:w.x,y:C!=null&&w.y!=null?l.scale(C):null}:{x:C!=null?s.scale(C):null,y:w.y}}):g=b?l.scale(f):s.scale(f),{points:y,baseLine:g,isRange:v}}var Bo=class extends wi.PureComponent{render(){return at.createElement(ag,{type:"area",data:this.props.data,dataKey:this.props.dataKey,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,stackId:this.props.stackId,hide:this.props.hide,barSize:void 0},at.createElement(tg,{legendPayload:nme(this.props)}),at.createElement(eg,{fn:ame,args:this.props}),at.createElement(mme,this.props))}};DC(Bo,"displayName","Area");DC(Bo,"defaultProps",fV);function gV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gV(Object(r),!0).forEach(function(n){gme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gme(e,t,r){return(t=hme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hme(e){var t=vme(e,"string");return typeof t=="symbol"?t:t+""}function vme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yme={xAxis:{},yAxis:{},zAxis:{}},vV=Ar({name:"cartesianAxis",initialState:yme,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=hV(hV({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:yV,removeXAxis:bV,addYAxis:xV,removeYAxis:wV,addZAxis:OVe,removeZAxis:FVe,updateYAxisWidth:SV}=vV.actions,kV=vV.reducer;var ib=_(B()),ug=_(B());var bme=["children"],xme=["dangerouslySetInnerHTML","ticks"];function CV(e,t,r){return(t=wme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wme(e){var t=Sme(e,"string");return typeof t=="symbol"?t:t+""}function Sme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KM(){return KM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KM.apply(null,arguments)}function TV(e,t){if(e==null)return{};var r,n,a=kme(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kme(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Cme(e){var t=wt(),r=(0,ug.useMemo)(()=>{var{children:o}=e,i=TV(e,bme);return i},[e]),n=xe(o=>vi(o,r.id)),a=r===n;return(0,ug.useEffect)(()=>(t(yV(r)),()=>{t(bV(r))}),[r,t]),a?e.children:null}var Tme=e=>{var{xAxisId:t,className:r}=e,n=xe(PS),a=Et(),o="xAxis",i=xe(m=>Fs(m,o,t,a)),s=xe(m=>Rk(m,o,t,a)),l=xe(m=>qL(m,t)),c=xe(m=>WU(m,t));if(l==null||c==null)return null;var{dangerouslySetInnerHTML:d,ticks:u}=e,p=TV(e,xme);return ib.createElement(Rs,KM({},p,{scale:i,x:c.x,y:c.y,width:l.width,height:l.height,className:We("recharts-".concat(o," ").concat(o),r),viewBox:n,ticks:s}))},Pme=e=>{var t,r,n,a,o;return ib.createElement(Cme,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(o=e.tick)!==null&&o!==void 0?o:!0,tickFormatter:e.tickFormatter},ib.createElement(Tme,e))},zn=class extends ug.Component{render(){return ib.createElement(Pme,this.props)}};CV(zn,"displayName","XAxis");CV(zn,"defaultProps",{allowDataOverflow:ro.allowDataOverflow,allowDecimals:ro.allowDecimals,allowDuplicatedCategory:ro.allowDuplicatedCategory,height:ro.height,hide:!1,mirror:ro.mirror,orientation:ro.orientation,padding:ro.padding,reversed:ro.reversed,scale:ro.scale,tickCount:ro.tickCount,type:ro.type,xAxisId:0});var _d=_(B()),Us=_(B());var PV=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:o=0}=e,i=0;if(t){t.forEach(d=>{if(d){var u=d.getBoundingClientRect();u.width>i&&(i=u.width)}});var s=r?r.getBoundingClientRect().width:0,l=a+o,c=i+l+s+(r?n:0);return Math.round(c)}return 0};var Dme=["dangerouslySetInnerHTML","ticks"];function DV(e,t,r){return(t=Eme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eme(e){var t=Ame(e,"string");return typeof t=="symbol"?t:t+""}function Ame(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JM(){return JM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JM.apply(null,arguments)}function Ime(e,t){if(e==null)return{};var r,n,a=Nme(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Nme(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Lme(e){var t=wt();return(0,Us.useEffect)(()=>(t(xV(e)),()=>{t(wV(e))}),[e,t]),null}var Mme=e=>{var t,{yAxisId:r,className:n,width:a,label:o}=e,i=(0,Us.useRef)(null),s=(0,Us.useRef)(null),l=xe(PS),c=Et(),d=wt(),u="yAxis",p=xe(g=>Fs(g,u,r,c)),m=xe(g=>HL(g,r)),h=xe(g=>UU(g,r)),f=xe(g=>Rk(g,u,r,c));if((0,Us.useLayoutEffect)(()=>{var g;if(!(a!=="auto"||!m||Qy(o)||(0,Us.isValidElement)(o))){var w=i.current,C=w==null||(g=w.tickRefs)===null||g===void 0?void 0:g.current,{tickSize:k,tickMargin:x}=w.props,S=PV({ticks:C,label:s.current,labelGapWithTick:5,tickSize:k,tickMargin:x});Math.round(m.width)!==Math.round(S)&&d(SV({id:r,width:S}))}},[i,i==null||(t=i.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,m==null?void 0:m.width,m,d,o,r,a]),m==null||h==null)return null;var{dangerouslySetInnerHTML:b,ticks:v}=e,y=Ime(e,Dme);return _d.createElement(Rs,JM({},y,{ref:i,labelRef:s,scale:p,x:h.x,y:h.y,width:m.width,height:m.height,className:We("recharts-".concat(u," ").concat(u),n),viewBox:l,ticks:f}))},Ome=e=>{var t,r,n,a,o;return _d.createElement(_d.Fragment,null,_d.createElement(Lme,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(o=e.tick)!==null&&o!==void 0?o:!0,tickFormatter:e.tickFormatter}),_d.createElement(Mme,e))},Fme={allowDataOverflow:no.allowDataOverflow,allowDecimals:no.allowDecimals,allowDuplicatedCategory:no.allowDuplicatedCategory,hide:!1,mirror:no.mirror,orientation:no.orientation,padding:no.padding,reversed:no.reversed,scale:no.scale,tickCount:no.tickCount,type:no.type,width:no.width,yAxisId:0},_n=class extends Us.Component{render(){return _d.createElement(Ome,this.props)}};DV(_n,"displayName","YAxis");DV(_n,"defaultProps",Fme);var pg=_(B()),tG=_(B());var UV=_(B()),qV=_(B());var Jr=_(B(),1),sfe=_(NV(),1);var Ume=Symbol.for("react.forward_ref");var qme=Symbol.for("react.memo");var Hme=Ume,Vme=qme;function Gme(e){e()}function Yme(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Gme(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0,a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var LV={notify(){},get:()=>[]};function Kme(e,t){let r,n=LV,a=0,o=!1;function i(f){d();let b=n.subscribe(f),v=!1;return()=>{v||(v=!0,b(),u())}}function s(){n.notify()}function l(){h.onStateChange&&h.onStateChange()}function c(){return o}function d(){a++,r||(r=t?t.addNestedSub(l):e.subscribe(l),n=Yme())}function u(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=LV)}function p(){o||(o=!0,d())}function m(){o&&(o=!1,u())}let h={addNestedSub:i,notifyNestedSubs:s,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:m,getListeners:()=>n};return h}var Jme=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",Xme=Jme(),Qme=()=>typeof navigator!="undefined"&&navigator.product==="ReactNative",Zme=Qme(),efe=()=>Xme||Zme?Jr.useLayoutEffect:Jr.useEffect,tfe=efe();var rfe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},nfe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},aGe={[Hme]:rfe,[Vme]:nfe};var oGe=Object.prototype;var XM=Symbol.for("react-redux-context"),QM=typeof globalThis!="undefined"?globalThis:{};function afe(){var r;if(!Jr.createContext)return{};let e=(r=QM[XM])!=null?r:QM[XM]=new Map,t=e.get(Jr.createContext);return t||(t=Jr.createContext(null),e.set(Jr.createContext,t)),t}var ofe=afe();function ife(e){let{children:t,context:r,serverState:n,store:a}=e,o=Jr.useMemo(()=>{let l=Kme(a);return{store:a,subscription:l,getServerState:n?()=>n:void 0}},[a,n]),i=Jr.useMemo(()=>a.getState(),[a]);return tfe(()=>{let{subscription:l}=o;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==a.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[o,i]),Jr.createElement((r||ofe).Provider,{value:o},t)}var MV=ife;var lfe=(e,t)=>t,lb=ne([lfe,dt,FU,On,nM,_o,g8,xr],S8);var cb=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}};var ZM=Nn("mouseClick"),eO=uc();eO.startListening({actionCreator:ZM,effect:(e,t)=>{var r=e.payload,n=lb(t.getState(),cb(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(ZU({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var EC=Nn("mouseMove"),tO=uc();tO.startListening({actionCreator:EC,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Gy(n,n.tooltip.settings.shared),o=lb(n,cb(r));a==="axis"&&((o==null?void 0:o.activeIndex)!=null?t.dispatch(Hk({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(qk()))}});function OV(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var FV={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},jV=Ar({name:"rootProps",initialState:FV,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:FV.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),zV=jV.reducer,{updateOptions:_V}=jV.actions;var BV=Ar({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:TGe}=BV.actions,$V=BV.reducer;var rO=Nn("keyDown"),nO=Nn("focus"),AC=uc();AC.startListening({actionCreator:rO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var i=Number(Uf(a,xc(r))),s=_o(r);if(o==="Enter"){var l=Yy(r,"axis","hover",String(a.index));t.dispatch(Gk({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:l}));return}var c=qU(r),d=c==="left-to-right"?1:-1,u=o==="ArrowRight"?1:-1,p=i+u*d;if(!(s==null||p>=s.length||p<0)){var m=Yy(r,"axis","hover",String(p));t.dispatch(Gk({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});AC.startListening({actionCreator:nO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var o="0",i=Yy(r,"axis","hover",String(o));t.dispatch(Gk({activeDataKey:void 0,active:!0,activeIndex:o,activeCoordinate:i}))}}}});var Si=Nn("externalEvent"),aO=uc();aO.startListening({actionCreator:Si,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:i8(r),activeDataKey:tC(r),activeIndex:wc(r),activeLabel:eC(r),activeTooltipIndex:wc(r),isTooltipActive:s8(r)};e.payload.handler(n,e.payload.reactEvent)}}});var cfe=ne([bc],e=>e.tooltipItemPayloads),RV=ne([cfe,up,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(s=>s.settings.dataKey===n);if(a!=null){var{positions:o}=a;if(o!=null){var i=t(o,r);return i}}});var oO=Nn("touchMove"),iO=uc();iO.startListening({actionCreator:oO,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Gy(n,n.tooltip.settings.shared);if(a==="axis"){var o=lb(n,cb({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(Hk({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var i,s=r.touches[0],l=document.elementFromPoint(s.clientX,s.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(H4),d=(i=l.getAttribute(V4))!==null&&i!==void 0?i:void 0,u=RV(t.getState(),c,d);t.dispatch(Uk({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}});var dfe=cS({brush:TH,cartesianAxis:kV,chartData:z8,graphicalItems:Lq,layout:T4,legend:Z4,options:L8,polarAxis:Pq,polarOptions:$V,referenceElements:OH,rootProps:zV,tooltip:e8}),WV=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return i4({reducer:dfe,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([eO.middleware,tO.middleware,AC.middleware,aO.middleware,iO.middleware]),devTools:{serialize:{replacer:OV},name:"recharts-".concat(r)}})};function HV(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Et(),o=(0,qV.useRef)(null);if(a)return r;o.current==null&&(o.current=WV(t,n));var i=ly;return UV.createElement(MV,{context:i,store:o.current},r)}var VV=_(B());function GV(e){var{layout:t,width:r,height:n,margin:a}=e,o=wt(),i=Et();return(0,VV.useEffect)(()=>{i||(o(S4(t)),o(k4({width:r,height:n})),o(w4(a)))},[o,i,t,r,n,a]),null}var YV=_(B());function KV(e){var t=wt();return(0,YV.useEffect)(()=>{t(_V(e))},[t,e]),null}var ub=_(B()),ZV=_(B());var db=_(B()),sO=_(B());var ufe=["children"];function pfe(e,t){if(e==null)return{};var r,n,a=mfe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function IC(){return IC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IC.apply(null,arguments)}var ffe={width:"100%",height:"100%"},gfe=(0,sO.forwardRef)((e,t)=>{var r=ES(),n=AS(),a=LS();if(!wf(r)||!wf(n))return null;var{children:o,otherAttributes:i,title:s,desc:l}=e,c,d;return typeof i.tabIndex=="number"?c=i.tabIndex:c=a?0:void 0,typeof i.role=="string"?d=i.role:d=a?"application":void 0,db.createElement(hA,IC({},i,{title:s,desc:l,role:d,tabIndex:c,width:r,height:n,style:ffe,ref:t}),o)}),hfe=e=>{var{children:t}=e,r=xe(qu);if(!r)return null;var{width:n,height:a,y:o,x:i}=r;return db.createElement(hA,{width:n,height:a,x:i,y:o},t)},lO=(0,sO.forwardRef)((e,t)=>{var{children:r}=e,n=pfe(e,ufe),a=Et();return a?db.createElement(hfe,null,r):db.createElement(gfe,IC({ref:t},n),r)});var LC=_(B()),bn=_(B());var NC=_(B());function JV(){var e=wt(),[t,r]=(0,NC.useState)(null),n=xe(q4);return(0,NC.useEffect)(()=>{if(t!=null){var a=t.getBoundingClientRect(),o=a.width/t.offsetWidth;Nr(o)&&o!==n&&e(C4(o))}},[t,e,n]),r}function XV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vfe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XV(Object(r),!0).forEach(function(n){yfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yfe(e,t,r){return(t=bfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bfe(e){var t=xfe(e,"string");return typeof t=="symbol"?t:t+""}function xfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QV=(0,bn.forwardRef)((e,t)=>{var{children:r,className:n,height:a,onClick:o,onContextMenu:i,onDoubleClick:s,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:p,onTouchEnd:m,onTouchMove:h,onTouchStart:f,style:b,width:v}=e,y=wt(),[g,w]=(0,bn.useState)(null),[C,k]=(0,bn.useState)(null);B8();var x=JV(),S=(0,bn.useCallback)(z=>{x(z),typeof t=="function"&&t(z),w(z),k(z)},[x,t,w,k]),T=(0,bn.useCallback)(z=>{y(ZM(z)),y(Si({handler:o,reactEvent:z}))},[y,o]),P=(0,bn.useCallback)(z=>{y(EC(z)),y(Si({handler:c,reactEvent:z}))},[y,c]),M=(0,bn.useCallback)(z=>{y(qk()),y(Si({handler:d,reactEvent:z}))},[y,d]),D=(0,bn.useCallback)(z=>{y(EC(z)),y(Si({handler:u,reactEvent:z}))},[y,u]),A=(0,bn.useCallback)(()=>{y(nO())},[y]),L=(0,bn.useCallback)(z=>{y(rO(z.key))},[y]),N=(0,bn.useCallback)(z=>{y(Si({handler:i,reactEvent:z}))},[y,i]),E=(0,bn.useCallback)(z=>{y(Si({handler:s,reactEvent:z}))},[y,s]),I=(0,bn.useCallback)(z=>{y(Si({handler:l,reactEvent:z}))},[y,l]),O=(0,bn.useCallback)(z=>{y(Si({handler:p,reactEvent:z}))},[y,p]),j=(0,bn.useCallback)(z=>{y(Si({handler:f,reactEvent:z}))},[y,f]),$=(0,bn.useCallback)(z=>{y(oO(z)),y(Si({handler:h,reactEvent:z}))},[y,h]),F=(0,bn.useCallback)(z=>{y(Si({handler:m,reactEvent:z}))},[y,m]);return LC.createElement(pM.Provider,{value:g},LC.createElement(kW.Provider,{value:C},LC.createElement("div",{className:We("recharts-wrapper",n),style:vfe({position:"relative",cursor:"default",width:v,height:a},b),role:"application",onClick:T,onContextMenu:N,onDoubleClick:E,onFocus:A,onKeyDown:L,onMouseDown:I,onMouseEnter:P,onMouseLeave:M,onMouseMove:D,onMouseUp:O,onTouchEnd:F,onTouchMove:$,onTouchStart:j,ref:S},r)))});var wfe=["children","className","width","height","style","compact","title","desc"];function Sfe(e,t){if(e==null)return{};var r,n,a=kfe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eG=(0,ZV.forwardRef)((e,t)=>{var{children:r,className:n,width:a,height:o,style:i,compact:s,title:l,desc:c}=e,d=Sfe(e,wfe),u=Me(d,!1);return s?ub.createElement(lO,{otherAttributes:u,title:l,desc:c},r):ub.createElement(QV,{className:n,style:i,width:a,height:o,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},ub.createElement(lO,{otherAttributes:u,title:l,desc:c,ref:t},ub.createElement(jH,null,r)))});var Cfe=["width","height"];function cO(){return cO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cO.apply(null,arguments)}function Tfe(e,t){if(e==null)return{};var r,n,a=Pfe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Pfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Dfe={top:5,right:5,bottom:5,left:5},Efe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Dfe,reverseStackOrder:!1,syncMethod:"index"},mg=(0,tG.forwardRef)(function(t,r){var n,a=vn(t.categoricalChartProps,Efe),{width:o,height:i}=a,s=Tfe(a,Cfe);if(!wf(o)||!wf(i))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,categoricalChartProps:p}=t,m={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return pg.createElement(HV,{preloadedState:{options:m},reduxStoreName:(n=p.id)!==null&&n!==void 0?n:l},pg.createElement(SH,{chartData:p.data}),pg.createElement(GV,{width:o,height:i,layout:a.layout,margin:a.margin}),pg.createElement(KV,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),pg.createElement(eG,cO({},s,{width:o,height:i,ref:r})))});var rG=_(B()),nG=_(B());var Afe=["axis","item"],vp=(0,nG.forwardRef)((e,t)=>rG.createElement(mg,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Afe,tooltipPayloadSearcher:Gf,categoricalChartProps:e,ref:t}));var aG=_(B()),oG=_(B());var Ife=["axis"],pb=(0,oG.forwardRef)((e,t)=>aG.createElement(mg,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ife,tooltipPayloadSearcher:Gf,categoricalChartProps:e,ref:t}));var iG=_(B()),sG=_(B());var Nfe=["axis"],mb=(0,sG.forwardRef)((e,t)=>iG.createElement(mg,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Nfe,tooltipPayloadSearcher:Gf,categoricalChartProps:e,ref:t}));Xl();var MC=_(B());var fg=MC.default.memo(({children:e,height:t="100%",width:r="100%",className:n="",style:a={},onChartClick:o})=>{let i=typeof t=="number"?`${t}px`:t,l={width:typeof r=="number"?`${r}px`:r,height:i,overflow:"hidden",borderRadius:"8px",...a},c=`journalit-chart-container ${n}`.trim();return MC.default.createElement("div",{className:c,style:l,onClick:o},MC.default.createElement(js,{width:"100%",height:"100%"},e))});var Dl=_(B());Xl();Ct();var dO=(e,t)=>e.type==="text"||typeof e.value=="string"?e.value.toString():typeof e.value=="number"?e.type==="pnl"?cv(e.value,"pnl",t):e.type==="drawdown"?cv(e.value,"drawdown",t):cv(e.value,"number",t):String(e.value),gg=Dl.default.memo(({active:e,payload:t,dateKey:r="date",valueKey:n="pnl",valueType:a="pnl",additionalItems:o,formatter:i})=>{let{currency:s}=Ae();if(!e||!t||t.length===0)return null;let l=t[0].payload;if(i){let{title:b,primaryValue:v,items:y}=i(l),g=v.isPositive?ai.positive:v.isNegative?ai.negative:"";return Dl.default.createElement("div",{className:ai.container},Dl.default.createElement("div",{className:ai.date},b),Dl.default.createElement("div",{className:`${ai.value} ${g}`},dO(v,s)),y==null?void 0:y.map((w,C)=>Dl.default.createElement("div",{key:C,className:ai.info,style:w.isPositive||w.isNegative?{color:w.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},w.label,": ",dO(w,s))))}let c=l[r],d=l[n],u=a==="pnl"?d>=0:!1,p=a==="drawdown"?!0:d<0,m=cv(d,a,s),h=u?ai.positive:p?ai.negative:"",f=o?o(l):[];return Dl.default.createElement("div",{className:ai.container},Dl.default.createElement("div",{className:ai.date},c),Dl.default.createElement("div",{className:`${ai.value} ${h}`},m),f.map((b,v)=>Dl.default.createElement("div",{key:v,className:ai.info,style:b.isPositive||b.isNegative?{color:b.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},b.label,": ",dO(b,s))))});Ct();var Lfe=e=>Xe.default.createElement(gg,{...e,valueKey:"pnl",valueType:"pnl",additionalItems:t=>t.tradePnL!==0?[{label:"Trade P&L",value:t.tradePnL,type:"pnl",isPositive:t.tradePnL>0,isNegative:t.tradePnL<0}]:[]}),Mfe=0,Bd="var(--chart-positive, #43a047)",$d="var(--chart-negative, #e53935)",El=Xe.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:a,gradientTransitionOffset:o,margin:i={top:6,right:5,left:0,bottom:6},className:s="",style:l={},tooltipProps:c={},showTooltip:d=!0,customTooltip:u,autoRange:p=!0,paddingPercentage:m=.05,fillGradient:h=!0,onChartClick:f,onPointClick:b})=>{let{currency:v}=Ae(),y=(0,Xe.useMemo)(()=>`pnl-chart-${++Mfe}`,[]),g=(0,Xe.useMemo)(()=>{let M=Math.min(...e.map(A=>A.pnl)),D=Math.max(...e.map(A=>A.pnl));return{dataMin:M,dataMax:D}},[e]),w=(0,Xe.useMemo)(()=>{let{dataMin:M,dataMax:D}=g,[A,L]=t$(M,D,n,a,m),N=L;if(D-M>0&&a===void 0)if(D>1e3){let O=D>1e4?1e3:500,j=Math.ceil(D/O)*O;N=Math.min(j,D*1.1)}else N=D*1.05;let I=o;if(I===void 0){let O=N-A;if(O!==0&&!isNaN(O)&&!isNaN(N)&&!isNaN(A)){let j=(N-0)/O*100;I=isNaN(j)?50:j}else isNaN(N)?I=50:I=N<0?100:0;I=Math.max(0,Math.min(100,I))}return{actualMinValue:A,adjustedMaxValue:N,actualTransitionOffset:I}},[g,n,a,o,m]),{actualMinValue:C,adjustedMaxValue:k,actualTransitionOffset:x}=w,S=`url(#${y}-gradientDual)`,T=`url(#${y}-strokeGradient)`;C>=0&&k>=0?S=`url(#${y}-gradientPositive)`:k<=0&&C<=0&&(S=`url(#${y}-gradientNegative)`);let P=M=>{if(f&&f(M),b&&M&&M.activePayload&&M.activePayload.length>0){let D=M.activePayload[0].payload,A=e.findIndex(L=>L===D);A!==-1&&b(D,A)}};return Xe.default.createElement(fg,{height:t,width:r,className:s,style:l,onChartClick:P},Xe.default.createElement(pb,{data:e,margin:i,onClick:P},Xe.default.createElement("defs",null,Xe.default.createElement("linearGradient",{id:`${y}-gradientPositive`,x1:"0",y1:"1",x2:"0",y2:"0"},Xe.default.createElement("stop",{offset:"0%",stopColor:Bd,stopOpacity:.1}),Xe.default.createElement("stop",{offset:"100%",stopColor:Bd,stopOpacity:.4})),Xe.default.createElement("linearGradient",{id:`${y}-gradientNegative`,x1:"0",y1:"0",x2:"0",y2:"1"},Xe.default.createElement("stop",{offset:"0%",stopColor:$d,stopOpacity:.1}),Xe.default.createElement("stop",{offset:"100%",stopColor:$d,stopOpacity:.4})),Xe.default.createElement("linearGradient",{id:`${y}-gradientDual`,x1:"0",y1:"0",x2:"0",y2:"1"},Xe.default.createElement("stop",{offset:"0%",stopColor:Bd,stopOpacity:.4}),Xe.default.createElement("stop",{offset:`${x}%`,stopColor:Bd,stopOpacity:.1}),Xe.default.createElement("stop",{offset:`${x}%`,stopColor:$d,stopOpacity:.1}),Xe.default.createElement("stop",{offset:"100%",stopColor:$d,stopOpacity:.4})),Xe.default.createElement("linearGradient",{id:`${y}-strokeGradient`,x1:"0",y1:"0",x2:"0",y2:"1"},x<=.1?Xe.default.createElement(Xe.default.Fragment,null,Xe.default.createElement("stop",{offset:"0%",stopColor:$d}),Xe.default.createElement("stop",{offset:"100%",stopColor:$d})):x>=99.9?Xe.default.createElement(Xe.default.Fragment,null,Xe.default.createElement("stop",{offset:"0%",stopColor:Bd}),Xe.default.createElement("stop",{offset:"100%",stopColor:Bd})):Xe.default.createElement(Xe.default.Fragment,null,Xe.default.createElement("stop",{offset:"0%",stopColor:Bd}),Xe.default.createElement("stop",{offset:`${Math.max(.1,x-.1)}%`,stopColor:Bd}),Xe.default.createElement("stop",{offset:`${Math.min(99.9,x+.1)}%`,stopColor:$d}),Xe.default.createElement("stop",{offset:"100%",stopColor:$d}))),Xe.default.createElement("filter",{id:`${y}-shadow`,height:"120%"},Xe.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Xe.default.createElement("filter",{id:`${y}-glow`,height:"130%"},Xe.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Xe.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Xe.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Xe.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Xe.default.createElement(nn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Xe.default.createElement(zn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Xe.default.createElement(_n,{tickFormatter:M=>ue(M,!0,v),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[C,k],allowDataOverflow:!1,width:75,ticks:Dm(C,k,5),scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),d&&Xe.default.createElement(oo,{content:u||Lfe,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...c}),Xe.default.createElement(Bo,{type:"monotone",dataKey:"pnl",stroke:T,strokeWidth:2.5,fill:h?S:"none",dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent, #4299e1)",filter:`url(#${y}-glow)`},animationDuration:500,animationEasing:"ease-out",filter:`url(#${y}-shadow)`})))});El.displayName="SharedPnLChart";var Wr=_(B());Xl();var Ofe=e=>Wr.default.createElement(gg,{...e,valueKey:"drawdown",valueType:"drawdown",additionalItems:t=>[{label:"P&L",value:t.pnl,type:"pnl",isPositive:t.pnl>0,isNegative:t.pnl<0},{label:"Peak Equity",value:t.peakEquity,type:"pnl"}]}),kc=Wr.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:a,margin:o={top:6,right:5,left:0,bottom:6},className:i="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:h})=>{let f=(0,Wr.useMemo)(()=>{let w=Math.min(...e.map(S=>S.drawdown)),C=a!==void 0?a:0,k=n!==void 0?n:Math.min(0,w);if(w<0&&n===void 0){let S=Math.abs(w)*p;k=Math.min(k,w-S),w>-20&&(k=Math.max(k,w*1.15))}return{yAxisMax:C,yAxisMin:k,negativeColor:"var(--text-error, #e53935)"}},[e,n,a,p]),{yAxisMax:b,yAxisMin:v,negativeColor:y}=f,g=w=>{if(m&&m(w),h&&w&&w.activePayload&&w.activePayload.length>0){let C=w.activePayload[0].payload,k=e.findIndex(x=>x===C);k!==-1&&h(C,k)}};return Wr.default.createElement(fg,{height:t,width:r,className:i,style:s,onChartClick:g},Wr.default.createElement(pb,{data:e,margin:o,onClick:g},Wr.default.createElement("defs",null,Wr.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Wr.default.createElement("stop",{offset:"0%",stopColor:y,stopOpacity:.1}),Wr.default.createElement("stop",{offset:"100%",stopColor:y,stopOpacity:.4})),Wr.default.createElement("filter",{id:"drawdown-shadow",height:"120%"},Wr.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Wr.default.createElement("filter",{id:"drawdown-glow",height:"130%"},Wr.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Wr.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Wr.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Wr.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Wr.default.createElement(nn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Wr.default.createElement(zn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Wr.default.createElement(_n,{tickFormatter:w=>_D(w),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[v,b],allowDataOverflow:!1,width:75,ticks:Dm(v,b,5),scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),c&&Wr.default.createElement(oo,{content:d||Ofe,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),Wr.default.createElement(Bo,{type:"monotone",dataKey:"drawdown",stroke:y,strokeWidth:2.5,fill:"url(#drawdownGradient)",fillOpacity:.4,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:y,filter:"url(#drawdown-glow)"},animationDuration:1e3,animationEasing:"ease-out",filter:"url(#drawdown-shadow)"})))});var xn=_(B());er();Xl();Ct();var Ffe=e=>{if(!e.active||!e.payload||e.payload.length===0)return null;let t=e.payload[0].payload,r=t.entryTime?new Date(t.entryTime).toLocaleString():"Unknown",n=t.exitTime?new Date(t.exitTime).toLocaleString():"Unknown";return xn.default.createElement(gg,{...e,formatter:a=>({title:a.instrument?`${a.instrument} ${a.direction==="long"?"\u2191":"\u2193"}`:`Trade #${a.tradeIndex+1}`,primaryValue:{value:a.pnl,type:"pnl",isPositive:a.pnl>=0,isNegative:a.pnl<0},items:[{label:"Entry",value:r,type:"text"},{label:"Exit",value:n,type:"text"},{label:"Trade",value:`#${a.tradeIndex+1}`,type:"text"}]})})},fb=({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:a,margin:o={top:6,right:5,left:0,bottom:6},className:i="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:h})=>{let{currency:f}=Ae(),b=x=>x===0?"$0":ue(x,!0,f),v=Math.min(...e.map(x=>x.pnl)),y=Math.max(...e.map(x=>x.pnl)),g=n!==void 0?n:Math.min(0,v),w=a!==void 0?a:Math.max(0,y),C=y-v;if(v<0&&n===void 0){let x=Math.max(Math.abs(v)*.02,10);g=Math.min(g,v-x)}if(y>0&&a===void 0){let x=Math.max(y*.02,10);w=Math.max(w,y+x)}if(y>0&&a===void 0){let x=Math.pow(10,Math.floor(Math.log10(y))),S;if(y>1e3){let T=y>5e3?1e3:500;S=Math.ceil(y/T)*T}else y>100?S=Math.ceil(y/100)*100:y>10?S=Math.ceil(y/10)*10:S=Math.ceil(y*1.05);S=Math.min(S,y*1.1),w=Math.min(w,S)}if(v<0&&n===void 0){let x=Math.pow(10,Math.floor(Math.log10(Math.abs(v)))),S;if(Math.abs(v)>1e3){let T=Math.abs(v)>5e3?1e3:500;S=Math.floor(v/T)*T}else Math.abs(v)>100?S=Math.floor(v/100)*100:Math.abs(v)>10?S=Math.floor(v/10)*10:S=Math.floor(v*1.05);S=Math.max(S,v*1.1),g=Math.max(g,S)}if(e.length===0)return xn.default.createElement("div",{style:{width:"100%",height:typeof t=="number"?`${t}px`:t,display:"flex",justifyContent:"center",alignItems:"center"}},xn.default.createElement(Ie,{message:"No trades available",subMessage:"Try selecting a different time period",iconSize:36}));let k=(x,S,T)=>{h&&h(S,T)};return xn.default.createElement(fg,{height:t,width:r,className:i,style:s,onChartClick:m},xn.default.createElement(vp,{data:e,margin:o},xn.default.createElement("defs",null,xn.default.createElement("filter",{id:"tradesChartBarShadow",height:"130%"},xn.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),xn.default.createElement("filter",{id:"tradesChartBarGlow",height:"130%"},xn.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),xn.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),xn.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),xn.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),xn.default.createElement(nn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),xn.default.createElement(zn,{dataKey:"tradeIndex",tickFormatter:x=>`#${x+1}`,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),xn.default.createElement(_n,{tickFormatter:b,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[g,w],allowDataOverflow:!1,width:75,ticks:Dm(g,w,5),interval:"preserveStartEnd",scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),c&&xn.default.createElement(oo,{content:d||Ffe,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),xn.default.createElement($s,{dataKey:"pnl",fill:"#8884d8",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#tradesChartBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#tradesChartBarGlow)",strokeWidth:1.2,strokeOpacity:.8},shape:x=>{var W,U;let{x:S,y:T,width:P,height:M}=x,A=(((W=x.payload)==null?void 0:W.pnl)||0)>=0,L=((U=x.payload)==null?void 0:U.fill)||(A?"var(--chart-positive)":"var(--chart-negative)"),N=S||0,E=T||0,I=P||0,O=M||0,j=O<0?Math.abs(O):O,$=O<0?E+O:E,F;A?F=[2,2,0,0]:F=[0,0,2,2];let z=x.index||0;return xn.default.createElement("rect",{x:N,y:$,width:I,height:j>0?j:0,fill:L,stroke:x.stroke,strokeWidth:x.strokeWidth,strokeOpacity:x.strokeOpacity,filter:A?x.filter:"none",rx:F[0],ry:F[0],onClick:K=>k(K,x.payload,z)})}})))};var Ur=_(B());er();Ct();var jfe=(e,t,r)=>{let n=[],a=t-e,o=a/(r-1),i=Math.pow(10,Math.floor(Math.log10(o))),s;o/i<1.5?s=i:o/i<3.5?s=2*i:o/i<7.5?s=5*i:s=10*i,a<10*i&&s>i&&(s=i);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},zfe=({active:e,payload:t})=>{let{currency:r}=Ae();if(!e||!t||t.length===0)return null;let n=t[0].payload,a=n.pnl>=0,o=ue(n.pnl,!0,r);return Ur.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative",animation:"tooltipFadeIn 0.2s cubic-bezier(0.19, 1, 0.22, 1)"}},Ur.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},n.date),Ur.default.createElement("div",{className:`journalit-chart-tooltip-value ${a?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:a?"var(--chart-positive)":"var(--chart-negative)"}},o),n.trades!==void 0&&Ur.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},n.trades," ",n.trades===1?"trade":"trades"))},uO=Ur.default.memo(({data:e,height:t="100%",minValue:r,maxValue:n})=>{let{currency:a}=Ae(),o=Math.min(...e.map(u=>u.pnl)),i=Math.max(...e.map(u=>u.pnl)),s=r!==void 0?r:Math.min(0,o),l=n!==void 0?n:Math.max(0,i);if(o<0){let u=Math.abs(o)*.05;s=r!==void 0?r:Math.min(s,o-u)}if(i>0){let u=i*.05;l=n!==void 0?n:Math.max(l,i+u)}let c=i-o;c>0&&c<100&&(s=Math.max(s,o-c*.03),l=Math.min(l,i+c*.03));let d=typeof t=="number"?`${t}px`:t;return Ur.default.createElement("div",{style:{width:"100%",height:d,overflow:"hidden",borderRadius:"8px"}},Ur.default.createElement(js,{width:"100%",height:"100%"},Ur.default.createElement(vp,{data:e,margin:{top:6,right:5,left:0,bottom:6}},Ur.default.createElement("defs",null,Ur.default.createElement("filter",{id:"dailyPerformanceBarShadow",height:"130%"},Ur.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),Ur.default.createElement("filter",{id:"dailyPerformanceBarGlow",height:"130%"},Ur.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),Ur.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Ur.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Ur.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Ur.default.createElement(nn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Ur.default.createElement(zn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Ur.default.createElement(_n,{tickFormatter:u=>ue(u,!0,a),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[s,l],allowDataOverflow:!1,width:75,ticks:jfe(s,l,5),scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),Ur.default.createElement(oo,{content:Ur.default.createElement(zfe,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),Ur.default.createElement($s,{dataKey:"pnl",fill:"#8884d8",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#dailyPerformanceBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#dailyPerformanceBarGlow)",strokeWidth:1.2,strokeOpacity:.8}}))))});var Mr=_(B());er();Ct();var _fe=(e,t=10)=>e.length<=t?e:e.substring(0,t-1)+"\u2026";var Bfe=({active:e,payload:t})=>{let{currency:r}=Ae();if(!e||!t||t.length===0)return null;let n=t[0].payload,a=n.pnl>=0,o=ue(n.pnl,!0,r);return Mr.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},Mr.default.createElement("div",{className:"journalit-chart-tooltip-setup",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},n.name),Mr.default.createElement("div",{className:`journalit-chart-tooltip-value ${a?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:a?"var(--chart-positive)":"var(--chart-negative)"}},o),Mr.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},"Win Rate: ",n.winRate.toFixed(1),"%"),Mr.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px",textAlign:"center",fontStyle:"italic"}},n.tradeCount," ",n.tradeCount===1?"trade":"trades"))},gb=({data:e,height:t="100%",minValue:r,maxValue:n})=>{let{currency:a}=Ae(),o=Math.min(...e.map(u=>u.pnl)),i=Math.max(...e.map(u=>u.pnl)),s=r!==void 0?r:Math.min(0,o),l=n!==void 0?n:Math.max(1,i);if(o<0){let u=Math.abs(o)*.05;s=r!==void 0?r:Math.min(s,o-u)}if(i>0){let u=i*.05;l=n!==void 0?n:Math.max(l,i+u)}let c=i-o;if(c>0&&e.length<=5){let u=c*.03,p=c*.03;s=Math.max(s,o-u),l=Math.min(l,i+p)}let d=typeof t=="number"?`${t}px`:t;return Mr.default.createElement("div",{style:{width:"100%",height:d,overflow:"hidden",borderRadius:"8px"}},Mr.default.createElement(js,{width:"100%",height:"100%"},Mr.default.createElement(vp,{data:e,margin:{top:6,right:5,left:0,bottom:6}},Mr.default.createElement("defs",null,Mr.default.createElement("filter",{id:"setup-bar-shadow",height:"130%"},Mr.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),Mr.default.createElement("filter",{id:"setup-bar-glow",height:"130%"},Mr.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),Mr.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Mr.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Mr.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Mr.default.createElement(nn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Mr.default.createElement(zn,{dataKey:"name",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:u=>_fe(u),interval:0}),Mr.default.createElement(_n,{tickFormatter:u=>ue(u,!0,a),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[s,l],allowDataOverflow:!1,width:75,scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),Mr.default.createElement(oo,{content:Mr.default.createElement(Bfe,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),Mr.default.createElement($s,{dataKey:"pnl",fill:"#8884d8",minPointSize:0,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#setup-bar-shadow)",radius:[2,2,0,0],activeBar:{filter:"url(#setup-bar-glow)",strokeWidth:1.2,strokeOpacity:.8},shape:u=>{let p=u.payload&&u.payload.pnl>=0,m=p?"var(--chart-positive)":"var(--chart-negative)",{x:h,y:f,width:b,height:v}=u,y=h||0,g=f||0,w=b||0,C=v||0,k=C<0?Math.abs(C):C,x=C<0?g+C:g,S=p?[2,2,0,0]:[0,0,2,2];return Mr.default.createElement("rect",{x:y,y:x,width:w,height:k>0?k:0,fill:m,stroke:u.stroke,strokeWidth:u.strokeWidth,strokeOpacity:u.strokeOpacity,filter:u.filter,rx:S[0],ry:S[0]})}}))))};var yt=_(B());Zt();er();xv();Ct();var lG=(0,yt.memo)(({day:e,dayIndex:t,onClick:r})=>{let{currency:n}=Ae(),a=(0,yt.useCallback)(()=>{e.date&&r(e.date)},[e.date,r]),o=["journalit-dashboard-calendar-day",e.currentMonth?"current-month":"other-month",e.pnl!==null&&e.pnl>0?"positive":"",e.pnl!==null&&e.pnl<0?"negative":"",t===5||t===6?"weekend-day":"",e.isToday?"today":""].filter(Boolean).join(" ");return yt.default.createElement("div",{className:o,onClick:a},yt.default.createElement("div",{className:"journalit-dashboard-calendar-day-number"},e.dayNumber||""),e.pnl!==null&&yt.default.createElement("div",{className:"journalit-dashboard-calendar-day-pnl"},ue(e.pnl,!1,n)),e.tradeCount>0&&yt.default.createElement("div",{className:"journalit-dashboard-calendar-day-trades"},e.tradeCount===1?"1 trade":`${e.tradeCount} trades`))});lG.displayName="CalendarDay";var OC=(0,yt.memo)(({trades:e,filters:t,onDayClick:r,onWeekClick:n,height:a="100%"})=>{var g,w,C,k,x,S,T;let o=Ee(),{currency:i}=Ae(),s=(0,yt.useMemo)(()=>{var P,M,D;return(D=(M=(P=o==null?void 0:o.settings)==null?void 0:P.trade)==null?void 0:M.skipWeekends)!=null?D:!0},[(w=(g=o==null?void 0:o.settings)==null?void 0:g.trade)==null?void 0:w.skipWeekends]),l=(0,yt.useRef)(null);(0,yt.useEffect)(()=>{let P=null;return P=requestAnimationFrame(()=>{l.current&&(Object.assign(l.current.style,{width:"100%",height:"100%"}),bv(),$i(),yv())}),()=>{P!==null&&cancelAnimationFrame(P),window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect()}},[]),(0,yt.useEffect)(()=>{let P=()=>{l.current&&$i()};return document.addEventListener("layout-changed",P),()=>{document.removeEventListener("layout-changed",P)}},[]);let c={},d={};e.forEach(P=>{let M=P.entryTime.getFullYear(),D=String(P.entryTime.getMonth()+1).padStart(2,"0"),A=String(P.entryTime.getDate()).padStart(2,"0"),L=`${M}-${D}-${A}`;c[L]||(c[L]=0,d[L]=0),c[L]+=P.pnl,d[L]++});let u,p,m=new Date,h=m.getFullYear(),f=m.getMonth();!((C=t==null?void 0:t.dateRange)!=null&&C[0])&&!((k=t==null?void 0:t.dateRange)!=null&&k[1])?(u=new Date(h,f,1),p=new Date(h,f+1,0)):(x=t==null?void 0:t.dateRange)!=null&&x[0]&&t.dateRange[0].getFullYear()===h&&t.dateRange[0].getMonth()===0&&t.dateRange[0].getDate()===1?(u=new Date(h,0,1),p=new Date(h,11,31)):(u=((S=t==null?void 0:t.dateRange)==null?void 0:S[0])||(e.length>0?new Date(Math.min(...e.map(P=>P.entryTime.getTime()))):m),p=((T=t==null?void 0:t.dateRange)==null?void 0:T[1])||m),u>p&&(u=new Date(p),u.setDate(1),console.warn("Calendar: Corrected invalid date range where start date was after end date."));let b=$fe(u,p,c,d),v=P=>{var D;let M=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}-${String(P.getDate()).padStart(2,"0")}`;c[M]&&r?r(P):c[M]&&o&&((D=o.drcService)==null||D.openDRC(P))},y=P=>{if(n)n(P);else if(o){let M=P;o.weeklyReviewService?o.weeklyReviewService.openWeeklyReview(M):o.drcService&&(console.warn("WeeklyReviewService not found, falling back to DRCService"),o.drcService.openDRC(M))}};return yt.default.createElement("div",{ref:l,className:"journalit-dashboard-calendar",style:{width:"100%",height:a,overflow:"auto",backdropFilter:"none",WebkitBackdropFilter:"none"}},yt.default.createElement("div",{style:{display:"flex",flexDirection:"column",animation:"calendarFadeIn 0.5s ease-out",padding:"0 6px 6px 0",minHeight:"100%"}},yt.default.createElement("div",{className:`journalit-dashboard-calendar-header ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",marginBottom:"10px",gap:"4px",position:"sticky",top:0,backgroundColor:"var(--background-primary)",zIndex:5,padding:"6px 0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid var(--background-modifier-border)",borderRadius:"6px"}},yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday monday-header","data-day":"Mon",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",display:"block !important",letterSpacing:"0.5px"}},"Mon"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Tue",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.5px"}},"Tue"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Wed",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Wed"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Thu",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Thu"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Fri",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Fri"),!s&&yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sat",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sat"),!s&&yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sun",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sun"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday weekly-pnl-header",style:{textAlign:"center",fontWeight:700,fontSize:"13px",color:"var(--text-on-accent)",backgroundColor:"var(--background-secondary-alt)",borderLeft:"1px solid rgba(0, 0, 0, 0.05)",borderRadius:"0 6px 6px 0",boxShadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.1)"}},"P&L")),yt.default.createElement("div",{className:`journalit-dashboard-calendar-grid ${s?"hide-weekends":""}`,style:{display:"flex",flexDirection:"column",gap:"4px",flex:"1"}},b.filter(P=>s?P.some((D,A)=>A<=4&&D.date!==null):!0).map((P,M)=>{var I;let D=0,A=0,L=0,N="",E=(I=P.find(O=>O.date))==null?void 0:I.date;if(E){let O=new Date(E.getFullYear(),0,4),j=new Date(O.getFullYear(),0,1),$=Math.floor((E.getTime()-j.getTime())/864e5);N=`W${Math.ceil(($+j.getDay()+1)/7)}`}return P.forEach(O=>{O.pnl!==null&&(D+=O.pnl,L++),O.tradeCount>0&&(A+=O.tradeCount)}),yt.default.createElement("div",{key:`week-${M}`,className:`journalit-dashboard-calendar-week ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px"}},(s?P.filter((O,j)=>j<=4):P).map((O,j)=>yt.default.createElement(lG,{key:`day-${M}-${j}`,day:O,dayIndex:j,onClick:v})),yt.default.createElement("div",{className:`journalit-dashboard-calendar-weekly-pnl ${L>0?D>=0?"positive":"negative":""}`,onClick:()=>E&&y(E)},L>0&&yt.default.createElement(yt.default.Fragment,null,yt.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-label"},"WEEK"),yt.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-value"},ue(D,!1,i)),A>0&&yt.default.createElement("div",{className:"journalit-dashboard-calendar-week-trade-count"},A===1?"1 trade":`${A} trades`))))}))))});OC.displayName="PerformanceCalendar";var $fe=(e,t,r,n)=>{let a=[],o=new Date(e);o.setDate(1);let i=new Date(t.getFullYear(),t.getMonth()+1,0);for(;o<=i;){let s=o.getFullYear(),l=o.getMonth(),d=(new Date(s,l,1).getDay()+6)%7,p=new Date(s,l+1,0).getDate(),m=1,h=[];for(;m<=p;){let f=[];for(let b=0;b<7;b++)if(m===1&&b<d||m>p)f.push({dayNumber:0,date:null,currentMonth:!1,pnl:null,tradeCount:0,isToday:!1});else{let v=new Date(s,l,m),y=`${s}-${String(l+1).padStart(2,"0")}-${String(m).padStart(2,"0")}`;f.push({dayNumber:m,date:v,currentMonth:!0,pnl:r[y]||null,tradeCount:n[y]||0,isToday:Rfe(y)}),m++}h.push(f)}a.push(...h),o.setMonth(o.getMonth()+1)}return a};function Rfe(e){if(!e)return!1;let t=new Date,r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return e===r}var Cc=_(B());Xl();function Al(e,t){return r=>{let{trades:n,dateFormat:a="MMM DD, YYYY",...o}=r;if(!n||n.length===0)switch(t){case"pnl":return Cc.default.createElement(e,{data:[],...o});case"drawdown":return Cc.default.createElement(e,{data:[],...o});case"trades":return Cc.default.createElement(e,{data:[],...o});default:return Cc.default.createElement(e,{data:[],...o})}switch(t){case"pnl":let i=sv(n,a);return Cc.default.createElement(e,{data:i,...o});case"drawdown":let s=ku(n,a);return Cc.default.createElement(e,{data:s,...o});case"trades":let l=lv(n);return Cc.default.createElement(e,{data:l,...o});default:return Cc.default.createElement(e,{data:[],...o})}}}Xl();Xl();Ea();Ct();var cG=({trades:e,openNote:t})=>{let{currency:r}=Ae(),[n,a]=(0,we.useState)(!1),[o,i]=(0,we.useState)([]),[s,l]=(0,we.useState)(0),[c,d]=(0,we.useState)(""),u=(0,we.useCallback)((g,w,C)=>{let k=C.indexOf(g);i(C),l(k>=0?k:0),d(w),a(!0)},[]),p=(0,we.useCallback)(()=>{a(!1)},[]),m=(0,we.useCallback)(g=>{g>=0&&g<o.length&&l(g)},[o.length]),h=(0,we.useMemo)(()=>{if(!(o.length<=1))return{images:o,currentIndex:s,onNavigate:m,altPrefix:`Trade ${c} Image`,useResolveMediaPath:!0}},[o,s,m,c]),b=(()=>{if(e.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,breakEvenTrades:0,pnl:0,winRate:0,profitFactor:0,expectancy:0,avgWin:0,avgLoss:0,plRatio:0};let g=e.filter(I=>!ct({tradeStatus:I.tradeStatus,exitTime:I.exitTime,pnl:I.pnl,useDirectPnLInput:I.useDirectPnLInput,exits:I.exits})),w=g.length,C=0,k=0,x=0,S=0,T=0,P=0;g.forEach(I=>{let O=I.pnl!==void 0&&I.pnl!==null?I.pnl:I.direction==="Long"?(I.exitPrice-I.entryPrice)*I.positionSize:(I.entryPrice-I.exitPrice)*I.positionSize;S+=O,O>0?(C++,T+=O):O<0?(k++,P+=Math.abs(O)):x++});let M=w>0?C/w*100:0,D=C>0?T/C:0,A=k>0?P/k:0,L=A>0?D/A:0,N=P>0?T/P:T>0?1/0:0,E=M/100*D-(100-M)/100*A;return{totalTrades:w,winningTrades:C,losingTrades:k,breakEvenTrades:x,pnl:S,winRate:M,profitFactor:N,expectancy:E,avgWin:D,avgLoss:A,plRatio:L}})(),v=(0,we.useMemo)(()=>{if(!e||e.length===0)return[];let g=e.filter(x=>!ct({tradeStatus:x.tradeStatus,exitTime:x.exitTime,pnl:x.pnl,useDirectPnLInput:x.useDirectPnLInput,exits:x.exits}));if(g.length===0)return[];let w=[...g].sort((x,S)=>new Date(x.entryTime).getTime()-new Date(S.entryTime).getTime()),C=0,k=[];if(w.length>0){let x=new Date(w[0].entryTime);k.push({date:Fe(x),pnl:0,tradePnL:0})}return w.forEach(x=>{var T;let S=x.pnl!==void 0&&x.pnl!==null?x.pnl:((T=x.direction)==null?void 0:T.toLowerCase())==="long"?(x.exitPrice-x.entryPrice)*x.positionSize:(x.entryPrice-x.exitPrice)*x.positionSize;C+=S,k.push({date:Fe(new Date(x.entryTime)),pnl:C,tradePnL:S})}),k},[e]),y=(0,we.useMemo)(()=>{if(!e||e.length===0)return[];let g=e.filter(C=>!ct({tradeStatus:C.tradeStatus,exitTime:C.exitTime,pnl:C.pnl,useDirectPnLInput:C.useDirectPnLInput,exits:C.exits}));if(g.length===0)return[];let w=g.map(C=>{var k;return{...C,pnl:C.pnl!==void 0&&C.pnl!==null?C.pnl:((k=C.direction)==null?void 0:k.toLowerCase())==="long"?(C.exitPrice-C.entryPrice)*C.positionSize:(C.entryPrice-C.exitPrice)*C.positionSize,entryTime:new Date(C.entryTime),exitTime:C.exitTime?new Date(C.exitTime):void 0}});return ku(w,"MMM DD, YYYY")},[e]);return we.default.createElement("div",{className:"drc-note-trades-tab"},v.length>0&&we.default.createElement("div",{className:"drc-section"},we.default.createElement("h3",null,"Cumulative P&L"),we.default.createElement(El,{data:v,height:250})),y.length>0&&we.default.createElement("div",{className:"drc-section"},we.default.createElement("h3",null,"Drawdown from Peak Equity"),we.default.createElement(kc,{data:y,height:250})),we.default.createElement("div",{className:"drc-section"},we.default.createElement("h3",null,"Daily Trade Statistics"),we.default.createElement("div",{className:"drc-stats"},we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:`drc-stat-value ${b.pnl>=0?"positive":"negative"}`,title:ue(b.pnl,!0,r),style:{width:"100%"}},ue(b.pnl,!0,r)),we.default.createElement("div",{className:"drc-stat-label"},"Net P&L")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value"},b.winRate.toFixed(1).endsWith(".0")?Math.floor(b.winRate):b.winRate.toFixed(1),"%"),we.default.createElement("div",{className:"drc-stat-label"},"Win Rate")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value"},b.profitFactor===1/0?"\u221E":b.profitFactor.toFixed(2)),we.default.createElement("div",{className:"drc-stat-label"},"Profit Factor")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value"},ue(b.expectancy,!0,r)),we.default.createElement("div",{className:"drc-stat-label"},"Expectancy")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value"},b.totalTrades),we.default.createElement("div",{className:"drc-stat-label"},"Total Trades")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value positive"},ue(b.avgWin,!0,r)),we.default.createElement("div",{className:"drc-stat-label"},"Avg Win")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value negative"},ue(b.avgLoss,!0,r)),we.default.createElement("div",{className:"drc-stat-label"},"Avg Loss")),we.default.createElement("div",{className:"drc-stat-card"},we.default.createElement("div",{className:"drc-stat-value"},b.plRatio.toFixed(2)),we.default.createElement("div",{className:"drc-stat-label"},"P/L Ratio")))),we.default.createElement("div",{className:"drc-section"},we.default.createElement("h3",null,"Trade Log"),e.length===0?we.default.createElement(Ie,{message:"No trades for this day",subMessage:"Trades will appear here once they are added",iconSize:40}):we.default.createElement("div",{className:"weekly-review-trades-table"},we.default.createElement("table",null,we.default.createElement("thead",null,we.default.createElement("tr",null,we.default.createElement("th",null,"Images"),we.default.createElement("th",null,"Entry/Exit Time"),we.default.createElement("th",null,"Ticker"),we.default.createElement("th",null,"Direction"),we.default.createElement("th",null,"Setup"),we.default.createElement("th",null,"P&L"))),we.default.createElement("tbody",null,[...e].sort((g,w)=>new Date(g.entryTime).getTime()-new Date(w.entryTime).getTime()).map((g,w)=>{var P,M;let C=g.id||`index-${w}`,k=ct({tradeStatus:g.tradeStatus,exitTime:g.exitTime,pnl:g.pnl,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits}),x=k?null:g.pnl!==void 0&&g.pnl!==null?g.pnl:g.direction==="Long"?(g.exitPrice-g.entryPrice)*g.positionSize:(g.entryPrice-g.exitPrice)*g.positionSize,S=x!==null&&x>0,T=[];try{if(g.images){if(Array.isArray(g.images))T=g.images;else if(typeof g.images=="string"){let D=JSON.parse(g.images);Array.isArray(D)&&(T=D.map(A=>String(A)))}}}catch(D){}return we.default.createElement("tr",{key:`trade-${C}`,className:"weekly-review-trade-row",onClick:()=>{t&&(g.path?t(g.path,!0):g.id&&t(g.id,!0))},style:{cursor:g.path||g.id?"pointer":"default"}},we.default.createElement("td",{className:"trade-preview-cell"},T.length>0?we.default.createElement("div",{className:"trade-image-wrapper",onClick:D=>{D.stopPropagation(),u(T[0],g.id||w,T)},style:{cursor:"pointer"}},we.default.createElement("div",{className:"trade-preview-thumbnail"},we.default.createElement("img",{src:$r.resolveMediaPath(T[0]),alt:`Trade ${g.id||w} preview`,className:"trade-image",style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>{}})),T.length>1&&we.default.createElement("span",{className:"trade-image-count-indicator"},"+",T.length-1)):we.default.createElement(T0,{size:24,className:"trade-no-image-icon"})),we.default.createElement("td",null,((P=g.entryTime)==null?void 0:P.toLocaleTimeString())||"N/A"," / ",k?"OPEN":((M=g.exitTime)==null?void 0:M.toLocaleTimeString())||"N/A"),we.default.createElement("td",null,g.instrument||g.ticker||"Unknown"),we.default.createElement("td",null,g.direction||g.side||"N/A"),we.default.createElement("td",null,g.setup&&Array.isArray(g.setup)?g.setup.join(", "):g.setup||"N/A"),we.default.createElement("td",{style:{color:k?"inherit":S?"var(--color-green)":"var(--color-red)"}},k?"-":ue(x,!0,r)))}))))),n&&o.length>0&&we.default.createElement(nc,{isOpen:n,onClose:p,title:`Trade ${c} Image`,portalId:"drc-trade-image-portal"},we.default.createElement(gd,{imagePath:o[s],alt:`Trade ${c} Image ${s+1}`,useResolveMediaPath:!0,navigationContext:h,onClose:p})))};var tt=_(B());qw();var Tt=_(B());Za();XD();var dG=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:a})=>{let[o,i]=(0,Tt.useState)([]),[s,l]=(0,Tt.useState)(!0),[c,d]=(0,Tt.useState)(null);(0,Tt.useEffect)(()=>{Iw()},[]);let u=()=>{var y,g;try{return a||((g=(y=window.app)==null?void 0:y.plugins)==null?void 0:g.plugins.journalit)}catch(w){return console.error("Could not access plugin instance:",w),null}},p=async()=>{try{l(!0),d(null);let y=u();if(!(y!=null&&y.missedTradeService)){d("Missed Trade service not available");return}let g=new Date(e.date),w=xt(g,y),C=new Date(w);C.setHours(0,0,0,0);let k=new Date(w);k.setHours(23,59,59,999);let x=await y.missedTradeService.getMissedTrades(C,k),S=[];for(let T of x){let P=y.app.metadataCache.getFileCache(T),M=P==null?void 0:P.frontmatter;M&&M.type==="missed-trade"&&S.push({file:T,instrument:M.instrument||"Unknown",direction:M.direction||"Unknown",setup:M.setup||[],missedReason:M.missedReason||"",entryTime:M.entryTime?new Date(M.entryTime):new Date,path:T.path})}S.sort((T,P)=>P.entryTime.getTime()-T.entryTime.getTime()),i(S)}catch(y){console.error("Error loading missed trades:",y),d("Failed to load missed trades")}finally{l(!1)}};(0,Tt.useEffect)(()=>{e.date&&p()},[e.date]),(0,Tt.useEffect)(()=>{let y=g=>{p()};return document.addEventListener("journalit:missed-trade-data-changed",y),()=>{document.removeEventListener("journalit:missed-trade-data-changed",y)}},[e.date]);let m=y=>{n(y,!0)},h=()=>{var y;try{let g=u();if(g){let w={isMissedTrade:!0,entryTime:new Date(e.date)};try{let{TradeFormModal:C}=(vd(),Wb(AR));new C({app:g.app,plugin:g,isEditMode:!1,initialData:w}).open()}catch(C){(y=g.viewManager)==null||y.openTradeFormView(w)}}}catch(g){console.error("Error opening trade form for missed trade:",g)}},f=y=>{switch(y.toLowerCase()){case"long":case"buy":return"\u{1F4C8}";case"short":case"sell":return"\u{1F4C9}";default:return"\u{1F4CA}"}},b=y=>!y||y.length===0?"No setup specified":y.join(", "),v=y=>Tt.default.createElement("div",{key:y.path,className:"drc-missed-trade-item"},Tt.default.createElement("div",{className:"drc-missed-trade-header"},Tt.default.createElement("div",{className:"drc-missed-trade-main"},Tt.default.createElement("span",{className:"drc-missed-trade-icon"},f(y.direction)),Tt.default.createElement("span",{className:"drc-missed-trade-instrument"},y.instrument),Tt.default.createElement("span",{className:"drc-missed-trade-direction"},y.direction),Tt.default.createElement("span",{className:"drc-missed-trade-badge"},"MISSED")),Tt.default.createElement("button",{className:"drc-missed-trade-open-btn",onClick:()=>m(y.path),title:"Open missed trade details"},"View Details \u2192")),Tt.default.createElement("div",{className:"drc-missed-trade-details"},Tt.default.createElement("div",{className:"drc-missed-trade-setup"},Tt.default.createElement("strong",null,"Setup:")," ",b(y.setup)),y.missedReason&&Tt.default.createElement("div",{className:"drc-missed-trade-reason"},Tt.default.createElement("strong",null,"Reason:")," ",y.missedReason)));return s?Tt.default.createElement("div",{className:"drc-missed-trades-loading"},"Loading missed trades..."):c?Tt.default.createElement("div",{className:"drc-missed-trades-error"},Tt.default.createElement("p",null,"Error: ",c),Tt.default.createElement("button",{onClick:p,className:"drc-retry-button"},"Retry")):Tt.default.createElement("div",{className:"drc-missed-trades-section"},Tt.default.createElement("div",{className:"drc-missed-trades-header"},Tt.default.createElement("h3",null,"Missed Trades",o.length>0&&Tt.default.createElement("span",{className:"drc-missed-trades-count"},"(",o.length,")")),Tt.default.createElement("button",{className:"drc-add-button drc-add-missed-trade-btn",onClick:h,title:"Add a new missed trade"},"+ Add Missed Trade")),Tt.default.createElement("div",{className:"drc-missed-trades-content"},o.length===0?Tt.default.createElement(Ie,{message:"No missed trades for today",subMessage:"Track trading opportunities you missed to improve your execution",iconSize:36}):Tt.default.createElement("div",{className:"drc-missed-trades-list"},o.map(v))))};var uG=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:a,instrumentOptions:o,setupOptions:i,onSaveInstrument:s,onSaveSetup:l})=>{var T,P,M;let c=e,d=t,u=()=>{let D=c.dailyGoals||[];t({dailyGoals:[...D,""]})},p=(D,A)=>{let L=[...c.dailyGoals||[]];D>=0&&D<L.length&&(L[D]=A,t({dailyGoals:L}))},m=D=>{let A=[...c.dailyGoals||[]];A.splice(D,1),t({dailyGoals:A})},h=(D,A)=>{let L={...c.reviewQuestions,[D]:A};t({reviewQuestions:L})},f=(D,A)=>{let L=c.endOfDayReview||{images:[]};d({endOfDayReview:{...L,[D]:A,timestamp:D==="images"?new Date().toISOString():L.timestamp}})},b=D=>{var L;let A=((L=c.endOfDayReview)==null?void 0:L.images)||[];f("images",[...A,D])},v=D=>{var L;let A=((L=c.endOfDayReview)==null?void 0:L.images)||[];f("images",[...A,...D])},y=(D,A)=>{var N,E;let L=[...((N=c.endOfDayReview)==null?void 0:N.images)||[]];L.splice(D,1),f("images",L);try{let I=window.app,O=(E=I==null?void 0:I.plugins)==null?void 0:E.plugins.journalit;O!=null&&O.drcService&&O.drcService.deleteImage(A).catch(console.error)}catch(I){console.error("Failed to delete EOD image:",I)}},g=async D=>{var A;try{let L=window.app,N=(A=L==null?void 0:L.plugins)==null?void 0:A.plugins.journalit;if(N!=null&&N.drcService){let E=new Date(c.date);return await N.drcService.saveDRCForecastImage(D,E,"eod")}throw new Error("DRC service not available")}catch(L){throw console.error("Failed to save EOD image:",L),L}},w=()=>{d({endOfDayReview:{...c.endOfDayReview||{images:[]},reviewed:!0,reviewedAt:new Date().toISOString()}})},C=()=>!c.dailyGoals||c.dailyGoals.length===0?null:tt.default.createElement(tt.default.Fragment,null,c.dailyGoals.map((D,A)=>tt.default.createElement("div",{key:A,className:"drc-goal-item"},tt.default.createElement("input",{type:"text",value:D,onChange:L=>p(A,L.target.value),placeholder:"Your goal for the next session"}),tt.default.createElement("button",{className:"drc-remove-button",onClick:()=>m(A)},"Remove")))),k=()=>!c.reviewQuestions||Object.keys(c.reviewQuestions).length===0?tt.default.createElement("div",{className:"drc-no-questions"},"No reflection questions defined. Add review questions in settings."):tt.default.createElement("div",{className:"drc-reflection"},Object.entries(c.reviewQuestions).map(([D,A])=>tt.default.createElement("div",{key:D,className:"drc-reflection-item"},tt.default.createElement("label",null,D),tt.default.createElement("textarea",{value:A,onChange:L=>h(D,L.target.value),placeholder:"Your answer..."})))),x=(D,A)=>{d({[D]:A})},S=()=>tt.default.createElement("div",{className:"drc-note-grades",style:{display:"flex",justifyContent:"space-evenly",width:"100%"}},tt.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},tt.default.createElement("span",{className:"drc-note-grade-label"},"Mental Game:"),tt.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},tt.default.createElement("select",{value:c.mentalGrade||"C",onChange:D=>x("mentalGrade",D.target.value),className:`drc-note-grade-value grade-${(c.mentalGrade||"C").toLowerCase()}`,"aria-label":"Mental Game Grade"},tt.default.createElement("option",{value:"A"},"A"),tt.default.createElement("option",{value:"B"},"B"),tt.default.createElement("option",{value:"C"},"C")))),tt.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},tt.default.createElement("span",{className:"drc-note-grade-label"},"Technical Game:"),tt.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},tt.default.createElement("select",{value:c.technicalGrade||"C",onChange:D=>x("technicalGrade",D.target.value),className:`drc-note-grade-value grade-${(c.technicalGrade||"C").toLowerCase()}`,"aria-label":"Technical Game Grade"},tt.default.createElement("option",{value:"A"},"A"),tt.default.createElement("option",{value:"B"},"B"),tt.default.createElement("option",{value:"C"},"C")))));return tt.default.createElement("div",{className:"drc-note-review-tab"},((T=c.endOfDayReview)==null?void 0:T.images)&&c.endOfDayReview.images.length>0&&tt.default.createElement("div",{className:"drc-section"},tt.default.createElement("h3",null,"End of Day Review"),tt.default.createElement("div",{className:"drc-eod-images"},tt.default.createElement(ac,{images:c.endOfDayReview.images,altPrefix:"End of Day Review",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:(D,A)=>y(D,A),enableFullscreen:!0}))),tt.default.createElement("div",{className:"drc-section"},tt.default.createElement("h3",null,"Performance Grades"),S()),tt.default.createElement("div",{className:"drc-section"},tt.default.createElement(dG,{frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:a})),tt.default.createElement("div",{className:"drc-section"},tt.default.createElement("h3",null,"Reflection Questions"),k()),tt.default.createElement("div",{className:"drc-section"},tt.default.createElement("h3",null,"Goals for Next Session"),tt.default.createElement("button",{className:"drc-add-button",onClick:u},"Add Goal"),tt.default.createElement("div",{className:"drc-goals"},C())),tt.default.createElement("div",{className:"drc-section"},tt.default.createElement("h3",null,"End of Day Screenshots"),tt.default.createElement(fd,{onImageUploaded:D=>b(D),onMultipleImagesUploaded:D=>v(D),label:"Add screenshots",enableDragDrop:!0,saveImageFunction:g,multiple:!0,className:"drc-eod-image-uploader",enablePaste:!0})),tt.default.createElement("div",{className:"drc-section drc-eod-review-button-section"},tt.default.createElement(hl,{reviewed:(P=c.endOfDayReview)==null?void 0:P.reviewed,reviewedAt:(M=c.endOfDayReview)==null?void 0:M.reviewedAt,onMarkReviewed:w})))};Tm();dv();pv();var pG=({data:e,trades:t=[],filePath:r,openNote:n,plugin:a})=>{let o="DRCNote",i=Em(o,"general"),[s,l]=(0,Or.useState)(null),[c,d]=(0,Or.useState)([]),[u,p]=(0,Or.useState)([]),m=(0,Or.useRef)(null),[h,f]=(0,Or.useState)(r||"unknown"),b=(0,Or.useRef)(!1),v=(0,Or.useRef)(null),{service:y}=UB(),g=Or.default.useMemo(()=>n$(e),[e]),[w,C]=(0,Or.useState)(g.date?new Date(g.date):new Date);(0,Or.useEffect)(()=>{try{if(m.current&&!r){let M=m.current.getAttribute("data-displaying-file");if(M){f(M);return}let D=m.current.parentElement;for(;D;){let A=D.getAttribute("data-displaying-file")||D.getAttribute("data-file-path");if(A){f(A);break}D=D.parentElement}}}catch(M){i(M,"Error finding file path")}},[r]),(0,Or.useEffect)(()=>{g.date&&C(new Date(g.date))},[g.date]),(0,Or.useEffect)(()=>{let M=async()=>{try{if(y){let D=new Date(g.date),A=await y.getPreviousDayGoals(D);l(A)}}catch(D){Bi({message:"Error fetching previous day goals",error:D,component:o,operation:"fetchPreviousDayGoals",severity:"warning"})}};!b.current&&g.date&&(M(),b.current=!0)},[g.date,y]),(0,Or.useEffect)(()=>{var M,D;try{let A=a||((D=(M=window.app)==null?void 0:M.plugins)==null?void 0:D.plugins.journalit);v.current=A==null?void 0:A.optionsService,(()=>{try{if(v.current){let E=v.current.getOptions("instrument"),I=v.current.getOptions("setup");d([...E]),p([...I])}}catch(E){Bi({message:"Failed to load options",error:E,component:o,operation:"loadOptions",severity:"warning"}),d([]),p([])}})();let N=()=>{setTimeout(()=>{try{if(v.current){let E=v.current.getOptions("instrument"),I=v.current.getOptions("setup");JSON.stringify(E)!==JSON.stringify(c)&&d(E),JSON.stringify(I)!==JSON.stringify(u)&&p(I)}}catch(E){Bi({message:"Error updating options",error:E,component:o,operation:"handleOptionsChanged",severity:"warning"})}},300)};return document.addEventListener("journalit-options-changed",N,{capture:!1}),()=>{document.removeEventListener("journalit-options-changed",N,{capture:!1})}}catch(A){Bi({message:"Failed to set up options listeners",error:A,component:o,operation:"setupOptionsListeners",severity:"warning"}),d([]),p([])}},[]);let k=async M=>{var D,A;try{let L=a||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit),N=L==null?void 0:L.optionsService;N&&await N.addOption("instrument",M)&&N.notifyOptionsChanged()}catch(L){Bi({message:"Failed to save custom instrument option",error:L,component:o,operation:"handleSaveInstrument",severity:"warning"})}},x=async M=>{var D,A;try{let L=a||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit),N=L==null?void 0:L.optionsService;N&&await N.addOption("setup",M)&&N.notifyOptionsChanged()}catch(L){Bi({message:"Failed to save custom setup option",error:L,component:o,operation:"handleSaveSetup",severity:"warning"})}};(0,Or.useEffect)(()=>{var E;m.current&&(m.current.classList.add("drc-note-mounted"),m.current.setAttribute("data-mounted-at",Date.now().toString()));let M=(E=m.current)==null?void 0:E.closest(".journalit-drc-view");M&&M.classList.add("drc-note-mounted"),T$(),eE();let D="drc-critical-navigation-styles";if(!document.getElementById(D)){let I=document.createElement("style");I.id=D,I.innerHTML=`
        /* Critical styles for DRC P&L display - ensuring it displays properly */
        html body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card .drc-stat-value {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          width: 100% !important;
          display: block !important;
        }
        
        html body .drc-container .drc-stats .drc-stat-card,
        body .drc-container .drc-stats .drc-stat-card,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card {
          min-width: 0 !important;
          overflow: hidden !important;
        }
        
        /* Stats card for P&L specifically */
        html body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        .workspace-leaf .drc-container .drc-stats .drc-stat-card:nth-child(4) {
          overflow: hidden !important;
          min-width: 140px !important;
        }
        
        /* Critical styles for DRC navigation - highest specificity possible */
        html body .drc-container .drc-header .drc-navigation,
        body .drc-container .drc-header .drc-navigation,
        .workspace-leaf .drc-container .drc-header .drc-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
          max-width: none !important;
          margin: 0 !important;
        }
        
        /* Ensure proper icon spacing */
        html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
        body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }
      `,document.head.appendChild(I)}if(!document.getElementById("fix-grade-display")){let I=document.createElement("style");I.id="fix-grade-display",I.textContent=`
        /* Performance Grade Containers Layout Fix */
        .drc-note-grades {
          display: flex !important;
          flex-direction: row !important;
          justify-content: space-evenly !important;
          gap: 16px !important;
          margin-bottom: 24px !important;
          width: 100% !important;
        }
        
        .drc-note-grade {
          display: flex !important;
          flex-direction: column !important;
          align-items: center !important;
          text-align: center !important;
          flex: 1 !important;
          padding: 16px !important;
          background-color: var(--background-primary) !important;
          border-radius: var(--border-radius-md, 4px) !important;
          border: 1px solid var(--background-modifier-border) !important;
        }
        
        /* Center label text */
        .drc-note-grade-label {
          text-align: center !important;
          width: 100% !important;
          margin-bottom: 12px !important;
        }
        
        /* Center dropdown in container */
        .drc-note-grade-dropdown {
          display: flex !important;
          justify-content: center !important;
          width: 100% !important;
        }

        /* Fix for grade display text cutoff and perfect centering */
        .drc-note-grade-value, 
        select.drc-note-grade-value {
          overflow: visible !important;
          min-height: 60px !important;
          min-width: 60px !important;
          width: 60px !important;
          height: 60px !important;
          max-width: 60px !important;
          max-height: 60px !important;
          padding: 0 !important; /* Remove all padding */
          font-size: 22px !important; /* Larger font */
          line-height: 1 !important; /* Critical for vertical centering */
          text-rendering: optimizeLegibility !important;
          -webkit-font-smoothing: antialiased !important;
          text-align: center !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          border-radius: 50% !important; /* Make it a circle */
          aspect-ratio: 1 / 1 !important; /* Keep it as a perfect circle */
          margin: 0 auto !important; /* Center horizontally */
          margin-top: 8px !important; /* Add some space from the label */
          border: none !important;
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Center text within the grade circle */
        .drc-note-grade-value,
        select.drc-note-grade-value,
        .drc-note-grade-dropdown select {
          text-align: center !important;
        }
        
        /* Prevent browser's default tooltip (the grey one) */
        .drc-note-grade-dropdown select:hover::before,
        .drc-note-grade-dropdown select::before {
          content: none !important;
          display: none !important;
        }
        
        /* Style the black tooltip */
        .tooltip {
          background-color: #000 !important;
          color: #fff !important;
          padding: 5px 10px !important;
          border-radius: 4px !important;
          font-size: 12px !important;
          z-index: 9999 !important;
        }
        
        /* Enhanced dropdown arrow positioning */
        .drc-note-grade-dropdown::after {
          right: 50% !important;
          transform: translateX(10px) translateY(-10px) !important;
          bottom: 10px !important;
          top: auto !important;
        }
        
        /* Hide default dropdown arrow */
        .drc-note-grade-dropdown select::-ms-expand {
          display: none !important;
        }
        
        .drc-note-grade-dropdown select {
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Modify the grade colors - A is green, B is orange, C is red */
        .drc-note-grade-value.grade-a {
          background-color: rgba(102, 187, 106, 0.3) !important;
          color: #2e7d32 !important; /* Darker green for better visibility */
        }
        
        .drc-note-grade-value.grade-b {
          background-color: rgba(255, 152, 0, 0.3) !important;
          color: #ef6c00 !important; /* Darker orange for better visibility */
        }
        
        .drc-note-grade-value.grade-c {
          background-color: rgba(229, 57, 53, 0.3) !important;
          color: #c62828 !important; /* Darker red for better visibility */
        }
      `,document.head.appendChild(I)}let L=document.getElementById("grade-tooltip-script");L&&L.remove();let N=document.getElementById("grade-tooltip");return N&&N.remove(),()=>{let I=document.getElementById("drc-critical-navigation-styles");I&&I.remove()}},[h]),(0,Or.useEffect)(()=>{let M=()=>{var D,A,L;try{let N=a||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(!((L=N==null?void 0:N.settings)!=null&&L.drc))return}catch(N){console.error("Error handling settings update:",N)}};return document.addEventListener("journalit-settings-updated",M),()=>document.removeEventListener("journalit-settings-updated",M)},[]);let S=[{id:"prepare",label:"Preparation",content:({data:M,updateData:D})=>Or.default.createElement(oW,{frontmatter:M,updateFrontmatter:D,previousDayGoals:s,trades:t,openNote:n||(A=>{}),plugin:a})},{id:"trades",label:"Trades",count:t.length,content:({data:M,updateData:D})=>Or.default.createElement(cG,{frontmatter:M,trades:t,updateFrontmatter:D,openNote:n||(A=>{}),plugin:a})},{id:"review",label:"Review",content:({data:M,updateData:D})=>Or.default.createElement(uG,{frontmatter:M,trades:t,updateFrontmatter:D,openNote:n||(A=>{}),plugin:a,instrumentOptions:c,setupOptions:u,onSaveInstrument:k,onSaveSetup:x})}],T=w.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"});return Or.default.createElement("div",{className:"drc-container",ref:m,"data-file-path":h,style:{margin:0}},Or.default.createElement(C0,{data:g,filePath:h,openNote:n,plugin:a,serviceName:"drcService",componentName:"Daily Report Card",navigationOptions:{currentDate:w,getAdjacentReview:async M=>{try{if(y)return await y.getAdjacentDRC(w,M)}catch(D){i(D,"Error getting adjacent DRC")}return null},getRelatedReviewPaths:{weekly:M=>{var D,A;try{let L=a||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(L!=null&&L.weeklyReviewService)return L.weeklyReviewService.getWeeklyReviewPath(M);if(L!=null&&L.drcService)return L.drcService.getWeeklyReviewPath(M)}catch(L){i(L,"Error getting weekly review path")}return""},monthly:M=>{var D,A;try{let L=a||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(L!=null&&L.monthlyReviewService)return L.monthlyReviewService.getMonthlyReviewPath(M);if(L!=null&&L.drcService)return L.drcService.getMonthlyReviewPath(M)}catch(L){i(L,"Error getting monthly review path")}return""}}},tabConfig:S,updateMethodName:"updateDRCFrontmatter",className:{container:"drc-content",header:{container:"drc-header",title:"drc-title",dateContainer:"drc-date-container"},tabContainer:{container:"drc-tabs-container",tabList:"drc-tabs",tab:"drc-tab",activeTab:"active"}}}))};var jC=class extends qi{constructor(t){super(t)}async renderComponent(t,r,n,a,o){if(!t||!t.isConnected){console.error(`[DRCNote] Cannot render into disconnected container for ${n}`);return}t.querySelector(".drc-container")||await this.renderDRCNote(t,r,n,a,o)}async renderDRCNote(t,r,n,a,o){var i,s;try{if(!t||!t.isConnected)return;let l=o?`${n}-${a}-${o}`:`${n}-${a}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".drc-container")||t.querySelector(".drc-container"))return;this.injectDropdownStyles(t);let u=(s=(i=window.app)==null?void 0:i.plugins)==null?void 0:s.plugins.journalit,p=this.findContainingLeaf(t),m;if(p&&p.view){let v=p.view.containerEl,y=p.containerEl;v&&v.id?m=v.id:y&&y.id&&(m=y.id)}let h=await this.fetchTradesForDRC(r);t.setAttribute("data-displaying-file",n),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${n}-${a}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let f={...r};["plugin","app","_"].forEach(v=>{v in f&&delete f[v]});let b={...f,trades:h};this.createReactRoot(t,l,m,o,b,n)}catch(l){console.error("[DRCNote] Error rendering DRC note:",l),t.setText("Error rendering DRC note: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}createReactElement(t,r,n){var o,i;let a=(i=(o=window.app)==null?void 0:o.plugins)==null?void 0:i.plugins.journalit;return mG.default.createElement(pG,{data:t,trades:t.trades||[],filePath:r,openNote:n,plugin:a})}injectDropdownStyles(t){let r=`drc-container-${Date.now()}-${Math.floor(Math.random()*1e3)}`;if(t.id=r,!document.getElementById("drc-critical-dropdown-styles")){let n=document.createElement("style");n.id="drc-critical-dropdown-styles",n.textContent=`
                /* Critical ComboBox styling for DRC dropdowns - with highest specificity */
                .drc-container .combobox-container,
                .drc-container [data-combobox-type],
                .drc-missed-trade .combobox-container,
                .drc-missed-trade .drc-input-group.field .combobox-container,
                #${r} .combobox-container,
                #${r} [data-combobox-type] {
                    position: relative !important;
                    width: 100% !important;
                    margin-bottom: 8px !important;
                    z-index: 10 !important;
                }
                
                /* Increased z-index when dropdown is open */
                .drc-container .combobox-container[data-is-open="true"],
                .drc-container [data-combobox-type][data-is-open="true"],
                .drc-missed-trade .combobox-container[data-is-open="true"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"],
                #${r} .combobox-container[data-is-open="true"],
                #${r} [data-combobox-type][data-is-open="true"] {
                    z-index: 9999 !important;
                }
                
                /* Force dropdown list to be visible at all times */
                .drc-container .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-container [data-combobox-type][data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} [data-combobox-type][data-is-open="true"] ul[role="listbox"] {
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    position: absolute !important;
                    top: 34px !important; /* Position closer to input */
                    left: 0 !important;
                    right: 0 !important;
                    max-height: 200px !important;
                    overflow-y: auto !important;
                    background-color: var(--background-primary) !important;
                    border: 1px solid var(--background-modifier-border) !important;
                    border-top: none !important; /* Remove top border for seamless connection */
                    border-radius: 0 0 4px 4px !important; /* Only round bottom corners */
                    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
                    z-index: 9999 !important;
                    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
                }
                
                /* Style dropdown list items */
                .drc-container [data-combobox-type] ul[role="listbox"] li,
                .drc-missed-trade .combobox-container ul[role="listbox"] li,
                #${r} [data-combobox-type] ul[role="listbox"] li,
                #${r} .combobox-container ul[role="listbox"] li {
                    padding: 8px 12px !important;
                    cursor: pointer !important;
                    transition: background-color 150ms ease !important;
                    margin: 0 !important;
                    background-color: var(--background-primary) !important;
                    color: var(--text-normal) !important;
                    font-size: 14px !important;
                    line-height: 1.5 !important;
                    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
                }
                
                /* Hover state for dropdown items */
                .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
                .drc-missed-trade .combobox-container ul[role="listbox"] li:hover,
                #${r} [data-combobox-type] ul[role="listbox"] li:hover,
                #${r} .combobox-container ul[role="listbox"] li:hover {
                    background-color: var(--background-secondary) !important;
                }
                
                /* Dropdown arrow styling */
                .drc-container [data-combobox-type] .input-container::after,
                .drc-missed-trade .combobox-container .input-container::after,
                #${r} [data-combobox-type] .input-container::after,
                #${r} .combobox-container .input-container::after {
                    content: "" !important;
                    position: absolute !important;
                    right: 12px !important;
                    top: 50% !important;
                    transform: translateY(-50%) !important;
                    width: 0 !important;
                    height: 0 !important;
                    border-left: 5px solid transparent !important;
                    border-right: 5px solid transparent !important;
                    border-top: 5px solid var(--text-normal) !important;
                    pointer-events: none !important;
                    z-index: 10 !important;
                }
                
                /* Input padding for dropdown arrow */
                .drc-container [data-combobox-type] input[role="combobox"],
                .drc-missed-trade .combobox-container input[role="combobox"],
                #${r} [data-combobox-type] input[role="combobox"],
                #${r} .combobox-container input[role="combobox"] {
                    padding-right: 30px !important;
                }
            `,document.head.appendChild(n)}return r}async fetchTradesForDRC(t){var r,n,a;try{if(!t.date)return[];let o=(n=(r=window.app)==null?void 0:r.plugins)==null?void 0:n.plugins.journalit;if(!o||!o.drcService)return console.error("[DRCNote] Cannot access plugin or DRC service"),[];let i=new Date(t.date),s=await o.drcService.getTradesForDate(i),l=[];for(let c of s)try{let d=(a=this.app.metadataCache.getFileCache(c))==null?void 0:a.frontmatter;if(!d||d.type!=="trade")continue;let u={id:c.path,instrument:d.instrument||"Unknown",direction:d.direction||"Unknown",entryPrice:parseFloat(d.entryPrice)||0,exitPrice:parseFloat(d.exitPrice)||0,positionSize:parseFloat(d.positionSize)||0,pnl:parseFloat(d.pnl)||void 0,entryTime:d.entryTime?new Date(d.entryTime):new Date,exitTime:d.exitTime?new Date(d.exitTime):void 0,path:c.path,setup:d.setup,images:d.images};l.push(u)}catch(d){console.error(`[DRCNote] Error processing trade file ${c.path}:`,d)}return l}catch(o){return console.error("[DRCNote] Error fetching trades:",o),[]}}unmountDRCNote(t,r,n,a){return this.unmountComponent(t,r,n,a)}unmountAllDRCNotes(){this.unmountAllComponents()}unmountLeafDRCNotes(t){this.unmountLeafComponents(t)}};var zC=class extends Hi{constructor(t,r){super(t,r,new jC(t))}isValidComponentType(t){return t&&t.type==="drc"}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}getComponentTypeIdentifier(){return"drc"}async getAdditionalDataForComponent(t,r){return{}}async handleFileOpen(t,r=!1){if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){this.markFileRenderedInMode(t.path,"source");return}if(this.cleanupDuplicateComponents(t.path),r){let s=`rendered-drc-${t.path}-${Date.now()}`;if(window[s]=!1,Date.now()-window.__obsidianStartTime<5e3){setTimeout(()=>{this.tryRenderActiveDRC(t,s)},500),setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s)},1500),setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s),delete window[s]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s),delete window[s]},500);return}let o=document.body,i=new MutationObserver((s,l)=>{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}c.forEach(u=>{var M;let p=u.querySelector(".metadata-container");if(!p)return;let m=p.closest(".workspace-leaf-content");if(!m)return;let h=this.findContainingLeaf(m),f=(M=h==null?void 0:h.view)==null?void 0:M.containerEl,b=p.closest(".workspace-leaf"),y=(b==null?void 0:b.id)||(f==null?void 0:f.id)||null,g=this.getUniqueElementId(u),w=y?`leaf-${y}`:g,C=!0;if(h){let D=h.view,A=null;(D&&"file"in D||D&&"getViewType"in D&&D.getViewType()==="markdown")&&(A=D.file),A&&(C=A.path===t.path)}if(!C)return;let k=this.getComponentClassName();u.querySelectorAll(`.${k}`).forEach(D=>{let A=D.getAttribute("data-file-path");if(A){let L=D.getAttribute("data-view-id"),N=D.getAttribute("data-leaf-id");L&&this.renderer.unmountComponent(A,L,N||void 0),D.remove()}});let x=this.getWrapperClassName(),S=u.querySelectorAll(`.${x}`),T=Array.from(S).some(D=>{var A;return(A=D.querySelector(".drc-container"))==null?void 0:A.classList.contains("drc-note-mounted")});if(S.length>0||T)return;let P=Array.from(u.querySelectorAll(`.${k}`)).find(D=>D.getAttribute("data-file-path")===t.path);P||(P=document.createElement("div"),P.className=k,P.style.marginTop="0px",P.style.marginBottom="0px",P.style.padding="0px",P.setAttribute("data-file-path",t.path),P.setAttribute("data-view-id",w),P.setAttribute("data-editor-id",g),y&&P.setAttribute("data-leaf-id",y),P.setAttribute("data-inserted-at",Date.now().toString()),P.setAttribute("data-created-at",Date.now().toString()),p.after(P)),this.renderDRCNoteWithDeduplication(t,P,a,w,g)}),l.disconnect();let d=this.activeObservers.indexOf(l);d>-1&&this.activeObservers.splice(d,1)});this.activeObservers.push(i),i.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{i.disconnect();let s=this.activeObservers.indexOf(i);s>-1&&this.activeObservers.splice(s,1)},5e3)}renderActiveComponent(){this.renderActiveDRCNote()}async tryRenderActiveDRC(t,r){try{let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){window[r]=!0;return}this.cleanupDuplicateComponents(t.path),this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[DRC] Error in tryRenderActiveDRC:",n)}}renderDRCNoteWithDeduplication(t,r,n,a,o){this.cleanupDuplicateComponents(t.path);let i=this.renderWithDeduplication({file:t,container:r,data:n,viewId:a,contextId:o,componentClassName:this.getComponentClassName(),mountedClassName:"drc-note-mounted",contentSelector:".drc-container"})}cleanup(){super.cleanup()}renderActiveDRCNote(){this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="drc")return;let a=this.app.workspace.getActiveViewOfType(fG.MarkdownView);if(!a)return;let o=a.getMode,i=typeof o=="function"?o.call(a)==="source":!1,s=null;if(i){let l=a.containerEl.querySelector(".metadata-container");if(!l)return;let c=Array.from(a.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="0px",s.style.marginBottom="0px",s.style.padding="0px",s.setAttribute("data-file-path",t.path),l.after(s))}else{let l=a.containerEl.querySelector(".markdown-preview-view");if(!l)return;let c=Array.from(l.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="0px",s.style.marginBottom="0px",s.style.padding="0px",s.setAttribute("data-file-path",t.path),l.prepend(s))}if(s){let l=`drc-active-${Date.now()}`;s.setAttribute("data-view-id",l),this.renderDRCNoteWithDeduplication(t,s,n,l)}}};var vg=require("obsidian");var AG=_(B());var Bn=_(B());gv();Sv();var Qe=_(B());jw();Zt();So();var hb=e=>e==="monthly"||e==="weekly"||e==="daily",gG=({data:e,updateData:t,previousWeekGoals:r})=>{let n=Ee(),[a,o]=(0,Qe.useState)(""),[i,s]=(0,Qe.useState)(""),[l,c]=(0,Qe.useState)("gray"),[d,u]=(0,Qe.useState)(""),p=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],[m,h]=(0,Qe.useState)([]);Qe.default.useEffect(()=>{try{if(n!=null&&n.optionsService){let N=n.optionsService.getOptions("event")||[];h(N)}}catch(N){ve.error("Failed to load event options:",N)}},[n]),Qe.default.useEffect(()=>{if(a&&(n!=null&&n.optionsService)){let N=n.optionsService.getEventOptionByName(a);N&&N.color?c(N.color):c("gray")}else c("gray")},[a,n]);let f=async N=>{try{if(n!=null&&n.optionsService){await n.optionsService.addOrUpdateEventOption(N,l);let E=n.optionsService.getOptions("event")||[];h(E)}}catch(E){ve.error("Failed to save event option:",E)}},b=N=>{let I={...e.previousGoalStatus||{}},O=`goal_${N}`;I[O]=!I[O],t({previousGoalStatus:I})},v=()=>{if(!a)return;n!=null&&n.optionsService&&n.optionsService.addOrUpdateEventOption(a,l);let N=[...e.keyEvents||[]];N.push({event:a,notes:i,color:l,day:d||void 0}),t({keyEvents:N}),o(""),s(""),c("gray"),u("")},y=N=>{let E=[...e.keyEvents||[]];E.splice(N,1),t({keyEvents:E})},g=()=>{var N,E;try{return((E=(N=n==null?void 0:n.settings)==null?void 0:N.weekly)==null?void 0:E.customTimeframes)||["Monthly","Weekly","Daily"]}catch(I){return ve.error("Error getting timeframes:",I),["Monthly","Weekly","Daily"]}};(0,Qe.useEffect)(()=>{let N=E=>{var I;((I=E.detail)==null?void 0:I.component)==="weekly"&&(k.current=C())};return document.addEventListener("journalit-settings-updated",N),()=>{document.removeEventListener("journalit-settings-updated",N)}},[]);let w=(N,E,I,O=!1)=>{var F,z,W,U,K,R;let j={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},$={monthly:{notes:((F=j.monthly)==null?void 0:F.notes)||"",images:Array.isArray((z=j.monthly)==null?void 0:z.images)?[...j.monthly.images]:[]},weekly:{notes:((W=j.weekly)==null?void 0:W.notes)||"",images:Array.isArray((U=j.weekly)==null?void 0:U.images)?[...j.weekly.images]:[]},daily:{notes:((K=j.daily)==null?void 0:K.notes)||"",images:Array.isArray((R=j.daily)==null?void 0:R.images)?[...j.daily.images]:[]},customTimeframes:{...j.customTimeframes||{}}};E==="notes"&&(O?($.customTimeframes||($.customTimeframes={}),$.customTimeframes[N]={...$.customTimeframes[N],notes:I}):hb(N)&&($[N].notes=I)),t({forecast:$})},C=()=>{let N=g(),E=["monthly","weekly","daily"];return N.forEach(I=>{if(!["Monthly","Weekly","Daily"].includes(I)){let O=I.replace(/\s+/g,"_").toLowerCase();E.push(O)}}),E},k=(0,Qe.useRef)(C()),x=async(N,E,I=!1)=>{var O,j;try{let $=n||((j=(O=window.app)==null?void 0:O.plugins)==null?void 0:j.plugins.journalit);if(!($!=null&&$.weeklyReviewService))throw new Error("Weekly Review Service not available");let F=new Date(e.date);return await $.weeklyReviewService.saveWeeklyReviewImage(N,F,E)}catch($){throw ve.error(`Error uploading image for ${E}:`,$),$}},S=(N,E,I=!1)=>{var $,F,z,W,U,K,R;let O={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},j={monthly:{notes:(($=O.monthly)==null?void 0:$.notes)||"",images:Array.isArray((F=O.monthly)==null?void 0:F.images)?[...O.monthly.images]:[]},weekly:{notes:((z=O.weekly)==null?void 0:z.notes)||"",images:Array.isArray((W=O.weekly)==null?void 0:W.images)?[...O.weekly.images]:[]},daily:{notes:((U=O.daily)==null?void 0:U.notes)||"",images:Array.isArray((K=O.daily)==null?void 0:K.images)?[...O.daily.images]:[]},customTimeframes:{...O.customTimeframes||{}}};if(I){j.customTimeframes||(j.customTimeframes={});let q=Array.isArray((R=j.customTimeframes[N])==null?void 0:R.images)?[...j.customTimeframes[N].images]:[];j.customTimeframes[N]={...j.customTimeframes[N],images:[...q,E]}}else if(hb(N)){let q=Array.isArray(j[N].images)?[...j[N].images]:[];j[N].images=[...q,E]}t({forecast:j})},T=(N,E,I=!1)=>{var $,F,z,W,U,K,R;let O={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},j={monthly:{notes:(($=O.monthly)==null?void 0:$.notes)||"",images:Array.isArray((F=O.monthly)==null?void 0:F.images)?[...O.monthly.images]:[]},weekly:{notes:((z=O.weekly)==null?void 0:z.notes)||"",images:Array.isArray((W=O.weekly)==null?void 0:W.images)?[...O.weekly.images]:[]},daily:{notes:((U=O.daily)==null?void 0:U.notes)||"",images:Array.isArray((K=O.daily)==null?void 0:K.images)?[...O.daily.images]:[]},customTimeframes:{...O.customTimeframes||{}}};if(I){j.customTimeframes||(j.customTimeframes={});let q=Array.isArray((R=j.customTimeframes[N])==null?void 0:R.images)?[...j.customTimeframes[N].images]:[];j.customTimeframes[N]={...j.customTimeframes[N],images:[...q,...E]}}else if(hb(N)){let q=Array.isArray(j[N].images)?[...j[N].images]:[];j[N].images=[...q,...E]}t({forecast:j})},P=async(N,E,I,O=!1)=>{var j,$,F,z,W,U,K,R,q;try{let X=n||(($=(j=window.app)==null?void 0:j.plugins)==null?void 0:$.plugins.journalit);if(!(X!=null&&X.weeklyReviewService))throw new Error("Weekly Review Service not available");await X.weeklyReviewService.deleteImage(I);let G={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},H={monthly:{notes:((F=G.monthly)==null?void 0:F.notes)||"",images:Array.isArray((z=G.monthly)==null?void 0:z.images)?[...G.monthly.images]:[]},weekly:{notes:((W=G.weekly)==null?void 0:W.notes)||"",images:Array.isArray((U=G.weekly)==null?void 0:U.images)?[...G.weekly.images]:[]},daily:{notes:((K=G.daily)==null?void 0:K.notes)||"",images:Array.isArray((R=G.daily)==null?void 0:R.images)?[...G.daily.images]:[]},customTimeframes:{...G.customTimeframes||{}}};if(O){if((q=H.customTimeframes[N])!=null&&q.images){let Y=[...H.customTimeframes[N].images];Y.splice(E,1),H.customTimeframes[N]={...H.customTimeframes[N],images:Y}}}else if(hb(N)){let Y=[...H[N].images||[]];Y.splice(E,1),H[N].images=Y}t({forecast:H})}catch(X){ve.error("Error deleting image:",X)}},M=N=>{var I;return((I=e.previousGoalStatus)==null?void 0:I[`goal_${N}`])||!1},D=(N,E=!1)=>({getSectionData:()=>{var O;let I=e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}};return E?((O=I.customTimeframes)==null?void 0:O[N])||{notes:"",images:[]}:hb(N)?I[N]||{notes:"",images:[]}:{notes:"",images:[]}},handleImageUpload:async I=>{S(N,I,E)},handleMultipleImagesUpload:async I=>{T(N,I,E)},handleNotesChange:I=>{w(N,"notes",I,E)},handleImageDelete:(I,O)=>{P(N,I,O,E)}}),A=(N,E,I=!1)=>{let O=D(N,I),j=O.getSectionData();return Qe.default.createElement(k0,{key:N,sectionName:N,sectionTitle:E,notes:j.notes||"",images:j.images||[],onNotesChange:O.handleNotesChange,onImageUploaded:O.handleImageUpload,onMultipleImagesUploaded:O.handleMultipleImagesUpload,onImageDeleted:O.handleImageDelete,saveImageFunction:async $=>await x($,N,I),isCustom:I,className:{container:"weekly-review-forecast-section",sectionTitle:"weekly-review-forecast-title",notesContainer:"weekly-review-forecast-notes",imageContainer:"weekly-review-image-container"}})},L=()=>{let N=g(),E={Monthly:"monthly",Weekly:"weekly",Daily:"daily"};return Qe.default.createElement("div",{className:"weekly-review-forecast-sections"},N.map(I=>{let O=I.replace(/\s+/g,"_").toLowerCase(),j=Object.keys(E).includes(I),$=j?E[I]:O;return A($,I,!j)}))};return Qe.default.createElement("div",{className:"weekly-review-preparation"},Qe.default.createElement("div",{className:"weekly-review-section"},Qe.default.createElement(S0,{goals:r,goalStatus:e.previousGoalStatus||{},onToggleGoal:b,title:"Previous Week Goals",emptyMessage:"No goals from previous week",emptyActionLabel:"",className:{container:"weekly-review-previous-goals",goalItem:"weekly-review-checklist-item",goalCheckbox:"weekly-review-checkbox",goalText:"weekly-review-goal-text",completed:"completed"}})),Qe.default.createElement("div",{className:"weekly-review-section"},Qe.default.createElement("h3",{className:"weekly-review-section-title"},"Key Events"),Qe.default.createElement("div",{className:"weekly-review-key-events"},Qe.default.createElement("div",{className:"weekly-review-event-selector"},Qe.default.createElement(oi,{label:"Event",options:m,value:a,onChange:N=>o(N),placeholder:"Select or create event",allowCreate:!0,isMulti:!1,optionType:"event",onSaveOption:f,error:"",helperText:"",required:!1}),Qe.default.createElement("div",{className:"weekly-review-event-color-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Qe.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Colour:"),["gray","red","orange","yellow"].map(N=>Qe.default.createElement("div",{key:N,style:{display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",padding:"4px",width:"24px",height:"24px",borderRadius:"4px",backgroundColor:l===N?"var(--background-modifier-hover)":"transparent"},onClick:()=>c(N)},Qe.default.createElement("span",{style:{display:"inline-block",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:`var(--event-color-${N}, ${N==="gray"?"#888":N})`,border:"1px solid var(--background-modifier-border)",margin:"0"},title:N.charAt(0).toUpperCase()+N.slice(1)}),Qe.default.createElement("input",{type:"radio",name:"event-color",value:N,checked:l===N,onChange:()=>{},style:{display:"none"}})))),Qe.default.createElement("div",{className:"weekly-review-event-day-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Qe.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Day:"),Qe.default.createElement("select",{value:d,onChange:N=>u(N.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",width:"150px"}},Qe.default.createElement("option",{value:""},"None (optional)"),p.map(N=>Qe.default.createElement("option",{key:N,value:N},N)))),Qe.default.createElement("textarea",{value:i,onChange:N=>s(N.target.value),placeholder:"Notes about this event",className:"weekly-review-textarea"}),Qe.default.createElement("button",{className:"weekly-review-add-button",onClick:v,disabled:!a},"Add Event")),e.keyEvents&&e.keyEvents.length>0?Qe.default.createElement("div",{className:"weekly-review-events-list"},e.keyEvents.map((N,E)=>{let I=N.color?`event-color-${N.color}`:"event-color-gray";return Qe.default.createElement("div",{key:`event-${E}`,className:`weekly-review-event-item ${I}`},Qe.default.createElement("div",{className:"weekly-review-event-header"},Qe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},Qe.default.createElement("h4",null,N.event),N.day&&Qe.default.createElement("span",{className:"weekly-review-event-day",style:{fontSize:"12px",padding:"2px 8px",backgroundColor:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)",fontWeight:"500"}},N.day)),Qe.default.createElement("button",{className:"weekly-review-remove-button",onClick:()=>y(E)},"Remove")),Qe.default.createElement("p",null,N.notes))})):Qe.default.createElement(Ie,{message:"No key events added",subMessage:"Add important market events that might impact your trading",iconSize:38,actionButtonText:"Add Your First Event",onActionButtonClick:()=>{let N=document.querySelector(".weekly-review-event-selector input");N instanceof HTMLElement&&N.focus()}}))),Qe.default.createElement("div",{className:"weekly-review-section"},Qe.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Forecast"),L(),Qe.default.createElement("style",null,`
          .weekly-review-forecast-section {
            width: 100%;
          }
          .weekly-review-forecast-notes {
            width: 100%;
          }
          .weekly-review-forecast-notes textarea {
            width: 100% !important;
            box-sizing: border-box !important;
            min-height: 80px;
          }
        `)))};var ae=_(B());Ea();mv();var Wfe=e=>({pnl:e.pnl,commission:e.commission||0,swap:e.swap||0,fees:e.fees||0}),pO=class{constructor(t=50){this.maxSize=t,this.cache=new Map}get(t){if(this.cache.has(t)){let r=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,r),r}}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}has(t){return this.cache.has(t)}clear(){this.cache.clear()}size(){return this.cache.size}},hG=new pO(50),Ufe=e=>e.tradeStatus==="CLOSED"?!1:e.tradeStatus==="OPEN"||e._originalPnlWasNull&&!e.tradeStatus?!0:ct({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}),qfe=async(e,t,r)=>{try{let n=r.dateRange[0]||new Date(0),a=r.dateRange[1]||new Date,o=await t.getTrades(n,a);return(await Promise.all(o.map(async s=>{var l;try{let c=((l=e.metadataCache.getFileCache(s))==null?void 0:l.frontmatter)||{},d=c.pnl===void 0||c.pnl===null;return{path:s.path,entryTime:new Date(c.entryTime),exitTime:c.exitTime?new Date(c.exitTime):new Date(c.entryTime),entryPrice:Number(c.entryPrice),exitPrice:c.exitTime!==void 0&&c.exitPrice!==null?Number(c.exitPrice):Number(c.entryPrice),positionSize:Number(c.positionSize),direction:c.direction,pnl:c.pnl!==void 0&&c.pnl!==null?Number(c.pnl):0,tradeStatus:c.tradeStatus,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits,_originalPnlWasNull:d,instrument:c.instrument,setup:Array.isArray(c.setup)?c.setup:c.setup?[c.setup]:[],mistake:Array.isArray(c.mistake)?c.mistake:c.mistake?[c.mistake]:[],account:Array.isArray(c.account)?c.account:c.account?[c.account]:[],accountIds:Array.isArray(c.accountIds)?c.accountIds:c.accountIds?[c.accountIds]:[],commission:c.commission!==void 0?(()=>{let p=Number(c.commission);return isNaN(p)?0:p})():void 0,swap:c.swap!==void 0?(()=>{let p=Number(c.swap);return isNaN(p)?0:p})():void 0,fees:c.fees!==void 0?(()=>{let p=Number(c.fees);return isNaN(p)?0:p})():void 0,ctags:Array.isArray(c.ctags)?c.ctags:c.ctags?[c.ctags]:[],tags:Array.isArray(c.tags)?c.tags:c.tags?[c.tags]:[]}}catch(c){return console.error(`Error processing trade file ${s.path}:`,c),null}}))).filter(s=>{if(s===null)return!1;let l=r.accounts.length===0||(()=>{let d=u=>u?Array.isArray(u)?u.some(p=>r.accounts.includes(p)):typeof u=="string"?r.accounts.includes(u):!1:!1;return d(s.account)||d(s.accountIds)})(),c=r.tickers.length===0||!!(s.instrument&&r.tickers.includes(s.instrument));return!!(l&&c)})}catch(n){return console.error("Error fetching trade data:",n),[]}},hg=e=>{var w,C;if(!e.length)return{netPnL:0,winRate:0,profitFactor:0,expectancy:0,numTrades:0,numWinTrades:0,numLossTrades:0,avgWin:0,avgLoss:0};let t=e.filter(k=>!Ufe(k)),r=t.map(k=>Aa(Wfe(k))),n=t.length,a=r.reduce((k,x)=>k+x,0),o=((w=t[0])==null?void 0:w.path)||"",i=((C=t[t.length-1])==null?void 0:C.path)||"",s=`${n}:${a.toFixed(2)}:${o}:${i}`,l=hG.get(s);if(l!==void 0)return l;let c=[],d=[];r.forEach(k=>{k>0?c.push(k):k<0&&d.push(k)});let u=c.reduce((k,x)=>k+x,0),p=Math.abs(d.reduce((k,x)=>k+x,0)),m=u-p,h=t.length>0?c.length/t.length:0,f=p===0?u:u/p,b=c.length>0?u/c.length:0,v=d.length>0?p/d.length:0,y=h*b-(1-h)*v,g={netPnL:m,winRate:h,profitFactor:f,expectancy:y,numTrades:t.length,numWinTrades:c.length,numLossTrades:d.length,avgWin:b,avgLoss:v};return hG.set(s,g),g},vG=async(e,t,r)=>{try{let n=await qfe(e,t,r),a=hg(n);return{trades:n,metrics:a}}catch(n){return console.error("Error fetching dashboard data:",n),{trades:[],metrics:hg([])}}};er();Ft();var yG=_(B());var Hfe=Al(El,"pnl"),bG=({trades:e,height:t=300,dateFormat:r})=>yG.default.createElement(Hfe,{trades:e,dateFormat:r,height:t});var xG=_(B());var Vfe=Al(kc,"drawdown"),wG=({trades:e,height:t=300,dateFormat:r})=>xG.default.createElement(Vfe,{trades:e,dateFormat:r,height:t});var SG=_(B());var kG=({data:e,height:t=300})=>SG.default.createElement(gb,{data:e,height:t});var CG=_(B());var Gfe=Al(fb,"trades"),TG=({trades:e,height:t=300,dateFormat:r})=>CG.default.createElement(Gfe,{trades:e,dateFormat:r,height:t,onPointClick:(n,a)=>{n!=null&&n.path}});Ea();Ct();var PG=({data:e,trades:t,updateData:r,openNote:n,dateFormat:a="DDMMYY"})=>{let{currency:o}=Ae(),i=(0,ae.useMemo)(()=>a||Ot(),[a]),s=(0,ae.useMemo)(()=>t.filter(f=>!ct({tradeStatus:f.tradeStatus,exitTime:f.exitTime,pnl:f._originalPnlWasNull?null:f.pnl,useDirectPnLInput:f.useDirectPnLInput,exits:f.exits})),[t]),l=hg(s),c=()=>{var f;try{let b=window.app;return(f=b==null?void 0:b.plugins)==null?void 0:f.plugins.journalit}catch(b){return console.error("Could not access plugin instance:",b),null}},d=(0,ae.useMemo)(()=>{if(s.length===0)return{returnOnLongs:0,returnOnShorts:0,biggestProfit:0,biggestLoss:0,profitLossRatio:0};let f=s.filter(L=>L.direction==="Long"),b=s.filter(L=>L.direction==="Short"),v=s.filter(L=>L.pnl>0),y=s.filter(L=>L.pnl<0),g=f.reduce((L,N)=>L+N.pnl,0),w=b.reduce((L,N)=>L+N.pnl,0),C=f.reduce((L,N)=>N.entryPrice&&N.positionSize?L+N.entryPrice*N.positionSize:L+Math.abs(N.pnl)*5,0),k=b.reduce((L,N)=>N.entryPrice&&N.positionSize?L+N.entryPrice*N.positionSize:L+Math.abs(N.pnl)*5,0),x=C>0?g/C*100:0,S=k>0?w/k*100:0,T=v.length>0?Math.max(...v.map(L=>L.pnl)):0,P=y.length>0?Math.min(...y.map(L=>L.pnl)):0,M=v.length>0?v.reduce((L,N)=>L+N.pnl,0)/v.length:0,D=y.length>0?Math.abs(y.reduce((L,N)=>L+N.pnl,0)/y.length):0,A=D>0?M/D:0;return{returnOnLongs:x,returnOnShorts:S,biggestProfit:T,biggestLoss:P,profitLossRatio:A}},[s]),u=(0,ae.useMemo)(()=>{if(s.length===0)return[];let f=new Map;s.forEach(v=>{let y=Array.isArray(v.setup)?[...v.setup]:v.setup?[v.setup]:[];y.length===0&&y.push("Other"),y.forEach(g=>{if(!g)return;let w=f.get(g)||{pnl:0,wins:0,losses:0,tradeCount:0};w.pnl+=v.pnl,w.tradeCount++,v.pnl>0?w.wins++:v.pnl<0&&w.losses++,f.set(g,w)})});let b=[];return f.forEach((v,y)=>{let g=v.tradeCount>0?v.wins/v.tradeCount*100:0;b.push({name:y,pnl:v.pnl,winRate:g,tradeCount:v.tradeCount})}),b.sort((v,y)=>y.pnl-v.pnl),b},[s]),p=(0,ae.useMemo)(()=>{if(s.length===0)return null;let f=s.filter(b=>b.pnl>0);return f.length===0?null:f.reduce((b,v)=>v.pnl>b.pnl?v:b,f[0])},[s]),m=(0,ae.useMemo)(()=>{if(s.length===0)return null;let f=s.filter(b=>b.pnl<0);return f.length===0?null:f.reduce((b,v)=>v.pnl<b.pnl?v:b,f[0])},[s]),h=(0,ae.useMemo)(()=>{if(s.length===0)return[];let f=new Map;s.forEach(v=>{var g;let y=Fe(v.entryTime,i);f.has(y)||f.set(y,[]),(g=f.get(y))==null||g.push(v)});let b=[];return f.forEach((v,y)=>{var D;let g=v.filter(A=>A.pnl>0),w=v.filter(A=>A.pnl<0),C=g.reduce((A,L)=>A+L.pnl,0),k=w.reduce((A,L)=>A+Math.abs(L.pnl),0),x=v.length>0?g.length/v.length:0,S=k>0?C/k:C>0?1/0:0,T=v.reduce((A,L)=>A+L.pnl,0),P=((D=v[0])==null?void 0:D.entryTime)||new Date,M;try{let A=c();A!=null&&A.drcService&&(M=A.drcService.getDRCNotePath(P))}catch(A){console.error(`Error getting DRC path for date ${y}:`,A)}b.push({date:y,rawDate:P,tradeCount:v.length,winRate:x,profitFactor:S,pnl:T,drcPath:M})}),b.sort((v,y)=>y.rawDate.getTime()-v.rawDate.getTime()),b},[s,i]);return ae.default.createElement("div",{className:"weekly-review-overview"},ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Cumulative P&L"),s.length>0?ae.default.createElement(bG,{trades:s,height:300,dateFormat:i}):ae.default.createElement(Ie,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Drawdown"),s.length>0?ae.default.createElement(wG,{trades:s,height:250,dateFormat:i}):ae.default.createElement(Ie,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Performance"),ae.default.createElement("div",{className:"weekly-review-metric-cards"},ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Net P&L"),ae.default.createElement("div",{className:"weekly-review-metric-value",style:{color:l.netPnL>=0?"var(--color-green)":"var(--color-red)"}},ue(l.netPnL,!0,o))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Win Rate"),ae.default.createElement("div",{className:"weekly-review-metric-value"},Pr(l.winRate*100))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Profit Factor"),ae.default.createElement("div",{className:"weekly-review-metric-value"},l.profitFactor.toFixed(2))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Expectancy"),ae.default.createElement("div",{className:"weekly-review-metric-value"},ue(l.expectancy,!0,o))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Total Trades"),ae.default.createElement("div",{className:"weekly-review-metric-value"},l.numTrades)),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Win"),ae.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-green)"}},ue(l.avgWin,!0,o))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Loss"),ae.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-red)"}},ue(-l.avgLoss,!0,o))),ae.default.createElement("div",{className:"weekly-review-metric-card"},ae.default.createElement("div",{className:"weekly-review-metric-label"},"P/L Ratio"),ae.default.createElement("div",{className:"weekly-review-metric-value",style:{color:d.profitLossRatio>=1?"var(--color-green)":"var(--color-red)"}},d.profitLossRatio.toFixed(2))))),u.length>0?ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),ae.default.createElement(kG,{data:u,height:250}),ae.default.createElement("div",{className:"weekly-review-setup-table"},ae.default.createElement("table",null,ae.default.createElement("thead",null,ae.default.createElement("tr",null,ae.default.createElement("th",null,"Setup"),ae.default.createElement("th",null,"P&L"),ae.default.createElement("th",null,"Win %"),ae.default.createElement("th",null,"Trades"))),ae.default.createElement("tbody",null,u.slice(0,5).map((f,b)=>ae.default.createElement("tr",{key:`setup-${b}`},ae.default.createElement("td",null,f.name),ae.default.createElement("td",{style:{color:f.pnl>=0?"var(--color-green)":"var(--color-red)"}},ue(f.pnl,!0,o)),ae.default.createElement("td",null,Pr(f.winRate)),ae.default.createElement("td",null,f.tradeCount))))))):t.length>0?ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),ae.default.createElement(Ie,{message:"No setup data available",subMessage:"Add setup tags to your trades to see performance metrics by setup",iconSize:40})):null,ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Trades"),t.length>0?ae.default.createElement(TG,{trades:t,height:300,dateFormat:i}):ae.default.createElement(Ie,{message:"No trades for this week",subMessage:"Track your individual trades to see them visualized here",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var b;let f=c();(b=f==null?void 0:f.views)!=null&&b.openTradeForm&&f.views.openTradeForm()}:void 0})),ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Best Trade of the Week"),p?ae.default.createElement("div",{className:"weekly-review-best-trade best-trade"},ae.default.createElement("div",{className:"weekly-review-best-trade-header"},ae.default.createElement("div",{className:"weekly-review-best-trade-title"},p.instrument||"Unknown"," (",p.direction,")"),ae.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-green)"}},ue(p.pnl,!0,o))),ae.default.createElement("div",{className:"weekly-review-best-trade-details"},ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},Fe(p.entryTime,i))),ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},p.setup&&Array.isArray(p.setup)?p.setup.join(", "):p.setup||"N/A")),p.exitTime&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let f=p.exitTime.getTime()-p.entryTime.getTime(),b=Math.floor(f/(1e3*60*60)),v=Math.floor(f%(1e3*60*60)/(1e3*60));return`${b}h ${v}m`})())),p.ctags&&p.ctags.length>0&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},p.ctags.join(", "))),p.mistake&&p.mistake.length>0&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},p.mistake.join(", ")))),ae.default.createElement("div",{className:"weekly-review-best-trade-actions"},ae.default.createElement("button",{className:"weekly-review-view-button",onClick:()=>n&&n(p.path,!0),disabled:!n},"View Trade Details"))):ae.default.createElement(Ie,{message:"No winning trades this week",subMessage:"Your best trades will appear here once you've logged some profitable trades",iconSize:40})),ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Worst Trade of the Week"),m?ae.default.createElement("div",{className:"weekly-review-best-trade worst-trade"},ae.default.createElement("div",{className:"weekly-review-best-trade-header"},ae.default.createElement("div",{className:"weekly-review-best-trade-title"},m.instrument||"Unknown"," (",m.direction,")"),ae.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-red)"}},ue(m.pnl,!0,o))),ae.default.createElement("div",{className:"weekly-review-best-trade-details"},ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},Fe(m.entryTime,i))),ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},m.setup&&Array.isArray(m.setup)?m.setup.join(", "):m.setup||"N/A")),m.exitTime&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let f=m.exitTime.getTime()-m.entryTime.getTime(),b=Math.floor(f/(1e3*60*60)),v=Math.floor(f%(1e3*60*60)/(1e3*60));return`${b}h ${v}m`})())),m.ctags&&m.ctags.length>0&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},m.ctags.join(", "))),m.mistake&&m.mistake.length>0&&ae.default.createElement("div",{className:"weekly-review-best-trade-detail"},ae.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),ae.default.createElement("span",{className:"weekly-review-best-trade-value"},m.mistake.join(", ")))),ae.default.createElement("div",{className:"weekly-review-best-trade-actions"},ae.default.createElement("button",{className:"weekly-review-view-button",onClick:()=>n&&n(m.path,!0),disabled:!n},"View Trade Details"))):ae.default.createElement(Ie,{message:"No losing trades this week",subMessage:"Your least successful trades will appear here to help you learn and improve",iconSize:40})),ae.default.createElement("div",{className:"weekly-review-section"},ae.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Performance"),h.length>0?ae.default.createElement("div",{className:"weekly-review-trades-table"},ae.default.createElement("table",null,ae.default.createElement("thead",null,ae.default.createElement("tr",null,ae.default.createElement("th",null,"Date"),ae.default.createElement("th",null,"Trades"),ae.default.createElement("th",null,"Win%"),ae.default.createElement("th",null,"Profit Factor"),ae.default.createElement("th",null,"P&L"))),ae.default.createElement("tbody",null,h.map((f,b)=>ae.default.createElement("tr",{key:`day-${b}`,className:"weekly-review-trade-row",onClick:()=>{n&&f.drcPath&&n(f.drcPath,!0)},style:{cursor:n?"pointer":"default"}},ae.default.createElement("td",null,f.date),ae.default.createElement("td",null,f.tradeCount),ae.default.createElement("td",null,Pr(f.winRate*100)),ae.default.createElement("td",null,f.profitFactor===1/0?"\u221E":f.profitFactor.toFixed(2)),ae.default.createElement("td",{style:{color:f.pnl>=0?"var(--color-green)":"var(--color-red)"}},ue(f.pnl,!0,o))))))):ae.default.createElement(Ie,{message:"No trades for this week",subMessage:"Your daily trading performance will appear here once you've logged trades",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var b;let f=c();(b=f==null?void 0:f.views)!=null&&b.openTradeForm&&f.views.openTradeForm()}:void 0})))};var Oe=_(B());Ft();var DG=({data:e,drcs:t,updateData:r,openNote:n,dateFormat:a="DDMMYY"})=>{let o=(0,Oe.useMemo)(()=>a||Ot(),[a]),[i,s]=(0,Oe.useState)(""),l=(u,p)=>{let m={...e.reviewQuestions||{}};m[u]=p,r({reviewQuestions:m})},c=()=>{if(!i.trim())return;let u=[...e.nextWeekGoals||[]];u.push(i),r({nextWeekGoals:u}),s("")},d=u=>{let p=[...e.nextWeekGoals||[]];p.splice(u,1),r({nextWeekGoals:p})};return Oe.default.createElement("div",{className:"weekly-review-review"},Oe.default.createElement("div",{className:"weekly-review-section"},Oe.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Reviews For This Week"),t.length===0?Oe.default.createElement(Ie,{message:"No daily reviews found for this week",subMessage:"Daily reviews will appear here once you've created them",iconSize:40,actionButtonText:n?"Create Daily Review":void 0,onActionButtonClick:n?()=>{var p,m,h;let u=typeof window!="undefined"?(m=(p=window==null?void 0:window.app)==null?void 0:p.plugins)==null?void 0:m.plugins.journalit:null;(h=u==null?void 0:u.drcService)!=null&&h.createDRCForDate&&u.drcService.createDRCForDate(new Date)}:void 0}):Oe.default.createElement("div",{className:"weekly-review-drc-list",style:{width:"100%",boxSizing:"border-box"}},t.map((u,p)=>Oe.default.createElement("div",{key:`drc-${p}`,className:"weekly-review-drc-card"},Oe.default.createElement("div",{className:"weekly-review-drc-header"},Oe.default.createElement("h4",{className:"weekly-review-drc-date"},new Date(u.data.date).toLocaleDateString(void 0,{weekday:"short"})," - ",Fe(new Date(u.data.date),o)),Oe.default.createElement("div",{className:"weekly-review-drc-grades"},Oe.default.createElement("span",{className:`weekly-review-drc-grade grade-${(u.data.mentalGrade||"").toString().toLowerCase()}`,"data-grade":u.data.mentalGrade},"Mental: ",u.data.mentalGrade||"N/A"),Oe.default.createElement("span",{className:`weekly-review-drc-grade grade-${(u.data.technicalGrade||"").toString().toLowerCase()}`,"data-grade":u.data.technicalGrade},"Technical: ",u.data.technicalGrade||"N/A")),Oe.default.createElement("div",{className:"weekly-review-drc-actions"},Oe.default.createElement("button",{className:"weekly-review-drc-button",onClick:()=>n&&n(u.file.path,!0),disabled:!n},"View DRC"))),Oe.default.createElement("div",{className:"weekly-review-drc-summary"},u.data.reviewQuestions&&Object.entries(u.data.reviewQuestions).slice(0,2).map(([m,h],f)=>Oe.default.createElement("div",{key:`drc-review-${p}-${f}`,className:"weekly-review-drc-section"},Oe.default.createElement("div",{className:"weekly-review-drc-section-label"},m),Oe.default.createElement("div",{className:"weekly-review-drc-section-content"},h||"No answer provided")))))))),Oe.default.createElement("div",{className:"weekly-review-section"},Oe.default.createElement("h3",{className:"weekly-review-section-title"},"Performance Self-Assessment"),Oe.default.createElement("div",{className:"weekly-review-grades"},Oe.default.createElement("div",{className:"weekly-review-grade-row"},Oe.default.createElement("div",{className:"weekly-review-grade-item"},Oe.default.createElement("div",{className:"weekly-review-grade-label"},"Mental Performance"),Oe.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(u=>{let p=e.mentalGrade||0,m="weekly-review-star";return p>=u?m+=" full":p>=u-.5&&(m+=" half"),Oe.default.createElement("span",{key:`mental-${u}`,className:m,onClick:()=>r({mentalGrade:u}),onContextMenu:h=>{h.preventDefault(),r({mentalGrade:u-.5})}},"\u2605")})),Oe.default.createElement("textarea",{className:"weekly-review-textarea",value:e.mentalNotes||"",onChange:u=>r({mentalNotes:u.target.value}),placeholder:"Notes about your mental performance..."})),Oe.default.createElement("div",{className:"weekly-review-grade-item"},Oe.default.createElement("div",{className:"weekly-review-grade-label"},"Technical Execution"),Oe.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(u=>{let p=e.technicalGrade||0,m="weekly-review-star";return p>=u?m+=" full":p>=u-.5&&(m+=" half"),Oe.default.createElement("span",{key:`technical-${u}`,className:m,onClick:()=>r({technicalGrade:u}),onContextMenu:h=>{h.preventDefault(),r({technicalGrade:u-.5})}},"\u2605")})),Oe.default.createElement("textarea",{className:"weekly-review-textarea",value:e.technicalNotes||"",onChange:u=>r({technicalNotes:u.target.value}),placeholder:"Notes about your technical execution..."}))))),Oe.default.createElement("div",{className:"weekly-review-section"},Oe.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Review Questions"),Oe.default.createElement("div",{className:"weekly-review-questions"},Object.keys(e.reviewQuestions||{}).length>0?Oe.default.createElement("div",{className:"weekly-review-question-list"},Object.entries(e.reviewQuestions||{}).map(([u,p],m)=>Oe.default.createElement("div",{key:`question-${m}`,className:"weekly-review-question"},Oe.default.createElement("div",{className:"weekly-review-question-header"},Oe.default.createElement("h4",{className:"weekly-review-question-text"},u)),Oe.default.createElement("textarea",{value:p||"",onChange:h=>l(u,h.target.value),placeholder:"Your answer here...",className:"weekly-review-textarea",rows:4})))):Oe.default.createElement(Ie,{message:"No review questions configured",subMessage:"Add review questions in the Weekly Review settings tab",iconSize:40}),Oe.default.createElement("p",{className:"weekly-review-info-text"},"Review questions can be configured in the Weekly Review settings tab."))),Oe.default.createElement("div",{className:"weekly-review-section"},Oe.default.createElement("h3",{className:"weekly-review-section-title"},"Goals for Next Week"),Oe.default.createElement("div",{className:"weekly-review-goals"},e.nextWeekGoals&&e.nextWeekGoals.length>0?Oe.default.createElement("div",{className:"weekly-review-goals-list"},e.nextWeekGoals.map((u,p)=>Oe.default.createElement("div",{key:`goal-${p}`,className:"weekly-review-goal-item"},Oe.default.createElement("div",{className:"weekly-review-goal-text"},u),Oe.default.createElement("button",{className:"weekly-review-goal-remove",onClick:()=>d(p)},"Remove")))):Oe.default.createElement(Ie,{message:"No goals set for next week",subMessage:"Define clear goals to focus your trading",iconSize:38,actionButtonText:"Add Your First Goal",onActionButtonClick:()=>{let u=document.querySelector(".weekly-review-input");u instanceof HTMLElement&&u.focus()}}),Oe.default.createElement("div",{className:"weekly-review-add-goal"},Oe.default.createElement("input",{type:"text",value:i,onChange:u=>s(u.target.value),placeholder:"Add a goal for next week",className:"weekly-review-input"}),Oe.default.createElement("button",{className:"weekly-review-add-button",onClick:c,disabled:!i.trim()},"Add Goal")))),Oe.default.createElement("div",{className:"weekly-review-section weekly-review-mark-reviewed-section"},Oe.default.createElement(hl,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:()=>{r({reviewed:!0,reviewedAt:new Date().toISOString()})}})))};Tm();pv();var mO=require("obsidian"),EG=({data:e,trades:t=[],drcs:r=[],filePath:n,openNote:a,plugin:o})=>{let i="WeeklyReview",s=Em(i,"general"),[l,c]=(0,Bn.useState)(e.previousGoals||null),d=(0,Bn.useRef)(null),[u,p]=(0,Bn.useState)(n||"unknown"),m=(0,Bn.useRef)(!1),{service:h}=qB(),f=Bn.default.useMemo(()=>{var k;try{let x={...e};if(e.forecast){x.forecast={monthly:{...e.forecast.monthly},weekly:{...e.forecast.weekly},daily:{...e.forecast.daily}},e.forecast.customTimeframes&&(x.forecast.customTimeframes={...e.forecast.customTimeframes});let S=T=>{T&&(T.imagePath&&!T.images?(T.images=[(0,mO.normalizePath)(T.imagePath)],delete T.imagePath):Array.isArray(T.images)?T.images=T.images.map(P=>(0,mO.normalizePath)(P)):T.images||(T.images=[]))};S(x.forecast.monthly),S(x.forecast.weekly),S(x.forecast.daily),(k=x.forecast)!=null&&k.customTimeframes&&Object.keys(x.forecast.customTimeframes).forEach(T=>{S(x.forecast.customTimeframes[T])})}return x}catch(x){return s(x,"Error normalizing data"),e}},[e]),b=Bn.default.useMemo(()=>{try{if(f.date){let k=f.date.split("-").map(S=>parseInt(S,10)),x=new Date(k[0],k[1]-1,k[2]);return x.getFullYear()!==k[0]||x.getMonth()!==k[1]-1||x.getDate()!==k[2]?(console.error(`Invalid date parsed from frontmatter: ${f.date}`),new Date):x}return new Date}catch(k){return s(k,"Error parsing date"),new Date}},[f.date]),v=(0,Bn.useCallback)(k=>{d.current=k;try{if(k&&!n){let x=k.getAttribute("data-displaying-file");if(x){p(x);return}let S=k.parentElement;for(;S;){let T=S.getAttribute("data-displaying-file")||S.getAttribute("data-file-path");if(T){p(T);break}S=S.parentElement}}}catch(x){s(x,"Error finding file path")}},[n]);(0,Bn.useEffect)(()=>{let k=async()=>{var x,S;try{if(h&&f.date){let T=f.date.split("-").map(N=>parseInt(N,10)),P=new Date(T[0],T[1]-1,T[2]);if(P.getFullYear()!==T[0]||P.getMonth()!==T[1]-1||P.getDate()!==T[2]){console.error(`Invalid date parsed from frontmatter when fetching previous goals: ${f.date}`);return}let M=new Date(P);M.setDate(P.getDate()-7);let D=h.getWeeklyReviewPath(M),A=o||((S=(x=window.app)==null?void 0:x.plugins)==null?void 0:S.plugins.journalit),L=A.app.vault.getAbstractFileByPath(D);if(L&&A.app.metadataCache.getFileCache(L)){let E=await h.extractWeeklyReviewData(L);E!=null&&E.nextWeekGoals&&c(E.nextWeekGoals)}}}catch(T){Bi({message:"Error fetching previous week goals",error:T,component:i,operation:"fetchPreviousWeekGoals",severity:"warning"})}};!m.current&&f.date&&!l&&(k(),m.current=!0)},[f.date,h,o,l]),(0,Bn.useEffect)(()=>{if(fv(),Du(),d.current){d.current.classList.add("weekly-review-mounted"),d.current.setAttribute("data-mounted-at",Date.now().toString());let k=d.current.closest(".journalit-weekly-review-view");k&&k.classList.add("weekly-review-mounted")}},[]);let y=k=>{let x=["January","February","March","April","May","June","July","August","September","October","November","December"],S=parseInt(k.toString())-1;return x[S]||k},g=`${f.week} Review, ${y(f.month)} ${f.year}`;return Bn.default.createElement("div",{className:"weekly-review-container",ref:v,"data-file-path":u,style:{margin:0}},Bn.default.createElement(C0,{data:f,filePath:u,openNote:a,plugin:o,serviceName:"weeklyReviewService",componentName:g,navigationOptions:{currentDate:b,getAdjacentReview:async k=>{try{if(h)return await h.getAdjacentWeeklyReview(b,k)}catch(x){s(x,"Error getting adjacent weekly review")}return null},getRelatedReviewPaths:{monthly:k=>{var x,S;try{let T=o||((S=(x=window.app)==null?void 0:x.plugins)==null?void 0:S.plugins.journalit);if(T!=null&&T.drcService)return T.drcService.getMonthlyReviewPath(k)}catch(T){s(T,"Error getting monthly review path")}return""},yearly:k=>{try{let x=k.getFullYear();return`!Journalit/${x}/Yearly-${x}.md`}catch(x){s(x,"Error getting yearly review path")}return""}}},tabConfig:[{id:"prepare",label:"Preparation",content:({data:k,updateData:x})=>Bn.default.createElement(gG,{data:k,updateData:x,previousWeekGoals:l})},{id:"overview",label:"Overview",content:({data:k,updateData:x,openNote:S})=>{var T,P;return Bn.default.createElement(PG,{data:k,trades:t,updateData:x,openNote:S,dateFormat:((P=(T=o==null?void 0:o.settings)==null?void 0:T.trade)==null?void 0:P.dateFormat)||"DDMMYY"})}},{id:"review",label:"Review",content:({data:k,updateData:x,openNote:S})=>{var T,P;return Bn.default.createElement(DG,{data:k,drcs:r,trades:t,updateData:x,openNote:S,dateFormat:((P=(T=o==null?void 0:o.settings)==null?void 0:T.trade)==null?void 0:P.dateFormat)||"DDMMYY"})}}],updateMethodName:"updateWeeklyReviewFrontmatter",className:{container:"weekly-review-content",header:{container:"weekly-review-header",title:"weekly-review-title",dateContainer:"weekly-review-date-container"},tabContainer:{container:"weekly-review-tabs-container",tabList:"weekly-review-tabs",tab:"weekly-review-tab",activeTab:"active"}}}))};gv();var _C=class extends qi{constructor(t,r){super(t),this.plugin=r}async renderComponent(t,r,n,a,o){await this.renderWeeklyReview(t,r,r.trades||[],r.drcs||[],n,a,o)}async renderWeeklyReview(t,r,n=[],a=[],o,i,s){try{if(!t||!t.isConnected)return;let l=s?`${o}-${i}-${s}`:`${o}-${i}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".weekly-review-container")||t.querySelector(".weekly-review-container"))return;fv();let u,p=t.closest(".workspace-leaf");p&&p.id&&(u=p.id,t.setAttribute("data-leaf-id",u)),t.setAttribute("data-weekly-protected","true"),t.setAttribute("data-displaying-file",o),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${o}-${i}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let m={...r};["plugin","app","_"].forEach(f=>{f in m&&delete m[f]});let h={...m,trades:n,drcs:a};this.createReactRoot(t,l,u,s,h,o)}catch(l){console.error("[WeeklyReview] Error rendering Weekly Review:",l),t.setText("Error rendering Weekly Review: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}createReactElement(t,r,n){let a=n||((o,i=!1)=>{this.plugin&&this.plugin.openFile(o,i)});return AG.default.createElement(EG,{data:t,trades:t.trades||[],drcs:t.drcs||[],filePath:r,openNote:a,plugin:this.plugin})}unmountWeeklyReview(t,r,n,a){return this.unmountComponent(t,r,n,a)}unmountAllWeeklyReviews(){this.unmountAllComponents()}};var BC=class extends Hi{constructor(t){super(t.app,t,new _C(t.app,t)),this.plugin=t}isValidComponentType(t){return t&&t.type==="weekly-review"}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}getComponentTypeIdentifier(){return"weekly-review"}async getAdditionalDataForComponent(t,r){let n=[],a=[];if(this.plugin.weeklyReviewService)try{let o=r.date.split("-").map(s=>parseInt(s,10)),i=new Date(o[0],o[1]-1,o[2]);if((i.getFullYear()!==o[0]||i.getMonth()!==o[1]-1||i.getDate()!==o[2])&&(console.error(`Invalid date parsed from frontmatter: ${r.date}`),i.setTime(new Date().getTime())),this.plugin.tradeService){let l=(await this.plugin.weeklyReviewService.getTradesForWeek(i)).map(async c=>{var d;try{let u=(d=this.app.metadataCache.getFileCache(c))==null?void 0:d.frontmatter;if(!u||u.type!=="trade")return null;let p=u.pnl===void 0||u.pnl===null;return{path:c.path,instrument:u.instrument||"Unknown",direction:u.direction||"Unknown",entryPrice:parseFloat(u.entryPrice)||0,exitPrice:u.exitPrice!==void 0&&u.exitPrice!==null?parseFloat(u.exitPrice):0,positionSize:parseFloat(u.positionSize)||0,pnl:u.pnl!==void 0&&u.pnl!==null?parseFloat(u.pnl):0,entryTime:u.entryTime?new Date(u.entryTime):new Date,exitTime:u.exitTime?new Date(u.exitTime):new Date(u.entryTime),setup:u.setup,mistake:u.mistake,ctags:u.ctags,tradeStatus:u.tradeStatus,useDirectPnLInput:u.useDirectPnLInput,exits:u.exits,_originalPnlWasNull:p}}catch(u){return console.error(`Error processing trade file ${c.path}:`,u),null}});n=(await Promise.all(l)).filter(Boolean)}a=await this.plugin.weeklyReviewService.getDRCsForWeek(i)}catch(o){console.error("[WeeklyReview] Error fetching additional data:",o)}return{trades:n,drcs:a}}async handleFileOpen(t,r=!1){if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;if(r){let s=`rendered-weekly-${t.path}-${Date.now()}`;if(window[s]=!1,Date.now()-window.__obsidianStartTime<5e3){setTimeout(()=>this.tryRenderActiveComponent(t,s),500),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s)},1500),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s),delete window[s]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(t,s),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s),delete window[s]},500)}let o=document.body,i=new MutationObserver(async(s,l)=>{var c;try{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}for(let p of Array.from(d)){let m=p.querySelector(".metadata-container");if(!m)continue;let h=m.closest(".workspace-leaf-content");if(!h)continue;let f=this.findContainingLeaf(h),b=(c=f==null?void 0:f.view)==null?void 0:c.containerEl,v=m.closest(".workspace-leaf"),g=(v==null?void 0:v.id)||(b==null?void 0:b.id)||null,w=this.getUniqueElementId(p),C=g?`leaf-${g}`:w,k=!0;if(f){let D=f.view,A=null;(D&&"file"in D||D&&"getViewType"in D&&D.getViewType()==="markdown")&&(A=D.file),A&&(k=A.path===t.path)}if(!k)continue;p.querySelectorAll(`.${this.getComponentClassName()}`).forEach(D=>{let A=D.getAttribute("data-file-path");if(A&&A!==t.path){let L=D.getAttribute("data-view-id"),N=D.getAttribute("data-leaf-id");L&&this.renderer.unmountComponent(A,L,N||void 0),D.remove()}});let x=Array.from(p.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`));if(x.length>1)for(let D=1;D<x.length;D++){let A=x[D],L=A.getAttribute("data-view-id"),N=A.getAttribute("data-leaf-id");L&&this.renderer.unmountComponent(t.path,L,N||void 0),A.remove()}let S=this.getWrapperClassName();if(p.querySelectorAll(`.${S}`).length>0)continue;let P=Array.from(p.querySelectorAll(`.${this.getComponentClassName()}`)).find(D=>D.getAttribute("data-file-path")===t.path);P||(P=document.createElement("div"),P.className=this.getComponentClassName(),P.style.marginTop="20px",P.style.marginBottom="20px",P.style.padding="10px",P.setAttribute("data-file-path",t.path),P.setAttribute("data-view-id",C),P.setAttribute("data-editor-id",w),P.setAttribute("data-view-mode","source"),g&&P.setAttribute("data-leaf-id",g),P.setAttribute("data-inserted-at",Date.now().toString()),P.style.margin="0",P.style.padding="0",P.style.border="none",P.style.width="100%",P.style.display="block",P.style.boxSizing="border-box",m.after(P));let M=await this.getAdditionalDataForComponent(t,a);this.renderer.renderComponent(P,{...a,...M},t.path,C,w),this.markFileRenderedInMode(t.path,"source")}l.disconnect();let u=this.activeObservers.indexOf(l);u>-1&&this.activeObservers.splice(u,1)}catch(d){console.error("[WeeklyReview] Error in MutationObserver:",d)}});this.activeObservers.push(i),i.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{i.disconnect();let s=this.activeObservers.indexOf(i);s>-1&&this.activeObservers.splice(s,1)},5e3)}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof vg.TFile))return;let a=this.app.metadataCache.getFileCache(n),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),h=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(h==null?void 0:h.id)||null,b=this.getUniqueElementId(c),v=f?`leaf-${f}`:b,y=!0;if(m){let S=m.view,T=null;("file"in S||S&&"getViewType"in S&&S.getViewType()==="markdown")&&(T=S.file),T&&(y=T.path===n.path)}if(!y)return;let g=this.getComponentClassName(),w=Array.from(c.querySelectorAll(`.${g}[data-file-path="${n.path}"]`));if(w.length>0){if(w.length>1)for(let S=1;S<w.length;S++){let T=w[S],P=T.getAttribute("data-view-id"),M=T.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(n.path,P,M||void 0),T.remove()}return}c.querySelectorAll(`.${g}`).forEach(S=>{let T=S.getAttribute("data-file-path");if(T&&T!==n.path){let P=S.getAttribute("data-view-id"),M=S.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(T,P,M||void 0),S.remove()}});let C=this.getWrapperClassName(),k=Array.from(c.querySelectorAll(`.${C}`));if(k.length>0&&k.some(T=>{var P;return((P=T.closest(`.${g}`))==null?void 0:P.getAttribute("data-file-path"))===n.path}))return;let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",v),x.setAttribute("data-markdown-view-id",b),x.setAttribute("data-view-mode","preview"),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),x.style.margin="0",x.style.padding="0",x.style.border="none",x.style.width="100%",x.style.display="block",x.style.boxSizing="border-box",c.insertBefore(x,c.firstChild);try{let S=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...S},n.path,v,b),this.markFileRenderedInMode(n.path,"preview")}catch(S){console.error(`[${this.constructor.name}] Error rendering component:`,S),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${S instanceof Error?S.message:String(S)}`}}}registerCurrentLeaves(){this.app.workspace.iterateAllLeaves(t=>{var a;let r=(a=t.view)==null?void 0:a.containerEl;r&&r.id&&this.registeredLeaves.add(r.id);let n=t.containerEl;n&&n.id&&n.id!==(r==null?void 0:r.id)&&this.registeredLeaves.add(n.id),(!r||!r.id)&&(!n||!n.id)&&(r&&!r.id?(r.id=`weekly-review-leaf-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,this.registeredLeaves.add(r.id)):n&&!n.id&&(n.id=`weekly-review-leaf-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,this.registeredLeaves.add(n.id)))})}async tryRenderWeeklyInActiveLeaf(t,r){try{let n=[];this.app.workspace.iterateAllLeaves(o=>{let i=null;(o.view&&"file"in o.view||o.view&&"getViewType"in o.view&&o.view.getViewType()==="markdown")&&(i=o.view.file),i&&i.path===t.path&&n.push(o)});let a=!1;for(let o of n){if(!o.view)continue;let i=o.view.getViewType()==="markdown",s=i?o.view.getMode:null,l=i&&typeof s=="function"?s.call(o.view)==="source":!1,c=l?"source":"preview";if(this.isFileRenderedInMode(t.path,c))return!0;let d=o.view.containerEl,u=`leaf-${d.id||this.generateViewId(d)}`;try{let p=await this.getAdditionalDataForComponent(t,r);if(l){let m=d.querySelector(".metadata-container");if(m){let h=d.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`),f=d.querySelectorAll(`.${this.getWrapperClassName()}`);if(h.length===0&&f.length===0){let b=document.createElement("div");b.className=this.getComponentClassName(),b.setAttribute("data-file-path",t.path),b.setAttribute("data-view-id",u),b.setAttribute("data-leaf-id",d.id||""),b.setAttribute("data-view-mode","source"),b.setAttribute("data-inserted-at",Date.now().toString()),b.style.margin="0",b.style.padding="0",b.style.border="none",b.style.width="100%",b.style.display="block",b.style.boxSizing="border-box",m.after(b),await this.renderer.renderComponent(b,{...r,...p},t.path,u),this.markFileRenderedInMode(t.path,"source"),a=!0}}}else if(i&&o.view instanceof vg.MarkdownView){let m=o.view;try{let h=m;typeof h.toggleSourceMode=="function"?(h.toggleSourceMode(),setTimeout(()=>h.toggleSourceMode(),50)):this.app.workspace.trigger("layout-change")}catch(h){console.error("[WeeklyReview] Error refreshing view:",h)}}}catch(p){console.error("[WeeklyReview] Error rendering in active leaf:",p)}}return a}catch(n){return console.error("[WeeklyReview] Error in tryRenderWeeklyInActiveLeaf:",n),!1}}async tryRenderActiveComponent(t,r){try{let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".weekly-review-container","weekly-review-mounted")){window[r]=!0;return}this.cleanupDuplicateComponents(t.path),await this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[WeeklyReview] Error in tryRenderActiveComponent:",n)}}async renderActiveComponent(){await this.renderActiveWeeklyReview()}async renderActiveWeeklyReview(){var f;this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="weekly-review")return;let a=this.getComponentClassName(),o=document.querySelectorAll(`.${a}[data-file-path="${t.path}"]`);if(o.length>0&&Array.from(o).some(v=>v.querySelector(".weekly-review-container"))){if(o.length>1)for(let v=1;v<o.length;v++){let y=o[v],g=y.getAttribute("data-view-id"),w=y.getAttribute("data-leaf-id");g&&this.renderer.unmountComponent(t.path,g,w||void 0),y.remove()}return}this.cleanupUnrelatedComponents(t.path);let i;try{i=this.app.workspace.getActiveViewOfType(vg.MarkdownView)}catch(b){console.error("[WeeklyReview] Error getting active view:",b);let v=this.app.workspace.activeLeaf;v&&v.view&&"getViewType"in v.view&&v.view.getViewType()==="markdown"&&(i=v.view)}if(!i)return;let s=i.containerEl.closest(".workspace-leaf-content");if(!s)return;let l=this.findContainingLeaf(s),c=(f=l==null?void 0:l.view)==null?void 0:f.containerEl,d=(c==null?void 0:c.id)||null,u=d?`leaf-${d}`:this.generateViewId(s),p=i.getMode,m=typeof p=="function"?p.call(i)==="source":!1,h=await this.getAdditionalDataForComponent(t,n);if(m){let b=i.containerEl.querySelector(".metadata-container");if(!b)return;let v=Array.from(i.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(g=>g.getAttribute("data-file-path")===t.path);if(v){if(v.querySelector(".weekly-review-container")){this.markFileRenderedInMode(t.path,"source");return}v.remove()}let y=document.createElement("div");y.className=this.getComponentClassName(),y.setAttribute("data-file-path",t.path),y.setAttribute("data-view-id",u),y.setAttribute("data-view-mode","source"),d&&y.setAttribute("data-leaf-id",d),y.style.margin="0",y.style.padding="0",y.style.border="none",y.style.width="100%",y.style.display="block",y.style.boxSizing="border-box",b.after(y),await this.renderer.renderComponent(y,{...n,...h},t.path,u),this.markFileRenderedInMode(t.path,"source")}else{let b=this.app.workspace.activeLeaf;if(b&&b.view instanceof vg.MarkdownView){let v=b.view;try{let y=v;typeof y.toggleSourceMode=="function"?(y.toggleSourceMode(),setTimeout(()=>y.toggleSourceMode(),50)):typeof y.updateDisplay=="function"?y.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(y){console.error("[WeeklyReview] Error refreshing markdown view:",y)}}}}};var vb=require("obsidian");var FG=_(B());var $a=_(B());var IG=_(B());Tw();var NG=({currentDate:e,navigateTo:t,getAdjacentMonthlyReview:r,getYearlyReviewPath:n})=>{let{handleNavigation:a,navigateToRelatedReview:o,isNavigating:i}=Cw({currentDate:e,navigateTo:t,getAdjacentReview:r});return IG.default.createElement(_m,{buttons:[{text:"Previous Month",action:()=>a(-1),icon:"left",disabled:i},{text:"Yearly Review",action:()=>{console.log("Yearly Review clicked - not yet implemented")},disabled:!1},{text:"Next Month",action:()=>a(1),icon:"right",disabled:i}],className:"monthly-review-navigation"})};var ce=_(B());er();Ft();Ea();Ct();var fO=Al(El,"pnl"),Yfe=Al(kc,"drawdown"),LG=({data:e,trades:t,weeklyPerformance:r,bestWeek:n,worstWeek:a,updateData:o,openNote:i,dateFormat:s="DDMMYY"})=>{let{currency:l}=Ae(),c=(0,ce.useMemo)(()=>s||Ot(),[s]),d=(0,ce.useMemo)(()=>t.filter(y=>!ct({tradeStatus:y.tradeStatus,exitTime:y.exitTime,pnl:y._originalPnlWasNull?null:y.pnl,useDirectPnLInput:y.useDirectPnLInput,exits:y.exits})),[t]),u=(0,ce.useMemo)(()=>hg(d),[d]),p=(0,ce.useMemo)(()=>{if(d.length===0)return[];let y=new Map;d.forEach(w=>{let C=Array.isArray(w.setup)?[...w.setup]:w.setup?[w.setup]:[];C.length===0&&C.push("Other"),C.forEach(k=>{if(!k)return;let x=y.get(k)||{pnl:0,wins:0,losses:0,tradeCount:0};x.pnl+=w.pnl||0,x.tradeCount++,(w.pnl||0)>0?x.wins++:(w.pnl||0)<0&&x.losses++,y.set(k,x)})});let g=[];return y.forEach((w,C)=>{let k=w.tradeCount>0?w.wins/w.tradeCount*100:0;g.push({name:C,pnl:w.pnl,winRate:k,tradeCount:w.tradeCount})}),g.sort((w,C)=>C.pnl-w.pnl)},[d]),m=(0,ce.useMemo)(()=>{let y=d.filter(g=>(g.pnl||0)>0);return y.length===0?null:y.reduce((g,w)=>(w.pnl||0)>(g.pnl||0)?w:g)},[d]),h=(0,ce.useMemo)(()=>{let y=d.filter(g=>(g.pnl||0)<0);return y.length===0?null:y.reduce((g,w)=>(w.pnl||0)<(g.pnl||0)?w:g)},[d]),f=(0,ce.useMemo)(()=>d.filter(y=>{var g;return((g=y.direction)==null?void 0:g.toLowerCase())==="long"}),[d]),b=(0,ce.useMemo)(()=>d.filter(y=>{var g;return((g=y.direction)==null?void 0:g.toLowerCase())==="short"}),[d]),v=e.date?new Date(e.date).toLocaleDateString("en-US",{month:"long",year:"numeric"}):new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"});return ce.default.createElement("div",{className:"monthly-review-overview"},ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Cumulative P&L"),d.length>0?ce.default.createElement(fO,{trades:d,height:300,dateFormat:c}):ce.default.createElement(Ie,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Drawdown"),d.length>0?ce.default.createElement(Yfe,{trades:d,height:250,dateFormat:c}):ce.default.createElement(Ie,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Performance"),ce.default.createElement("div",{className:"monthly-review-metric-cards"},ce.default.createElement("div",{className:"monthly-review-metric-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Net P&L"),ce.default.createElement("div",{className:"monthly-review-metric-value",style:{color:u.netPnL>=0?"var(--color-green)":"var(--color-red)"}},ue(u.netPnL,!0,l))),ce.default.createElement("div",{className:"monthly-review-metric-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Win Rate"),ce.default.createElement("div",{className:"monthly-review-metric-value"},Pr(u.winRate*100))),ce.default.createElement("div",{className:"monthly-review-metric-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Profit Factor"),ce.default.createElement("div",{className:"monthly-review-metric-value"},u.profitFactor.toFixed(2))),ce.default.createElement("div",{className:"monthly-review-metric-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Total Trades"),ce.default.createElement("div",{className:"monthly-review-metric-value"},u.numTrades)))),p.length>0&&ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Setup Performance"),ce.default.createElement(gb,{data:p,height:250})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Winner of ",v),m?ce.default.createElement("div",{className:"monthly-review-best-trade best-trade"},ce.default.createElement("div",{className:"monthly-review-best-trade-header"},ce.default.createElement("div",{className:"monthly-review-best-trade-title"},m.instrument||"Unknown"," (",m.direction,")"),ce.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-green)"}},ue(m.pnl||0,!0,l))),ce.default.createElement("div",{className:"monthly-review-best-trade-details"},ce.default.createElement("div",{className:"monthly-review-best-trade-detail"},ce.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),ce.default.createElement("span",{className:"monthly-review-best-trade-value"},Fe(m.entryTime,c))),ce.default.createElement("div",{className:"monthly-review-best-trade-detail"},ce.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),ce.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(m.setup)?m.setup.join(", "):m.setup||"N/A"))),i&&m.path&&ce.default.createElement("div",{className:"monthly-review-best-trade-actions"},ce.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>i(m.path,!0)},"View Trade Details"))):ce.default.createElement(Ie,{message:"No winning trades this month",subMessage:"Your best trades will appear here",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Loser of ",v),h?ce.default.createElement("div",{className:"monthly-review-best-trade worst-trade"},ce.default.createElement("div",{className:"monthly-review-best-trade-header"},ce.default.createElement("div",{className:"monthly-review-best-trade-title"},h.instrument||"Unknown"," (",h.direction,")"),ce.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-red)"}},ue(h.pnl||0,!0,l))),ce.default.createElement("div",{className:"monthly-review-best-trade-details"},ce.default.createElement("div",{className:"monthly-review-best-trade-detail"},ce.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),ce.default.createElement("span",{className:"monthly-review-best-trade-value"},Fe(h.entryTime,c))),ce.default.createElement("div",{className:"monthly-review-best-trade-detail"},ce.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),ce.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(h.setup)?h.setup.join(", "):h.setup||"N/A"))),i&&h.path&&ce.default.createElement("div",{className:"monthly-review-best-trade-actions"},ce.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>i(h.path,!0)},"View Trade Details"))):ce.default.createElement(Ie,{message:"No losing trades this month",subMessage:"Your worst trades will appear here",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Performance Highlights"),ce.default.createElement("div",{className:"monthly-review-week-highlights"},n&&ce.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Best Performing Week"),ce.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-green)"}},"Week ",n.weekNumber),ce.default.createElement("div",{className:"monthly-review-metric-detail"},ue(n.pnl,!0,l)),i&&n.weeklyReviewPath&&ce.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>i(n.weeklyReviewPath,!0)},"View Week")),a&&ce.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},ce.default.createElement("div",{className:"monthly-review-metric-label"},"Worst Performing Week"),ce.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-red)"}},"Week ",a.weekNumber),ce.default.createElement("div",{className:"monthly-review-metric-detail"},ue(a.pnl,!0,l)),i&&a.weeklyReviewPath&&ce.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>i(a.weeklyReviewPath,!0)},"View Week")))),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Long Only Performance"),f.length>0?ce.default.createElement(fO,{trades:f,height:250,dateFormat:c}):ce.default.createElement(Ie,{message:"No long trades this month",subMessage:"Your long trade performance will appear here",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Short Only Performance"),b.length>0?ce.default.createElement(fO,{trades:b,height:250,dateFormat:c}):ce.default.createElement(Ie,{message:"No short trades this month",subMessage:"Your short trade performance will appear here",iconSize:40})),ce.default.createElement("div",{className:"monthly-review-section"},ce.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Breakdown"),r.length>0?ce.default.createElement("div",{className:"monthly-review-trades-table"},ce.default.createElement("table",null,ce.default.createElement("thead",null,ce.default.createElement("tr",null,ce.default.createElement("th",null,"Week"),ce.default.createElement("th",null,"Trades"),ce.default.createElement("th",null,"Win%"),ce.default.createElement("th",null,"Profit Factor"),ce.default.createElement("th",null,"P&L"))),ce.default.createElement("tbody",null,r.map((y,g)=>ce.default.createElement("tr",{key:`week-${g}`,className:"monthly-review-trade-row",onClick:()=>{i&&y.weeklyReviewPath&&i(y.weeklyReviewPath,!0)},style:{cursor:i&&y.weeklyReviewPath?"pointer":"default"}},ce.default.createElement("td",null,"W",y.weekNumber),ce.default.createElement("td",null,y.trades),ce.default.createElement("td",null,Pr(y.winRate*100)),ce.default.createElement("td",null,y.profitFactor===1/0?"\u221E":y.profitFactor.toFixed(2)),ce.default.createElement("td",{style:{color:y.pnl>=0?"var(--color-green)":"var(--color-red)"}},ue(y.pnl,!0,l))))))):ce.default.createElement(Ie,{message:"No weekly data available",subMessage:"Your weekly performance breakdown will appear here",iconSize:40})))};var Pt=_(B());var qr=_(B()),gO=({title:e,data:t,type:r,openNote:n})=>{let a=l=>l==null?"N/A":l.toFixed(1),o=l=>r==="mental"?l.mentalGradeDistribution:l.technicalGradeDistribution,i=l=>r==="mental"?l.mentalRating:l.technicalRating,s=l=>r==="mental"?l.mentalNotes:l.technicalNotes;return qr.default.createElement("div",{className:"monthly-review-section"},qr.default.createElement("h3",{className:"monthly-review-section-title"},e),t.length>0?qr.default.createElement("div",{className:"monthly-review-trades-table"},qr.default.createElement("table",null,qr.default.createElement("thead",null,qr.default.createElement("tr",null,qr.default.createElement("th",null,"Week"),qr.default.createElement("th",null,"A Games"),qr.default.createElement("th",null,"B Games"),qr.default.createElement("th",null,"C Games"),qr.default.createElement("th",null,"Rating"),qr.default.createElement("th",null,"Notes"))),qr.default.createElement("tbody",null,t.map((l,c)=>{let d=o(l),u=i(l),p=s(l);return qr.default.createElement("tr",{key:`week-${l.weekNumber}`,className:"monthly-review-trade-row",onClick:()=>{n&&l.weeklyReviewPath&&n(l.weeklyReviewPath,!0)},style:{cursor:n&&l.weeklyReviewPath?"pointer":"default"}},qr.default.createElement("td",null,"W",l.weekNumber),qr.default.createElement("td",{className:"grade-count grade-a"},d.A),qr.default.createElement("td",{className:"grade-count grade-b"},d.B),qr.default.createElement("td",{className:"grade-count grade-c"},d.C),qr.default.createElement("td",{className:"rating-cell"},a(u)),qr.default.createElement("td",{className:"notes-cell"},p&&qr.default.createElement("div",{className:"notes-content"},p)))})))):qr.default.createElement("div",{className:"empty-performance-message"},"No performance data available for this month"))};var MG=({data:e,demonTrackerData:t,weeklyGamePerformance:r,updateData:n,openNote:a})=>{let o=["DEMON","1","2","3","4","5","STOP TRADING"];return Pt.default.createElement("div",{className:"monthly-review-review"},Pt.default.createElement("div",{className:"monthly-review-section"},Pt.default.createElement("h3",{className:"monthly-review-section-title"},"Demon Tracker"),Pt.default.createElement("p",{className:"monthly-review-section-description"},"Track your recurring mistakes to identify patterns and improve your trading discipline."),t.length>0?Pt.default.createElement("div",{className:"demon-tracker-container"},Pt.default.createElement("table",{className:"demon-tracker-table"},Pt.default.createElement("thead",null,Pt.default.createElement("tr",null,o.map((i,s)=>Pt.default.createElement("th",{key:`col-${s}`,className:`demon-tracker-header ${i==="STOP TRADING"?"stop-trading":""}`},i)))),Pt.default.createElement("tbody",null,t.map((i,s)=>Pt.default.createElement("tr",{key:`demon-${s}`,className:"demon-tracker-row"},Pt.default.createElement("td",{className:"demon-name"},i.mistake),[1,2,3,4,5].map(l=>Pt.default.createElement("td",{key:`occ-${l}`,className:"demon-occurrence"},i.occurrences>=l?Pt.default.createElement("span",{className:"demon-x"},"\u2717"):Pt.default.createElement("span",{className:"demon-empty"},"-"))),Pt.default.createElement("td",{className:"demon-occurrence stop-trading"},i.occurrences>=6?Pt.default.createElement("span",{className:"demon-x stop"},"\u2717"):Pt.default.createElement("span",{className:"demon-empty"},"-")))))),Pt.default.createElement("div",{className:"demon-tracker-summary"},Pt.default.createElement("div",{className:"demon-summary-item"},Pt.default.createElement("span",{className:"demon-summary-label"},"Total Unique Mistakes:"),Pt.default.createElement("span",{className:"demon-summary-value"},t.length)),Pt.default.createElement("div",{className:"demon-summary-item"},Pt.default.createElement("span",{className:"demon-summary-label"},"Total Mistake Occurrences:"),Pt.default.createElement("span",{className:"demon-summary-value"},t.reduce((i,s)=>i+s.occurrences,0))),t.filter(i=>i.occurrences>=6).length>0&&Pt.default.createElement("div",{className:"demon-summary-item warning"},Pt.default.createElement("span",{className:"demon-summary-label"},"Critical Mistakes (6+):"),Pt.default.createElement("span",{className:"demon-summary-value"},t.filter(i=>i.occurrences>=6).length)))):Pt.default.createElement(Ie,{message:"No mistakes tracked this month",subMessage:"Mistakes logged in your trades will appear here to help identify patterns",iconSize:40})),Pt.default.createElement(gO,{title:"Mental Game Performance",data:r,type:"mental",openNote:a}),Pt.default.createElement(gO,{title:"Technical Game Performance",data:r,type:"technical",openNote:a}),Pt.default.createElement("div",{className:"monthly-review-section monthly-review-mark-reviewed-section"},Pt.default.createElement(hl,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:()=>{n({reviewed:!0,reviewedAt:new Date().toISOString()})}})))};Ew();var OG=({data:e,trades:t,weeklyPerformance:r,weeklyGamePerformance:n,demonTrackerData:a,bestWeek:o,worstWeek:i,updateData:s,openNote:l,plugin:c,dateFormat:d})=>{let[u,p]=(0,$a.useState)("overview"),[m,h]=(0,$a.useState)(0),[f,b]=(0,$a.useState)(e);(0,$a.useEffect)(()=>{b(e)},[e.date,e.month,e.year]),(0,$a.useEffect)(()=>{hv()},[]),(0,$a.useEffect)(()=>{var S;let x=()=>{h(T=>T+1)};return(S=c==null?void 0:c.events)==null||S.on("settings-changed",x),()=>{var T;(T=c==null?void 0:c.events)==null||T.off("settings-changed",x)}},[c]);let v=async x=>{try{b(S=>({...S,...x})),await s(x)}catch(S){console.error("Error updating monthly review data:",S),b(e)}},y=[{id:"overview",label:"Overview"},{id:"review",label:"Review"}],g=f.date?new Date(f.date):new Date,w=g.toLocaleDateString("en-US",{month:"long",year:"numeric"});return $a.default.createElement("div",{className:"monthly-review",key:m},$a.default.createElement("h1",{className:"monthly-review-title"},w," Review"),$a.default.createElement(NG,{currentDate:g,navigateTo:(x,S)=>l==null?void 0:l(x,S),getAdjacentMonthlyReview:async x=>{let S=c==null?void 0:c.monthlyReviewService;return S?await S.getAdjacentMonthlyReview(g,x):null},getYearlyReviewPath:x=>""}),$a.default.createElement(w0,{tabs:y,activeTab:u,onTabChange:p,className:{container:"monthly-review-tabs-container",tabList:"monthly-review-tabs",tab:"monthly-review-tab",activeTab:"active"}}),$a.default.createElement("div",{className:"monthly-review-content"},u==="overview"&&$a.default.createElement(LG,{data:f,trades:t,weeklyPerformance:r,bestWeek:o,worstWeek:i,updateData:v,openNote:l,dateFormat:d}),u==="review"&&$a.default.createElement(MG,{data:f,demonTrackerData:a,weeklyGamePerformance:n,updateData:v,openNote:l})))};Yn();var $C=class extends qi{constructor(t){super(t.app),this.plugin=t}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}createReactElement(t,r,n){var m;let{trades:a,weeklyPerformance:o,weeklyGamePerformance:i,demonTrackerData:s,bestWeek:l,worstWeek:c}=t,d={type:t.type||"monthly-review",date:t.date,month:t.month,year:t.year,reviewQuestions:t.reviewQuestions,monthlyGoals:t.monthlyGoals,keyFocusAreas:t.keyFocusAreas,biggestAccomplishment:t.biggestAccomplishment,biggestChallenge:t.biggestChallenge,lessonsLearned:t.lessonsLearned,nextMonthGoals:t.nextMonthGoals,areasOfImprovement:t.areasOfImprovement,reviewed:t.reviewed,reviewedAt:t.reviewedAt},u=((m=this.plugin.settings)==null?void 0:m.dateFormat)||"DDMMYY",p=this.plugin.monthlyReviewService;return FG.default.createElement(OG,{data:d,trades:a||[],weeklyPerformance:o||[],weeklyGamePerformance:i||[],demonTrackerData:s||[],bestWeek:l||null,worstWeek:c||null,updateData:async h=>{p&&await p.updateMonthlyReviewFrontmatter(r,h)},openNote:n,plugin:this.plugin,dateFormat:u})}async renderComponent(t,r,n,a,o){hv(),t.addClass("journalit-monthly-review-container");let i=`${a}-${o||"default"}`;this.createReactRoot(t,i,void 0,o,r,n)}};var RC=class extends Hi{constructor(t){super(t.app,t,new $C(t)),this.plugin=t}isValidComponentType(t){return(t==null?void 0:t.type)==="monthly-review"}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}getComponentTypeIdentifier(){return"monthly-review"}async getAdditionalDataForComponent(t,r){if(!this.plugin.monthlyReviewService)return{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null};try{let n=await this.plugin.monthlyReviewService.getMonthlyDataOptimized(r.year,r.month);return{trades:n.trades,weeklyPerformance:n.weeklyPerformance,weeklyGamePerformance:n.weeklyGamePerformance,demonTrackerData:n.demonTrackerData,bestWeek:n.bestWeek,worstWeek:n.worstWeek}}catch(n){return console.error("[MonthlyReview] Error fetching additional data:",n),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async handleFileOpen(t,r){if(!t){this.cleanup();return}this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(this.isValidComponentType(a)){if(r||document.dispatchEvent(new CustomEvent("journalit:monthly-review-opened",{detail:{file:t.path,frontmatter:a}})),r){let o=`rendered-monthly-${t.path}-${Date.now()}`;if(window[o]=!1,Date.now()-(window.__obsidianStartTime||0)<5e3){setTimeout(()=>this.tryRenderActiveComponent(t,o),500),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o)},1500),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o),delete window[o]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(t,o),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o),delete window[o]},500)}await this.processMonthlyReviewNote(t,a,r)}}async processMonthlyReviewNote(t,r,n){let a=document.body,o=new MutationObserver(async(i,s)=>{var l;try{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}for(let u of Array.from(c)){let p=u.querySelector(".metadata-container");if(!p)continue;let m=p.closest(".workspace-leaf-content");if(!m)continue;let h=this.findContainingLeaf(m),f=(l=h==null?void 0:h.view)==null?void 0:l.containerEl,b=p.closest(".workspace-leaf"),y=(b==null?void 0:b.id)||(f==null?void 0:f.id)||null,g=this.getUniqueElementId(u),w=y?`leaf-${y}`:g,C=!0;if(h){let M=h.view,D=null;(M&&"file"in M||M&&"getViewType"in M&&M.getViewType()==="markdown")&&(D=M.file),D&&(C=D.path===t.path)}if(!C)continue;u.querySelectorAll(`.${this.getComponentClassName()}`).forEach(M=>{let D=M.getAttribute("data-file-path");if(D&&D!==t.path){let A=M.getAttribute("data-view-id"),L=M.getAttribute("data-leaf-id");A&&this.renderer.unmountComponent(D,A,L||void 0),M.remove()}});let k=Array.from(u.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`));if(k.length>1)for(let M=1;M<k.length;M++){let D=k[M],A=D.getAttribute("data-view-id"),L=D.getAttribute("data-leaf-id");A&&this.renderer.unmountComponent(t.path,A,L||void 0),D.remove()}let x=this.getWrapperClassName();if(u.querySelectorAll(`.${x}`).length>0)continue;let T=Array.from(u.querySelectorAll(`.${this.getComponentClassName()}`)).find(M=>M.getAttribute("data-file-path")===t.path);T||(T=document.createElement("div"),T.className=this.getComponentClassName(),T.style.marginTop="20px",T.style.marginBottom="20px",T.style.padding="10px",T.setAttribute("data-file-path",t.path),T.setAttribute("data-view-id",w),T.setAttribute("data-editor-id",g),T.setAttribute("data-view-mode","source"),y&&T.setAttribute("data-leaf-id",y),T.setAttribute("data-inserted-at",Date.now().toString()),T.style.margin="0",T.style.padding="0",T.style.border="none",T.style.width="100%",T.style.display="block",T.style.boxSizing="border-box",p.after(T));let P=await this.getAdditionalDataForComponent(t,r);this.renderer.renderComponent(T,{...r,...P},t.path,w,g),this.markFileRenderedInMode(t.path,"source")}s.disconnect();let d=this.activeObservers.indexOf(s);d>-1&&this.activeObservers.splice(d,1)}catch(c){console.error("[MonthlyReview] Error in MutationObserver:",c)}});this.activeObservers.push(o),o.observe(a,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect();let i=this.activeObservers.indexOf(o);i>-1&&this.activeObservers.splice(i,1)},5e3)}async renderActiveComponent(){var f;this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="monthly-review")return;let a=this.getComponentClassName(),o=document.querySelectorAll(`.${a}[data-file-path="${t.path}"]`);if(o.length>0&&Array.from(o).some(v=>v.querySelector(".journalit-monthly-review-container")||v.querySelector(".monthly-review")||v.querySelector(".monthly-review-wrapper"))){if(o.length>1)for(let v=1;v<o.length;v++){let y=o[v],g=y.getAttribute("data-view-id"),w=y.getAttribute("data-leaf-id");g&&this.renderer.unmountComponent(t.path,g,w||void 0),y.remove()}return}this.cleanupUnrelatedComponents(t.path);let i;try{i=this.app.workspace.getActiveViewOfType(vb.MarkdownView)}catch(b){console.error("[MonthlyReview] Error getting active view:",b);let v=this.app.workspace.activeLeaf;v&&v.view&&"getViewType"in v.view&&v.view.getViewType()==="markdown"&&(i=v.view)}if(!i)return;let s=i.containerEl.closest(".workspace-leaf-content");if(!s)return;let l=this.findContainingLeaf(s),c=(f=l==null?void 0:l.view)==null?void 0:f.containerEl,d=(c==null?void 0:c.id)||null,u=d?`leaf-${d}`:this.generateViewId(s),p=i.getMode,m=typeof p=="function"?p.call(i)==="source":!1,h=await this.getAdditionalDataForComponent(t,n);if(m){let b=i.containerEl.querySelector(".metadata-container");if(!b)return;let v=Array.from(i.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(g=>g.getAttribute("data-file-path")===t.path);if(v){if(v.querySelector(".journalit-monthly-review-container")||v.querySelector(".monthly-review")||v.querySelector(".monthly-review-wrapper")){this.markFileRenderedInMode(t.path,"source");return}v.remove()}let y=document.createElement("div");y.className=this.getComponentClassName(),y.setAttribute("data-file-path",t.path),y.setAttribute("data-view-id",u),y.setAttribute("data-view-mode","source"),d&&y.setAttribute("data-leaf-id",d),y.style.margin="0",y.style.padding="0",y.style.border="none",y.style.width="100%",y.style.display="block",y.style.boxSizing="border-box",b.after(y),await this.renderer.renderComponent(y,{...n,...h},t.path,u),this.markFileRenderedInMode(t.path,"source")}else{let b=this.app.workspace.activeLeaf;if(b&&b.view instanceof vb.MarkdownView){let v=b.view;try{let y=v;typeof y.toggleSourceMode=="function"?(y.toggleSourceMode(),setTimeout(()=>y.toggleSourceMode(),50)):typeof y.updateDisplay=="function"?y.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(y){console.error("[MonthlyReview] Error refreshing markdown view:",y)}}}}async tryRenderActiveComponent(t,r){try{let n=this.app.metadataCache.getFileCache(t),a=n==null?void 0:n.frontmatter;if(!a||!this.isValidComponentType(a))return;let o=this.getComponentClassName(),i=document.querySelectorAll(`.${o}[data-file-path="${t.path}"]`);if(i.length>0&&Array.from(i).some(l=>l.querySelector(".journalit-monthly-review-container")||l.querySelector(".monthly-review")||l.querySelector(".monthly-review-wrapper"))){window[r]=!0;return}this.cleanupUnrelatedComponents(t.path),await this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[MonthlyReview] Error in tryRenderActiveComponent:",n)}}cleanup(){super.cleanup()}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof vb.TFile))return;let a=this.app.metadataCache.getFileCache(n),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),h=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(h==null?void 0:h.id)||null,b=this.getUniqueElementId(c),v=f?`leaf-${f}`:b,y=!0;if(m){let S=m.view,T=null;("file"in S||S&&"getViewType"in S&&S.getViewType()==="markdown")&&(T=S.file),T&&(y=T.path===n.path)}if(!y)return;let g=this.getComponentClassName(),w=Array.from(c.querySelectorAll(`.${g}[data-file-path="${n.path}"]`));if(w.length>0){if(w.length>1)for(let S=1;S<w.length;S++){let T=w[S],P=T.getAttribute("data-view-id"),M=T.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(n.path,P,M||void 0),T.remove()}return}c.querySelectorAll(`.${g}`).forEach(S=>{let T=S.getAttribute("data-file-path");if(T&&T!==n.path){let P=S.getAttribute("data-view-id"),M=S.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(T,P,M||void 0),S.remove()}});let C=this.getWrapperClassName(),k=Array.from(c.querySelectorAll(`.${C}`));if(k.length>0&&k.some(T=>{var P;return((P=T.closest(`.${g}`))==null?void 0:P.getAttribute("data-file-path"))===n.path}))return;let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",v),x.setAttribute("data-markdown-view-id",b),x.setAttribute("data-view-mode","preview"),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),x.style.margin="0",x.style.padding="0",x.style.border="none",x.style.width="100%",x.style.display="block",x.style.boxSizing="border-box",c.insertBefore(x,c.firstChild);try{let S=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...S},n.path,v,b),this.markFileRenderedInMode(n.path,"preview")}catch(S){console.error(`[${this.constructor.name}] Error rendering component:`,S),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${S instanceof Error?S.message:String(S)}`}}}};var WC=class e{constructor(t,r){this._tradeNoteProcessor=null;this._drcNoteProcessor=null;this._weeklyReviewProcessor=null;this._monthlyReviewProcessor=null;this._missedTradeNoteProcessor=null;this.initializedProcessors=new Set;this.registeredLazyHandlers=new Set;this.customProcessors=new Map;this.customRenderers=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async initializeRequiredProcessors(){let t=this.app.workspace.getActiveFile(),r=!1,n=!1,a=!1,o=!1,i=!1;if(t){let s=this.app.metadataCache.getFileCache(t),l=s==null?void 0:s.frontmatter;l&&(l.type==="trade"?r=!0:l.type==="drc"?n=!0:l.type==="weekly-review"?a=!0:l.type==="monthly-review"?o=!0:(l.type==="missed-trade"||l.isMissedTrade===!0)&&(i=!0))}await this.getTradeNoteProcessor(),n?await this.getDRCNoteProcessor():this.registerLazyDRCProcessor(),a?await this.getWeeklyReviewProcessor():this.registerLazyWeeklyReviewProcessor(),o?await this.getMonthlyReviewProcessor():this.registerLazyMonthlyReviewProcessor(),i?await this.getMissedTradeNoteProcessor():this.registerLazyMissedTradeProcessor()}async getTradeNoteProcessor(){return this._tradeNoteProcessor||(this._tradeNoteProcessor=await pa(()=>{let t=new ry(this.app,this.plugin);return t.initialize(),t},"TradeNoteProcessor"),this.initializedProcessors.add("tradeNoteProcessor")),this._tradeNoteProcessor}async getDRCNoteProcessor(){return this._drcNoteProcessor||(this._drcNoteProcessor=await pa(()=>{let t=new zC(this.app,this.plugin);return t.initialize(),t},"DRCNoteProcessor"),this.initializedProcessors.add("drcNoteProcessor")),this._drcNoteProcessor}async getWeeklyReviewProcessor(){return this._weeklyReviewProcessor||(this._weeklyReviewProcessor=await pa(()=>{let t=new BC(this.plugin);return t.initialize(),t},"WeeklyReviewProcessor"),this.initializedProcessors.add("weeklyReviewProcessor")),this._weeklyReviewProcessor}async getMonthlyReviewProcessor(){return this._monthlyReviewProcessor||(this._monthlyReviewProcessor=await pa(()=>{let t=new RC(this.plugin);return t.initialize(),t},"MonthlyReviewProcessor"),this.initializedProcessors.add("monthlyReviewProcessor")),this._monthlyReviewProcessor}async getMissedTradeNoteProcessor(){return this._missedTradeNoteProcessor||(this._missedTradeNoteProcessor=await pa(()=>{let t=new qm(this.app,this.plugin);return t.initialize(),t},"MissedTradeNoteProcessor"),this.initializedProcessors.add("missedTradeNoteProcessor")),this._missedTradeNoteProcessor}registerLazyDRCProcessor(){if(this.registeredLazyHandlers.has("drc"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;a&&a.type==="drc"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("drc"),this.getDRCNoteProcessor().catch(o=>{console.error("Failed to initialize DRC processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("drc")}registerLazyWeeklyReviewProcessor(){if(this.registeredLazyHandlers.has("weekly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;a&&a.type==="weekly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("weekly-review"),this.getWeeklyReviewProcessor().catch(o=>{console.error("Failed to initialize Weekly Review processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("weekly-review")}registerLazyMonthlyReviewProcessor(){if(this.registeredLazyHandlers.has("monthly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;a&&a.type==="monthly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("monthly-review"),this.getMonthlyReviewProcessor().catch(o=>{console.error("Failed to initialize Monthly Review processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("monthly-review")}registerLazyMissedTradeProcessor(){if(this.registeredLazyHandlers.has("missed-trade"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;a&&(a.type==="missed-trade"||a.isMissedTrade===!0)&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("missed-trade"),this.getMissedTradeNoteProcessor().catch(o=>{console.error("Failed to initialize missed trade processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("missed-trade")}isProcessorInitialized(t){return this.initializedProcessors.has(t)}getAllInitializedProcessors(){return{tradeNoteProcessor:this._tradeNoteProcessor,drcNoteProcessor:this._drcNoteProcessor,weeklyReviewProcessor:this._weeklyReviewProcessor,monthlyReviewProcessor:this._monthlyReviewProcessor,missedTradeNoteProcessor:this._missedTradeNoteProcessor}}cleanupProcessors(){this._tradeNoteProcessor&&(this._tradeNoteProcessor.cleanup(),this._tradeNoteProcessor=null),this._drcNoteProcessor&&(this._drcNoteProcessor.cleanup(),this._drcNoteProcessor=null),this._weeklyReviewProcessor&&(this._weeklyReviewProcessor.cleanup(),this._weeklyReviewProcessor=null),this._monthlyReviewProcessor&&(this._monthlyReviewProcessor.cleanup(),this._monthlyReviewProcessor=null),this._missedTradeNoteProcessor&&(this._missedTradeNoteProcessor.cleanup(),this._missedTradeNoteProcessor=null),this.customProcessors.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customProcessors.clear(),this.customRenderers.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customRenderers.clear(),this.initializedProcessors.clear(),this.registeredLazyHandlers.clear()}registerProcessor(t,r){this.customProcessors.set(t,r),r&&typeof r.initialize=="function"&&r.initialize(),this.initializedProcessors.add(`${t}Processor`)}registerRenderer(t,r){this.customRenderers.set(t,r)}getRenderer(t){return this.customRenderers.has(t)?this.customRenderers.get(t):null}};var Yd=_(B());var jG=require("obsidian"),zG=_(vo()),yb=_(B());Ct();var Rd=class extends jG.ItemView{constructor(r,n={}){super(r);this.root=null;this.rootEl=null;this._pendingAnimationFrame=null;this._intervals=[];this.config={containerClass:"react-view-container",rootId:`react-root-${Date.now()}`,...n},this._themeChangeHandler=()=>this.renderComponent(),this._currencyChangeHandler=()=>this.renderComponent()}registerInterval(r){return this._intervals.push(r),r}clearInterval(r){window.clearInterval(r),this._intervals=this._intervals.filter(n=>n!==r)}async onOpen(){try{this.config.containerClass&&this.config.containerClass.trim()!==""&&this.containerEl.addClass(this.config.containerClass);let r=this.containerEl.querySelector(".view-content");r instanceof HTMLElement&&(r.style.display="none"),this.rootEl=this.containerEl.createDiv(),this.config.rootId&&(this.rootEl.id=this.config.rootId),this.rootEl&&(this.rootEl.style.height="100%",this.rootEl.style.display="flex",this.rootEl.style.flexDirection="column",this.rootEl.style.overflow="visible",this.rootEl.style.flex="1 1 auto",this.rootEl.style.minHeight="min-content"),this.containerEl instanceof HTMLElement&&(this.containerEl.style.height="100%",this.containerEl.style.overflowY="auto",this.containerEl.style.display="flex",this.containerEl.style.flexDirection="column"),this.root=(0,zG.createRoot)(this.rootEl),this.renderComponent(),document.addEventListener("theme-change",this._themeChangeHandler),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler),this.app.workspace.onLayoutReady(()=>{this._pendingAnimationFrame=window.requestAnimationFrame(()=>{this.renderComponent(),this._pendingAnimationFrame=null})})}catch(r){throw console.error("Failed to initialize React view:",r),r}}renderComponent(){if(!this.root){console.warn("Cannot render component: React root not initialized");return}if(!(!document.body.contains(this.containerEl)||!document.body.contains(this.rootEl)))try{let r=this.getRenderFunction();this.root.render(yb.default.createElement(yb.StrictMode,null,yb.default.createElement(Co,null,r())))}catch(r){console.error("Failed to render React component:",r)}}async onClose(){if(this._pendingAnimationFrame&&(window.cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=null),this._intervals&&(this._intervals.forEach(r=>window.clearInterval(r)),this._intervals=[]),this.root)try{this.root.unmount(),this.root=null}catch(r){console.error("Failed to unmount React component:",r)}return document.removeEventListener("theme-change",this._themeChangeHandler),window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler),Promise.resolve()}};Yn();var ar=_(B());var Jt=_(B());Fw();Ft();var bb=({dateRange:e,onChange:t})=>{let[r,n]=(0,Jt.useState)(!1),a=(0,Jt.useRef)(null),[o,i]=(0,Jt.useState)(!1),s=(0,Jt.useCallback)((f,b)=>{if(!f&&!b)return"allTime";let v=null,y=null;f&&(v=mn(f)),b&&(y=mn(b,!1));let g=new Date,w=mn(g);if(v&&y&&v.getFullYear()===w.getFullYear()&&v.getMonth()===w.getMonth()&&v.getDate()===w.getDate()&&y.getFullYear()===w.getFullYear()&&y.getMonth()===w.getMonth()&&y.getDate()===w.getDate())return"today";let C=new Date(g);C.setDate(C.getDate()-1);let k=mn(C),x=pn(g),S=mn(x);if(v&&y&&v.getFullYear()===k.getFullYear()&&v.getMonth()===k.getMonth()&&v.getDate()===k.getDate()&&y.getFullYear()===k.getFullYear()&&y.getMonth()===k.getMonth()&&y.getDate()===k.getDate())return"yesterday";if(v&&v.getFullYear()===S.getFullYear()&&v.getMonth()===S.getMonth()&&v.getDate()===S.getDate())return"thisWeek";let T=new Date(g.getFullYear(),g.getMonth(),1),P=mn(T);if(v&&v.getFullYear()===P.getFullYear()&&v.getMonth()===P.getMonth()&&v.getDate()===P.getDate())return"thisMonth";let M=new Date(g.getFullYear(),0,1),D=mn(M);return v&&v.getFullYear()===D.getFullYear()&&v.getMonth()===D.getMonth()&&v.getDate()===D.getDate()?"thisYear":f||b?"custom":null},[]),l=(0,Jt.useMemo)(()=>s(e[0],e[1]),[e,s]);(0,Jt.useEffect)(()=>{let f=b=>{a.current&&!a.current.contains(b.target)&&r&&n(!1)};return r&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[r]),(0,Jt.useEffect)(()=>{if(r&&a.current){let f=a.current.getBoundingClientRect(),b=360,v=window.innerWidth;f.right+b>v-20?i(!0):i(!1)}},[r]);let c=(0,Jt.useCallback)(f=>{if(f&&f instanceof Date){let b=mn(f,!0);t([b,e[1]])}else t([null,e[1]])},[e,t]),d=(0,Jt.useCallback)(f=>{if(f&&f instanceof Date){let b=mn(f,!1);t([e[0],b])}else t([e[0],null])},[e,t]),u=(0,Jt.useCallback)(()=>{l==="custom"?n(!r):(n(!0),!e[0]&&!e[1]&&t([null,null]))},[l,r,e,t]),p=(0,Jt.useCallback)(f=>{let b=new Date,v=null,y=null;if(f==="custom")if(l==="custom"){n(!r);return}else{n(!0);return}else n(!1);switch(f){case"today":v=mn(b,!0),y=mn(b,!1);break;case"yesterday":let g=new Date(b);g.setDate(b.getDate()-1),v=mn(g,!0),y=mn(g,!1);break;case"thisWeek":let w=pn(b);v=mn(w,!0),y=mn(b,!1);break;case"thisMonth":let C=new Date(b.getFullYear(),b.getMonth(),1);v=mn(C,!0),y=mn(b,!1);break;case"thisYear":let k=new Date(b.getFullYear(),0,1);v=mn(k,!0),y=mn(b,!1);break;case"allTime":default:v=null,y=null;break}t([v,y])},[l,r,t]),m=(0,Jt.useMemo)(()=>[{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"thisYear",label:"This Year"},{id:"allTime",label:"All Time"},{id:"custom",label:"Custom"}],[]),h=(0,Jt.useCallback)(f=>()=>p(f),[p]);return Jt.default.createElement("div",{className:"journalit-dashboard-date-range-filter",ref:a},Jt.default.createElement("div",{className:"journalit-dashboard-date-range-presets"},m.map(f=>Jt.default.createElement("button",{key:f.id,onClick:h(f.id),className:l===f.id?"active":""},f.label))),r&&Jt.default.createElement("div",{className:`journalit-dashboard-date-range-inputs journalit-dashboard-custom-date-dropdown date-dropdown-visible ${o?"position-left":""}`},Jt.default.createElement("div",{className:"journalit-dashboard-date-range-start"},Jt.default.createElement("label",null,"From"),Jt.default.createElement(ko,{value:e[0]||void 0,onChange:c,className:"journalit-date-picker-input"})),Jt.default.createElement("div",{className:"journalit-dashboard-date-range-end"},Jt.default.createElement("label",null,"To"),Jt.default.createElement(ko,{value:e[1]||void 0,onChange:d,className:"journalit-date-picker-input",minDate:e[0]||void 0}))))};var zt=_(B());So();Zt();var hO=({accounts:e,selectedAccounts:t,onChange:r})=>{let n=Ee(),[a,o]=(0,zt.useState)([]),[i,s]=(0,zt.useState)(!1),l=(0,zt.useRef)(null);(0,zt.useEffect)(()=>{if(n&&n.optionsService){let f=n.optionsService.getOptions("account");o(f);let b=()=>{let v=n.optionsService.getOptions("account");o(v)};return document.addEventListener("journalit-options-changed",b),()=>{document.removeEventListener("journalit-options-changed",b)}}},[n]);let c=(0,zt.useMemo)(()=>[...new Set([...e,...a])],[e,a]),d=(0,zt.useMemo)(()=>c.length>0?[{value:"select-all",label:"-- Select All --"},...c.map(b=>({value:b,label:b}))]:[],[c]);(0,zt.useEffect)(()=>{let f=b=>{l.current&&!l.current.contains(b.target)&&s(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);let u=(0,zt.useCallback)(f=>{f==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(f)?r(t.filter(b=>b!==f)):r([...t,f])},[t,c,r]),p=(0,zt.useMemo)(()=>t.length===0||t.length===c.length?"All Accounts":t.length===1?t[0]:`${t.length} Accounts`,[t,c]),m=(0,zt.useMemo)(()=>c.length>0,[c]),h=(0,zt.useCallback)(()=>s(!i),[i]);return zt.default.createElement("div",{className:"journalit-dashboard-account-filter journalit-responsive-account-filter",ref:l},zt.default.createElement("div",{className:"journalit-dashboard-account-dropdown"},zt.default.createElement("div",{className:"journalit-dashboard-account-summary",onClick:h},p,zt.default.createElement("span",{className:"dropdown-arrow"},i?"\u25B2":"\u25BC")),i&&zt.default.createElement("div",{className:"journalit-dashboard-account-options-dropdown"},m?zt.default.createElement(zt.default.Fragment,null,zt.default.createElement("div",{className:"journalit-dashboard-account-option-item select-all",onClick:()=>u("select-all")},zt.default.createElement("input",{type:"checkbox",checked:t.length===c.length,readOnly:!0}),zt.default.createElement("span",null,"Select All")),zt.default.createElement("div",{className:"journalit-dashboard-account-divider"}),c.map(f=>zt.default.createElement("div",{key:f,className:"journalit-dashboard-account-option-item",onClick:()=>u(f)},zt.default.createElement("input",{type:"checkbox",checked:t.includes(f),readOnly:!0}),zt.default.createElement("span",null,f)))):zt.default.createElement("div",{className:"journalit-dashboard-no-accounts"},"No accounts found"))))};var It=_(B());So();Zt();var vO=({tickers:e,selectedTickers:t,onChange:r})=>{let n=Ee(),[a,o]=(0,It.useState)([]),[i,s]=(0,It.useState)(!1),l=(0,It.useRef)(null);(0,It.useEffect)(()=>{if(n&&n.optionsService){let b=n.optionsService.getOptions("instrument");o(b);let v=()=>{let y=n.optionsService.getOptions("instrument");o(y)};return document.addEventListener("journalit-options-changed",v),()=>{document.removeEventListener("journalit-options-changed",v)}}},[n]);let c=(0,It.useMemo)(()=>[...new Set([...e,...a])],[e,a]),d=(0,It.useMemo)(()=>c.length>0,[c]);(0,It.useEffect)(()=>{let b=v=>{l.current&&!l.current.contains(v.target)&&s(!1)};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[]);let u=(0,It.useCallback)(b=>{b==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(b)?r(t.filter(v=>v!==b)):r([...t,b])},[t,c,r]),p=(0,It.useMemo)(()=>t.length===0||t.length===c.length?"All Tickers":t.length===1?t[0]:`${t.length} Tickers`,[t,c]),m=(0,It.useCallback)(()=>s(!i),[i]),h=(0,It.useCallback)(()=>u("select-all"),[u]),f=(0,It.useCallback)(b=>()=>u(b),[u]);return It.default.createElement("div",{className:"journalit-dashboard-ticker-filter journalit-responsive-ticker-filter",ref:l},It.default.createElement("div",{className:"journalit-dashboard-ticker-dropdown"},It.default.createElement("div",{className:"journalit-dashboard-ticker-summary",onClick:m},p,It.default.createElement("span",{className:"dropdown-arrow"},i?"\u25B2":"\u25BC")),i&&It.default.createElement("div",{className:"journalit-dashboard-ticker-options-dropdown"},d?It.default.createElement(It.default.Fragment,null,It.default.createElement("div",{className:"journalit-dashboard-ticker-option-item select-all",onClick:h},It.default.createElement("input",{type:"checkbox",checked:t.length===c.length,readOnly:!0}),It.default.createElement("span",null,"Select All")),It.default.createElement("div",{className:"journalit-dashboard-ticker-divider"}),c.map(b=>It.default.createElement("div",{key:b,className:"journalit-dashboard-ticker-option-item",onClick:f(b)},It.default.createElement("input",{type:"checkbox",checked:t.includes(b),readOnly:!0}),It.default.createElement("span",null,b)))):It.default.createElement("div",{className:"journalit-dashboard-no-tickers"},"No tickers found"))))};var Kfe={defaultFilters:{dateRange:[null,null],accounts:[],tickers:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[]}},_G=e=>{var r,n,a,o,i,s;if(!e.settings.dashboard)return Kfe;let t=e.settings.dashboard;return{defaultFilters:{dateRange:(r=t.defaultFilters)!=null&&r.dateRange?[t.defaultFilters.dateRange[0]?new Date(t.defaultFilters.dateRange[0]):null,t.defaultFilters.dateRange[1]?new Date(t.defaultFilters.dateRange[1]):null]:[null,null],accounts:((n=t.defaultFilters)==null?void 0:n.accounts)||[],tickers:((a=t.defaultFilters)==null?void 0:a.tickers)||[]},lastUsedFilters:{dateRange:(o=t.lastUsedFilters)!=null&&o.dateRange?[t.lastUsedFilters.dateRange[0]?new Date(t.lastUsedFilters.dateRange[0]):null,t.lastUsedFilters.dateRange[1]?new Date(t.lastUsedFilters.dateRange[1]):null]:[null,null],accounts:((i=t.lastUsedFilters)==null?void 0:i.accounts)||[],tickers:((s=t.lastUsedFilters)==null?void 0:s.tickers)||[]}}},Jfe=async(e,t)=>{e.settings.dashboard||(e.settings.dashboard=Pa.dashboard),e.settings.dashboard.defaultFilters=t.defaultFilters,e.settings.dashboard.lastUsedFilters=t.lastUsedFilters,await e.saveSettings()},UC=async(e,t)=>{let r=_G(e);r.lastUsedFilters=t,await Jfe(e,r)};var BG=e=>_G(e).defaultFilters;Su();yo();var yO=({filters:e,onFilterChange:t,isEditing:r=!1,onToggleEditMode:n})=>{let a=Ee(),[o,i]=(0,ar.useState)([]),[s,l]=(0,ar.useState)([]),[c,d]=(0,ar.useState)(!0),u=GB(1300);(0,ar.useEffect)(()=>{(async()=>{d(!0);try{if(a){let y=a.tradeService,g=await y.getUniqueAccounts();i(g);let w=await y.getUniqueInstruments();l(w)}}catch(y){console.error("Error loading accounts:",y)}finally{d(!1)}})()},[a]);let p=v=>{let y={...e,dateRange:v};t(y),a&&UC(a,y)},m=v=>{let y={...e,accounts:v};t(y),a&&UC(a,y)},h=()=>{if(a){let v=BG(a);t(v)}},f=()=>{var v;return e.dateRange[0]!==null||e.dateRange[1]!==null||e.accounts.length>0||((v=e.tickers)==null?void 0:v.length)>0},b=v=>{let y={...e,tickers:v};t(y),a&&UC(a,y)};return ar.default.createElement("div",{className:`journalit-dashboard-filter-controls ${u?"compact-view":""}`},u?ar.default.createElement("div",{className:"journalit-dashboard-filter-row compact medium-responsive"},ar.default.createElement("div",{className:"journalit-dashboard-filter-section"},ar.default.createElement(bb,{dateRange:e.dateRange,onChange:p})),ar.default.createElement("div",{className:"journalit-dashboard-filter-section journalit-dashboard-compact-filters"},ar.default.createElement(vO,{tickers:s,selectedTickers:e.tickers||[],onChange:b}),ar.default.createElement(hO,{accounts:o,selectedAccounts:e.accounts,onChange:m})),ar.default.createElement("div",{className:"journalit-dashboard-filter-actions button-container"},ar.default.createElement(De,{className:"journalit-dashboard-reset-button",onClick:h,disabled:!f()||c,variant:f()?"secondary":"plain"},"Reset Filters"),n&&ar.default.createElement(De,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:r?"primary":"secondary"},r?"Save Layout":"Edit Layout"))):ar.default.createElement("div",{className:"journalit-dashboard-filter-row standard-responsive"},ar.default.createElement("div",{className:"journalit-dashboard-date-range-section"},ar.default.createElement(bb,{dateRange:e.dateRange,onChange:p})),ar.default.createElement("div",{className:"journalit-dashboard-filters-section"},ar.default.createElement("div",{className:"journalit-dashboard-tickers-section"},ar.default.createElement(vO,{tickers:s,selectedTickers:e.tickers||[],onChange:b})),ar.default.createElement("div",{className:"journalit-dashboard-accounts-section"},ar.default.createElement(hO,{accounts:o,selectedAccounts:e.accounts,onChange:m}))),ar.default.createElement("div",{className:"journalit-dashboard-filter-actions"},ar.default.createElement(De,{className:"journalit-dashboard-reset-button",onClick:h,disabled:!f()||c,variant:f()?"secondary":"plain"},"Reset Filters"),n&&ar.default.createElement(De,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:r?"primary":"secondary"},r?"Save Layout":"Edit Layout"))))};var co=_(B());var wr=_(B());er();var xb={topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}],xs:[{i:"pnlChart",x:0,y:0,w:2,h:6},{i:"performanceCalendar",x:0,y:6,w:2,h:3},{i:"dailyPerformance",x:0,y:9,w:2,h:3}],xxs:[{i:"pnlChart",x:0,y:0,w:1,h:6},{i:"performanceCalendar",x:0,y:6,w:1,h:3},{i:"dailyPerformance",x:0,y:9,w:1,h:3}]}},bO={layouts:{Default:xb},activeLayout:"Default"},$G=e=>e.settings.dashboard?{layouts:(()=>{let r=e.settings.dashboard;if(!r)return bO.layouts;let n=r.layouts||{},a={};return Object.entries(n).forEach(([o,i])=>{var d,u;if(!(i!=null&&i.bottomSection)){a[o]=JSON.parse(JSON.stringify(xb));return}let s=i.bottomSection,l=s.xs||((d=s.sm)==null?void 0:d.map(p=>({...p,w:Math.min(p.w,2)})))||[],c=s.xxs||((u=s.sm)==null?void 0:u.map(p=>({...p,w:1})))||[];a[o]={topSection:i.topSection||[],bottomSection:{lg:i.bottomSection.lg||[],md:i.bottomSection.md||[],sm:i.bottomSection.sm||[],xs:l,xxs:c}}}),a})(),activeLayout:e.settings.dashboard.activeLayout||bO.activeLayout}:bO;function Xfe(e){let t={};return Object.entries(e.layouts).forEach(([r,n])=>{t[r]={topSection:[...n.topSection],bottomSection:{lg:Nl(n.bottomSection.lg),md:Nl(n.bottomSection.md),sm:Nl(n.bottomSection.sm),xs:Nl(n.bottomSection.xs||[]),xxs:Nl(n.bottomSection.xxs||[])}}}),{layouts:t,activeLayout:e.activeLayout}}var Qfe=async(e,t)=>{try{e.settings.dashboard||(e.settings.dashboard=Pa.dashboard);let r=Xfe(t);e.settings.dashboard.layouts=r.layouts,e.settings.dashboard.activeLayout=r.activeLayout,await e.saveSettings();let n=new CustomEvent("journalit:settings-updated");document.dispatchEvent(n)}catch(r){throw console.error("Error saving layout settings:",r),r}};function Il(e){return e.map(t=>{let r=typeof t.y=="number"?t.y===1e7?1/0:t.y:0;return{...t,y:r,x:typeof t.x=="number"?t.x:0,w:typeof t.w=="number"?t.w:1,h:typeof t.h=="number"?t.h:1}})}var ra=e=>{try{let t=$G(e),r=t.activeLayout,n=t.layouts[r];if(!n)return console.warn(`Active layout '${r}' not found, using default layout`),xb;if(!n.topSection||!n.bottomSection)return console.warn(`Active layout '${r}' is malformed, using default layout`),xb;if(!n.bottomSection.lg||!n.bottomSection.md||!n.bottomSection.sm||!n.bottomSection.xs||!n.bottomSection.xxs){console.warn(`Active layout '${r}' is missing breakpoint layouts, fixing...`);let a={topSection:[...n.topSection],bottomSection:{lg:Il(n.bottomSection.lg||[]),md:Il(n.bottomSection.md||[]),sm:Il(n.bottomSection.sm||[]),xs:Il(n.bottomSection.xs||[]),xxs:Il(n.bottomSection.xxs||[])}};return ya(e,r,a).catch(o=>console.error(`Failed to save fixed layout: ${o}`)),a}return{topSection:[...n.topSection],bottomSection:{lg:Il(n.bottomSection.lg||[]),md:Il(n.bottomSection.md||[]),sm:Il(n.bottomSection.sm||[]),xs:Il(n.bottomSection.xs||[]),xxs:Il(n.bottomSection.xxs||[])}}}catch(t){return console.error("Error retrieving active layout:",t),xb}};function Nl(e){return e.map(t=>({...t,y:t.y===1/0?1e7:typeof t.y=="number"?t.y:0}))}var ya=async(e,t,r)=>{try{let n=$G(e),a={topSection:[...r.topSection],bottomSection:{lg:Nl(r.bottomSection.lg),md:Nl(r.bottomSection.md),sm:Nl(r.bottomSection.sm),xs:Nl(r.bottomSection.xs||[]),xxs:Nl(r.bottomSection.xxs||[])}},o=new Set;Object.values(a.bottomSection).forEach(s=>{s.forEach(l=>o.add(l.i))});let i={lg:12,md:6,sm:4,xs:2,xxs:1};Object.entries(a.bottomSection).forEach(([s,l])=>{let c=new Set(l.map(d=>d.i));o.forEach(d=>{var u;if(!c.has(d)){let p;for(let m of["lg","md","sm","xs","xxs"]){let h=(u=a.bottomSection[m])==null?void 0:u.find(f=>f.i===d);if(h){p=h;break}}p&&l.push({i:d,x:0,y:1/0,w:Math.min(p.w,i[s]),h:p.h})}})}),n.layouts[t]=a,await Qfe(e,n)}catch(n){throw console.error(`Error saving layout '${t}':`,n),n}};Zt();var mr=_(B());var RG=(0,mr.createContext)(null),Zfe=5e3,WG=({app:e,tradeService:t,filters:r,children:n})=>{let[a,o]=(0,mr.useState)(null),[i,s]=(0,mr.useState)(!1),[l,c]=(0,mr.useState)(!1),[d,u]=(0,mr.useState)(null),[p,m]=(0,mr.useState)(0),h=(0,mr.useRef)(!1),f=(0,mr.useRef)(r),b=(0,mr.useRef)(r);mr.default.useEffect(()=>{f.current=r},[r]);let v=(0,mr.useCallback)((x,S)=>{var D,A,L,N;let T=((D=x.dateRange[0])==null?void 0:D.getTime())!==((A=S.dateRange[0])==null?void 0:A.getTime())||((L=x.dateRange[1])==null?void 0:L.getTime())!==((N=S.dateRange[1])==null?void 0:N.getTime()),P=x.accounts.length!==S.accounts.length||x.accounts.some((E,I)=>E!==S.accounts[I]),M=x.tickers.length!==S.tickers.length||x.tickers.some((E,I)=>E!==S.tickers[I]);return T||P||M},[]),y=(0,mr.useCallback)((x=Zfe)=>Date.now()-p<x,[p]),g=(0,mr.useCallback)(async(x=!1)=>{if(h.current)return;let S=v(b.current,f.current);if(!(!x&&!S&&a&&y())){b.current=f.current,h.current=!0,s(!0),u(null);try{let T=await vG(e,t,f.current);o(T),m(Date.now()),c(!1)}catch(T){console.error("Error fetching dashboard data:",T),u(T instanceof Error?T:new Error("Failed to fetch dashboard data"))}finally{s(!1),c(!1),h.current=!1}}},[e,t,y,a,v]),w=(0,mr.useCallback)(x=>{if(!a)return[];switch(x){case"total-pnl":return[{label:"Total P&L",value:a.metrics.netPnL,type:"pnl"}];case"win-rate":return[{label:"Win Rate",value:a.metrics.winRate,type:"percentage"}];case"avg-win-loss":return[{label:"Avg Win",value:a.metrics.avgWin,type:"pnl"},{label:"Avg Loss",value:a.metrics.avgLoss,type:"pnl"}];case"profit-factor":return[{label:"Profit Factor",value:a.metrics.profitFactor,type:"ratio"}];case"total-trades":return[{label:"Total Trades",value:a.metrics.numTrades,type:"number"}];case"avg-rr":return[{label:"Avg RR",value:0,type:"ratio"}];default:return[]}},[a]),C=(0,mr.useCallback)(x=>{if(!a)return null;switch(x){case"pnl-chart":return a.trades||[];case"performance-calendar":return a.trades||[];case"setup-performance":return a.trades||[];case"daily-pnl":return a.trades||[];case"trade-distribution":return a.trades||[];default:return null}},[a]);mr.default.useEffect(()=>{v(b.current,r)&&a&&c(!0);let S=setTimeout(()=>{g()},100);return()=>clearTimeout(S)},[r,g,v,a]);let k=(0,mr.useMemo)(()=>({dashboardData:a,isLoading:i,isStale:l,error:d,filters:r,refreshData:()=>g(!1),getMetricData:w,getWidgetData:C,lastFetchTime:p,isCacheValid:y}),[a,i,l,d,r,g,w,C,p,y]);return mr.default.createElement(RG.Provider,{value:k},n)},yg=()=>{let e=(0,mr.useContext)(RG);if(!e)throw new Error("useDashboardData must be used within a DashboardDataProvider");return e};var yp=_(B()),UG=({name:e,value:t,isPositive:r,dollarPart:n,centsPart:a,isCurrency:o=!1})=>yp.default.createElement("div",{className:"journalit-dashboard-metric-card",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px",backgroundColor:"transparent",padding:"14px",borderRadius:"8px",border:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08)",display:"flex",flexDirection:"column"}},yp.default.createElement("div",{className:"journalit-dashboard-metric-name",style:{textTransform:"uppercase",fontSize:"14px",fontWeight:"600",letterSpacing:"0.5px",marginBottom:"6px",textAlign:"left",width:"100%"}},e),yp.default.createElement("div",{className:`journalit-dashboard-metric-value ${r!==void 0?r?"positive":"negative":""}`,style:{fontSize:"24px",fontWeight:"600",textAlign:"left",width:"100%"}},o&&n&&a?yp.default.createElement(yp.default.Fragment,null,n,yp.default.createElement("span",{className:"journalit-dashboard-metric-cents",style:{fontSize:"16px",opacity:"0.7",fontWeight:"500",marginLeft:"1px"}},a)):t));var le=_(B()),Cp=_(Yl());var an=_(B());function HG(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,an.useMemo)(()=>n=>{t.forEach(a=>a(n))},t)}var wb=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";function bp(e){let t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function qC(e){return"nodeType"in e}function so(e){var t,r;return e?bp(e)?e:qC(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function HC(e){let{Document:t}=so(e);return e instanceof t}function bg(e){return bp(e)?!1:e instanceof so(e).HTMLElement}function wO(e){return e instanceof so(e).SVGElement}function xp(e){return e?bp(e)?e.document:qC(e)?HC(e)?e:bg(e)||wO(e)?e.ownerDocument:document:document:document}var ss=wb?an.useLayoutEffect:an.useEffect;function VC(e){let t=(0,an.useRef)(e);return ss(()=>{t.current=e}),(0,an.useCallback)(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function VG(){let e=(0,an.useRef)(null),t=(0,an.useCallback)((n,a)=>{e.current=setInterval(n,a)},[]),r=(0,an.useCallback)(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function xg(e,t){t===void 0&&(t=[e]);let r=(0,an.useRef)(e);return ss(()=>{r.current!==e&&(r.current=e)},t),r}function wg(e,t){let r=(0,an.useRef)();return(0,an.useMemo)(()=>{let n=e(r.current);return r.current=n,n},[...t])}function Sb(e){let t=VC(e),r=(0,an.useRef)(null),n=(0,an.useCallback)(a=>{a!==r.current&&(t==null||t(a,r.current)),r.current=a},[]);return[r,n]}function GC(e){let t=(0,an.useRef)();return(0,an.useEffect)(()=>{t.current=e},[e]),t.current}var xO={};function wp(e,t){return(0,an.useMemo)(()=>{if(t)return t;let r=xO[e]==null?0:xO[e]+1;return xO[e]=r,e+"-"+r},[e,t])}function GG(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((o,i)=>{let s=Object.entries(i);for(let[l,c]of s){let d=o[l];d!=null&&(o[l]=d+e*c)}return o},{...t})}}var Sp=GG(1),Sg=GG(-1);function ege(e){return"clientX"in e&&"clientY"in e}function kb(e){if(!e)return!1;let{KeyboardEvent:t}=so(e.target);return t&&e instanceof t}function tge(e){if(!e)return!1;let{TouchEvent:t}=so(e.target);return t&&e instanceof t}function YC(e){if(tge(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return ege(e)?{x:e.clientX,y:e.clientY}:null}var Wd=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Wd.Translate.toString(e),Wd.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),qG="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function YG(e){return e.matches(qG)?e:e.querySelector(qG)}var kp=_(B()),rge={display:"none"};function KG(e){let{id:t,value:r}=e;return kp.default.createElement("div",{id:t,style:rge},r)}function JG(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e,a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return kp.default.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function XG(){let[e,t]=(0,kp.useState)("");return{announce:(0,kp.useCallback)(n=>{n!=null&&t(n)},[]),announcement:e}}var cY=(0,le.createContext)(null);function nge(e){let t=(0,le.useContext)(cY);(0,le.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function age(){let[e]=(0,le.useState)(()=>new Set),t=(0,le.useCallback)(n=>(e.add(n),()=>e.delete(n)),[e]);return[(0,le.useCallback)(n=>{let{type:a,event:o}=n;e.forEach(i=>{var s;return(s=i[a])==null?void 0:s.call(i,o)})},[e]),t]}var oge={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ige={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function sge(e){let{announcements:t=ige,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=oge}=e,{announce:o,announcement:i}=XG(),s=wp("DndLiveRegion"),[l,c]=(0,le.useState)(!1);if((0,le.useEffect)(()=>{c(!0)},[]),nge((0,le.useMemo)(()=>({onDragStart(u){let{active:p}=u;o(t.onDragStart({active:p}))},onDragMove(u){let{active:p,over:m}=u;t.onDragMove&&o(t.onDragMove({active:p,over:m}))},onDragOver(u){let{active:p,over:m}=u;o(t.onDragOver({active:p,over:m}))},onDragEnd(u){let{active:p,over:m}=u;o(t.onDragEnd({active:p,over:m}))},onDragCancel(u){let{active:p,over:m}=u;o(t.onDragCancel({active:p,over:m}))}}),[o,t])),!l)return null;let d=le.default.createElement(le.default.Fragment,null,le.default.createElement(KG,{id:n,value:a.draggable}),le.default.createElement(JG,{id:s,announcement:i}));return r?(0,Cp.createPortal)(d,r):d}var $n;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})($n||($n={}));function JC(){}var qs=Object.freeze({x:0,y:0});function lge(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function cge(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function dge(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function dY(e,t){if(!e||e.length===0)return null;let[r]=e;return t?r[t]:r}function QG(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}var uY=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,a=QG(t,t.left,t.top),o=[];for(let i of n){let{id:s}=i,l=r.get(s);if(l){let c=lge(QG(l),a);o.push({id:s,data:{droppableContainer:i,value:c}})}}return o.sort(cge)};function uge(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=a-n,s=o-r;if(n<a&&r<o){let l=t.width*t.height,c=e.width*e.height,d=i*s,u=d/(l+c-d);return Number(u.toFixed(4))}return 0}var pge=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,a=[];for(let o of n){let{id:i}=o,s=r.get(i);if(s){let l=uge(s,t);l>0&&a.push({id:i,data:{droppableContainer:o,value:l}})}}return a.sort(dge)};function mge(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function pY(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:qs}function fge(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return a.reduce((i,s)=>({...i,top:i.top+e*s.y,bottom:i.bottom+e*s.y,left:i.left+e*s.x,right:i.right+e*s.x}),{...r})}}var gge=fge(1);function hge(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function vge(e,t,r){let n=hge(t);if(!n)return e;let{scaleX:a,scaleY:o,x:i,y:s}=n,l=e.left-i-(1-a)*parseFloat(r),c=e.top-s-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),d=a?e.width/a:e.width,u=o?e.height/o:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}var yge={ignoreTransform:!1};function Dp(e,t){t===void 0&&(t=yge);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:c,transformOrigin:d}=so(e).getComputedStyle(e);c&&(r=vge(r,c,d))}let{top:n,left:a,width:o,height:i,bottom:s,right:l}=r;return{top:n,left:a,width:o,height:i,bottom:s,right:l}}function ZG(e){return Dp(e,{ignoreTransform:!0})}function bge(e){let t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function xge(e,t){return t===void 0&&(t=so(e).getComputedStyle(e)),t.position==="fixed"}function wge(e,t){t===void 0&&(t=so(e).getComputedStyle(e));let r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{let o=t[a];return typeof o=="string"?r.test(o):!1})}function eT(e,t){let r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if(HC(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!bg(a)||wO(a)||r.includes(a))return r;let o=so(e).getComputedStyle(a);return a!==e&&wge(a,o)&&r.push(a),xge(a,o)?r:n(a.parentNode)}return e?n(e):r}function mY(e){let[t]=eT(e,1);return t!=null?t:null}function SO(e){return!wb||!e?null:bp(e)?e:qC(e)?HC(e)||e===xp(e).scrollingElement?window:bg(e)?e:null:null}function fY(e){return bp(e)?e.scrollX:e.scrollLeft}function gY(e){return bp(e)?e.scrollY:e.scrollTop}function TO(e){return{x:fY(e),y:gY(e)}}var na;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(na||(na={}));function hY(e){return!wb||!e?!1:e===document.scrollingElement}function vY(e){let t={x:0,y:0},r=hY(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,s=e.scrollLeft>=n.x;return{isTop:a,isLeft:o,isBottom:i,isRight:s,maxScroll:n,minScroll:t}}var Sge={x:.2,y:.2};function kge(e,t,r,n,a){let{top:o,left:i,right:s,bottom:l}=r;n===void 0&&(n=10),a===void 0&&(a=Sge);let{isTop:c,isBottom:d,isLeft:u,isRight:p}=vY(e),m={x:0,y:0},h={x:0,y:0},f={height:t.height*a.y,width:t.width*a.x};return!c&&o<=t.top+f.height?(m.y=na.Backward,h.y=n*Math.abs((t.top+f.height-o)/f.height)):!d&&l>=t.bottom-f.height&&(m.y=na.Forward,h.y=n*Math.abs((t.bottom-f.height-l)/f.height)),!p&&s>=t.right-f.width?(m.x=na.Forward,h.x=n*Math.abs((t.right-f.width-s)/f.width)):!u&&i<=t.left+f.width&&(m.x=na.Backward,h.x=n*Math.abs((t.left+f.width-i)/f.width)),{direction:m,speed:h}}function Cge(e){if(e===document.scrollingElement){let{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}let{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function yY(e){return e.reduce((t,r)=>Sp(t,TO(r)),qs)}function Tge(e){return e.reduce((t,r)=>t+fY(r),0)}function Pge(e){return e.reduce((t,r)=>t+gY(r),0)}function Dge(e,t){if(t===void 0&&(t=Dp),!e)return;let{top:r,left:n,bottom:a,right:o}=t(e);mY(e)&&(a<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}var Ege=[["x",["left","right"],Tge],["y",["top","bottom"],Pge]],Tb=class{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;let n=eT(r),a=yY(n);this.rect={...t},this.width=t.width,this.height=t.height;for(let[o,i,s]of Ege)for(let l of i)Object.defineProperty(this,l,{get:()=>{let c=s(n),d=a[o]-c;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}},Tp=class{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}};function Age(e){let{EventTarget:t}=so(e);return e instanceof t?e:xp(e)}function kO(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ls;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ls||(ls={}));function eY(e){e.preventDefault()}function Ige(e){e.stopPropagation()}var _t;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(_t||(_t={}));var bY={start:[_t.Space,_t.Enter],cancel:[_t.Esc],end:[_t.Space,_t.Enter,_t.Tab]},Nge=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case _t.Right:return{...r,x:r.x+25};case _t.Left:return{...r,x:r.x-25};case _t.Down:return{...r,y:r.y+25};case _t.Up:return{...r,y:r.y-25}}},XC=class{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;let{event:{target:r}}=t;this.props=t,this.listeners=new Tp(xp(r)),this.windowListeners=new Tp(so(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ls.Resize,this.handleCancel),this.windowListeners.add(ls.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ls.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&Dge(n),r(qs)}handleKeyDown(t){if(kb(t)){let{active:r,context:n,options:a}=this.props,{keyboardCodes:o=bY,coordinateGetter:i=Nge,scrollBehavior:s="smooth"}=a,{code:l}=t;if(o.end.includes(l)){this.handleEnd(t);return}if(o.cancel.includes(l)){this.handleCancel(t);return}let{collisionRect:c}=n.current,d=c?{x:c.left,y:c.top}:qs;this.referenceCoordinates||(this.referenceCoordinates=d);let u=i(t,{active:r,context:n.current,currentCoordinates:d});if(u){let p=Sg(u,d),m={x:0,y:0},{scrollableAncestors:h}=n.current;for(let f of h){let b=t.code,{isTop:v,isRight:y,isLeft:g,isBottom:w,maxScroll:C,minScroll:k}=vY(f),x=Cge(f),S={x:Math.min(b===_t.Right?x.right-x.width/2:x.right,Math.max(b===_t.Right?x.left:x.left+x.width/2,u.x)),y:Math.min(b===_t.Down?x.bottom-x.height/2:x.bottom,Math.max(b===_t.Down?x.top:x.top+x.height/2,u.y))},T=b===_t.Right&&!y||b===_t.Left&&!g,P=b===_t.Down&&!w||b===_t.Up&&!v;if(T&&S.x!==u.x){let M=f.scrollLeft+p.x,D=b===_t.Right&&M<=C.x||b===_t.Left&&M>=k.x;if(D&&!p.y){f.scrollTo({left:M,behavior:s});return}D?m.x=f.scrollLeft-M:m.x=b===_t.Right?f.scrollLeft-C.x:f.scrollLeft-k.x,m.x&&f.scrollBy({left:-m.x,behavior:s});break}else if(P&&S.y!==u.y){let M=f.scrollTop+p.y,D=b===_t.Down&&M<=C.y||b===_t.Up&&M>=k.y;if(D&&!p.x){f.scrollTo({top:M,behavior:s});return}D?m.y=f.scrollTop-M:m.y=b===_t.Down?f.scrollTop-C.y:f.scrollTop-k.y,m.y&&f.scrollBy({top:-m.y,behavior:s});break}}this.handleMove(t,Sp(Sg(u,this.referenceCoordinates),m))}}}handleMove(t,r){let{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){let{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){let{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}};XC.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=bY,onActivation:a}=t,{active:o}=r,{code:i}=e.nativeEvent;if(n.start.includes(i)){let s=o.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function tY(e){return!!(e&&"distance"in e)}function rY(e){return!!(e&&"delay"in e)}var Pb=class{constructor(t,r,n){var a;n===void 0&&(n=Age(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;let{event:o}=t,{target:i}=o;this.props=t,this.events=r,this.document=xp(i),this.documentListeners=new Tp(this.document),this.listeners=new Tp(n),this.windowListeners=new Tp(so(i)),this.initialCoordinates=(a=YC(o))!=null?a:qs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ls.Resize,this.handleCancel),this.windowListeners.add(ls.DragStart,eY),this.windowListeners.add(ls.VisibilityChange,this.handleCancel),this.windowListeners.add(ls.ContextMenu,eY),this.documentListeners.add(ls.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(rY(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(tY(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){let{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){let{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ls.Click,Ige,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ls.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;let{activated:n,initialCoordinates:a,props:o}=this,{onMove:i,options:{activationConstraint:s}}=o;if(!a)return;let l=(r=YC(t))!=null?r:qs,c=Sg(a,l);if(!n&&s){if(tY(s)){if(s.tolerance!=null&&kO(c,s.tolerance))return this.handleCancel();if(kO(c,s.distance))return this.handleStart()}if(rY(s)&&kO(c,s.tolerance))return this.handleCancel();this.handlePending(s,c);return}t.cancelable&&t.preventDefault(),i(l)}handleEnd(){let{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){let{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===_t.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}},Lge={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}},QC=class extends Pb{constructor(t){let{event:r}=t,n=xp(r.target);super(t,Lge,n)}};QC.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];var Mge={move:{name:"mousemove"},end:{name:"mouseup"}},PO;(function(e){e[e.RightClick=2]="RightClick"})(PO||(PO={}));var DO=class extends Pb{constructor(t){super(t,Mge,xp(t.event.target))}};DO.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===PO.RightClick?!1:(n==null||n({event:r}),!0)}}];var CO={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}},EO=class extends Pb{constructor(t){super(t,CO)}static setup(){return window.addEventListener(CO.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(CO.move.name,t)};function t(){}}};EO.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t,{touches:a}=r;return a.length>1?!1:(n==null||n({event:r}),!0)}}];var Cb;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Cb||(Cb={}));var ZC;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ZC||(ZC={}));function Oge(e){let{acceleration:t,activator:r=Cb.Pointer,canScroll:n,draggingRect:a,enabled:o,interval:i=5,order:s=ZC.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:d,delta:u,threshold:p}=e,m=jge({delta:u,disabled:!o}),[h,f]=VG(),b=(0,le.useRef)({x:0,y:0}),v=(0,le.useRef)({x:0,y:0}),y=(0,le.useMemo)(()=>{switch(r){case Cb.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Cb.DraggableRect:return a}},[r,a,l]),g=(0,le.useRef)(null),w=(0,le.useCallback)(()=>{let k=g.current;if(!k)return;let x=b.current.x*v.current.x,S=b.current.y*v.current.y;k.scrollBy(x,S)},[]),C=(0,le.useMemo)(()=>s===ZC.TreeOrder?[...c].reverse():c,[s,c]);(0,le.useEffect)(()=>{if(!o||!c.length||!y){f();return}for(let k of C){if((n==null?void 0:n(k))===!1)continue;let x=c.indexOf(k),S=d[x];if(!S)continue;let{direction:T,speed:P}=kge(k,S,y,t,p);for(let M of["x","y"])m[M][T[M]]||(P[M]=0,T[M]=0);if(P.x>0||P.y>0){f(),g.current=k,h(w,i),b.current=P,v.current=T;return}}b.current={x:0,y:0},v.current={x:0,y:0},f()},[t,w,n,f,o,i,JSON.stringify(y),JSON.stringify(m),h,c,C,d,JSON.stringify(p)])}var Fge={x:{[na.Backward]:!1,[na.Forward]:!1},y:{[na.Backward]:!1,[na.Forward]:!1}};function jge(e){let{delta:t,disabled:r}=e,n=GC(t);return wg(a=>{if(r||!n||!a)return Fge;let o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[na.Backward]:a.x[na.Backward]||o.x===-1,[na.Forward]:a.x[na.Forward]||o.x===1},y:{[na.Backward]:a.y[na.Backward]||o.y===-1,[na.Forward]:a.y[na.Forward]||o.y===1}}},[r,t,n])}function zge(e,t){let r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return wg(a=>{var o;return t==null?null:(o=n!=null?n:a)!=null?o:null},[n,t])}function _ge(e,t){return(0,le.useMemo)(()=>e.reduce((r,n)=>{let{sensor:a}=n,o=a.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...o]},[]),[e,t])}var Db;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Db||(Db={}));var AO;(function(e){e.Optimized="optimized"})(AO||(AO={}));var nY=new Map;function Bge(e,t){let{dragging:r,dependencies:n,config:a}=t,[o,i]=(0,le.useState)(null),{frequency:s,measure:l,strategy:c}=a,d=(0,le.useRef)(e),u=b(),p=xg(u),m=(0,le.useCallback)(function(v){v===void 0&&(v=[]),!p.current&&i(y=>y===null?v:y.concat(v.filter(g=>!y.includes(g))))},[p]),h=(0,le.useRef)(null),f=wg(v=>{if(u&&!r)return nY;if(!v||v===nY||d.current!==e||o!=null){let y=new Map;for(let g of e){if(!g)continue;if(o&&o.length>0&&!o.includes(g.id)&&g.rect.current){y.set(g.id,g.rect.current);continue}let w=g.node.current,C=w?new Tb(l(w),w):null;g.rect.current=C,C&&y.set(g.id,C)}return y}return v},[e,o,r,u,l]);return(0,le.useEffect)(()=>{d.current=e},[e]),(0,le.useEffect)(()=>{u||m()},[r,u]),(0,le.useEffect)(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),(0,le.useEffect)(()=>{u||typeof s!="number"||h.current!==null||(h.current=setTimeout(()=>{m(),h.current=null},s))},[s,u,m,...n]),{droppableRects:f,measureDroppableContainers:m,measuringScheduled:o!=null};function b(){switch(c){case Db.Always:return!1;case Db.BeforeDragging:return r;default:return!r}}}function xY(e,t){return wg(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function $ge(e,t){return xY(e,t)}function Rge(e){let{callback:t,disabled:r}=e,n=VC(t),a=(0,le.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;let{MutationObserver:o}=window;return new o(n)},[n,r]);return(0,le.useEffect)(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function tT(e){let{callback:t,disabled:r}=e,n=VC(t),a=(0,le.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;let{ResizeObserver:o}=window;return new o(n)},[r]);return(0,le.useEffect)(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Wge(e){return new Tb(Dp(e),e)}function aY(e,t,r){t===void 0&&(t=Wge);let[n,a]=(0,le.useState)(null);function o(){a(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l!=null?l:r)!=null?c:null}let d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}let i=Rge({callback(l){if(e)for(let c of l){let{type:d,target:u}=c;if(d==="childList"&&u instanceof HTMLElement&&u.contains(e)){o();break}}}}),s=tT({callback:o});return ss(()=>{o(),e?(s==null||s.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),i==null||i.disconnect())},[e]),n}function Uge(e){let t=xY(e);return pY(e,t)}var oY=[];function qge(e){let t=(0,le.useRef)(e),r=wg(n=>e?n&&n!==oY&&e&&t.current&&e.parentNode===t.current.parentNode?n:eT(e):oY,[e]);return(0,le.useEffect)(()=>{t.current=e},[e]),r}function Hge(e){let[t,r]=(0,le.useState)(null),n=(0,le.useRef)(e),a=(0,le.useCallback)(o=>{let i=SO(o.target);i&&r(s=>s?(s.set(i,TO(i)),new Map(s)):null)},[]);return(0,le.useEffect)(()=>{let o=n.current;if(e!==o){i(o);let s=e.map(l=>{let c=SO(l);return c?(c.addEventListener("scroll",a,{passive:!0}),[c,TO(c)]):null}).filter(l=>l!=null);r(s.length?new Map(s):null),n.current=e}return()=>{i(e),i(o)};function i(s){s.forEach(l=>{let c=SO(l);c==null||c.removeEventListener("scroll",a)})}},[a,e]),(0,le.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>Sp(o,i),qs):yY(e):qs,[e,t])}function iY(e,t){t===void 0&&(t=[]);let r=(0,le.useRef)(null);return(0,le.useEffect)(()=>{r.current=null},t),(0,le.useEffect)(()=>{let n=e!==qs;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?Sg(e,r.current):qs}function Vge(e){(0,le.useEffect)(()=>{if(!wb)return;let t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(let r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function Gge(e,t){return(0,le.useMemo)(()=>e.reduce((r,n)=>{let{eventName:a,handler:o}=n;return r[a]=i=>{o(i,t)},r},{}),[e,t])}function wY(e){return(0,le.useMemo)(()=>e?bge(e):null,[e])}var sY=[];function Yge(e,t){t===void 0&&(t=Dp);let[r]=e,n=wY(r?so(r):null),[a,o]=(0,le.useState)(sY);function i(){o(()=>e.length?e.map(l=>hY(l)?n:new Tb(t(l),l)):sY)}let s=tT({callback:i});return ss(()=>{s==null||s.disconnect(),i(),e.forEach(l=>s==null?void 0:s.observe(l))},[e]),a}function Kge(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return bg(t)?t:e}function Jge(e){let{measure:t}=e,[r,n]=(0,le.useState)(null),a=(0,le.useCallback)(c=>{for(let{target:d}of c)if(bg(d)){n(u=>{let p=t(d);return u?{...u,width:p.width,height:p.height}:p});break}},[t]),o=tT({callback:a}),i=(0,le.useCallback)(c=>{let d=Kge(c);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?t(d):null)},[t,o]),[s,l]=Sb(i);return(0,le.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}var Xge=[{sensor:QC,options:{}},{sensor:XC,options:{}}],Qge={current:{}},KC={draggable:{measure:ZG},droppable:{measure:ZG,strategy:Db.WhileDragging,frequency:AO.Optimized},dragOverlay:{measure:Dp}},Pp=class extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}},Zge={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Pp,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:JC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:KC,measureDroppableContainers:JC,windowRect:null,measuringScheduled:!1},ehe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:JC,draggableNodes:new Map,over:null,measureDroppableContainers:JC},rT=(0,le.createContext)(ehe),SY=(0,le.createContext)(Zge);function the(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Pp}}}function rhe(e,t){switch(t.type){case $n.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case $n.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case $n.DragEnd:case $n.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case $n.RegisterDroppable:{let{element:r}=t,{id:n}=r,a=new Pp(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case $n.SetDroppableDisabled:{let{id:r,key:n,disabled:a}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;let i=new Pp(e.droppable.containers);return i.set(r,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:i}}}case $n.UnregisterDroppable:{let{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let o=new Pp(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function nhe(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:a}=(0,le.useContext)(rT),o=GC(n),i=GC(r==null?void 0:r.id);return(0,le.useEffect)(()=>{if(!t&&!n&&o&&i!=null){if(!kb(o)||document.activeElement===o.target)return;let s=a.get(i);if(!s)return;let{activatorNode:l,node:c}=s;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(let d of[l.current,c.current]){if(!d)continue;let u=YG(d);if(u){u.focus();break}}})}},[n,t,a,i,o]),null}function ahe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...n}),r):r}function ohe(e){return(0,le.useMemo)(()=>({draggable:{...KC.draggable,...e==null?void 0:e.draggable},droppable:{...KC.droppable,...e==null?void 0:e.droppable},dragOverlay:{...KC.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ihe(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e,o=(0,le.useRef)(!1),{x:i,y:s}=typeof a=="boolean"?{x:a,y:a}:a;ss(()=>{if(!i&&!s||!t){o.current=!1;return}if(o.current||!n)return;let c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;let d=r(c),u=pY(d,n);if(i||(u.x=0),s||(u.y=0),o.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){let p=mY(c);p&&p.scrollBy({top:u.y,left:u.x})}},[t,i,s,n,r])}var kY=(0,le.createContext)({...qs,scaleX:1,scaleY:1}),Ud;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ud||(Ud={}));var CY=(0,le.memo)(function(t){var r,n,a,o;let{id:i,accessibility:s,autoScroll:l=!0,children:c,sensors:d=Xge,collisionDetection:u=pge,measuring:p,modifiers:m,...h}=t,f=(0,le.useReducer)(rhe,void 0,the),[b,v]=f,[y,g]=age(),[w,C]=(0,le.useState)(Ud.Uninitialized),k=w===Ud.Initialized,{draggable:{active:x,nodes:S,translate:T},droppable:{containers:P}}=b,M=x!=null?S.get(x):null,D=(0,le.useRef)({initial:null,translated:null}),A=(0,le.useMemo)(()=>{var xa;return x!=null?{id:x,data:(xa=M==null?void 0:M.data)!=null?xa:Qge,rect:D}:null},[x,M]),L=(0,le.useRef)(null),[N,E]=(0,le.useState)(null),[I,O]=(0,le.useState)(null),j=xg(h,Object.values(h)),$=wp("DndDescribedBy",i),F=(0,le.useMemo)(()=>P.getEnabled(),[P]),z=ohe(p),{droppableRects:W,measureDroppableContainers:U,measuringScheduled:K}=Bge(F,{dragging:k,dependencies:[T.x,T.y],config:z.droppable}),R=zge(S,x),q=(0,le.useMemo)(()=>I?YC(I):null,[I]),X=E7(),G=$ge(R,z.draggable.measure);ihe({activeNode:x!=null?S.get(x):null,config:X.layoutShiftCompensation,initialRect:G,measure:z.draggable.measure});let H=aY(R,z.draggable.measure,G),Y=aY(R?R.parentElement:null),V=(0,le.useRef)({activatorEvent:null,active:null,activeNode:R,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=P.getNodeFor((r=V.current.over)==null?void 0:r.id),Z=Jge({measure:z.dragOverlay.measure}),se=(n=Z.nodeRef.current)!=null?n:R,ie=k?(a=Z.rect)!=null?a:H:null,Se=!!(Z.nodeRef.current&&Z.rect),qe=Uge(Se?null:H),ht=wY(se?so(se):null),ft=qge(k?Q!=null?Q:R:null),it=Yge(ft),Tn=ahe(m,{transform:{x:T.x-qe.x,y:T.y-qe.y,scaleX:1,scaleY:1},activatorEvent:I,active:A,activeNodeRect:H,containerNodeRect:Y,draggingNodeRect:ie,over:V.current.over,overlayNodeRect:Z.rect,scrollableAncestors:ft,scrollableAncestorRects:it,windowRect:ht}),hr=q?Sp(q,T):null,kt=Hge(ft),Pn=iY(kt),jl=iY(kt,[H]),Ti=Sp(Tn,Pn),Bp=ie?gge(ie,Tn):null,Gg=A&&Bp?u({active:A,collisionRect:Bp,droppableRects:W,droppableContainers:F,pointerCoordinates:hr}):null,f2=dY(Gg,"id"),[Ic,g2]=(0,le.useState)(null),k7=Se?Tn:Sp(Tn,jl),C7=mge(k7,(o=Ic==null?void 0:Ic.rect)!=null?o:null,H),n1=(0,le.useRef)(null),h2=(0,le.useCallback)((xa,Ko)=>{let{sensor:Jo,options:Nc}=Ko;if(L.current==null)return;let Pi=S.get(L.current);if(!Pi)return;let Xo=xa.nativeEvent,Xs=new Jo({active:L.current,activeNode:Pi,event:Xo,options:Nc,context:V,onAbort(aa){if(!S.get(aa))return;let{onDragAbort:Qs}=j.current,zl={id:aa};Qs==null||Qs(zl),y({type:"onDragAbort",event:zl})},onPending(aa,Lc,Qs,zl){if(!S.get(aa))return;let{onDragPending:Kg}=j.current,Mc={id:aa,constraint:Lc,initialCoordinates:Qs,offset:zl};Kg==null||Kg(Mc),y({type:"onDragPending",event:Mc})},onStart(aa){let Lc=L.current;if(Lc==null)return;let Qs=S.get(Lc);if(!Qs)return;let{onDragStart:zl}=j.current,Yg={activatorEvent:Xo,active:{id:Lc,data:Qs.data,rect:D}};(0,Cp.unstable_batchedUpdates)(()=>{zl==null||zl(Yg),C(Ud.Initializing),v({type:$n.DragStart,initialCoordinates:aa,active:Lc}),y({type:"onDragStart",event:Yg}),E(n1.current),O(Xo)})},onMove(aa){v({type:$n.DragMove,coordinates:aa})},onEnd:$p($n.DragEnd),onCancel:$p($n.DragCancel)});n1.current=Xs;function $p(aa){return async function(){let{active:Qs,collisions:zl,over:Yg,scrollAdjustedTranslate:Kg}=V.current,Mc=null;if(Qs&&Kg){let{cancelDrop:Jg}=j.current;Mc={activatorEvent:Xo,active:Qs,collisions:zl,delta:Kg,over:Yg},aa===$n.DragEnd&&typeof Jg=="function"&&await Promise.resolve(Jg(Mc))&&(aa=$n.DragCancel)}L.current=null,(0,Cp.unstable_batchedUpdates)(()=>{v({type:aa}),C(Ud.Uninitialized),g2(null),E(null),O(null),n1.current=null;let Jg=aa===$n.DragEnd?"onDragEnd":"onDragCancel";if(Mc){let a1=j.current[Jg];a1==null||a1(Mc),y({type:Jg,event:Mc})}})}}},[S]),T7=(0,le.useCallback)((xa,Ko)=>(Jo,Nc)=>{let Pi=Jo.nativeEvent,Xo=S.get(Nc);if(L.current!==null||!Xo||Pi.dndKit||Pi.defaultPrevented)return;let Xs={active:Xo};xa(Jo,Ko.options,Xs)===!0&&(Pi.dndKit={capturedBy:Ko.sensor},L.current=Nc,h2(Jo,Ko))},[S,h2]),v2=_ge(d,T7);Vge(d),ss(()=>{H&&w===Ud.Initializing&&C(Ud.Initialized)},[H,w]),(0,le.useEffect)(()=>{let{onDragMove:xa}=j.current,{active:Ko,activatorEvent:Jo,collisions:Nc,over:Pi}=V.current;if(!Ko||!Jo)return;let Xo={active:Ko,activatorEvent:Jo,collisions:Nc,delta:{x:Ti.x,y:Ti.y},over:Pi};(0,Cp.unstable_batchedUpdates)(()=>{xa==null||xa(Xo),y({type:"onDragMove",event:Xo})})},[Ti.x,Ti.y]),(0,le.useEffect)(()=>{let{active:xa,activatorEvent:Ko,collisions:Jo,droppableContainers:Nc,scrollAdjustedTranslate:Pi}=V.current;if(!xa||L.current==null||!Ko||!Pi)return;let{onDragOver:Xo}=j.current,Xs=Nc.get(f2),$p=Xs&&Xs.rect.current?{id:Xs.id,rect:Xs.rect.current,data:Xs.data,disabled:Xs.disabled}:null,aa={active:xa,activatorEvent:Ko,collisions:Jo,delta:{x:Pi.x,y:Pi.y},over:$p};(0,Cp.unstable_batchedUpdates)(()=>{g2($p),Xo==null||Xo(aa),y({type:"onDragOver",event:aa})})},[f2]),ss(()=>{V.current={activatorEvent:I,active:A,activeNode:R,collisionRect:Bp,collisions:Gg,droppableRects:W,draggableNodes:S,draggingNode:se,draggingNodeRect:ie,droppableContainers:P,over:Ic,scrollableAncestors:ft,scrollAdjustedTranslate:Ti},D.current={initial:ie,translated:Bp}},[A,R,Gg,Bp,S,se,ie,W,P,Ic,ft,Ti]),Oge({...X,delta:T,draggingRect:Bp,pointerCoordinates:hr,scrollableAncestors:ft,scrollableAncestorRects:it});let P7=(0,le.useMemo)(()=>({active:A,activeNode:R,activeNodeRect:H,activatorEvent:I,collisions:Gg,containerNodeRect:Y,dragOverlay:Z,draggableNodes:S,droppableContainers:P,droppableRects:W,over:Ic,measureDroppableContainers:U,scrollableAncestors:ft,scrollableAncestorRects:it,measuringConfiguration:z,measuringScheduled:K,windowRect:ht}),[A,R,H,I,Gg,Y,Z,S,P,W,Ic,U,ft,it,z,K,ht]),D7=(0,le.useMemo)(()=>({activatorEvent:I,activators:v2,active:A,activeNodeRect:H,ariaDescribedById:{draggable:$},dispatch:v,draggableNodes:S,over:Ic,measureDroppableContainers:U}),[I,v2,A,H,v,$,S,Ic,U]);return le.default.createElement(cY.Provider,{value:g},le.default.createElement(rT.Provider,{value:D7},le.default.createElement(SY.Provider,{value:P7},le.default.createElement(kY.Provider,{value:C7},c)),le.default.createElement(nhe,{disabled:(s==null?void 0:s.restoreFocus)===!1})),le.default.createElement(sge,{...s,hiddenTextDescribedById:$}));function E7(){let xa=(N==null?void 0:N.autoScrollEnabled)===!1,Ko=typeof l=="object"?l.enabled===!1:l===!1,Jo=k&&!xa&&!Ko;return typeof l=="object"?{...l,enabled:Jo}:{enabled:Jo}}}),she=(0,le.createContext)(null),lY="button",lhe="Draggable";function TY(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e,o=wp(lhe),{activators:i,activatorEvent:s,active:l,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:p}=(0,le.useContext)(rT),{role:m=lY,roleDescription:h="draggable",tabIndex:f=0}=a!=null?a:{},b=(l==null?void 0:l.id)===t,v=(0,le.useContext)(b?kY:she),[y,g]=Sb(),[w,C]=Sb(),k=Gge(i,t),x=xg(r);ss(()=>(u.set(t,{id:t,key:o,node:y,activatorNode:w,data:x}),()=>{let T=u.get(t);T&&T.key===o&&u.delete(t)}),[u,t]);let S=(0,le.useMemo)(()=>({role:m,tabIndex:f,"aria-disabled":n,"aria-pressed":b&&m===lY?!0:void 0,"aria-roledescription":h,"aria-describedby":d.draggable}),[n,m,f,b,h,d.draggable]);return{active:l,activatorEvent:s,activeNodeRect:c,attributes:S,isDragging:b,listeners:n?void 0:k,node:y,over:p,setNodeRef:g,setActivatorNodeRef:C,transform:v}}function PY(){return(0,le.useContext)(SY)}var che="Droppable",dhe={timeout:25};function DY(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e,o=wp(che),{active:i,dispatch:s,over:l,measureDroppableContainers:c}=(0,le.useContext)(rT),d=(0,le.useRef)({disabled:r}),u=(0,le.useRef)(!1),p=(0,le.useRef)(null),m=(0,le.useRef)(null),{disabled:h,updateMeasurementsFor:f,timeout:b}={...dhe,...a},v=xg(f!=null?f:n),y=(0,le.useCallback)(()=>{if(!u.current){u.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(v.current)?v.current:[v.current]),m.current=null},b)},[b]),g=tT({callback:y,disabled:h||!i}),w=(0,le.useCallback)((S,T)=>{g&&(T&&(g.unobserve(T),u.current=!1),S&&g.observe(S))},[g]),[C,k]=Sb(w),x=xg(t);return(0,le.useEffect)(()=>{!g||!C.current||(g.disconnect(),u.current=!1,g.observe(C.current))},[C,g]),(0,le.useEffect)(()=>(s({type:$n.RegisterDroppable,element:{id:n,key:o,disabled:r,node:C,rect:p,data:x}}),()=>s({type:$n.UnregisterDroppable,key:o,id:n})),[n]),(0,le.useEffect)(()=>{r!==d.current.disabled&&(s({type:$n.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)},[n,o,r,s]),{active:i,rect:p,isOver:(l==null?void 0:l.id)===n,node:C,over:l,setNodeRef:k}}var on=_(B());function EY(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function uhe(e,t){return e.reduce((r,n,a)=>{let o=t.get(n);return o&&(r[a]=o),r},Array(e.length))}function nT(e){return e!==null&&e>=0}function phe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function mhe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}var aT={scaleX:1,scaleY:1},AY=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:a,overIndex:o,index:i}=e,s=(t=r[a])!=null?t:n;if(!s)return null;let l=fhe(r,i,a);if(i===a){let c=r[o];return c?{x:a<o?c.left+c.width-(s.left+s.width):c.left-s.left,y:0,...aT}:null}return i>a&&i<=o?{x:-s.width-l,y:0,...aT}:i<a&&i>=o?{x:s.width+l,y:0,...aT}:{x:0,y:0,...aT}};function fhe(e,t,r){let n=e[t],a=e[t-1],o=e[t+1];return!n||!a&&!o?0:r<t?a?n.left-(a.left+a.width):o.left-(n.left+n.width):o?o.left-(n.left+n.width):n.left-(a.left+a.width)}var IY=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e,o=EY(t,n,r),i=t[a],s=o[a];return!s||!i?null:{x:s.left-i.left,y:s.top-i.top,scaleX:s.width/i.width,scaleY:s.height/i.height}};var NY="Sortable",LY=on.default.createContext({activeIndex:-1,containerId:NY,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:IY,disabled:{draggable:!1,droppable:!1}});function MY(e){let{children:t,id:r,items:n,strategy:a=IY,disabled:o=!1}=e,{active:i,dragOverlay:s,droppableRects:l,over:c,measureDroppableContainers:d}=PY(),u=wp(NY,r),p=s.rect!==null,m=(0,on.useMemo)(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),h=i!=null,f=i?m.indexOf(i.id):-1,b=c?m.indexOf(c.id):-1,v=(0,on.useRef)(m),y=!phe(m,v.current),g=b!==-1&&f===-1||y,w=mhe(o);ss(()=>{y&&h&&d(m)},[y,m,h,d]),(0,on.useEffect)(()=>{v.current=m},[m]);let C=(0,on.useMemo)(()=>({activeIndex:f,containerId:u,disabled:w,disableTransforms:g,items:m,overIndex:b,useDragOverlay:p,sortedRects:uhe(m,l),strategy:a}),[f,u,w.draggable,w.droppable,g,m,b,l,p,a]);return on.default.createElement(LY.Provider,{value:C},t)}var ghe=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return EY(r,n,a).indexOf(t)},hhe=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:o,newIndex:i,previousItems:s,previousContainerId:l,transition:c}=e;return!c||!n||s!==o&&a===i?!1:r?!0:i!==a&&t===l},vhe={duration:200,easing:"ease"},OY="transform",yhe=Wd.Transition.toString({property:OY,duration:0,easing:"linear"}),bhe={roleDescription:"sortable"};function xhe(e){let{disabled:t,index:r,node:n,rect:a}=e,[o,i]=(0,on.useState)(null),s=(0,on.useRef)(r);return ss(()=>{if(!t&&r!==s.current&&n.current){let l=a.current;if(l){let c=Dp(n.current,{ignoreTransform:!0}),d={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(d.x||d.y)&&i(d)}}r!==s.current&&(s.current=r)},[t,r,n,a]),(0,on.useEffect)(()=>{o&&i(null)},[o]),o}function FY(e){let{animateLayoutChanges:t=hhe,attributes:r,disabled:n,data:a,getNewIndex:o=ghe,id:i,strategy:s,resizeObserverConfig:l,transition:c=vhe}=e,{items:d,containerId:u,activeIndex:p,disabled:m,disableTransforms:h,sortedRects:f,overIndex:b,useDragOverlay:v,strategy:y}=(0,on.useContext)(LY),g=whe(n,m),w=d.indexOf(i),C=(0,on.useMemo)(()=>({sortable:{containerId:u,index:w,items:d},...a}),[u,a,w,d]),k=(0,on.useMemo)(()=>d.slice(d.indexOf(i)),[d,i]),{rect:x,node:S,isOver:T,setNodeRef:P}=DY({id:i,data:C,disabled:g.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...l}}),{active:M,activatorEvent:D,activeNodeRect:A,attributes:L,setNodeRef:N,listeners:E,isDragging:I,over:O,setActivatorNodeRef:j,transform:$}=TY({id:i,data:C,attributes:{...bhe,...r},disabled:g.draggable}),F=HG(P,N),z=!!M,W=z&&!h&&nT(p)&&nT(b),U=!v&&I,K=U&&W?$:null,R=s!=null?s:y,q=W?K!=null?K:R({rects:f,activeNodeRect:A,activeIndex:p,overIndex:b,index:w}):null,X=nT(p)&&nT(b)?o({id:i,items:d,activeIndex:p,overIndex:b}):w,G=M==null?void 0:M.id,H=(0,on.useRef)({activeId:G,items:d,newIndex:X,containerId:u}),Y=d!==H.current.items,V=t({active:M,containerId:u,isDragging:I,isSorting:z,id:i,index:w,items:d,newIndex:H.current.newIndex,previousItems:H.current.items,previousContainerId:H.current.containerId,transition:c,wasDragging:H.current.activeId!=null}),Q=xhe({disabled:!V,index:w,node:S,rect:x});return(0,on.useEffect)(()=>{z&&H.current.newIndex!==X&&(H.current.newIndex=X),u!==H.current.containerId&&(H.current.containerId=u),d!==H.current.items&&(H.current.items=d)},[z,X,u,d]),(0,on.useEffect)(()=>{if(G===H.current.activeId)return;if(G!=null&&H.current.activeId==null){H.current.activeId=G;return}let se=setTimeout(()=>{H.current.activeId=G},50);return()=>clearTimeout(se)},[G]),{active:M,activeIndex:p,attributes:L,data:C,rect:x,index:w,newIndex:X,items:d,isOver:T,isSorting:z,isDragging:I,listeners:E,node:S,overIndex:b,over:O,setNodeRef:F,setActivatorNodeRef:j,setDroppableNodeRef:P,setDraggableNodeRef:N,transform:Q!=null?Q:q,transition:Z()};function Z(){if(Q||Y&&H.current.newIndex===w)return yhe;if(!(U&&!kb(D)||!c)&&(z||V))return Wd.Transition.toString({...c,property:OY})}}function whe(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}var iQe=[_t.Down,_t.Right,_t.Up,_t.Left];Ct();var She=({transform:e})=>({...e,y:0});var khe=({id:e,name:t,value:r,isPositive:n,isEditing:a,onRemove:o,dollarPart:i,centsPart:s,isCurrency:l})=>{let{attributes:c,listeners:d,setNodeRef:u,transform:p,transition:m}=FY({id:e,disabled:!a}),h={transform:Wd.Transform.toString(p&&{...p,y:0}),transition:m,position:"relative",height:"100%",flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"};return wr.default.createElement("div",{ref:u,style:h},wr.default.createElement("div",{className:"journalit-dashboard-metric-wrapper",style:{position:"relative",cursor:a?"grab":"default",height:"100%",display:"flex",flexDirection:"column"}},wr.default.createElement("div",{...c,...a?d:{},style:{flex:1,height:"100%"}},wr.default.createElement(UG,{name:t,value:r,isPositive:n,dollarPart:i,centsPart:s,isCurrency:l})),a&&wr.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:f=>{f.stopPropagation(),f.preventDefault(),o(e)},"aria-label":"Remove metric",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},"\u2715")))},IO=({filters:e,isEditing:t,onShowMetricSelector:r,hideAddButton:n=!1})=>{let a=Ee(),{currency:o}=Ae(),{dashboardData:i,isLoading:s,isStale:l,error:c}=yg(),[d,u]=(0,wr.useState)([]),[p,m]=(0,wr.useState)(null);(0,wr.useEffect)(()=>{m(c?c.message||"Failed to load metrics":null)},[c]),(0,wr.useEffect)(()=>{(()=>{try{if(a){let S=ra(a);u(S.topSection)}}catch(S){console.error("Error initializing metrics:",S),u(["netPnL","winRate","profitFactor","expectancy"])}})();let x=S=>{u([...S.detail.activeMetrics])};return document.addEventListener("journalit:metrics-changed",x),()=>{document.removeEventListener("journalit:metrics-changed",x)}},[a]);let h=k=>{let{active:x,over:S}=k;if(S&&x.id!==S.id){let T=d.indexOf(x.id.toString()),P=d.indexOf(S.id.toString());if(T!==-1&&P!==-1){let M=[...d];if(M.splice(T,1),M.splice(P,0,x.id.toString()),u(M),a)try{let A={...ra(a),topSection:M};ya(a,"Default",A)}catch(D){console.error("Error saving layout:",D)}}}},f=k=>{if(a)try{let x=d.filter(M=>M!==k);u([...x]);let T={...ra(a),topSection:[...x]};ya(a,"Default",T).catch(M=>{console.error("Error saving layout:",M)}),document.querySelectorAll(".journalit-dashboard-widget-remove").forEach(M=>{M.style.opacity="0.99",setTimeout(()=>{M.style.opacity="1"},0)});let P=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:x}});document.dispatchEvent(P)}catch(x){console.error("Error removing metric:",x)}},b=(k,x)=>{switch(k){case"netPnL":return ue(x,!0,o);case"winRate":return`${(x*100).toFixed(1)}%`;case"profitFactor":return x.toFixed(2);case"expectancy":return ue(x,!0,o);case"numTrades":return x.toString();case"numWinTrades":return x.toString();case"numLossTrades":return x.toString();case"avgWin":return ue(x,!0,o);case"avgLoss":return ue(x,!0,o);default:return x.toString()}},v=k=>{switch(k){case"netPnL":return"Net P&L";case"winRate":return"Win Rate";case"profitFactor":return"Profit Factor";case"expectancy":return"Expectancy";case"numTrades":return"Total Trades";case"numWinTrades":return"Winning Trades";case"numLossTrades":return"Losing Trades";case"avgWin":return"Avg Win";case"avgLoss":return"Avg Loss";default:return k}},y=(k,x)=>{switch(k){case"netPnL":case"profitFactor":case"expectancy":case"avgWin":return x>0;case"avgLoss":return x<0;case"winRate":return x>.5;default:return!0}},g=k=>["netPnL","expectancy","avgWin","avgLoss"].includes(k),w=(k,x)=>{if(!g(k))return;let S=ue(x,!0,o);return S.includes(".")?S.split(".")[0]:S},C=(k,x)=>{if(!g(k))return;let S=ue(x,!0,o);if(S.includes("."))return"."+S.split(".")[1]};return wr.default.createElement("div",{className:"journalit-dashboard-top-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!n&&r&&wr.default.createElement("div",{className:"journalit-dashboard-top-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},wr.default.createElement("button",{className:"journalit-dashboard-add-metric-button",onClick:r,style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Metric")),s&&!i?wr.default.createElement(sr,{message:"Loading metrics..."}):p?wr.default.createElement("div",{className:"journalit-dashboard-error"},p):i?wr.default.createElement("div",{style:{position:"relative"}},wr.default.createElement(CY,{collisionDetection:uY,onDragEnd:h,autoScroll:!0,modifiers:[She]},wr.default.createElement(MY,{items:d,strategy:AY},wr.default.createElement("div",{className:"journalit-dashboard-metrics",id:"topsection-metrics-container",style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",overflowX:"hidden",gap:"8px",padding:"10px 0",position:"relative",backgroundColor:"transparent",borderRadius:"0",minHeight:"auto"}},d.map(k=>wr.default.createElement(khe,{key:k,id:k,name:v(k),value:b(k,i.metrics[k]),isPositive:y(k,i.metrics[k]),isEditing:t,onRemove:f,dollarPart:w(k,i.metrics[k]),centsPart:C(k,i.metrics[k]),isCurrency:g(k)})),t&&d.length===0&&wr.default.createElement("div",{className:"journalit-dashboard-no-metrics"},'Click "Add Metric" to add metrics')))),(l||s)&&wr.default.createElement(sr,{message:"Loading...",size:"small",overlay:!0})):wr.default.createElement("div",{className:"journalit-dashboard-no-data"},"No data available"))};var jY=[{id:"netPnL",name:"Net P&L",description:"Total profit and loss across all trades",category:"performance"},{id:"winRate",name:"Win Rate",description:"Percentage of winning trades",category:"performance"},{id:"profitFactor",name:"Profit Factor",description:"Ratio of gross profit to gross loss",category:"performance"},{id:"expectancy",name:"Expectancy",description:"Average amount won or lost per trade",category:"performance"},{id:"numTrades",name:"Total Trades",description:"Total number of trades",category:"volume"},{id:"numWinTrades",name:"Winning Trades",description:"Number of winning trades",category:"volume"},{id:"numLossTrades",name:"Losing Trades",description:"Number of losing trades",category:"volume"},{id:"avgWin",name:"Avg Win",description:"Average profit of winning trades",category:"average"},{id:"avgLoss",name:"Avg Loss",description:"Average loss of losing trades",category:"average"}];var Wo=_(B());Zt();var Qr=_(B()),OT=_(QK());Zt();Ft();var Ua=[{id:"pnlChart",name:"Cumulative P&L",description:"Line chart showing cumulative P&L over time",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"performanceCalendar",name:"Performance Calendar",description:"Calendar view showing daily performance",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"dailyPerformance",name:"Daily Performance",description:"Bar chart showing P&L for each trading day",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"tradesChart",name:"Trades Chart",description:"Bar chart showing P&L for each individual trade",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"drawdownChart",name:"Drawdown Chart",description:"Chart showing percentage drawdown from peak equity",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"recentTrades",name:"Recent Trades",description:"Shows the 10 most recent trades with details",category:"journal",minSize:{w:4,h:3},defaultSize:{w:6,h:4}}];var LT=_(B());var Vs=_(B());Zt();Ft();vd();var cs=({filters:e,dateFormat:t,children:r})=>{let n=Ee(),{dashboardData:a,isLoading:o,isStale:i,error:s,refreshData:l}=yg(),c=t||Ot();return(0,Vs.useEffect)(()=>{Promise.resolve().then(()=>(wv(),ZD)).then(({ensureChartStyles:d})=>{d()}).catch(d=>{console.error("Error loading chart styles:",d)}),Promise.resolve().then(()=>(kv(),w$)).then(({ensureSharedComponentStyles:d})=>{d()}).catch(d=>{console.error("Error loading shared component styles:",d)})},[]),(0,Vs.useEffect)(()=>{let d=()=>{l()};return document.addEventListener("journalit:trade-data-changed",d),()=>{document.removeEventListener("journalit:trade-data-changed",d)}},[l]),Vs.default.createElement("div",{className:"journalit-dashboard-widget-container",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},o&&!a?Vs.default.createElement(sr,{fullscreen:!0}):s?Vs.default.createElement("div",{className:"journalit-dashboard-widget-error",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",textAlign:"center",padding:"16px",color:"var(--text-error)"}},(typeof s=="string"?s:s==null?void 0:s.message)||"Failed to load data"):!a||a.trades.length===0?Vs.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"}},Vs.default.createElement(Ie,{message:"No data available",subMessage:"Try adjusting your filter settings",iconSize:40,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!n||!n.app)return;new Jn({app:n.app,plugin:n}).open()}})):Vs.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"transparent",position:"relative"}},r(a,c),(i||o)&&Vs.default.createElement(sr,{message:"Loading...",size:"small",overlay:!0})))};var ZK=LT.default.memo(({filters:e,dateFormat:t})=>LT.default.createElement(cs,{filters:e,dateFormat:t},(r,n)=>{let a=sv(r.trades,n);return LT.default.createElement(El,{data:a,onPointClick:(o,i)=>{}})}));var PF=_(B());var e9=({filters:e})=>PF.default.createElement(cs,{filters:e},t=>PF.default.createElement(OC,{trades:t.trades,filters:e}));var Og=_(B());Ft();var t9=Og.default.memo(({filters:e,dateFormat:t})=>((0,Og.useEffect)(()=>{Promise.resolve().then(()=>(wv(),ZD)).then(({ensureChartStyles:r})=>{r()})},[]),Og.default.createElement(cs,{filters:e,dateFormat:t},(r,n)=>{let a={};r.trades.forEach(i=>{let s=i.entryTime.toISOString().split("T")[0];a[s]||(a[s]={pnl:0,trades:0}),a[s].pnl+=i.pnl,a[s].trades+=1});let o=Object.entries(a).map(([i,s])=>({date:Fe(new Date(i),n),originalDate:i,pnl:s.pnl,trades:s.trades,fill:s.pnl>=0?"var(--chart-positive)":"var(--chart-negative)"}));return o.sort((i,s)=>new Date(i.originalDate).getTime()-new Date(s.originalDate).getTime()),Og.default.createElement(uO,{data:o})})));var DF=_(B());var r9=({filters:e,dateFormat:t})=>DF.default.createElement(cs,{filters:e,dateFormat:t},(r,n)=>{let a=lv(r.trades);return DF.default.createElement(fb,{data:a,onPointClick:(o,i)=>{o!=null&&o.path},className:"dashboard-trades-chart",style:{boxShadow:"var(--shadow-s)"}})});var MT=_(B());var n9=MT.default.memo(({filters:e,dateFormat:t})=>MT.default.createElement(cs,{filters:e,dateFormat:t},(r,n)=>{let a=ku(r.trades,n);return MT.default.createElement(kc,{data:a,showTooltip:!0,tooltipProps:{wrapperStyle:{zIndex:1001}}})}));var Xr=_(B());er();Zt();vd();Ea();Ct();var _ye=(e,t)=>{var r,n;try{let a=((n=(r=t==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.dateFormat)||"MMDDYY",o=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getFullYear()).slice(2);switch(a){case"DDMMYY":return`${o}/${i}/${l}`;case"MMDDYY":return`${i}/${o}/${l}`;case"YYMMDD":return`${l}/${i}/${o}`;default:return e.toLocaleDateString()}}catch(a){return e.toLocaleDateString()}},a9=({filters:e})=>{let t=Ee(),{currency:r}=Ae(),n=a=>{t&&t.app.workspace.openLinkText(a,"",!0)};return Xr.default.createElement(cs,{filters:e},a=>{let o=[...a.trades].sort((i,s)=>s.entryTime.getTime()-i.entryTime.getTime()).slice(0,10);return Xr.default.createElement("div",{className:"journalit-dashboard-recent-trades"},Xr.default.createElement("table",{className:"journalit-dashboard-recent-trades-table"},Xr.default.createElement("thead",null,Xr.default.createElement("tr",null,Xr.default.createElement("th",null,"Date"),Xr.default.createElement("th",null,"Ticker"),Xr.default.createElement("th",null,"Direction"),Xr.default.createElement("th",{className:"pnl-column"},"P&L"),Xr.default.createElement("th",null,"Setups"))),Xr.default.createElement("tbody",null,o.length===0?Xr.default.createElement("tr",null,Xr.default.createElement("td",{colSpan:5,style:{padding:"20px 0",textAlign:"center",height:"150px",position:"relative"}},Xr.default.createElement("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center"}},Xr.default.createElement(Ie,{message:"No trades found",subMessage:"Try selecting a different date range",iconSize:32,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!t||!t.app)return;new Jn({app:t.app,plugin:t}).open()}})))):o.map((i,s)=>{let l=i.tradeStatus==="CLOSED"?!1:i.tradeStatus==="OPEN"||i._originalPnlWasNull&&!i.tradeStatus?!0:ct({tradeStatus:i.tradeStatus,exitTime:i.exitTime,pnl:i._originalPnlWasNull?null:i.pnl,useDirectPnLInput:i.useDirectPnLInput,exits:i.exits}),c=!l&&i.pnl>0,d=!l&&i.pnl<0,u=Array.isArray(i.setup)?i.setup:i.setup?[i.setup]:[];return Xr.default.createElement("tr",{key:`${i.path}-${s}`,onClick:()=>n(i.path),className:`trade-row ${s%2===0?"even":"odd"} ${l?"open-trade":""}`},Xr.default.createElement("td",{className:"date-cell"},_ye(i.entryTime,t)),Xr.default.createElement("td",{className:"ticker-cell"},i.instrument||"Unknown"),Xr.default.createElement("td",{className:"direction-cell"},i.direction==="long"?"Long":"Short"),Xr.default.createElement("td",{className:`pnl-cell ${l?"open":c?"positive":d?"negative":""}`},l?"OPEN":ue(i.pnl,!0,r)),Xr.default.createElement("td",{className:"setups-cell"},u.length>0?u.slice(0,2).join(", ")+(u.length>2?"...":""):"-"))}))))})};var zp=(e,t,r,n,a)=>{var i,s,l;if(!e||e.length===0)return{i:t,x:0,y:0,w:r,h:n};if(a)try{let c=((s=(i=a.settings)==null?void 0:i.dashboard)==null?void 0:s.layouts)||{};for(let d in c){let m=(((l=c[d].bottomSection)==null?void 0:l.lg)||[]).find(h=>h.i===t);if(m)return{i:t,x:0,y:1/0,w:m.w,h:m.h}}}catch(c){console.error("Error finding previous layout:",c)}let o=0;return e.forEach(c=>{let d=c.y+c.h;d>o&&(o=d)}),{i:t,x:0,y:o,w:r,h:n}},Bye=(0,OT.WidthProvider)(OT.Responsive),o9=({filters:e,isEditing:t,widgets:r,onRemoveWidget:n})=>{let a=Ee(),[o,i]=(0,Qr.useState)({lg:[],md:[],sm:[],xs:[],xxs:[]}),s=u=>({...u,i:u.i,x:typeof u.x=="number"?u.x:0,y:typeof u.y=="number"?u.y:0,w:typeof u.w=="number"&&u.w>0?u.w:1,h:typeof u.h=="number"&&u.h>0?u.h:1});(0,Qr.useEffect)(()=>{(()=>{try{if(a){let p=ra(a),m=p.bottomSection.lg.filter(g=>r.includes(g.i)).map(s),h=p.bottomSection.md.filter(g=>r.includes(g.i)).map(s),f=p.bottomSection.sm.filter(g=>r.includes(g.i)).map(s),b=(p.bottomSection.xs||[]).filter(g=>r.includes(g.i)).map(s),v=(p.bottomSection.xxs||[]).filter(g=>r.includes(g.i)).map(s),y={lg:12,md:6,sm:4,xs:2,xxs:1};r.forEach(g=>{let w=m.some(T=>T.i===g),C=h.some(T=>T.i===g),k=f.some(T=>T.i===g),x=b.some(T=>T.i===g),S=v.some(T=>T.i===g);if(!w||!C||!k||!x||!S){let T=Ua.find(P=>P.id===g);if(T){let P,M="lg";if(w?(P=m.find(D=>D.i===g),M="lg"):C?(P=h.find(D=>D.i===g),M="md"):k?(P=f.find(D=>D.i===g),M="sm"):x?(P=b.find(D=>D.i===g),M="xs"):S&&(P=v.find(D=>D.i===g),M="xxs"),P||(P=zp(m,g,T.defaultSize.w,T.defaultSize.h,a)),!w){let D=zp(m,g,Math.min(P.w,12),P.h,a);m.push(D)}if(!C){let D={i:g,x:0,y:1/0,w:Math.min(P.w,6),h:P.h};h.push(D)}if(!k){let D={i:g,x:0,y:1/0,w:Math.min(P.w,4),h:P.h};f.push(D)}if(!x){let D={i:g,x:0,y:1/0,w:Math.min(P.w,2),h:P.h};b.push(D)}if(!S){let D={i:g,x:0,y:1/0,w:1,h:P.h};v.push(D)}}}}),i({lg:m,md:h,sm:f,xs:b,xxs:v})}}catch(p){console.error("Error loading layouts:",p);let m={lg:12,md:6,sm:4,xs:2,xxs:1},h=(b,v)=>{let y=Ua.find(k=>k.id===b),g=m[v],w=v==="xxs"?1:Math.min((y==null?void 0:y.defaultSize.w)||6,g),C=(y==null?void 0:y.defaultSize.h)||(v==="lg"?4:3);return s({i:b,x:0,y:0,w,h:C})},f={lg:r.map(b=>h(b,"lg")),md:r.map(b=>h(b,"md")),sm:r.map(b=>h(b,"sm")),xs:r.map(b=>h(b,"xs")),xxs:r.map(b=>h(b,"xxs"))};i(f)}})()},[a,r]);let l=u=>{let p=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:u}});document.dispatchEvent(p)},c=(u,p)=>{let m=new CustomEvent("layout-changed");if(document.dispatchEvent(m),t&&a)try{let h=ra(a),f=Object.keys(p).find(w=>JSON.stringify(p[w])===JSON.stringify(u))||"lg",b=u.map(w=>w.i),v={...h,bottomSection:{...h.bottomSection,lg:p.lg||[],md:p.md||[],sm:p.sm||[],xs:p.xs||[],xxs:p.xxs||[]}},y={lg:12,md:6,sm:4,xs:2,xxs:1};["lg","md","sm","xs","xxs"].forEach(w=>{if(w===f)return;let C=v.bottomSection[w],k=C.map(x=>x.i);v.bottomSection[w]=C.filter(x=>b.includes(x.i)),b.forEach(x=>{if(!k.includes(x)){let S=u.find(T=>T.i===x);if(S){let T=Ua.find(M=>M.id===x),P=(T==null?void 0:T.defaultSize)||{w:6,h:4};v.bottomSection[w].push({i:x,x:0,y:1/0,w:Math.min(Math.max(1,Math.floor(S.w*y[w]/y[f])),y[w]),h:S.h})}}})}),ya(a,"Default",v)}catch(h){console.error("Error saving layout:",h)}},d=u=>{var h,f;if(!Ua.find(b=>b.id===u))return Qr.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Unknown widget type: ",u);let m=((f=(h=a==null?void 0:a.settings)==null?void 0:h.trade)==null?void 0:f.dateFormat)||Ot();switch(u){case"pnlChart":return Qr.default.createElement(ZK,{filters:e,dateFormat:m});case"performanceCalendar":return Qr.default.createElement(e9,{filters:e,dateFormat:m});case"dailyPerformance":return Qr.default.createElement(t9,{filters:e,dateFormat:m});case"tradesChart":return Qr.default.createElement(r9,{filters:e,dateFormat:m});case"drawdownChart":return Qr.default.createElement(n9,{filters:e,dateFormat:m});case"recentTrades":return Qr.default.createElement(a9,{filters:e,dateFormat:m});default:return Qr.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Widget not implemented: ",u)}};return Qr.default.createElement("div",{className:`journalit-dashboard-grid-layout ${t?"is-editing":""}`,style:{padding:"0",margin:"0"}},Qr.default.createElement(Bye,{className:"layout",layouts:o,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:6,sm:4,xs:2,xxs:1},rowHeight:50,isResizable:t,isDraggable:t,onLayoutChange:c,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,0],margin:[4,4]},r.map(u=>Qr.default.createElement("div",{key:u},Qr.default.createElement(()=>{var v;let m=y=>{y.stopPropagation(),y.preventDefault(),y.nativeEvent.stopImmediatePropagation(),n(u);let g=r.filter(w=>w!==u);l(g)},h=["pnlChart","dailyPerformance","tradesChart","drawdownChart"],f=t||h.includes(u),b=!t&&h.includes(u);return Qr.default.createElement("div",{className:"journalit-dashboard-widget",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"transparent",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"}},t&&Qr.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:m,style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",zIndex:1e4,padding:0,fontWeight:"bold",lineHeight:1},onMouseDown:y=>{y.stopPropagation(),y.preventDefault()},"aria-label":"Remove widget"},"\u2715"),b&&Qr.default.createElement("div",{className:"journalit-dashboard-widget-minimal-header",style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"4px 12px 4px 12px",height:"24px",backgroundColor:"transparent",borderBottom:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.4)",opacity:.8}},Qr.default.createElement("div",{className:"journalit-dashboard-widget-title",style:{fontWeight:"500",fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center",width:"100%"}},((v=Ua.find(y=>y.id===u))==null?void 0:v.name)||u)),Qr.default.createElement("div",{className:"journalit-dashboard-widget-content",style:{flex:1,padding:"4px 4px 2px 1px",height:b?"calc(100% - 24px)":"100%",overflow:"hidden"}},d(u)))},null)))))};var Gs=_(B()),i9=({availableWidgets:e,activeWidgets:t,onAddWidget:r,onClose:n})=>(console.warn("ComponentSelector is deprecated, use UnifiedComponentSelector instead"),Gs.default.createElement("div",{className:"journalit-dashboard-component-selector"},Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},Gs.default.createElement("h3",null,"Add Widget"),Gs.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:n,"aria-label":"Close"},"\xD7")),Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},e.map(a=>Gs.default.createElement("div",{key:a.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{r(a.id),n()},style:{opacity:t.includes(a.id)?.5:1}},Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},a.name),a.description&&Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},a.description),a.category&&Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-category"},a.category),t.includes(a.id)&&Gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))))));var EF=({filters:e,isEditing:t,hideAddButton:r=!1})=>{let n=Ee(),[a,o]=(0,Wo.useState)(!1),[i,s]=(0,Wo.useState)([]);return(0,Wo.useEffect)(()=>{let d=u=>{s([...u.detail.activeWidgets])};return document.addEventListener("journalit:widgets-changed",d),()=>{document.removeEventListener("journalit:widgets-changed",d)}},[]),(0,Wo.useEffect)(()=>{let d=()=>{try{if(n){let m=ra(n).bottomSection.lg.map(h=>h.i);s(m)}}catch(p){console.error("Error initializing layout:",p),s(["pnlChart","performanceCalendar","dailyPerformance"])}};d();let u=()=>{d()};return document.addEventListener("journalit:settings-updated",u),()=>{document.removeEventListener("journalit:settings-updated",u)}},[n]),(0,Wo.useEffect)(()=>{!t&&a&&o(!1)},[t]),Wo.default.createElement("div",{className:"journalit-dashboard-bottom-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!r&&Wo.default.createElement("div",{className:"journalit-dashboard-bottom-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},Wo.default.createElement("button",{className:"journalit-dashboard-add-widget-button",onClick:()=>o(!a),style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Widget")),Wo.default.createElement("div",{style:{position:"relative"}},!r&&a&&Wo.default.createElement(i9,{availableWidgets:Ua,activeWidgets:i,onAddWidget:d=>{if(n)try{let u=ra(n),p=Ua.find(v=>v.id===d);if(!p)throw new Error(`Widget definition not found: ${d}`);if(i.includes(d))return;let m=zp(u.bottomSection.lg,d,p.defaultSize.w,p.defaultSize.h,n),h={lg:12,md:6,sm:4,xs:2,xxs:1},f={};Object.keys(h).forEach(v=>{let y=h[v],g=Math.min(p.defaultSize.w,y);f[v]={i:d,x:0,y:1/0,w:g,h:p.defaultSize.h}});let b={...u,bottomSection:{lg:[...u.bottomSection.lg,f.lg],md:[...u.bottomSection.md,f.md],sm:[...u.bottomSection.sm,f.sm],xs:[...u.bottomSection.xs||[],f.xs],xxs:[...u.bottomSection.xxs||[],f.xxs]}};ya(n,"Default",b),s([...i,d]),o(!1)}catch(u){console.error("Error adding widget:",u)}},onClose:()=>o(!1)}),Wo.default.createElement(o9,{filters:e,isEditing:t,widgets:i,onRemoveWidget:d=>{if(n)try{let u=ra(n),p={...u,bottomSection:{lg:u.bottomSection.lg.filter(f=>f.i!==d),md:u.bottomSection.md.filter(f=>f.i!==d),sm:u.bottomSection.sm.filter(f=>f.i!==d),xs:(u.bottomSection.xs||[]).filter(f=>f.i!==d),xxs:(u.bottomSection.xxs||[]).filter(f=>f.i!==d)}};ya(n,"Default",p);let m=i.filter(f=>f!==d);s(m);let h=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:m}});document.dispatchEvent(h)}catch(u){console.error("Error removing widget:",u)}}})))};var ot=_(B());Zt();var s9=({activeMetrics:e,activeWidgets:t,onAddMetric:r,onAddWidget:n,onClose:a})=>{let o=Ee(),[i,s]=(0,ot.useState)("all"),[l,c]=(0,ot.useState)(""),d=Array.from(new Set(Ua.map(h=>h.category||"general"))),u=[{id:"all",name:"All Widgets"},{id:"metrics",name:"Metrics"},...d.map(h=>({id:h,name:h.charAt(0).toUpperCase()+h.slice(1)}))],p=jY.filter(h=>l===""||h.name.toLowerCase().includes(l.toLowerCase())),m=Ua.filter(h=>{let f=l===""||h.name.toLowerCase().includes(l.toLowerCase()),b=i==="all"||h.category===i;return f&&b});return ot.default.createElement("div",{className:"unified-selector-overlay",onClick:h=>{h.target===h.currentTarget&&a()}},ot.default.createElement("div",{className:"journalit-dashboard-component-selector",onClick:h=>h.stopPropagation()},ot.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},ot.default.createElement("h3",null,"Add Widget"),ot.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:a,"aria-label":"Close"},ot.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ot.default.createElement("path",{d:"M13 1L1 13M1 1L13 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),ot.default.createElement("div",{className:"journalit-dashboard-component-selector-search"},ot.default.createElement("input",{type:"text",placeholder:"Search widgets...",value:l,onChange:h=>c(h.target.value)})),ot.default.createElement("div",{className:"journalit-dashboard-component-selector-categories"},u.map(h=>ot.default.createElement("button",{key:h.id,className:`journalit-dashboard-component-selector-category ${i===h.id?"active":""}`,onClick:()=>s(h.id)},h.name))),ot.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},i==="all"&&ot.default.createElement(ot.default.Fragment,null,p.length===0?ot.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(h=>ot.default.createElement("div",{key:h.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!e.includes(h.id)&&(r(h.id),o))try{let f=ra(o),b=[...f.topSection];b.includes(h.id)||b.push(h.id);let v={...f,topSection:b};ya(o,"Default",v).then(()=>{let y=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:b}});document.dispatchEvent(y)}).catch(y=>{console.error("Error saving layout:",y)})}catch(f){console.error("Error adding metric:",f)}},style:{opacity:e.includes(h.id)?.5:1}},ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},h.name),h.description&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},h.description),e.includes(h.id)&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))),p.length>0&&m.length>0&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-divider"}),m.length===0?ot.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(h=>ot.default.createElement("div",{key:h.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!t.includes(h.id)&&o)try{let f=ra(o),b=Ua.find(g=>g.id===h.id);if(!b)throw new Error(`Widget definition not found: ${h.id}`);let v=zp(f.bottomSection.lg,h.id,b.defaultSize.w,b.defaultSize.h,o),y={...f,bottomSection:{lg:[...f.bottomSection.lg,v],md:[...f.bottomSection.md,v],sm:[...f.bottomSection.sm,v],xs:[...f.bottomSection.xs||[],{...v,w:Math.min(v.w,2)}],xxs:[...f.bottomSection.xxs||[],{...v,w:1}]}};ya(o,"Default",y).then(()=>{n(h.id);let g=[...t,h.id],w=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:g}});document.dispatchEvent(w)}).catch(g=>{console.error("Error saving layout after adding widget:",g)})}catch(f){console.error("Error adding widget:",f)}},style:{opacity:t.includes(h.id)?.5:1}},ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},h.name),h.description&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},h.description),t.includes(h.id)&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),i==="metrics"&&ot.default.createElement(ot.default.Fragment,null,p.length===0?ot.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(h=>ot.default.createElement("div",{key:h.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!e.includes(h.id)&&(r(h.id),o))try{let f=ra(o),b=[...f.topSection];b.includes(h.id)||b.push(h.id);let v={...f,topSection:b};ya(o,"Default",v).then(()=>{let y=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:b}});document.dispatchEvent(y)}).catch(y=>{console.error("Error saving layout:",y)})}catch(f){console.error("Error adding metric:",f)}},style:{opacity:e.includes(h.id)?.5:1}},ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},h.name),h.description&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},h.description),e.includes(h.id)&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),i!=="metrics"&&i!=="all"&&ot.default.createElement(ot.default.Fragment,null,m.length===0?ot.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(h=>ot.default.createElement("div",{key:h.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!t.includes(h.id)&&o)try{let f=ra(o),b=Ua.find(g=>g.id===h.id);if(!b)throw new Error(`Widget definition not found: ${h.id}`);let v=zp(f.bottomSection.lg,h.id,b.defaultSize.w,b.defaultSize.h,o),y={...f,bottomSection:{lg:[...f.bottomSection.lg,v],md:[...f.bottomSection.md,v],sm:[...f.bottomSection.sm,v],xs:[...f.bottomSection.xs||[],{...v,w:Math.min(v.w,2)}],xxs:[...f.bottomSection.xxs||[],{...v,w:1}]}};ya(o,"Default",y).then(()=>{n(h.id);let g=[...t,h.id],w=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:g}});document.dispatchEvent(w)}).catch(g=>{console.error("Error saving layout after adding widget:",g)})}catch(f){console.error("Error adding widget:",f)}},style:{opacity:t.includes(h.id)?.5:1}},ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},h.name),h.description&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},h.description),t.includes(h.id)&&ot.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))))))};vd();Zt();var l9=({isLoading:e,dashboardData:t,filters:r,isEditing:n,showUnifiedSelector:a,activeMetrics:o,activeWidgets:i,onAddMetric:s,onAddWidget:l,onCloseSelector:c,openUnifiedSelector:d})=>{let u=Ee(),p=()=>{if(!u||!u.app)return;new Jn({app:u.app,plugin:u}).open()};return e?co.default.createElement("div",{className:"journalit-dashboard-loading"},"Loading dashboard..."):!t||t.trades.length===0?co.default.createElement("div",{style:{padding:"40px 0",display:"flex",justifyContent:"center",alignItems:"center",flex:"1",width:"100%",minHeight:"300px"}},co.default.createElement(Ie,{message:"No trading data available",subMessage:"Add some trades to see your dashboard come to life",iconSize:56,actionButtonText:"Add Trade",onActionButtonClick:p})):co.default.createElement(co.default.Fragment,null,n&&co.default.createElement("div",{className:"journalit-dashboard-unified-selector-button-container",style:{marginBottom:"4px"}},co.default.createElement("button",{className:"journalit-dashboard-add-component-button",onClick:d},co.default.createElement("span",null,"+")," Add Widget")),co.default.createElement("div",{className:"journalit-dashboard-unified-container",style:{gap:"10px",backgroundColor:"transparent"}},co.default.createElement("div",{style:{position:"relative"}},co.default.createElement(IO,{filters:r,isEditing:n,hideAddButton:!0})),co.default.createElement("div",{style:{position:"relative"}},co.default.createElement(EF,{filters:r,isEditing:n,hideAddButton:!0}))),a&&co.default.createElement(s9,{activeMetrics:o,activeWidgets:i,onAddMetric:s,onAddWidget:l,onClose:c}))};var fr=_(B());xv();Yn();Zt();var AF=()=>{var P,M;let e=Ee(),[t,r]=(0,fr.useState)(()=>({dateRange:[null,null],accounts:[],tickers:[]})),[n,a]=(0,fr.useState)(!1),[o,i]=(0,fr.useState)(!1),[s,l]=(0,fr.useState)(!1),[c,d]=(0,fr.useState)(0),[u,p]=(0,fr.useState)([]),[m,h]=(0,fr.useState)([]);(0,fr.useEffect)(()=>{d(D=>D+1)},[m,u]);let f=(0,fr.useCallback)(D=>{h(D.detail.activeWidgets)},[]),b=(0,fr.useCallback)(D=>{p(D.detail.activeMetrics)},[]),v=(0,fr.useCallback)(()=>{document.dispatchEvent(new CustomEvent("journalit:trade-data-changed"))},[]);(0,fr.useEffect)(()=>(document.addEventListener("journalit:widgets-changed",f),()=>{document.removeEventListener("journalit:widgets-changed",f)}),[f]);let y=(0,fr.useMemo)(()=>e?ra(e):null,[e]);(0,fr.useEffect)(()=>(document.querySelector('[data-dashboard-styles="true"]')||(KD(),Im(),document.documentElement.setAttribute("data-dashboard-styles","true")),(async()=>{try{e&&y&&(p(y.topSection),h(y.bottomSection.lg.map(A=>A.i)),requestAnimationFrame(()=>{bv()}))}catch(A){console.error("Failed to initialize dashboard:",A)}})(),document.addEventListener("journalit:metrics-changed",b),document.addEventListener("journalit:trade-data-changed",v),()=>{document.removeEventListener("journalit:metrics-changed",b),document.removeEventListener("journalit:trade-data-changed",v)}),[e,y,b,v]),(0,fr.useEffect)(()=>{var D,A;((A=(D=e==null?void 0:e.settings)==null?void 0:D.trade)==null?void 0:A.skipWeekends)!==void 0&&requestAnimationFrame(()=>{bv()})},[(M=(P=e==null?void 0:e.settings)==null?void 0:P.trade)==null?void 0:M.skipWeekends]);let g=(0,fr.useCallback)(D=>{r(D)},[]),w=(0,fr.useCallback)(()=>{i(D=>{let A=!D;return A===!1&&s&&l(!1),A})},[s]),C=(0,fr.useCallback)(()=>{l(!0),setTimeout(()=>Im(),10)},[]),k=(0,fr.useCallback)(()=>{l(!1)},[]),x=(0,fr.useCallback)(D=>{try{if(!u.includes(D)&&(p(A=>[...A,D]),e&&y)){let A={...y,topSection:[...u,D]};ya(e,"Default",A).catch(L=>{console.error("Error saving layout after adding metric:",L)})}}catch(A){console.error("Error in handleAddMetric:",A)}},[u,e,y]),S=(0,fr.useMemo)(()=>{let D={lg:12,md:6,sm:4,xs:2,xxs:1};return(A,L,N)=>{let E=D[L],I=Math.min(N.defaultSize.w,E);return{i:A,x:0,y:1e4,w:I,h:N.defaultSize.h}}},[]),T=(0,fr.useCallback)(D=>{if(!(!e||!y||m.includes(D)))try{let A=Ua.find(I=>I.id===D);if(!A){console.warn(`Widget definition not found: ${D}`);return}let N=["lg","md","sm","xs","xxs"].reduce((I,O)=>(I[O]=S(D,O,A),I),{}),E={...y,bottomSection:{lg:[...y.bottomSection.lg,N.lg],md:[...y.bottomSection.md,N.md],sm:[...y.bottomSection.sm,N.sm],xs:[...y.bottomSection.xs||[],N.xs],xxs:[...y.bottomSection.xxs||[],N.xxs]}};ya(e,"Default",E),h(I=>[...I,D])}catch(A){console.error("Error adding widget:",A)}},[m,e,y,S]);return{filters:t,setFilters:r,isLoading:n,isEditing:o,showUnifiedSelector:s,selectorKey:c,activeMetrics:u,activeWidgets:m,handleFilterChange:g,toggleEditMode:w,openUnifiedSelector:C,closeUnifiedSelector:k,handleAddMetric:x,handleAddWidget:T}};Zt();var ds="journalit-dashboard-view",zb=class extends Rd{getDisplayText(){return"Journalit Dashboard"}getViewType(){return ds}getIcon(){return"grip"}async onOpen(){try{await super.onOpen(),Ps(!0,!0,!0,!0),Tu(!0,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-dashboard-view-container"),Object.assign(this.containerEl.style,{padding:"0",overflow:"hidden"})),Im()}catch(t){console.error("Error in DashboardView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in DashboardView.onClose:",t)}}getRenderFunction(){return()=>Yd.default.createElement($ye,{leaf:this.leaf,view:this})}},$ye=({leaf:e,view:t})=>{let r=Ee(),{filters:n,isLoading:a,isEditing:o,showUnifiedSelector:i,activeMetrics:s,activeWidgets:l,handleFilterChange:c,toggleEditMode:d,openUnifiedSelector:u,closeUnifiedSelector:p,handleAddMetric:m,handleAddWidget:h}=AF();return r?Yd.default.createElement(WG,{app:r.app,tradeService:r.tradeService,filters:n},Yd.default.createElement("div",{className:"journalit-dashboard-view"},Yd.default.createElement(yO,{filters:n,onFilterChange:c,isEditing:o,onToggleEditMode:d}),Yd.default.createElement(Rye,{isLoading:a,filters:n,isEditing:o,showUnifiedSelector:i,activeMetrics:s,activeWidgets:l,onAddMetric:m,onAddWidget:h,onCloseSelector:p,openUnifiedSelector:u}))):Yd.default.createElement("div",{className:"journalit-dashboard-view"},"Loading...")},Rye=e=>{let{dashboardData:t}=yg();return Yd.default.createElement(l9,{...e,dashboardData:t})};xv();var L9=require("obsidian"),JF=_(B()),M9=_(vo());Ja();er();Ft();ym();var _b=new Map,Wye=10;function c9(e){if(e==null)return"null";if(typeof e!="object")return JSON.stringify(e);let t={};return Object.keys(e).sort().forEach(r=>{t[r]=typeof e[r]=="object"&&e[r]!==null?c9(e[r]):e[r]}),JSON.stringify(t)}function d9(e,t){var m,h;if(!e||e.length===0)return{totalAccounts:0,totalAUM:0,totalGrowthAmount:0,totalGrowthPercent:0,totalWithdrawals:0,totalTrades:0};let r=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],n=((h=t==null?void 0:t.account)==null?void 0:h.includeWithdrawalsFromExcluded)||{archived:!0},a=e.filter(f=>!r.includes(f.accountType.toLowerCase())),o=[...a,...e.filter(f=>r.includes(f.accountType.toLowerCase())&&n[f.accountType.toLowerCase()])],i=a.length,s=a.reduce((f,b)=>f+b.currentBalance,0),l=a.reduce((f,b)=>f+b.initialBalance,0),c=s-l,d=l>0?c/l*100:0,u=o.reduce((f,b)=>{let v=b.transactions.filter(y=>y.type==="withdrawal"||y.type==="deposit"&&y.amount<0).reduce((y,g)=>y+Math.abs(g.amount),0);return f+v},0),p=a.reduce((f,b)=>f+b.metrics.totalTrades,0);return{totalAccounts:i,totalAUM:s,totalGrowthAmount:c,totalGrowthPercent:d,totalWithdrawals:u,totalTrades:p}}function u9(e,t){var m;if(!e||e.length===0)return[];let r=e.map(h=>h.id).sort().join(","),n=c9(t||{}),a=`${r}:${n}`,o=_b.get(a);if(o)return o.data;let i=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],s=e.filter(h=>!i.includes(h.accountType.toLowerCase()));if(s.length===0)return[];let l=new Map,c=new Map;s.forEach(h=>{let f=new Map,b=new Date(h.createdDate).toISOString().split("T")[0];l.has(b)||l.set(b,{depositsForDay:0,withdrawalsForDay:0}),l.get(b).accountCreated=h.id;let v=[...h.transactions].sort((g,w)=>new Date(g.date).getTime()-new Date(w.date).getTime()),y=h.initialBalance;if(v.forEach(g=>{let w=new Date(g.date).toISOString().split("T")[0];y=g.balanceAfter,f.set(w,y),l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0});let C=l.get(w);g.type==="deposit"&&g.amount>0?C.depositsForDay+=g.amount:(g.type==="withdrawal"||g.type==="deposit"&&g.amount<0)&&(C.withdrawalsForDay+=Math.abs(g.amount))}),h.accountType.toLowerCase()==="archived"&&v.length>0){let g=v[v.length-1],w=new Date(g.date).toISOString().split("T")[0];l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0}),l.get(w).accountArchived=h.id}c.set(h.id,f)});let d=[...l.keys()].sort(),u=[],p=new Map;if(s.forEach(h=>{p.set(h.id,h.initialBalance)}),d.forEach(h=>{let f=new Date(h),b=l.get(h);s.forEach(y=>{if(new Date(y.createdDate)<=f){let g=c.get(y.id),w=y.initialBalance;for(let[C,k]of g)if(C<=h)w=k;else break;p.set(y.id,w)}});let v=0;for(let[y,g]of p){let w=s.find(C=>C.id===y);new Date(w.createdDate)<=f&&(v+=g)}u.push({date:Fe(f,Ot()),rawDate:f,balance:v,isDeposit:b.depositsForDay>0,depositAmount:b.depositsForDay>0?b.depositsForDay:void 0,isWithdrawal:b.withdrawalsForDay>0,withdrawalAmount:b.withdrawalsForDay>0?b.withdrawalsForDay:void 0,accountCreated:b.accountCreated,accountArchived:b.accountArchived})}),_b.size>=Wye){let h=_b.keys().next().value;_b.delete(h)}return _b.set(a,{settings:t,data:u}),u}function p9(e){if(!e||e.length===0)return{};let t=e.reduce((n,a)=>{let o=a.accountType.toLowerCase();return n[o]||(n[o]=[]),n[o].push(a),n},{}),r={};return Object.entries(t).forEach(([,n])=>{let a=n[0].accountType;r[a]=n}),r}function FT(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function m9(e){let r=Math.abs(new Date().getTime()-new Date(e).getTime()),n=Math.floor(r/(1e3*60*60*24));if(n<30)return`${n} day${n===1?"":"s"}`;if(n<365){let a=Math.floor(n/30);return`${a} month${a===1?"":"s"}`}else{let a=Math.floor(n/365),o=Math.floor(n%365/30);return o===0?`${a} year${a===1?"":"s"}`:`${a}y ${o}m`}}function f9(e){if(e.drawdownType==="none"||e.drawdownAmount<=0)return 0;let r=(e.currentBalance-e.maxDrawdownReached)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function g9(e,t="USD"){return!e.monthlyCost||e.monthlyCost<=0?"N/A":`${av(e.monthlyCost,t)}/month`}function Uye(e){if(!e.monthlyCost||e.monthlyCost<=0)return 0;let t=new Date(e.createdDate),r;if(e.accountType.toLowerCase()==="archived")if(e.transactions.length>0){let s=[...e.transactions].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());r=new Date(s[s.length-1].date)}else r=t;else r=new Date;let n=Math.abs(r.getTime()-t.getTime()),a=Math.floor(n/(1e3*60*60*24)),o=Math.floor(a/30),i=Math.max(1,o);return e.monthlyCost*i}function h9(e,t="USD"){let r=Uye(e);return r<=0?"N/A":av(r,t)}function jT(e){if(!e.hasProfitTarget||e.profitTarget<=0)return 0;let t=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,n=e.metrics.totalPnL/t*100;return Math.min(100,Math.max(0,n))}function v9(e){return e.transactions.filter(t=>t.type==="withdrawal"||t.type==="deposit"&&t.amount<0).reduce((t,r)=>t+Math.abs(r.amount),0)}function zT(e){if(e.drawdownType==="none"||e.drawdownAmount<=0)return 0;let r=(e.initialBalance-e.currentBalance)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function _T(e,t){if(!e||e.length===0)return{aumAmount:0,aumWeightPercent:0,totalWithdrawals:0,accountCount:0,totalTrades:0,totalGrowthAmount:0,totalGrowthPercent:0};let r=e.reduce((d,u)=>d+u.currentBalance,0),n=t>0?r/t*100:0,a=e.reduce((d,u)=>{let p=u.transactions.filter(m=>m.type==="withdrawal"||m.type==="deposit"&&m.amount<0).reduce((m,h)=>m+Math.abs(h.amount),0);return d+p},0),o=e.length,i=e.reduce((d,u)=>d+u.metrics.totalTrades,0),s=e.reduce((d,u)=>d+u.initialBalance,0),l=r-s,c=s>0?l/s*100:0;return{aumAmount:r,aumWeightPercent:n,totalWithdrawals:a,accountCount:o,totalTrades:i,totalGrowthAmount:l,totalGrowthPercent:c}}var He=_(B());ll();ec();So();var Ye=_(B());er();Ct();var qye=(e,t)=>{let r=t-e,n;r<=100?n=10:r<=1e3?n=100:r<=1e4?n=1e3:r<=1e5?n=1e4:r<=1e6?n=1e5:n=1e6;let a=Math.floor(e/n)*n,o=[];for(let i=a;i<=t+n;i+=n)o.push(i);if(o.length>10){let i=[],s=Math.ceil(o.length/7);for(let l=0;l<o.length;l+=s)i.push(o[l]);return i[i.length-1]!==o[o.length-1]&&i.push(o[o.length-1]),i}return o},Hye=({active:e,payload:t,currency:r})=>{if(!e||!t||t.length===0)return null;let n=t[0].payload;return Ye.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},Ye.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},n.date),Ye.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"AUM: ",ue(n.balance,!0,r)),(n.isDeposit||n.isWithdrawal||n.accountCreated||n.accountArchived)&&Ye.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},n.isDeposit&&Ye.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ue(n.depositAmount,!0,r)),n.isWithdrawal&&Ye.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ue(n.withdrawalAmount,!0,r)),n.accountCreated&&Ye.default.createElement("div",{style:{color:"var(--text-success)"}},"Account Added"),n.accountArchived&&Ye.default.createElement("div",{style:{color:"var(--text-error)"}},"Account Archived")))},y9=({data:e,height:t=300})=>{let{currency:r}=Ae(),[n,a]=(0,Ye.useState)(!1);if((0,Ye.useEffect)(()=>{a(!1)},[e]),!e||e.length===0)return Ye.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},Ye.default.createElement(Ie,{message:"No account data",subMessage:"Add accounts to view AUM history"}));let o=e.map(c=>c.balance),i=Math.min(...o),s=Math.max(...o),l=s-i;return s=s+l*.05,i=i-l*.1,i=0,Ye.default.createElement("div",{className:"aum-chart"},Ye.default.createElement("div",{style:{width:"100%",height:`${t}px`,padding:"0 10px"}},Ye.default.createElement(js,{width:"100%",height:"100%"},Ye.default.createElement(mb,{data:e,margin:{top:10,right:10,left:0,bottom:10}},Ye.default.createElement("defs",null,Ye.default.createElement("linearGradient",{id:"aumGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Ye.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.6}),Ye.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.1})),Ye.default.createElement("filter",{id:"aumShadow",height:"120%"},Ye.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Ye.default.createElement("filter",{id:"aumGlow",height:"130%"},Ye.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Ye.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Ye.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Ye.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Ye.default.createElement(zn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Ye.default.createElement(_n,{tickFormatter:c=>ue(c,!0,r),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[i,s],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:8,ticks:qye(i,s)}),Ye.default.createElement(oo,{content:Ye.default.createElement(Hye,{currency:r}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"#41B4F7"},wrapperStyle:{zIndex:1e3}}),Ye.default.createElement(nn,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),Ye.default.createElement(Bo,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#aumGradient)",fillOpacity:1,dot:!1,activeDot:!1,filter:"url(#aumShadow)"}),Ye.default.createElement(Pl,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:2.5,onAnimationEnd:()=>a(!0),dot:c=>{let{cx:d,cy:u,payload:p}=c;return p?n?p.accountCreated?Ye.default.createElement("g",null,Ye.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"var(--text-success)",strokeWidth:"2"}),Ye.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"var(--text-success)",strokeWidth:"2"})):p.accountArchived?Ye.default.createElement("g",null,Ye.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"var(--text-error)",strokeWidth:"2"}),Ye.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"var(--text-error)",strokeWidth:"2"})):p.isDeposit?Ye.default.createElement("g",null,Ye.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"#41B4F7",strokeWidth:"2"}),Ye.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"#41B4F7",strokeWidth:"2"})):p.isWithdrawal?Ye.default.createElement("g",null,Ye.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"var(--text-warning, gold)",strokeWidth:"2"}),Ye.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"var(--text-warning, gold)",strokeWidth:"2"})):Ye.default.createElement("circle",{cx:d,cy:u,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):Ye.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):Ye.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:{r:7,stroke:"var(--background-primary)",strokeWidth:1,fill:"#41B4F7",filter:"url(#aumGlow)"},name:"AUM Balance"})))))};var Sn=_(B());er();Ct();var b9=({metrics:e})=>{let{currency:t}=Ae(),r=e.totalGrowthAmount>=0?"positive":"negative";return Sn.default.createElement("div",{className:"dashboard-metrics"},Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:"metric-value"},e.totalAccounts),Sn.default.createElement("div",{className:"metric-label"},"Total Accounts")),Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:"metric-value"},ue(e.totalAUM,!0,t)),Sn.default.createElement("div",{className:"metric-label"},"Total AUM")),Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:`metric-value ${r}`},ue(e.totalGrowthAmount,!0,t)),Sn.default.createElement("div",{className:"metric-label"},"Total Growth")),Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:`metric-value ${r}`},Pr(e.totalGrowthPercent)),Sn.default.createElement("div",{className:"metric-label"},"Growth %")),Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:"metric-value"},ue(e.totalWithdrawals,!0,t)),Sn.default.createElement("div",{className:"metric-label"},"Total Withdrawals")),Sn.default.createElement("div",{className:"metric-item"},Sn.default.createElement("div",{className:"metric-value"},e.totalTrades),Sn.default.createElement("div",{className:"metric-label"},"Total Trades")))};var qa=_(B());var Ze=_(B());er();Ja();Ct();var Vye=({account:e,onClick:t})=>{let{currency:r}=Ae(),n=(0,Ze.useMemo)(()=>{let a=m9(e.createdDate),o=e.currentBalance-e.initialBalance,i=e.initialBalance>0?o/e.initialBalance*100:0,s=o>=0?"positive":"negative",l=jT(e),c=l>=100?"complete":"",d=f9(e),u=zT(e),p="";u>=75?p="critical":u>=50?p="warning":p="safe";let m=v9(e),h=e.drawdownType!=="none"&&e.drawdownAmount>0,f=e.hasProfitTarget&&e.profitTarget>0,b=h?u>=100?"BREACHED":"IN PROGRESS":null,v=f?l>=100?"ACHIEVED":"IN PROGRESS":null;return{accountAge:a,growthAmount:o,growthPercent:i,growthClass:s,profitTargetProgress:l,profitTargetProgressClass:c,drawdownRemaining:d,drawdownUsed:u,drawdownProgressClass:p,totalWithdrawals:m,hasDrawdownSet:h,hasProfitTargetSet:f,drawdownStatus:b,profitTargetStatus:v}},[e.createdDate,e.currentBalance,e.initialBalance,e.profitTarget,e.hasProfitTarget,e.drawdownType,e.drawdownAmount,e.metrics.maxDrawdown,e.transactions]);return Ze.default.createElement("div",{className:"account-card",onClick:t},Ze.default.createElement("div",{className:"account-card-header"},Ze.default.createElement("div",{className:"account-identity"},Ze.default.createElement("div",{className:"account-name"},e.name),Ze.default.createElement("div",{className:"account-type-badge"},e.accountType)),Ze.default.createElement("div",{className:"account-balance"},Ze.default.createElement("div",{className:"balance-amount"},ue(e.currentBalance,!0,r)),Ze.default.createElement("div",{className:`balance-growth ${n.growthClass}`},ue(n.growthAmount,!0,r)," (",Pr(n.growthPercent),")"))),Ze.default.createElement("div",{className:"account-card-body"},Ze.default.createElement("div",{className:"key-metrics"},Ze.default.createElement("div",{className:"metric-item"},Ze.default.createElement("div",{className:"metric-value"},e.metrics.totalTrades),Ze.default.createElement("div",{className:"metric-label"},"Trades")),Ze.default.createElement("div",{className:"metric-item"},Ze.default.createElement("div",{className:"metric-value"},ue(n.totalWithdrawals,!0,r)),Ze.default.createElement("div",{className:"metric-label"},"Withdrawals")),Ze.default.createElement("div",{className:"metric-item"},Ze.default.createElement("div",{className:"metric-value"},n.accountAge),Ze.default.createElement("div",{className:"metric-label"},"Age"))),Ze.default.createElement("div",{className:"progress-section"},Ze.default.createElement("div",{className:`progress-item ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},Ze.default.createElement("div",{className:"progress-header"},Ze.default.createElement("div",{className:"progress-label-with-badge"},Ze.default.createElement("span",{className:"progress-label"},"Profit Target"),n.profitTargetStatus&&Ze.default.createElement("span",{className:`dashboard-status-badge ${n.profitTargetStatus==="ACHIEVED"?"achieved":"in-progress"}`},n.profitTargetStatus)),Ze.default.createElement("div",{className:`progress-value ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},e.hasProfitTarget&&e.profitTarget>0?Pr(n.profitTargetProgress):"Not set")),Ze.default.createElement("div",{className:"progress-bar-container"},Ze.default.createElement("div",{className:`progress-bar ${e.hasProfitTarget&&e.profitTarget>0&&n.profitTargetProgress>0?`profit-target ${n.profitTargetProgressClass}`:"empty"}`,style:{width:e.hasProfitTarget&&e.profitTarget>0?`${n.profitTargetProgress}%`:"0%"}}))),Ze.default.createElement("div",{className:`progress-item ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},Ze.default.createElement("div",{className:"progress-header"},Ze.default.createElement("div",{className:"progress-label-with-badge"},Ze.default.createElement("span",{className:"progress-label"},"Drawdown Used"),n.drawdownStatus&&Ze.default.createElement("span",{className:`dashboard-status-badge ${n.drawdownStatus==="BREACHED"?"breached":"in-progress"}`},n.drawdownStatus)),Ze.default.createElement("div",{className:`progress-value ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},e.drawdownType!=="none"&&e.drawdownAmount>0?Pr(n.drawdownUsed):"Not set")),Ze.default.createElement("div",{className:"progress-bar-container"},Ze.default.createElement("div",{className:`progress-bar ${e.drawdownType!=="none"&&e.drawdownAmount>0&&n.drawdownUsed>0?`drawdown ${n.drawdownProgressClass}`:"empty"}`,style:{width:e.drawdownType!=="none"&&e.drawdownAmount>0?`${n.drawdownUsed}%`:"0%"}})))),Ze.default.createElement("div",{className:"account-card-footer"},Ze.default.createElement("div",{className:"footer-metric"},Ze.default.createElement("span",{className:"footer-label"},"Monthly:"),Ze.default.createElement("span",{className:"footer-value"},g9(e,r))),Ze.default.createElement("div",{className:"footer-metric"},Ze.default.createElement("span",{className:"footer-label"},"Total Costs:"),Ze.default.createElement("span",{className:"footer-value"},h9(e,r))))))},Gye=(e,t)=>e.account.id===t.account.id&&e.account.name===t.account.name&&e.account.accountType===t.account.accountType&&e.account.currentBalance===t.account.currentBalance&&e.account.initialBalance===t.account.initialBalance&&e.account.metrics.totalTrades===t.account.metrics.totalTrades&&e.account.metrics.maxDrawdown===t.account.metrics.maxDrawdown&&e.account.profitTarget===t.account.profitTarget&&e.account.hasProfitTarget===t.account.hasProfitTarget&&e.account.drawdownType===t.account.drawdownType&&e.account.drawdownAmount===t.account.drawdownAmount&&e.account.createdDate===t.account.createdDate&&e.account.transactions.length===t.account.transactions.length&&e.account.monthlyCost===t.account.monthlyCost&&e.onClick===t.onClick,BT=Ze.default.memo(Vye,Gye);var sn=_(B());var IF=sn.default.memo(({accounts:e,openAccount:t,itemHeight:r=140,containerHeight:n=600,overscan:a=3,columns:o,minColumnWidth:i=300})=>{let[s,l]=(0,sn.useState)(0),[c,d]=(0,sn.useState)(0),u=(0,sn.useRef)(null),p=(0,sn.useMemo)(()=>o||(c===0?1:Math.max(1,Math.floor(c/i))),[o,c,i]),m=(0,sn.useMemo)(()=>{let g=[];for(let w=0;w<e.length;w+=p)g.push(e.slice(w,w+p));return g},[e,p]),h=(0,sn.useMemo)(()=>{let g=Math.max(0,Math.floor(s/r)-a),w=Math.ceil(n/r),C=Math.min(m.length,g+w+a*2);return{start:g,end:C}},[s,r,n,m.length,a]),f=(0,sn.useMemo)(()=>m.slice(h.start,h.end),[m,h]),b=(0,sn.useCallback)(()=>{u.current&&requestAnimationFrame(()=>{u.current&&l(u.current.scrollTop)})},[]),v=m.length*r,y=h.start*r;return(0,sn.useEffect)(()=>{let g=u.current;if(!g)return;let w=new ResizeObserver(C=>{for(let k of C){let x=k.contentRect.width;d(x),b()}});return w.observe(g),d(g.clientWidth),()=>{w.disconnect()}},[b]),sn.default.createElement("div",{ref:u,className:"virtualized-account-list",style:{height:n,overflowY:"auto",position:"relative"},onScroll:b},sn.default.createElement("div",{style:{height:v,position:"relative"}},sn.default.createElement("div",{style:{transform:`translateY(${y}px)`,position:"absolute",top:0,left:0,right:0}},f.map((g,w)=>sn.default.createElement("div",{key:h.start+w,className:"account-cards",style:{marginBottom:"15px"}},g.map(C=>sn.default.createElement(BT,{key:C.id,account:C,onClick:()=>t(C.name)})))))))},(e,t)=>e.accounts===t.accounts&&e.openAccount===t.openAccount&&e.itemHeight===t.itemHeight&&e.containerHeight===t.containerHeight&&e.overscan===t.overscan&&e.columns===t.columns&&e.minColumnWidth===t.minColumnWidth);IF.displayName="VirtualizedAccountList";var gr=_(B());er();Ct();var Yye=({type:e,accounts:t,totalAUM:r,isExcludedFromStats:n=!1})=>{let{currency:a}=Ae(),o=(0,gr.useMemo)(()=>_T(t,r),[t,r]),i=o.totalGrowthAmount>=0?"positive":"negative";return gr.default.createElement("div",{className:"account-type-header"},gr.default.createElement("div",{className:"account-type-name"},gr.default.createElement("h3",null,FT(e))),gr.default.createElement("div",{className:"account-type-metrics"},gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:`metric-value ${n?"excluded-status":"weight-percent"}`},n?"Excluded":Pr(o.aumWeightPercent)),gr.default.createElement("div",{className:"metric-label"},n?"From Stats":"of Total AUM")),gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:"metric-value"},ue(o.aumAmount,!0,a)),gr.default.createElement("div",{className:"metric-label"},"AUM")),gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:"metric-value"},ue(o.totalWithdrawals,!0,a)),gr.default.createElement("div",{className:"metric-label"},"Withdrawals")),gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:"metric-value"},o.accountCount),gr.default.createElement("div",{className:"metric-label"},"Account",o.accountCount!==1?"s":"")),gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:"metric-value"},o.totalTrades),gr.default.createElement("div",{className:"metric-label"},"Trade",o.totalTrades!==1?"s":"")),gr.default.createElement("div",{className:"metric-item"},gr.default.createElement("div",{className:`metric-value ${i}`},ue(o.totalGrowthAmount,!0,a)),gr.default.createElement("div",{className:"metric-label"},"Growth (",Pr(o.totalGrowthPercent),")"))))},Kye=(e,t)=>e.type===t.type&&e.totalAUM===t.totalAUM&&e.isExcludedFromStats===t.isExcludedFromStats&&e.accounts.length===t.accounts.length&&e.accounts.every((r,n)=>{let a=t.accounts[n];return a&&r.id===a.id&&r.currentBalance===a.currentBalance&&r.initialBalance===a.initialBalance&&r.metrics.totalTrades===a.metrics.totalTrades&&r.transactions.length===a.transactions.length}),x9=gr.default.memo(Yye,Kye);So();var Jye=({type:e,accounts:t,openAccount:r,totalAUM:n=0,excludedTypes:a=[]})=>{let o=(0,qa.useMemo)(()=>[...t].sort((l,c)=>c.currentBalance-l.currentBalance),[t]),i=o.length>50,s=a.includes(e.toLowerCase());return qa.default.createElement("div",{className:"account-section"},qa.default.createElement(x9,{type:e,accounts:o,totalAUM:n,isExcludedFromStats:s}),o.length===0?qa.default.createElement("div",{className:"account-section-content"},qa.default.createElement(Ie,{message:`No ${FT(e)} accounts`,subMessage:"Create an account to see it here",iconSize:40})):i?qa.default.createElement("div",{className:"account-section-content"},qa.default.createElement(IF,{accounts:o,openAccount:r,containerHeight:600,itemHeight:180,minColumnWidth:300})):qa.default.createElement("div",{className:"account-cards"},o.map(l=>qa.default.createElement(BT,{key:l.id,account:l,onClick:()=>r(l.name)}))))},Xye=qa.default.memo(Jye),Qye=({accountsByType:e,openAccount:t,plugin:r,refreshTrigger:n,totalAUM:a=0,excludedTypes:o=[]})=>{var l,c,d;let i=r||((d=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins)==null?void 0:d.journalit),s=(0,qa.useMemo)(()=>{var v,y,g,w;let u=Object.keys(e),p=((y=(v=i==null?void 0:i.settings)==null?void 0:v.account)==null?void 0:y.accountTypeOrder)||["funded","evaluation","demo","archived"],m=((w=(g=i==null?void 0:i.optionsService)==null?void 0:g.getOptions)==null?void 0:w.call(g,"account_type"))||[],h=new Set([...u.map(C=>C.toLowerCase()),...p.map(C=>C.toLowerCase()),...m.map(C=>C.toLowerCase())]),f=new Map;u.forEach(C=>f.set(C.toLowerCase(),C)),p.forEach(C=>{if(!f.has(C.toLowerCase())){let k=C.charAt(0).toUpperCase()+C.slice(1).toLowerCase();f.set(C.toLowerCase(),k)}}),m.forEach(C=>{f.has(C.toLowerCase())||f.set(C.toLowerCase(),C)});let b=[];return p.forEach(C=>{let k=f.get(C.toLowerCase());k&&h.has(C.toLowerCase())&&(b.push(k),h.delete(C.toLowerCase()))}),h.forEach(C=>{let k=f.get(C);k&&b.push(k)}),b},[e,i,n]);return qa.default.createElement("div",{className:"account-sections"},s.map(u=>qa.default.createElement(Xye,{key:u,type:u,accounts:e[u]||[],openAccount:t,totalAUM:a,excludedTypes:o})))},w9=qa.default.memo(Qye);var Fg=_(B());var Ml=_(B());er();var $T=["#3b82f6","#7c3aed","#06b6d4","#f59e0b","#8b5cf6","#2563eb","#0ea5e9","#d97706","#6366f1","#ec4899"];function Zye(e){let t=e%$T.length,r=$T[t];if(e>=$T.length){let n=Math.max(.6,1-Math.floor(e/$T.length)*.2),a=r.replace("#",""),o=parseInt(a.substr(0,2),16),i=parseInt(a.substr(2,2),16),s=parseInt(a.substr(4,2),16);return`rgba(${o}, ${i}, ${s}, ${n})`}return r}function ebe(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function RT(e,t,r,n,a=[]){if(!e||e.length===0||n===0)return[];let o=[];return r.forEach((i,s)=>{let l=t[i]||[];if(l.length===0||a.includes(i.toLowerCase()))return;let d=_T(l,n);d.aumAmount>0&&o.push({type:i,displayName:ebe(i),aumAmount:d.aumAmount,aumWeightPercent:d.aumWeightPercent,color:Zye(s),accounts:l,metrics:d})}),o}function S9(e,t=1){let r=e.filter(m=>m.aumWeightPercent>=t),n=e.filter(m=>m.aumWeightPercent<t);if(n.length===0)return{segments:r};let a=n.reduce((m,h)=>m+h.aumAmount,0),o=n.reduce((m,h)=>m+h.aumWeightPercent,0),i=n.reduce((m,h)=>m+h.metrics.accountCount,0),s=n.reduce((m,h)=>m+h.metrics.totalTrades,0),l=n.reduce((m,h)=>m+h.metrics.totalGrowthAmount,0),c=n.reduce((m,h)=>m+h.metrics.totalWithdrawals,0),d=n.reduce((m,h)=>m+h.aumAmount-h.metrics.totalGrowthAmount,0),u=d>0?l/d*100:0,p={type:"other",displayName:"Other",aumAmount:a,aumWeightPercent:o,color:"#94a3b8",accounts:n.flatMap(m=>m.accounts),metrics:{aumAmount:a,aumWeightPercent:o,accountCount:i,totalTrades:s,totalGrowthAmount:l,totalGrowthPercent:u,totalWithdrawals:c}};return{segments:r,otherSegment:p}}var Ys=_(B());er();var tbe=({data:e,dotSize:t,showPercentage:r})=>{let n={width:`${t}px`,height:`${t}px`,backgroundColor:e.color,borderRadius:"50%",flexShrink:0,border:"1px solid rgba(0, 0, 0, 0.1)",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"};return Ys.default.createElement("div",{className:"account-weight-legend-item"},Ys.default.createElement("div",{className:"legend-dot",style:n,"aria-hidden":"true"}),Ys.default.createElement("span",{className:"legend-text"},Ys.default.createElement("span",{className:"legend-type-name"},e.displayName),r&&Ys.default.createElement("span",{className:"legend-percentage"},Pr(e.aumWeightPercent))))},NF=({weightData:e,className:t="",dotSize:r=12,showPercentages:n=!0,maxItemsPerRow:a=6})=>{if(!e||e.length===0)return null;let o=e,i={display:"flex",flexWrap:"wrap",gap:"8px 16px",alignItems:"center",justifyContent:"flex-start"};return Ys.default.createElement("div",{className:`account-weight-legend-container ${t}`},Ys.default.createElement("div",{className:"account-weight-legend",style:i,role:"list","aria-label":"Account type distribution legend"},o.map(s=>Ys.default.createElement("div",{key:s.type,role:"listitem","aria-label":`${s.displayName}: ${n?Pr(s.aumWeightPercent):""}`},Ys.default.createElement(tbe,{data:s,dotSize:r,showPercentage:n})))))},Vtt=Ys.default.memo(NF);var rbe=({data:e,minimumWidth:t=2})=>{let n={width:`${Math.max(e.aumWeightPercent,t)}%`,backgroundColor:e.color};return Ml.default.createElement("div",{className:"account-weight-segment",style:n,role:"progressbar","aria-valuenow":e.aumWeightPercent,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`${e.displayName}: ${e.aumWeightPercent.toFixed(1)}% of total AUM`})},LF=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:a=[],className:o="",showLegend:i=!0,minimumSegmentWidth:s=2})=>{let l=(0,Ml.useMemo)(()=>RT(e,t,r,n,a),[e,t,r,n,a]),{segments:c}=(0,Ml.useMemo)(()=>S9(l,0),[l]);return c.length===0?null:Ml.default.createElement("div",{className:`account-weight-bar-container ${o}`},Ml.default.createElement("div",{className:"account-weight-bar",role:"progressbar","aria-label":"Account type AUM distribution"},c.map(d=>Ml.default.createElement(rbe,{key:d.type,data:d,minimumWidth:s}))),i&&Ml.default.createElement(NF,{weightData:l,showPercentages:!0}))},Xtt=Ml.default.memo(LF);var MF=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:a=[],className:o="",showLegend:i=!0})=>{let s=(0,Fg.useMemo)(()=>RT(e,t,r,n,a),[e,t,r,n,a]);return!s||s.length===0||n===0?null:Fg.default.createElement("div",{className:`account-type-weights ${o}`},Fg.default.createElement(LF,{accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:a,showLegend:i}))},trt=Fg.default.memo(MF);_i();var Zr=_(B());ll();var Bt=_(B());mv();var k9=(0,Bt.createContext)(null),nbe=5e3,C9=({app:e,accountPageService:t,accountName:r,children:n})=>{let[a,o]=(0,Bt.useState)(null),[i,s]=(0,Bt.useState)(!1),[l,c]=(0,Bt.useState)(!1),[d,u]=(0,Bt.useState)(null),[p,m]=(0,Bt.useState)(0),[h,f]=(0,Bt.useState)({}),b=(0,Bt.useRef)(!1),v=(0,Bt.useRef)(r),y=(0,Bt.useRef)(r),g=(0,Bt.useRef)(h),w=(0,Bt.useRef)(h);Bt.default.useEffect(()=>{v.current=r,g.current=h},[r,h]);let C=(0,Bt.useCallback)((D,A)=>{var j,$,F,z,W,U,K,R,q,X,G,H,Y,V,Q,Z,se;let L=(($=(j=D.dateRange)==null?void 0:j[0])==null?void 0:$.getTime())!==((z=(F=A.dateRange)==null?void 0:F[0])==null?void 0:z.getTime())||((U=(W=D.dateRange)==null?void 0:W[1])==null?void 0:U.getTime())!==((R=(K=A.dateRange)==null?void 0:K[1])==null?void 0:R.getTime()),N=(((q=D.instruments)==null?void 0:q.length)||0)!==(((X=A.instruments)==null?void 0:X.length)||0)||((G=D.instruments)==null?void 0:G.some((ie,Se)=>{var qe;return ie!==((qe=A.instruments)==null?void 0:qe[Se])})),E=(((H=D.setups)==null?void 0:H.length)||0)!==(((Y=A.setups)==null?void 0:Y.length)||0)||((V=D.setups)==null?void 0:V.some((ie,Se)=>{var qe;return ie!==((qe=A.setups)==null?void 0:qe[Se])})),I=(((Q=D.directions)==null?void 0:Q.length)||0)!==(((Z=A.directions)==null?void 0:Z.length)||0)||((se=D.directions)==null?void 0:se.some((ie,Se)=>{var qe;return ie!==((qe=A.directions)==null?void 0:qe[Se])})),O=D.reviewed!==A.reviewed;return L||N||E||I||O},[]),k=(0,Bt.useCallback)((D=nbe)=>Date.now()-p<D,[p]),x=(0,Bt.useCallback)(async(D=!1)=>{if(b.current)return;let A=y.current!==v.current,L=C(w.current,g.current);if(!(!D&&!A&&!L&&k())){y.current=v.current,w.current=g.current,b.current=!0,s(!0),u(null);try{D&&await t.refreshAccountData(v.current);let N=await t.getAccountPageData(v.current);o(N),m(Date.now()),c(!1)}catch(N){console.error("Error fetching account page data:",N),u(N instanceof Error?N:new Error("Failed to fetch account page data"))}finally{s(!1),c(!1),b.current=!1}}},[t,k,C]),S=(0,Bt.useCallback)(D=>{f(D),C(g.current,D)&&c(!0)},[C]),T=(0,Bt.useCallback)(()=>{if(!(a!=null&&a.trades))return[];let D=a.trades;return h.dateRange&&(h.dateRange[0]||h.dateRange[1])&&(D=D.filter(A=>{let L;try{if(A.entryTime instanceof Date)L=A.entryTime;else if(L=new Date(A.entryTime),isNaN(L.getTime()))return!1}catch(N){return console.error("Error parsing trade entry time:",N,A.entryTime),!1}return!(h.dateRange[0]&&L<h.dateRange[0]||h.dateRange[1]&&L>h.dateRange[1])})),h.instruments&&h.instruments.length>0&&(D=D.filter(A=>h.instruments.includes(A.instrument))),h.setups&&h.setups.length>0&&(D=D.filter(A=>A.setup.some(L=>h.setups.includes(L)))),h.directions&&h.directions.length>0&&(D=D.filter(A=>h.directions.includes(A.direction))),h.reviewed!==void 0&&(D=D.filter(A=>A.reviewed===h.reviewed)),D.sort((A,L)=>{let N=A.entryTime instanceof Date?A.entryTime:new Date(A.entryTime);return(L.entryTime instanceof Date?L.entryTime:new Date(L.entryTime)).getTime()-N.getTime()}),D},[a,h]),P=(0,Bt.useCallback)(()=>{if(!a)return null;let D=T();if(D.length===a.trades.length)return a.metrics;if(D.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0};let A=D.length,L=D.reduce((R,q)=>R+q.commission,0),N=D.reduce((R,q)=>R+q.swap,0),E=D.reduce((R,q)=>R+q.fees,0),I=D.reduce((R,q)=>{let X=Aa(q);return R+X},0),O=D.filter(R=>Aa(R)>0),j=D.filter(R=>Aa(R)<0),$=A>0?O.length/A*100:0,F=O.reduce((R,q)=>{let X=Aa(q);return R+X},0),z=Math.abs(j.reduce((R,q)=>{let X=Aa(q);return R+X},0)),W=O.length>0?F/O.length:0,U=j.length>0?z/j.length:0,K=0;return z>0?K=F/z:F>0?K=999:K=0,{totalTrades:A,winningTrades:O.length,losingTrades:j.length,winRate:$,totalPnL:I,avgWin:W,avgLoss:U,profitFactor:K,totalCommission:L,totalSwap:N,totalFees:E}},[a,T]);Bt.default.useEffect(()=>{let D=async A=>{setTimeout(async()=>{var L;(L=e==null?void 0:e.workspace)!=null&&L.trigger&&e.workspace.trigger("layout-change"),await new Promise(N=>setTimeout(N,100)),await x(!0)},600)};return document.addEventListener("journalit:trade-data-changed",D),document.addEventListener("journalit:missed-trade-data-changed",D),()=>{document.removeEventListener("journalit:trade-data-changed",D),document.removeEventListener("journalit:missed-trade-data-changed",D)}},[x,e]),Bt.default.useEffect(()=>{let D=y.current!==r,A=C(w.current,h);(D||A)&&c(!0);let L=setTimeout(()=>{x()},100);return()=>clearTimeout(L)},[r,h,x,C]),Bt.default.useEffect(()=>{r&&t&&x()},[r,t,x]);let M=(0,Bt.useMemo)(()=>({accountPageData:a,isLoading:i,isStale:l,error:d,accountName:r,filters:h,refreshData:()=>x(!0),setFilters:S,lastFetchTime:p,isCacheValid:k,getFilteredTrades:T,getMetrics:P}),[a,i,l,d,r,h,x,S,p,k,T,P]);return Bt.default.createElement(k9.Provider,{value:M},n)},Uo=()=>{let e=(0,Bt.useContext)(k9);if(!e)throw new Error("useAccountPageData must be used within an AccountPageDataProvider");return e};Zt();_i();var Rn=require("obsidian"),pe=_(B()),T9=_(vo());Ja();So();_i();Ft();Ct();var OF=class extends Rn.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Edit Account",cls:"modal-title"}),this.container=t.createDiv({cls:"edit-account-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,T9.createRoot)(this.container),this.root.render(pe.default.createElement(Co,null,pe.default.createElement(abe,{...this.props,onModalClose:()=>this.close()})))}},abe=({app:e,plugin:t,account:r,onSave:n,onModalClose:a})=>{let[o,i]=(0,pe.useState)(!1),[s,l]=(0,pe.useState)([]),{currency:c}=Ae(),[d,u]=(0,pe.useState)({name:r.name,accountType:r.accountType,initialBalance:r.initialBalance,drawdownType:r.drawdownType,drawdownAmount:r.drawdownAmount,hasProfitTarget:r.hasProfitTarget,profitTarget:r.profitTarget,profitTargetType:r.profitTargetType||"absolute",profitTargetDate:r.profitTargetDate||null,monthlyCost:r.monthlyCost||0,createdDate:r.createdDate});(0,pe.useEffect)(()=>{let x=()=>{if(t.optionsService){let T=t.optionsService.getOptions("account_type");l(T)}};x();let S=()=>x();return document.addEventListener("journalit-options-changed",S),()=>{document.removeEventListener("journalit-options-changed",S)}},[t.optionsService]);let p=x=>x.split("_").map(S=>S.charAt(0).toUpperCase()+S.slice(1).toLowerCase()).join(" "),m=async()=>{try{if(i(!0),!d.name){new Rn.Notice("Account name is required");return}if(d.initialBalance<=0){new Rn.Notice("Initial balance must be greater than 0");return}if(d.drawdownType!=="none"&&d.drawdownAmount<=0){new Rn.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}let x=r.name!==d.name,S=r.initialBalance!==d.initialBalance;if(x&&S){let T=await y(r.name,d.name);await w(r.initialBalance,d.initialBalance)?await h(T):(u(M=>({...M,initialBalance:r.initialBalance})),await f(T,d.name))}else if(x){let T=await y(r.name,d.name);await h(T)}else if(S)if(await w(r.initialBalance,d.initialBalance))await h(!1);else return;else await h(!1)}catch(x){console.error("Error updating account:",x),new Rn.Notice(`Error updating account: ${x.message}`)}finally{i(!1)}},h=async x=>{await f(x,d.name)},f=async(x,S)=>{try{let T=new Date(r.createdDate),P=new Date(d.createdDate);T.setHours(0,0,0,0),P.setHours(0,0,0,0),T.getTime()!==P.getTime()&&(await g(r.name,T,P)||u(A=>({...A,createdDate:r.createdDate}))),await v(x,S)}catch(T){console.error("Error in performUpdate:",T),new Rn.Notice(`Error updating account: ${T.message}`)}},b=async x=>{await v(x,d.name)},v=async(x,S)=>{try{let T={name:S,accountType:d.accountType,initialBalance:d.initialBalance,drawdownType:d.drawdownType,drawdownAmount:d.drawdownAmount,hasProfitTarget:d.hasProfitTarget,profitTarget:d.profitTarget,profitTargetType:d.profitTargetType,profitTargetDate:d.profitTargetDate||void 0,monthlyCost:d.monthlyCost,createdDate:d.createdDate};t.accountPageService&&await t.accountPageService.updateAccountMetadata(S,{accountType:T.accountType,initialBalance:T.initialBalance,drawdownType:T.drawdownType,drawdownAmount:T.drawdownAmount,hasProfitTarget:T.hasProfitTarget,profitTarget:T.profitTarget,profitTargetType:T.profitTargetType,profitTargetDate:T.profitTargetDate,monthlyCost:T.monthlyCost,createdDate:T.createdDate});let P=new Date(r.createdDate).getTime()!==new Date(d.createdDate).getTime(),M=r.initialBalance!==d.initialBalance;(P||M)&&t.accountPageService&&await t.accountPageService.refreshAccountData(S),x&&r.name!==S&&t.optionsService&&await t.optionsService.updateOption("account",r.name,S,!0),n(),x&&r.name!==S?new Rn.Notice(`Account "${r.name}" updated to "${S}" and all references updated`):new Rn.Notice(`Account "${S}" updated successfully`),document.dispatchEvent(new CustomEvent("journalit:account-updated",{detail:{accountId:r.id,accountName:S}})),t.accountPageService&&(await t.accountPageService.refreshAccountData(S),await t.accountPageService.refreshAllAccountData()),setTimeout(()=>{a()},100)}catch(T){console.error("Error updating account:",T),new Rn.Notice(`Error updating account: ${T.message}`)}},y=(x,S)=>new Promise(T=>{let P=`Do you want to update all existing notes that use account "${x}" to use "${S}" instead?

This will search through all notes and update the account reference wherever it's found.`;new FF(e,P,T).open()}),g=(x,S,T)=>new Promise(P=>{new jF(e,x,S,T,P).open()}),w=(x,S)=>new Promise(T=>{new zF(e,t,x,S,T).open()}),C=x=>new Promise(S=>{new _F(e,x,S).open()}),k=async()=>{try{if(i(!0),!await C(r.name))return;t.accountPageService?(await t.accountPageService.deleteAccount(r.name),new Rn.Notice(`Account "${r.name}" has been deleted successfully`),t.viewManager&&(await t.viewManager.closeAccountPageViews(r.name),setTimeout(async()=>{await t.viewManager.navigateToAccountDashboard()},200)),document.dispatchEvent(new CustomEvent("journalit:account-deleted",{detail:{accountId:r.id,accountName:r.name}})),n(),a()):new Rn.Notice("AccountPageService not available for account deletion")}catch(x){console.error("Error deleting account:",x),new Rn.Notice(`Error deleting account: ${x.message}`)}finally{i(!1)}};return pe.default.createElement("div",{className:"edit-account-form"},pe.default.createElement("div",{className:"setting-item two-column"},pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Account Name"),pe.default.createElement("div",{className:"setting-item-description"},"Name for your account")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"text",value:d.name,onChange:x=>u({...d,name:x.target.value}),placeholder:"My Trading Account",disabled:o}))),pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Account Type"),pe.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("select",{value:d.accountType,onChange:x=>u({...d,accountType:x.target.value}),disabled:o},s.length>0?s.map(x=>pe.default.createElement("option",{key:x,value:x},p(x))):pe.default.createElement(pe.default.Fragment,null,pe.default.createElement("option",{value:"demo"},"Demo"),pe.default.createElement("option",{value:"evaluation"},"Evaluation"),pe.default.createElement("option",{value:"funded"},"Funded")))))),pe.default.createElement("div",{className:"setting-item two-column"},pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),pe.default.createElement("div",{className:"setting-item-description"},"Starting account balance")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"number",value:d.initialBalance===0?"":d.initialBalance,onChange:x=>u({...d,initialBalance:x.target.value===""?0:parseFloat(x.target.value)||0}),onFocus:x=>{d.initialBalance===0&&(x.target.value="")},min:"0.01",step:"100",placeholder:"10000",disabled:o}))),pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Creation Date"),pe.default.createElement("div",{className:"setting-item-description"},"When account was created")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"date",value:(()=>{try{return(d.createdDate instanceof Date?d.createdDate:new Date(d.createdDate)).toISOString().split("T")[0]}catch(x){return console.error("Error formatting date for input:",x),new Date().toISOString().split("T")[0]}})(),onChange:x=>{if(!x.target.value)return;let S=new Date(x.target.value);if(S>new Date){new Rn.Notice("Creation date cannot be in the future");return}S.setHours(0,0,0,0),u({...d,createdDate:S})},max:new Date().toISOString().split("T")[0],disabled:o})))),pe.default.createElement("div",{className:"setting-item two-column"},pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),pe.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("select",{value:d.drawdownType,onChange:x=>{let S=x.target.value,T=S!=="none"&&d.drawdownType==="none"?Math.round(r.initialBalance*.1):d.drawdownAmount;u({...d,drawdownType:S,drawdownAmount:S==="none"?0:T})},disabled:o},pe.default.createElement("option",{value:"none"},"None"),pe.default.createElement("option",{value:"fixed"},"Fixed"),pe.default.createElement("option",{value:"eod_trailing"},"EOD Trailing")))),d.drawdownType!=="none"&&pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),pe.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown limit")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"number",value:d.drawdownAmount===0?"":d.drawdownAmount,onChange:x=>u({...d,drawdownAmount:x.target.value===""?0:parseFloat(x.target.value)||0}),onFocus:x=>{d.drawdownAmount===0&&(x.target.value="")},min:"0",step:"100",placeholder:"0",disabled:o})))),pe.default.createElement("div",{className:"setting-item two-column"},pe.default.createElement("div",{className:"column"},pe.default.createElement(Hh,{checked:d.hasProfitTarget,onChange:x=>u({...d,hasProfitTarget:x}),disabled:o,label:"Enable Profit Target"}),pe.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),pe.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"number",value:d.monthlyCost===0?"":d.monthlyCost,onChange:x=>u({...d,monthlyCost:x.target.value===""?0:parseFloat(x.target.value)||0}),onFocus:x=>{d.monthlyCost===0&&(x.target.value="")},min:"0",step:"1",placeholder:"0",disabled:o})))),d.hasProfitTarget&&pe.default.createElement(pe.default.Fragment,null,pe.default.createElement("div",{className:"setting-item two-column"},pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Target Type"),pe.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("select",{value:d.profitTargetType,onChange:x=>u({...d,profitTargetType:x.target.value}),disabled:o},pe.default.createElement("option",{value:"absolute"},"Absolute Amount"),pe.default.createElement("option",{value:"percentage"},"Percentage")))),pe.default.createElement("div",{className:"column"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Target ",d.profitTargetType==="percentage"?"(%)":"($)"),pe.default.createElement("div",{className:"setting-item-description"},d.profitTargetType==="percentage"?"Percentage":"Dollar amount")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"number",value:d.profitTarget===0?"":d.profitTarget,onChange:x=>u({...d,profitTarget:x.target.value===""?0:parseFloat(x.target.value)||0}),onFocus:x=>{d.profitTarget===0&&(x.target.value="")},min:"0",step:d.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:o})))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),pe.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"date",value:d.profitTargetDate?new Date(d.profitTargetDate).toISOString().split("T")[0]:"",onChange:x=>u({...d,profitTargetDate:x.target.value?new Date(x.target.value):null}),disabled:o})))),pe.default.createElement("div",{className:"edit-account-buttons"},pe.default.createElement($e,{variant:"secondary",onClick:k,disabled:o,className:"delete-account-button",style:{backgroundColor:"#dc3545",color:"white",borderColor:"#dc3545"}},"Delete Account"),pe.default.createElement("div",{className:"button-group-right"},pe.default.createElement($e,{variant:"primary",onClick:m,disabled:o,className:"save-account-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},o?"Saving...":"Save Changes"),pe.default.createElement($e,{variant:"secondary",onClick:a,disabled:o,className:"cancel-button"},"Cancel"))))},FF=class extends Rn.Modal{constructor(r,n,a){super(r);this.message=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},jF=class extends Rn.Modal{constructor(r,n,a,o,i){super(r);this.accountName=n;this.oldDate=a;this.newDate=o;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Change Creation Date"});let n=Ot();r.createEl("p",{text:`You are about to change the creation date for account "${this.accountName}" from ${Fe(this.oldDate,n)} to ${Fe(this.newDate,n)}.`}),r.createEl("p",{text:"This will update the initial deposit transaction date and may affect account age calculations, monthly billing cycles, and other date-based metrics.",cls:"warning"});let a=r.createDiv({cls:"modal-button-container"});a.createEl("button",{text:"Update Creation Date",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),a.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}},zF=class extends Rn.Modal{constructor(r,n,a,o,i){super(r);this.plugin=n;this.oldBalance=a;this.newBalance=o;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Change Initial Balance"});let n=o=>{var s,l,c;let i=((c=(l=(s=this.plugin)==null?void 0:s.settings)==null?void 0:l.general)==null?void 0:c.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:i,minimumFractionDigits:2}).format(o)};r.createEl("p",{text:`You are about to change the initial balance from ${n(this.oldBalance)} to ${n(this.newBalance)}.`}),r.createEl("p",{text:"This will affect all balance calculations, P&L percentages, drawdown calculations, and transaction history. The current balance will be recalculated based on the new initial balance plus all trade P&L.",cls:"warning"}),r.createEl("p",{text:"This change may significantly impact account metrics and historical data accuracy.",cls:"warning"});let a=r.createDiv({cls:"modal-button-container"});a.createEl("button",{text:"Update Initial Balance",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),a.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}},_F=class extends Rn.Modal{constructor(r,n,a){super(r);this.accountName=n;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Delete Account",cls:"modal-title-danger"}),r.createEl("p",{text:`Are you sure you want to permanently delete the account "${this.accountName}"?`}),r.createEl("p",{text:"This action will:",cls:"warning"});let n=r.createEl("ul",{cls:"warning-list"});n.createEl("li",{text:"Remove all account metadata and settings"}),n.createEl("li",{text:"Remove account references from all linked trade notes"}),n.createEl("li",{text:"Remove auto-generated account tags from all trades"}),n.createEl("li",{text:"This action cannot be undone"}),r.createEl("p",{text:"\u26A0\uFE0F WARNING: This is a permanent action that cannot be reversed!",cls:"danger-warning"});let a=r.createDiv({cls:"modal-button-container"});a.createEl("button",{text:"Cancel",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let o=a.createEl("button",{text:`Delete "${this.accountName}"`,cls:"mod-destructive"});o.style.backgroundColor="#dc3545",o.style.color="white",o.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}};function BF(e,t,r,n){new OF({app:e,plugin:t,account:r,onClose:()=>{},onSave:n}).open()}var Dc=require("obsidian"),pt=_(B()),P9=_(vo());Ja();_i();Ft();Ct();var $F=class extends Dc.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Add Deposit/Withdrawal",cls:"modal-title"}),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,P9.createRoot)(this.container),this.root.render(pt.default.createElement(Co,null,pt.default.createElement(obe,{...this.props,onModalClose:()=>this.close()})))}},obe=({plugin:e,accountName:t,onSave:r,onModalClose:n})=>{let[a,o]=(0,pt.useState)(!1),{currency:i}=Ae(),s=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(m),l=()=>new Date().toISOString().split("T")[0],[c,d]=(0,pt.useState)({type:"deposit",amount:"",date:l(),description:""}),u=async()=>{var m,h;try{if(o(!0),!c.amount||parseFloat(c.amount)<=0){new Dc.Notice("Amount must be greater than 0");return}if(!c.date){new Dc.Notice("Date is required");return}let f=parseFloat(c.amount),b=new Date(c.date),v=new Date;if(v.setHours(23,59,59,999),b>v){new Dc.Notice("Transaction date cannot be in the future");return}if(!await p(c,f))return;c.type==="deposit"?await((m=e.accountPageService)==null?void 0:m.addManualDeposit(t,f,b,c.description||void 0)):await((h=e.accountPageService)==null?void 0:h.addManualWithdrawal(t,f,b,c.description||void 0));let g=c.type==="deposit"?"Deposit":"Withdrawal";new Dc.Notice(`${g} of ${s(f)} added successfully`),r(),n()}catch(f){console.error("Error adding transaction:",f),new Dc.Notice(`Error adding transaction: ${f.message}`)}finally{o(!1)}},p=(m,h)=>new Promise(f=>{new RF(e.app,e,m,h,t,f).open()});return pt.default.createElement("div",{className:"add-event-form"},pt.default.createElement("div",{className:"setting-item two-column"},pt.default.createElement("div",{className:"column"},pt.default.createElement("div",{className:"setting-item-info"},pt.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),pt.default.createElement("div",{className:"setting-item-description"},"Deposit or withdrawal")),pt.default.createElement("div",{className:"setting-item-control"},pt.default.createElement("select",{value:c.type,onChange:m=>d({...c,type:m.target.value,description:""}),disabled:a},pt.default.createElement("option",{value:"deposit"},"Deposit"),pt.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),pt.default.createElement("div",{className:"column"},pt.default.createElement("div",{className:"setting-item-info"},pt.default.createElement("div",{className:"setting-item-name"},"Amount"),pt.default.createElement("div",{className:"setting-item-description"},"Amount in ",i)),pt.default.createElement("div",{className:"setting-item-control"},pt.default.createElement("input",{type:"number",value:c.amount,onChange:m=>d({...c,amount:m.target.value}),onFocus:m=>{(c.amount==="0"||c.amount==="")&&(m.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:a})))),pt.default.createElement("div",{className:"setting-item two-column"},pt.default.createElement("div",{className:"column"},pt.default.createElement("div",{className:"setting-item-info"},pt.default.createElement("div",{className:"setting-item-name"},"Date"),pt.default.createElement("div",{className:"setting-item-description"},"Transaction date")),pt.default.createElement("div",{className:"setting-item-control"},pt.default.createElement("input",{type:"date",value:c.date,onChange:m=>d({...c,date:m.target.value}),max:l(),disabled:a}))),pt.default.createElement("div",{className:"column"},pt.default.createElement("div",{className:"setting-item-info"},pt.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),pt.default.createElement("div",{className:"setting-item-description"},"Additional notes")),pt.default.createElement("div",{className:"setting-item-control"},pt.default.createElement("input",{type:"text",value:c.description,onChange:m=>d({...c,description:m.target.value}),placeholder:c.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:a})))),pt.default.createElement("div",{className:"add-event-buttons"},pt.default.createElement("div",{className:"button-group-left"}),pt.default.createElement("div",{className:"button-group-right"},pt.default.createElement($e,{variant:"primary",onClick:u,disabled:a,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},a?"Adding...":"Add Transaction"),pt.default.createElement($e,{variant:"secondary",onClick:n,disabled:a,className:"cancel-button"},"Cancel"))))},RF=class extends Dc.Modal{constructor(r,n,a,o,i,s){super(r);this.plugin=n;this.eventData=a;this.amount=o;this.accountName=i;this.onConfirm=s}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Confirm Transaction"});let n=s=>{var c,d,u;let l=((u=(d=(c=this.plugin)==null?void 0:c.settings)==null?void 0:d.general)==null?void 0:u.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:l,minimumFractionDigits:2}).format(s)},a=this.eventData.type==="deposit"?"deposit":"withdrawal",o=Fe(new Date(this.eventData.date),Ot());r.createEl("p",{text:`Add ${a} of ${n(this.amount)} to account "${this.accountName}" on ${o}?`}),this.eventData.description&&r.createEl("p",{text:`Description: ${this.eventData.description}`,cls:"transaction-description"});let i=r.createDiv({cls:"modal-button-container"});i.createEl("button",{text:"Add Transaction",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),i.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}};function WT(e,t,r,n){new $F({app:e,plugin:t,accountName:r,onClose:()=>{},onSave:n}).open()}Ct();er();var WF=()=>{var s,l;let{accountPageData:e,refreshData:t}=Uo(),{currency:r}=Ae(),n=Ee();if(!e||!n)return null;let{account:a}=e,o=()=>{BF(n.app,n,a,t)},i=()=>{WT(n.app,n,a.name,t)};return Zr.default.createElement("div",{className:"account-page-header"},Zr.default.createElement("div",{className:"account-header-main"},Zr.default.createElement("h2",null,"Account: ",a.name),Zr.default.createElement("div",{className:"header-buttons"},Zr.default.createElement($e,{onClick:i,variant:"secondary",size:"sm",className:"add-event-btn",title:"Add Deposit/Withdrawal"},Zr.default.createElement(zi,{size:16})),Zr.default.createElement($e,{onClick:o,variant:"secondary",size:"sm",className:"edit-account-btn",title:"Edit Account"},Zr.default.createElement(un,{size:16})))),Zr.default.createElement("div",{className:"account-info"},Zr.default.createElement("div",{className:"account-info-item"},Zr.default.createElement("span",{className:"info-label"},"Type:"),Zr.default.createElement("span",{className:"info-value"},a.accountType||"N/A")),Zr.default.createElement("div",{className:"account-info-item"},Zr.default.createElement("span",{className:"info-label"},"Initial Balance:"),Zr.default.createElement("span",{className:"info-value"},Da((s=a.initialBalance)!=null?s:0,!1,r))),Zr.default.createElement("div",{className:"account-info-item"},Zr.default.createElement("span",{className:"info-label"},"Current Balance:"),Zr.default.createElement("span",{className:"info-value"},Da((l=a.currentBalance)!=null?l:0,!1,r))),a.accountId&&Zr.default.createElement("div",{className:"account-info-item"},Zr.default.createElement("span",{className:"info-label"},"Account ID:"),Zr.default.createElement("span",{className:"info-value"},a.accountId))))};var Lt=_(B());Ct();er();var UF=()=>{let{getMetrics:e,getFilteredTrades:t}=Uo(),{currency:r}=Ae(),n=e(),a=t();if(!n)return null;let o=c=>`${c.toFixed(1)}%`,i=c=>Da(c,!1,r),s=c=>c.toFixed(2),l=c=>c>0?"positive":c<0?"negative":"neutral";return Lt.default.createElement("div",{className:"account-metrics"},Lt.default.createElement("div",{className:"metrics-grid"},Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Total Trades"),Lt.default.createElement("span",{className:"metric-value"},n.totalTrades)),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Win Rate"),Lt.default.createElement("span",{className:`metric-value ${l(n.winRate-50)}`},o(n.winRate))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Total P&L"),Lt.default.createElement("span",{className:`metric-value ${l(n.totalPnL)}`},i(n.totalPnL))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Profit Factor"),Lt.default.createElement("span",{className:`metric-value ${l(n.profitFactor-1)}`},s(n.profitFactor))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Avg Win"),Lt.default.createElement("span",{className:"metric-value positive"},i(n.avgWin))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Avg Loss"),Lt.default.createElement("span",{className:"metric-value negative"},i(n.avgLoss))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Winning Trades"),Lt.default.createElement("span",{className:"metric-value positive"},n.winningTrades)),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Losing Trades"),Lt.default.createElement("span",{className:"metric-value negative"},n.losingTrades)),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Total Commission"),Lt.default.createElement("span",{className:"metric-value negative"},i(n.totalCommission))),Lt.default.createElement("div",{className:"metric-card"},Lt.default.createElement("span",{className:"metric-label"},"Total Fees"),Lt.default.createElement("span",{className:"metric-value negative"},i(n.totalFees)))))};var mt=_(B());Zt();er();Ft();Ct();var ibe=({trade:e})=>{let{currency:t}=Ae(),r=Ot(),n=e.exitTime===null||e.exitTime===void 0,a=Ee(),o=()=>{try{if(!e.path||e.path.trim()===""){console.error("Cannot navigate to trade: No valid file path found",e);return}a&&a.openFile?a.openFile(e.path,!1):a!=null&&a.app?a.app.workspace.openLinkText(e.path,"",!1):console.error("Cannot navigate to trade: Plugin context not available")}catch(s){console.error("Error navigating to trade:",s,{path:e.path,trade:e})}},i=e.path&&e.path.trim()!=="";return mt.default.createElement("div",{className:`trade-item ${i?"clickable":"no-path"}`,onClick:i?o:void 0,title:i?`Click to open: ${e.path}`:"No file path available - cannot navigate"},mt.default.createElement("div",{className:"trade-header"},mt.default.createElement("div",{className:"trade-primary-info"},mt.default.createElement("span",{className:"trade-instrument"},e.instrument),mt.default.createElement("span",{className:`trade-direction ${e.direction.toLowerCase()}`},e.direction),!i&&mt.default.createElement("span",{className:"no-path-indicator",title:"No file path - cannot open"},"\u26A0\uFE0F")),n?mt.default.createElement("span",{className:"status-open"},"OPEN"):mt.default.createElement("span",{className:`trade-pnl ${e.pnl>=0?"positive":"negative"}`},ue(e.pnl,!0,t))),mt.default.createElement("div",{className:"trade-details"},mt.default.createElement("div",{className:"trade-prices"},mt.default.createElement("span",{className:"trade-price"},"Entry: ",Da(e.entryPrice,!1,t)),!n&&mt.default.createElement("span",{className:"trade-price"},"Exit: ",Da(e.exitPrice,!1,t)),mt.default.createElement("span",{className:"trade-size"},"Size: ",e.positionSize)),mt.default.createElement("div",{className:"trade-dates"},mt.default.createElement("span",{className:"trade-date"},"Entry: ",Fe(e.entryTime,r)),!n&&mt.default.createElement("span",{className:"trade-date"},"Exit: ",Fe(e.exitTime,r))),e.setup.length>0&&mt.default.createElement("div",{className:"trade-setups"},mt.default.createElement("span",{className:"setup-label"},"Setups:"),mt.default.createElement("div",{className:"setup-tags"},e.setup.map((s,l)=>mt.default.createElement("span",{key:l,className:"setup-tag"},s)))),e.mistake.length>0&&mt.default.createElement("div",{className:"trade-mistakes"},mt.default.createElement("span",{className:"mistake-label"},"Mistakes:"),mt.default.createElement("div",{className:"mistake-tags"},e.mistake.map((s,l)=>mt.default.createElement("span",{key:l,className:"mistake-tag"},s)))),e.tags.length>0&&mt.default.createElement("div",{className:"trade-tags"},mt.default.createElement("span",{className:"tags-label"},"Tags:"),mt.default.createElement("div",{className:"tag-list"},e.tags.map((s,l)=>mt.default.createElement("span",{key:l,className:"trade-tag"},s)))),mt.default.createElement("div",{className:"trade-meta"},mt.default.createElement("span",{className:`review-status ${e.reviewed?"reviewed":"not-reviewed"}`},e.reviewed?"Reviewed":"Not Reviewed"),(Math.abs(e.commission)>0||Math.abs(e.fees)>0)&&mt.default.createElement("span",{className:"trade-costs"},"Costs: ",av(Math.abs(e.commission)+Math.abs(e.fees),t)))))},qF=()=>{let{getFilteredTrades:e}=Uo(),t=e();return mt.default.createElement("div",{className:"account-trades"},mt.default.createElement("div",{className:"trades-header-centered"},mt.default.createElement("span",{className:"trades-header-line"}),mt.default.createElement("h3",{className:"trades-header-title"},"Linked Trades (",t.length,")"),mt.default.createElement("span",{className:"trades-header-line"})),t.length===0?mt.default.createElement(Ie,{message:"No trades are linked to this account or match the current filters.",subMessage:"Try adjusting your filters or add some trades to this account."}):mt.default.createElement("div",{className:"trades-list"},t.map((r,n)=>mt.default.createElement(ibe,{key:`${r.path}-${n}`,trade:r}))))};var Kd=_(B());var ke=_(B());er();Ft();Za();Ja();Ct();var sbe=(e,t,r)=>{let n=t-e,a;n<=100?a=10:n<=1e3?a=100:n<=1e4?a=1e3:n<=1e5?a=1e4:n<=1e6?a=1e5:a=1e6;let o=Math.floor(e/a)*a,i=[];for(let s=o;s<=t+a;s+=a)i.push(s);if(i.includes(r)||(i.push(r),i.sort((s,l)=>s-l)),i.length>10){let s=[],l=Math.ceil(i.length/7);for(let c=0;c<i.length;c+=l)s.push(i[c]);return s.includes(r)||(s.push(r),s.sort((c,d)=>c-d)),s[s.length-1]!==i[i.length-1]&&s.push(i[i.length-1]),s}return i},lbe=e=>{if(!e)return"-";if(!e.startsWith("Trade P&L:"))return e;let t=/Trade P&L: .+\/([A-Z0-9]+)-(\d{6})-([^.]+)\.md/,r=e.match(t);if(!r||r.length<4)return e;let[,n,a,o]=r;try{let i="20"+a.substring(0,2),s=a.substring(2,4),l=a.substring(4,6),d=new Date(`${i}-${s}-${l}`).toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${n} ${o} (${d})`}catch(i){return`${n} ${o}`}},cbe=ke.default.memo(({active:e,payload:t,currency:r})=>{if(!e||!t||t.length===0)return null;let n=t[0].payload;return ke.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},ke.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},n.date),ke.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"Balance: ",ue(n.balance,!0,r)),n.isConsolidated&&ke.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},n.tradeCount&&n.tradeCount>0&&ke.default.createElement("div",{style:{marginBottom:"4px"}},ke.default.createElement("span",{style:{fontWeight:500}},"Trades:")," ",n.tradeCount),n.dailyPnL!==void 0&&ke.default.createElement("div",{style:{color:n.dailyPnL>=0?"var(--text-success)":"var(--text-error)",fontWeight:500}},"Day P&L: ",ue(n.dailyPnL,!0,r)),n.hasEvents&&n.dayTransactions&&ke.default.createElement("div",{style:{marginTop:"4px"}},n.dayTransactions.filter(a=>a.type==="deposit"||a.type==="withdrawal").filter(a=>!(a.type==="deposit"&&a.description==="Initial deposit")).map((a,o)=>{let i=a.type==="deposit"&&a.amount>0,s=a.type==="withdrawal"||a.type==="deposit"&&a.amount<0;return ke.default.createElement("div",{key:o,style:{fontSize:"12px",marginBottom:"2px",color:i?"#2563eb":s?"#eab308":"var(--text-normal)"}},i&&`\u2022 Deposit: ${ue(a.amount,!0,r)}`,s&&`\u2022 Withdrawal: ${ue(Math.abs(a.amount),!0,r)}`,a.description&&a.description!=="Manual deposit"&&a.description!=="Manual withdrawal"&&ke.default.createElement("span",{style:{color:"var(--text-muted)",fontStyle:"italic"}}," - "+a.description))}))),n.transaction&&ke.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},n.isDeposit&&ke.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ue(n.transaction.amount,!0,r)),n.isWithdrawal&&ke.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ue(Math.abs(n.transaction.amount),!0,r)),n.isTrade&&!n.isConsolidated&&ke.default.createElement("div",{style:{color:n.transaction&&n.transaction.amount>=0?"var(--text-success)":"var(--text-error)"}},lbe(n.transaction.description),": ",ue(n.transaction.amount,!0,r)),n.transaction.description&&!n.isTrade&&ke.default.createElement("div",{style:{marginTop:"4px",fontSize:"12px",color:"var(--text-muted)",fontStyle:"italic"}},n.transaction.description)),n.drawdownLevel!==void 0&&ke.default.createElement("div",{style:{marginTop:"6px",fontSize:"13px",color:"var(--text-error)"}},"Drawdown Level: ",ue(n.drawdownLevel,!0,r)))}),D9=({account:e,height:t=250})=>{let{currency:r}=Ae(),[n,a]=(0,ke.useState)(!1);(0,ke.useEffect)(()=>{a(!1)},[e.transactions]);let o=ke.default.useMemo(()=>Ot(),[]),i=ke.default.useMemo(()=>window.journalitPlugin,[]),s=ke.default.useCallback(f=>`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`,[]),l=ke.default.useMemo(()=>{if(!e.transactions||e.transactions.length===0)return[];let f=[...e.transactions].sort((T,P)=>new Date(T.date).getTime()-new Date(P.date).getTime()),b=e.initialBalance-e.drawdownAmount,v=[],y=f.filter(T=>(T.type==="deposit"||T.type==="withdrawal")&&!(T.type==="deposit"&&T.description==="Initial deposit"));if(e.createdDate){let T=e.createdDate instanceof Date?e.createdDate:new Date(e.createdDate);if(!isNaN(T.getTime())){let P=T.toISOString().split("T")[0];if(!f.some(D=>(D.date instanceof Date?D.date:new Date(D.date)).toISOString().split("T")[0]===P))v.push({date:Fe(T,o),rawDate:T,balance:e.initialBalance,...e.drawdownType!=="none"&&{drawdownLevel:b}});else if(f.some(A=>A.type==="deposit"&&A.description==="Initial deposit")){let A=new Date(T);A.setHours(0,0,0,0),v.push({date:Fe(A,o),rawDate:A,balance:e.initialBalance,isInitialBalance:!0,...e.drawdownType!=="none"&&{drawdownLevel:b}})}}}let g=new Map,w=e.initialBalance,C=b;return f.filter(T=>T.type!=="cost").forEach(T=>{let P=new Date(T.date),M=xt(P,i),D=s(M);g.has(D)||g.set(D,{dayEnd:M,transactions:[],finalBalance:0,tradeCount:0,dailyPnL:0,hasEvents:!1});let A=g.get(D);A.transactions.push(T),A.finalBalance=T.balanceAfter,T.type==="trade"&&(A.tradeCount++,A.dailyPnL+=T.amount),(T.type==="deposit"||T.type==="withdrawal")&&(A.hasEvents=!0),P>A.dayEnd&&(A.dayEnd=P)}),Array.from(g.keys()).sort().forEach(T=>{let P=g.get(T),M=new Date(P.dayEnd),D=b;if(e.drawdownType==="eod_trailing"){P.finalBalance>w&&(w=P.finalBalance);let N=Math.min(e.initialBalance,Math.max(w-e.drawdownAmount,C));C=N,D=N}let A=P.transactions.some(N=>N.type==="deposit"&&N.amount>0&&N.description!=="Initial deposit"),L=P.transactions.some(N=>N.type==="withdrawal"||N.type==="deposit"&&N.amount<0);v.push({date:Fe(M,o),rawDate:M,balance:P.finalBalance,...e.drawdownType!=="none"&&{drawdownLevel:D},isConsolidated:!0,tradeCount:P.tradeCount,dailyPnL:P.dailyPnL,hasEvents:P.hasEvents,isTrade:P.tradeCount>0,dayTransactions:P.transactions,isDeposit:A,isWithdrawal:L})}),v.sort((T,P)=>T.rawDate.getTime()-P.rawDate.getTime())},[e.transactions,e.initialBalance,e.drawdownType,e.drawdownAmount,o,i,s]);if(l.length===0)return ke.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},ke.default.createElement(Ie,{message:"No trades found",subMessage:"No trading activity available for this account"}));let c=l.map(f=>f.balance),d=Math.min(...c),u=Math.max(...c);if(e.hasProfitTarget&&e.profitTarget>0){let f=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,b=e.initialBalance+f;u=Math.max(u,b)}let p=e.maxDrawdownReached,m=u-Math.min(d,p||d);u=u+m*.05,p!==void 0&&p<d?d=p-m*.15:d=d-m*.1,d>0&&d<u*.05&&(d=0);let h=e.hasProfitTarget&&e.profitTarget>0?e.profitTargetType==="percentage"?e.initialBalance+e.initialBalance*e.profitTarget/100:e.initialBalance+e.profitTarget:void 0;return ke.default.createElement("div",{className:"account-balance-chart",style:{width:"100%",height:`${t}px`}},ke.default.createElement(js,{width:"100%",height:"100%"},ke.default.createElement(mb,{data:l,margin:{top:10,right:15,left:10,bottom:5}},ke.default.createElement("defs",null,ke.default.createElement("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1"},ke.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.4}),ke.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.05})),ke.default.createElement("filter",{id:"balanceShadow",height:"120%"},ke.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),ke.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},ke.default.createElement("stop",{offset:"0%",stopColor:"var(--text-error)",stopOpacity:.2}),ke.default.createElement("stop",{offset:"100%",stopColor:"var(--text-error)",stopOpacity:.5}))),ke.default.createElement(Ba,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),ke.default.createElement(zn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),ke.default.createElement(_n,{tickFormatter:f=>ue(f,!0,r),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[d,u],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:5,ticks:sbe(d,u,e.initialBalance)}),ke.default.createElement(oo,{content:ke.default.createElement(cbe,{currency:r}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},offset:10}),ke.default.createElement(nn,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),ke.default.createElement(nn,{y:e.initialBalance,stroke:"#888888",strokeOpacity:.7,strokeDasharray:"3 3",strokeWidth:1}),h&&ke.default.createElement(nn,{y:h,stroke:"var(--text-success, #00b300)",strokeOpacity:1,strokeDasharray:"5 5",strokeWidth:2,className:"profit-target-line",label:{value:"Profit Target",fill:"var(--text-success, #00b300)",fontSize:12,position:"insideTopRight"}}),ke.default.createElement(Bo,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#balanceGradient)",fillOpacity:.95,dot:!1,activeDot:!1,filter:"url(#balanceShadow)"}),e.drawdownType!=="none"&&ke.default.createElement(Pl,{type:"stepAfter",dataKey:"drawdownLevel",stroke:"var(--text-error)",strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1,name:"Drawdown Level"}),e.drawdownType!=="none"&&ke.default.createElement(Bo,{type:"monotone",dataKey:"drawdownLevel",stroke:"none",fill:"url(#drawdownGradient)",fillOpacity:1}),ke.default.createElement(Pl,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:3,onAnimationEnd:()=>a(!0),dot:f=>{let{cx:b,cy:v,payload:y}=f;return y?n?y.isDeposit?ke.default.createElement("g",null,ke.default.createElement("line",{x1:b,y1:v-15,x2:b,y2:v+15,stroke:"#2563eb",strokeWidth:"2"}),ke.default.createElement("circle",{cx:b,cy:v,r:"5",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"})):y.isWithdrawal?ke.default.createElement("g",null,ke.default.createElement("line",{x1:b,y1:v-15,x2:b,y2:v+15,stroke:"#eab308",strokeWidth:"2"}),ke.default.createElement("circle",{cx:b,cy:v,r:"5",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"})):y.isTrade?y.isConsolidated?ke.default.createElement("circle",{cx:b,cy:v,r:"4",fill:y.dailyPnL!==void 0&&y.dailyPnL>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):ke.default.createElement("circle",{cx:b,cy:v,r:"4",fill:y.transaction&&y.transaction.amount>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):ke.default.createElement("circle",{cx:b,cy:v,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):ke.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):ke.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:f=>{let{cx:b,cy:v,payload:y}=f;if(!y)return ke.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0});if(y.isDeposit)return ke.default.createElement("g",null,ke.default.createElement("line",{x1:b,y1:v-18,x2:b,y2:v+18,stroke:"#2563eb",strokeWidth:"3"}),ke.default.createElement("circle",{cx:b,cy:v,r:"7",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"}));if(y.isWithdrawal)return ke.default.createElement("g",null,ke.default.createElement("line",{x1:b,y1:v-18,x2:b,y2:v+18,stroke:"#eab308",strokeWidth:"3"}),ke.default.createElement("circle",{cx:b,cy:v,r:"7",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"}));let g="#41B4F7";return y.isTrade&&(y.isConsolidated?g=y.dailyPnL!==void 0&&y.dailyPnL>=0?"var(--text-success)":"var(--text-error)":y.transaction&&(g=y.transaction.amount>=0?"var(--text-success)":"var(--text-error)")),ke.default.createElement("circle",{cx:b,cy:v,r:"6",fill:g,stroke:"var(--background-primary)",strokeWidth:"2"})},name:"Balance"}))))};var HF=()=>{let{accountPageData:e,isLoading:t}=Uo();return t||!e?Kd.default.createElement("div",{className:"account-balance-section"},Kd.default.createElement("h3",null,"Account Balance Chart"),Kd.default.createElement("div",{className:"balance-chart-loading"},Kd.default.createElement("p",null,"Loading balance chart..."))):Kd.default.createElement("div",{className:"account-balance-section"},Kd.default.createElement("div",{className:"balance-chart-container"},Kd.default.createElement(D9,{account:e.account,height:400})))};var Ne=_(B());Ja();er();Ft();Ct();var VF=()=>{let{accountPageData:e,isLoading:t}=Uo(),{currency:r}=Ae();if(t||!e)return Ne.default.createElement("div",{className:"account-risk-metrics-section"},Ne.default.createElement("div",{className:"risk-metrics-loading"},Ne.default.createElement("p",null,"Loading risk metrics...")));let{account:n}=e,a=zT(n),o=jT(n),i=n.drawdownType!=="none"&&n.drawdownAmount>0,s=n.hasProfitTarget&&n.profitTarget>0,l=i?a>=100?"BREACHED":"IN PROGRESS":null,c=s?o>=100?"ACHIEVED":"IN PROGRESS":null;return Ne.default.createElement("div",{className:"account-risk-metrics-section"},Ne.default.createElement("div",{className:"section-header-centered"},Ne.default.createElement("span",{className:"section-header-line"}),Ne.default.createElement("h3",{className:"section-header-title"},"Risk Management"),Ne.default.createElement("span",{className:"section-header-line"})),Ne.default.createElement("div",{className:"risk-metrics-container"},Ne.default.createElement("div",{className:`risk-metric-box ${i?"":"not-set"}`},Ne.default.createElement("div",{className:"risk-metric-header"},Ne.default.createElement("div",{className:"header-left"},Ne.default.createElement("div",{className:"title-with-badge"},Ne.default.createElement("h4",{className:"risk-metric-title"},"Drawdown Used"),l&&Ne.default.createElement("span",{className:`risk-status-badge ${l==="BREACHED"?"breached":"in-progress"}`},l))),Ne.default.createElement("div",{className:`risk-metric-percentage ${i?"":"not-set"}`},i?Pr(a):"Not set")),i&&Ne.default.createElement("div",{className:"horizontal-bar-container"},Ne.default.createElement("div",{className:"horizontal-bar-track"},Ne.default.createElement("div",{className:`horizontal-bar-fill ${a>=75?"critical":a>=50?"warning":"safe"}`,style:{width:`${Math.min(100,a)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),Ne.default.createElement("div",{className:"risk-metric-details"},i?Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Used:"),Ne.default.createElement("span",{className:"detail-value"},ue(n.initialBalance-n.currentBalance,!0,r))),Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Limit:"),Ne.default.createElement("span",{className:"detail-value"},ue(n.drawdownAmount,!0,r))),Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Remaining:"),Ne.default.createElement("span",{className:"detail-value"},ue(n.drawdownAmount-(n.initialBalance-n.currentBalance),!0,r)))):Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-value no-limit"},"No drawdown limit set")))),Ne.default.createElement("div",{className:`risk-metric-box ${s?"":"not-set"}`},Ne.default.createElement("div",{className:"risk-metric-header"},Ne.default.createElement("div",{className:"header-left"},Ne.default.createElement("div",{className:"title-with-badge"},Ne.default.createElement("h4",{className:"risk-metric-title"},"Profit Target"),c&&Ne.default.createElement("span",{className:`risk-status-badge ${c==="ACHIEVED"?"achieved":"in-progress"}`},c))),Ne.default.createElement("div",{className:`risk-metric-percentage ${s?"":"not-set"}`},s?Pr(o):"Not set")),s&&Ne.default.createElement("div",{className:"horizontal-bar-container"},Ne.default.createElement("div",{className:"horizontal-bar-track"},Ne.default.createElement("div",{className:`horizontal-bar-fill ${o>=100?"complete":"progress"}`,style:{width:`${Math.min(100,o)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),Ne.default.createElement("div",{className:"risk-metric-details"},s?Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Progress:"),Ne.default.createElement("span",{className:"detail-value"},ue(n.metrics.totalPnL,!0,r))),Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Target:"),Ne.default.createElement("span",{className:"detail-value"},ue(n.profitTargetType==="percentage"?n.initialBalance*n.profitTarget/100:n.profitTarget,!0,r))),Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Remaining:"),Ne.default.createElement("span",{className:"detail-value"},ue((n.profitTargetType==="percentage"?n.initialBalance*n.profitTarget/100:n.profitTarget)-n.metrics.totalPnL,!0,r))),n.profitTargetDate&&Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-label"},"Target Date:"),Ne.default.createElement("span",{className:"detail-value"},Fe(new Date(n.profitTargetDate))))):Ne.default.createElement("div",{className:"detail-row"},Ne.default.createElement("span",{className:"detail-value no-target"},"No profit target set"))))))};var qo=require("obsidian"),ge=_(B()),E9=_(vo());Ja();So();_i();Yn();var GF=class extends qo.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),Eu(),t.createEl("h2",{text:"Create New Account",cls:"modal-title"}),this.container=t.createDiv({cls:"create-account-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,E9.createRoot)(this.container),this.root.render(ge.default.createElement(dbe,{...this.props,onModalClose:()=>this.close()}))}},dbe=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[a,o]=(0,ge.useState)(!1),[i,s]=(0,ge.useState)([]),[l,c]=(0,ge.useState)({name:"",accountType:"demo",createdDate:new Date().toISOString().split("T")[0],initialBalance:0,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0});(0,ge.useEffect)(()=>{let m=()=>{if(t.optionsService){let f=t.optionsService.getOptions("account_type");s(f)}};m();let h=()=>m();return document.addEventListener("journalit-options-changed",h),()=>{document.removeEventListener("journalit-options-changed",h)}},[t.optionsService]);let d=m=>m.split("_").map(h=>h.charAt(0).toUpperCase()+h.slice(1).toLowerCase()).join(" "),u=async m=>{if(!t.accountPageService)return!1;try{return(await t.accountPageService.getAllEnhancedAccounts()).some(f=>f.name.toLowerCase().trim()===m.toLowerCase().trim())}catch(h){return console.error("Error checking account name uniqueness:",h),!1}},p=async()=>{try{if(o(!0),!l.name||!l.name.trim()){new qo.Notice("Account name is required");return}let m=l.name.trim();if(await u(m)){new qo.Notice(`Account name "${m}" already exists. Please choose a different name.`);return}if(l.initialBalance<0){new qo.Notice("Initial balance cannot be negative");return}if(l.drawdownType!=="none"&&l.drawdownAmount<=0){new qo.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}if(l.hasProfitTarget&&l.profitTarget<=0){new qo.Notice("Profit target amount must be greater than 0 when profit target is enabled");return}let f=new Date(l.createdDate);if(f>new Date){new qo.Notice("Creation date cannot be in the future");return}if(l.monthlyCost<0){new qo.Notice("Monthly cost cannot be negative");return}if(!t.accountPageService){new qo.Notice("AccountPageService not available for account creation");return}f.setHours(0,0,0,0),await t.accountPageService.updateAccountMetadata(m,{name:m,accountType:l.accountType,createdDate:f,initialBalance:l.initialBalance,drawdownType:l.drawdownType,drawdownAmount:l.drawdownAmount,hasProfitTarget:l.hasProfitTarget,profitTarget:l.profitTarget,profitTargetType:l.profitTargetType,profitTargetDate:l.profitTargetDate||void 0,monthlyCost:l.monthlyCost,lastUpdated:new Date}),new qo.Notice(`Account "${m}" created successfully`),document.dispatchEvent(new CustomEvent("journalit:account-created",{detail:{accountName:m}})),t.accountPageService&&await t.accountPageService.refreshAllAccountData(),r(),n(),t.viewManager&&setTimeout(()=>{t.viewManager.openAccountPageView(m)},150)}catch(m){console.error("Error creating account:",m),new qo.Notice(`Error creating account: ${m.message}`)}finally{o(!1)}};return ge.default.createElement("div",{className:"create-account-form"},ge.default.createElement("div",{className:"setting-item two-column"},ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Account Name"),ge.default.createElement("div",{className:"setting-item-description"},"Name for your new account")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"text",value:l.name,onChange:m=>c({...l,name:m.target.value}),placeholder:"My Trading Account",disabled:a}))),ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Account Type"),ge.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("select",{value:l.accountType,onChange:m=>c({...l,accountType:m.target.value}),disabled:a},i.length>0?i.map(m=>ge.default.createElement("option",{key:m,value:m},d(m))):ge.default.createElement(ge.default.Fragment,null,ge.default.createElement("option",{value:"demo"},"Demo"),ge.default.createElement("option",{value:"evaluation"},"Evaluation"),ge.default.createElement("option",{value:"funded"},"Funded")))))),ge.default.createElement("div",{className:"setting-item two-column"},ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),ge.default.createElement("div",{className:"setting-item-description"},"Starting account balance (optional, defaults to 0)")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"number",value:l.initialBalance===0?"":l.initialBalance,onChange:m=>c({...l,initialBalance:m.target.value===""?0:parseFloat(m.target.value)||0}),onFocus:m=>{l.initialBalance===0&&(m.target.value="")},min:"0",step:"100",placeholder:"10000",disabled:a}))),ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Creation Date"),ge.default.createElement("div",{className:"setting-item-description"},"When account was created")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"date",value:l.createdDate,onChange:m=>{if(!m.target.value)return;if(new Date(m.target.value)>new Date){new qo.Notice("Creation date cannot be in the future");return}c({...l,createdDate:m.target.value})},max:new Date().toISOString().split("T")[0],disabled:a})))),ge.default.createElement("div",{className:"setting-item two-column"},ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),ge.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("select",{value:l.drawdownType,onChange:m=>{let h=m.target.value;c({...l,drawdownType:h,drawdownAmount:h==="none"?0:l.drawdownAmount})},disabled:a},ge.default.createElement("option",{value:"none"},"None"),ge.default.createElement("option",{value:"fixed"},"Fixed"),ge.default.createElement("option",{value:"eod_trailing"},"EOD Trailing")))),l.drawdownType!=="none"&&ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),ge.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown limit")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"number",value:l.drawdownAmount===0?"":l.drawdownAmount,onChange:m=>c({...l,drawdownAmount:m.target.value===""?0:parseFloat(m.target.value)||0}),onFocus:m=>{l.drawdownAmount===0&&(m.target.value="")},min:"0",step:"100",placeholder:"0",disabled:a})))),ge.default.createElement("div",{className:"setting-item two-column"},ge.default.createElement("div",{className:"column"},ge.default.createElement(Hh,{checked:l.hasProfitTarget,onChange:m=>c({...l,hasProfitTarget:m}),disabled:a,label:"Enable Profit Target"}),ge.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),ge.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"number",value:l.monthlyCost===0?"":l.monthlyCost,onChange:m=>c({...l,monthlyCost:m.target.value===""?0:parseFloat(m.target.value)||0}),onFocus:m=>{l.monthlyCost===0&&(m.target.value="")},min:"0",step:"1",placeholder:"0",disabled:a})))),l.hasProfitTarget&&ge.default.createElement(ge.default.Fragment,null,ge.default.createElement("div",{className:"setting-item two-column"},ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Target Type"),ge.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("select",{value:l.profitTargetType,onChange:m=>c({...l,profitTargetType:m.target.value}),disabled:a},ge.default.createElement("option",{value:"absolute"},"Absolute Amount"),ge.default.createElement("option",{value:"percentage"},"Percentage")))),ge.default.createElement("div",{className:"column"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Target ",l.profitTargetType==="percentage"?"(%)":"($)"),ge.default.createElement("div",{className:"setting-item-description"},l.profitTargetType==="percentage"?"Percentage":"Dollar amount")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"number",value:l.profitTarget===0?"":l.profitTarget,onChange:m=>c({...l,profitTarget:m.target.value===""?0:parseFloat(m.target.value)||0}),onFocus:m=>{l.profitTarget===0&&(m.target.value="")},min:"0",step:l.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:a})))),ge.default.createElement("div",{className:"setting-item"},ge.default.createElement("div",{className:"setting-item-info"},ge.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),ge.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),ge.default.createElement("div",{className:"setting-item-control"},ge.default.createElement("input",{type:"date",value:l.profitTargetDate?new Date(l.profitTargetDate).toISOString().split("T")[0]:"",onChange:m=>c({...l,profitTargetDate:m.target.value?new Date(m.target.value):null}),disabled:a})))),ge.default.createElement("div",{className:"create-account-buttons"},ge.default.createElement($e,{variant:"primary",onClick:p,disabled:a,className:"create-account-button"},a?"Creating...":"Create Account"),ge.default.createElement($e,{variant:"secondary",onClick:n,disabled:a,className:"cancel-button"},"Cancel")))};function YF(e,t,r){new GF({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}var kn=require("obsidian"),ee=_(B()),A9=_(vo());ll();So();_i();Yn();var KF=class extends kn.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),Eu(),t.createEl("h2",{text:"Account Dashboard Settings",cls:"modal-title"}),this.container=t.createDiv({cls:"account-dashboard-settings-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,A9.createRoot)(this.container),this.root.render(ee.default.createElement(ube,{...this.props,onModalClose:()=>this.close()}))}},ube=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[a,o]=(0,ee.useState)(!1),[i,s]=(0,ee.useState)([]),[l,c]=(0,ee.useState)(!1),[d,u]=(0,ee.useState)(""),[p,m]=(0,ee.useState)(null),[h,f]=(0,ee.useState)(!1),[b,v]=(0,ee.useState)(""),[y,g]=(0,ee.useState)(null),[w,C]=(0,ee.useState)(!1),[k,x]=(0,ee.useState)(""),[S,T]=(0,ee.useState)("reassign"),[P,M]=(0,ee.useState)({excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[]});(0,ee.useEffect)(()=>{let H=()=>{var V;if(t.optionsService){let Q=t.optionsService.getOptions("account_type");s(Q)}(V=t.settings)!=null&&V.account&&M({excludedAccountTypes:[...t.settings.account.excludedAccountTypes||[]],includeWithdrawalsFromExcluded:{...t.settings.account.includeWithdrawalsFromExcluded||{}},accountTypeOrder:[...t.settings.account.accountTypeOrder||["funded","evaluation","demo","archived"]]})};H();let Y=()=>H();return document.addEventListener("journalit-options-changed",Y),()=>{document.removeEventListener("journalit-options-changed",Y)}},[t.optionsService,t.settings]);let D=H=>H.split("_").map(Y=>Y.charAt(0).toUpperCase()+Y.slice(1).toLowerCase()).join(" "),A=async()=>{if(!d.trim()){new kn.Notice("Account type name cannot be empty");return}let H=d.trim().toLowerCase().replace(/\s+/g,"_");if(i.some(V=>V.toLowerCase().replace(/\s+/g,"_")===H)){new kn.Notice(`Account type "${D(H)}" already exists`);return}if(["demo","evaluation","funded","archived","real"].includes(H)){new kn.Notice(`"${D(H)}" is a reserved account type name`);return}try{o(!0),await t.optionsService.addOption("account_type",H),s([...i,H]);let V=[...P.accountTypeOrder];V.includes(H)||V.push(H),M({...P,accountTypeOrder:V,includeWithdrawalsFromExcluded:{...P.includeWithdrawalsFromExcluded,[H]:!1}}),u(""),c(!1),R("added",H),new kn.Notice(`Account type "${D(H)}" added successfully`)}catch(V){console.error("Error adding account type:",V),new kn.Notice(`Error adding account type: ${V.message}`)}finally{o(!1)}},L=()=>{u(""),c(!1)},N=()=>{c(!0),u("")},E=async H=>{var Y;try{let Q=(await((Y=t.accountPageService)==null?void 0:Y.getAllEnhancedAccounts())||[]).filter(se=>{var ie;return((ie=se.accountType)==null?void 0:ie.toLowerCase())===H.toLowerCase()}),Z={inExcludedTypes:P.excludedAccountTypes.includes(H.toLowerCase()),inDisplayOrder:P.accountTypeOrder.includes(H.toLowerCase()),inWithdrawalSettings:P.includeWithdrawalsFromExcluded.hasOwnProperty(H.toLowerCase())};return{affectedAccounts:Q.length,accountNames:Q.map(se=>se.name||se.accountName||"Unnamed Account"),settingsImpact:Z}}catch(V){return console.error("Error analyzing account type deletion impact:",V),{affectedAccounts:0,accountNames:[],settingsImpact:{inExcludedTypes:!1,inDisplayOrder:!1,inWithdrawalSettings:!1}}}},I=H=>{let Y=H.toLowerCase(),V=P.excludedAccountTypes.filter(ie=>ie.toLowerCase()!==Y),Q=P.accountTypeOrder.filter(ie=>ie.toLowerCase()!==Y),Z={...P.includeWithdrawalsFromExcluded};delete Z[Y];let se={...P,excludedAccountTypes:V,accountTypeOrder:Q,includeWithdrawalsFromExcluded:Z};return M(se),t.settings.account||(t.settings.account={defaultAccountType:"DEMO",defaultDrawdownType:"NONE",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[]}),t.settings.account.excludedAccountTypes=V,t.settings.account.accountTypeOrder=Q,t.settings.account.includeWithdrawalsFromExcluded=Z,{removedFromExcluded:P.excludedAccountTypes.length!==V.length,removedFromDisplayOrder:P.accountTypeOrder.length!==Q.length,removedFromWithdrawalSettings:Object.keys(P.includeWithdrawalsFromExcluded).length!==Object.keys(Z).length}},O=async H=>{try{o(!0);let Y=await E(H);v(H),g(Y),f(!0)}catch(Y){console.error("Error analyzing deletion impact:",Y),new kn.Notice("Error analyzing account type usage")}finally{o(!1)}},j=async()=>{if(b)try{if(o(!0),y&&y.affectedAccounts>0){new kn.Notice(`Cannot delete "${D(b)}" - it has ${y.affectedAccounts} associated accounts. Migration feature coming soon.`),f(!1);return}if(!await q(async()=>{await t.optionsService.removeOption("account_type",b)},"Account type deletion"))return;let Y=I(b);t.settings.account||(t.settings.account={defaultAccountType:"DEMO",defaultDrawdownType:"NONE",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{}}),t.settings.account.excludedAccountTypes=P.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=P.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=P.accountTypeOrder,await t.saveSettings(),s(i.filter(Z=>Z.toLowerCase()!==b.toLowerCase())),R("deleted",b,{cleanupActions:{removedFromExcluded:Y.removedFromExcluded,removedFromDisplayOrder:Y.removedFromDisplayOrder,removedFromWithdrawalSettings:Y.removedFromWithdrawalSettings}}),f(!1),v(""),g(null);let V=`Account type "${D(b)}" deleted successfully`,Q=[];Y.removedFromExcluded&&Q.push("excluded types"),Y.removedFromDisplayOrder&&Q.push("display order"),Y.removedFromWithdrawalSettings&&Q.push("withdrawal settings"),Q.length>0&&(V+=` (cleaned up: ${Q.join(", ")})`),new kn.Notice(V),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),r()}catch(H){console.error("Error deleting account type:",H),new kn.Notice(`Error deleting account type: ${H.message}`)}finally{o(!1)}},$=()=>{f(!1),v(""),g(null)},F=()=>{let H=i.filter(Y=>Y.toLowerCase()!==b.toLowerCase());if(H.length===0){new kn.Notice("Cannot migrate accounts - no other account types available. Create a new account type first.");return}x(H[0]),T("reassign"),f(!1),C(!0)},z=async()=>{if(!(!y||!b))try{if(o(!0),S==="reassign"&&!k){new kn.Notice("Please select a target account type for reassignment");return}let H=await U(b,S,k);if(!H.success){new kn.Notice(`Migration failed: ${H.error}`);return}if(!await q(async()=>{await t.optionsService.removeOption("account_type",b)},"Account type deletion"))return;let V=I(b);s(i.filter(Z=>Z.toLowerCase()!==b.toLowerCase())),R("migrated",b,{migrationOption:S,targetType:k,migratedCount:H.migratedCount,cleanupActions:{removedFromExcluded:V.removedFromExcluded,removedFromDisplayOrder:V.removedFromDisplayOrder,removedFromWithdrawalSettings:V.removedFromWithdrawalSettings}}),C(!1),f(!1),v(""),g(null),x("");let Q=`Account type "${D(b)}" deleted successfully. `;switch(Q+=`${H.migratedCount} accounts `,S){case"reassign":Q+=`reassigned to "${D(k)}"`;break;case"archive":Q+="moved to archived status";break;case"delete":Q+="marked for deletion";break}new kn.Notice(Q,5e3),await t.saveSettings(),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),await new Promise(Z=>setTimeout(Z,100)),r()}catch(H){console.error("Error during migration and deletion:",H),new kn.Notice(`Error during migration: ${H.message}`)}finally{o(!1)}},W=()=>{C(!1),x(""),T("reassign"),f(!0)},U=async(H,Y,V)=>{var Q,Z;try{let ie=(await((Q=t.accountPageService)==null?void 0:Q.getAllEnhancedAccounts())||[]).filter(ft=>{var it;return((it=ft.accountType)==null?void 0:it.toLowerCase())===H.toLowerCase()});if(ie.length===0)return{success:!0,migratedCount:0};let Se;switch(Y){case"reassign":if(!V)return{success:!1,migratedCount:0,error:"Target type required for reassignment"};Se=V;break;case"archive":Se="archived";break;case"delete":Se="deleted";break;default:return{success:!1,migratedCount:0,error:"Invalid migration option"}}let qe=0,ht=(Z=t.settings)==null?void 0:Z.account;if(ht!=null&&ht.accountMetadata){for(let ft of ie){let it=Object.keys(ht.accountMetadata).find(Tn=>{let hr=ht.accountMetadata[Tn];return hr.name===ft.name||hr.name===ft.accountName});it&&(ht.accountMetadata[it].accountType=Se,ht.accountMetadata[it].lastUpdated=new Date,qe++)}await t.saveSettings()}return{success:!0,migratedCount:qe}}catch(se){return console.error("Error migrating accounts:",se),{success:!1,migratedCount:0,error:se.message}}},K=async()=>{try{o(!0),t.settings.account||(t.settings.account={defaultAccountType:"DEMO",defaultDrawdownType:"NONE",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{}}),t.settings.account.excludedAccountTypes=P.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=P.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=P.accountTypeOrder,await t.saveSettings(),new kn.Notice("Account dashboard settings saved successfully"),r(),n()}catch(H){console.error("Error saving account dashboard settings:",H),new kn.Notice(`Error saving settings: ${H.message}`)}finally{o(!1)}},R=(H,Y,V)=>{try{let Q=new CustomEvent("journalit-options-changed",{detail:{timestamp:Date.now(),optionType:"account_type",action:H,accountType:Y,...V}});document.dispatchEvent(Q);let Z=new CustomEvent("journalit-account-type-changed",{detail:{timestamp:Date.now(),action:H,accountType:Y,...V}});document.dispatchEvent(Z)}catch(Q){console.error("Error dispatching account type changed event:",Q)}},q=async(H,Y,V=2)=>{let Q=null;for(let Z=1;Z<=V;Z++)try{return await H(),!0}catch(se){Q=se,console.warn(`${Y} failed (attempt ${Z}/${V}):`,se),Z<V&&await new Promise(ie=>setTimeout(ie,Z*1e3))}return new kn.Notice(`${Y} failed after ${V} attempts: ${(Q==null?void 0:Q.message)||"Unknown error"}`),!1};return ee.default.createElement("div",{className:"account-dashboard-settings-form"},ee.default.createElement(()=>{if(!w||!y||!b)return null;let H=i.filter(Y=>Y.toLowerCase()!==b.toLowerCase());return ee.default.createElement("div",{className:"account-migration-modal-overlay"},ee.default.createElement("div",{className:"account-type-delete-modal account-migration-modal"},ee.default.createElement("h3",null,"Migrate Accounts Before Deletion"),ee.default.createElement("div",{className:"delete-modal-content"},ee.default.createElement("div",{className:"migration-warning"},ee.default.createElement("p",null,ee.default.createElement("strong",null,`You're about to delete "`,D(b),'" which has ',y.affectedAccounts," associated accounts.")),ee.default.createElement("p",null,"These accounts must be handled before the account type can be deleted:"),ee.default.createElement("ul",{className:"affected-accounts-list"},y.accountNames.slice(0,3).map((Y,V)=>ee.default.createElement("li",{key:V},Y)),y.accountNames.length>3&&ee.default.createElement("li",null,"... and ",y.accountNames.length-3," more"))),ee.default.createElement("div",{className:"migration-options"},ee.default.createElement("h4",null,"Choose how to handle these accounts:"),ee.default.createElement("div",{className:"migration-option-group"},ee.default.createElement("label",{className:"migration-option"},ee.default.createElement("input",{type:"radio",name:"migrationOption",value:"reassign",checked:S==="reassign",onChange:Y=>T(Y.target.value)}),ee.default.createElement("div",{className:"migration-option-content"},ee.default.createElement("span",{className:"migration-option-title"},"Reassign to different type"),ee.default.createElement("span",{className:"migration-option-desc"},"Move all accounts to another account type"))),S==="reassign"&&ee.default.createElement("div",{className:"target-type-select"},ee.default.createElement("label",null,"Target account type:"),ee.default.createElement("select",{value:k,onChange:Y=>x(Y.target.value),disabled:a},H.map(Y=>ee.default.createElement("option",{key:Y,value:Y},D(Y))))),ee.default.createElement("label",{className:"migration-option"},ee.default.createElement("input",{type:"radio",name:"migrationOption",value:"archive",checked:S==="archive",onChange:Y=>T(Y.target.value)}),ee.default.createElement("div",{className:"migration-option-content"},ee.default.createElement("span",{className:"migration-option-title"},"Archive accounts"),ee.default.createElement("span",{className:"migration-option-desc"},'Move all accounts to "archived" status'))),ee.default.createElement("label",{className:"migration-option"},ee.default.createElement("input",{type:"radio",name:"migrationOption",value:"delete",checked:S==="delete",onChange:Y=>T(Y.target.value)}),ee.default.createElement("div",{className:"migration-option-content"},ee.default.createElement("span",{className:"migration-option-title"},"Mark for deletion"),ee.default.createElement("span",{className:"migration-option-desc"},"Mark all accounts as deleted")))))),ee.default.createElement("div",{className:"delete-modal-actions"},ee.default.createElement($e,{variant:"secondary",onClick:W,disabled:a},"Cancel"),ee.default.createElement($e,{variant:"secondary",onClick:z,disabled:a||S==="reassign"&&!k,className:"delete-confirm-button"},a?"Migrating...":"Migrate & Delete Type"))))},null),ee.default.createElement(()=>!h||!y?null:ee.default.createElement("div",{className:"account-type-delete-modal-overlay"},ee.default.createElement("div",{className:"account-type-delete-modal"},ee.default.createElement("h3",null,"Delete Account Type"),ee.default.createElement("div",{className:"delete-modal-content"},ee.default.createElement("div",{className:"delete-warning"},ee.default.createElement("p",null,ee.default.createElement("strong",null,'Are you sure you want to delete the account type "',D(b),'"?'))),ee.default.createElement("div",{className:"impact-analysis"},ee.default.createElement("h4",null,"Impact Analysis:"),y.affectedAccounts>0?ee.default.createElement("div",{className:"affected-accounts"},ee.default.createElement("div",{className:"impact-item impact-critical"},ee.default.createElement("strong",null,"\u26A0\uFE0F ",y.affectedAccounts," account(s) affected:"),ee.default.createElement("ul",null,y.accountNames.slice(0,5).map((H,Y)=>ee.default.createElement("li",{key:Y},H)),y.accountNames.length>5&&ee.default.createElement("li",null,"... and ",y.accountNames.length-5," more"))),ee.default.createElement("div",{className:"migration-notice"},ee.default.createElement("strong",null,"Note:")," These accounts will need to be reassigned to a different account type before deletion can proceed. Account migration feature is coming in Phase 4.")):ee.default.createElement("div",{className:"no-affected-accounts"},ee.default.createElement("div",{className:"impact-item impact-safe"},"\u2705 No accounts are using this account type")),ee.default.createElement("div",{className:"settings-cleanup"},ee.default.createElement("h5",null,"Settings that will be cleaned up:"),ee.default.createElement("ul",null,y.settingsImpact.inExcludedTypes&&ee.default.createElement("li",null,"\u2713 Removed from excluded account types"),y.settingsImpact.inDisplayOrder&&ee.default.createElement("li",null,"\u2713 Removed from display order"),y.settingsImpact.inWithdrawalSettings&&ee.default.createElement("li",null,"\u2713 Removed from withdrawal settings"),!y.settingsImpact.inExcludedTypes&&!y.settingsImpact.inDisplayOrder&&!y.settingsImpact.inWithdrawalSettings&&ee.default.createElement("li",null,"No settings cleanup needed"))))),ee.default.createElement("div",{className:"delete-modal-actions"},y.affectedAccounts>0?ee.default.createElement(ee.default.Fragment,null,ee.default.createElement($e,{variant:"secondary",onClick:$,disabled:a},"Cancel"),ee.default.createElement($e,{variant:"primary",onClick:F,disabled:a},"Setup Migration")):ee.default.createElement(ee.default.Fragment,null,ee.default.createElement($e,{variant:"secondary",onClick:$,disabled:a},"Cancel"),ee.default.createElement($e,{variant:"primary",onClick:j,disabled:a,className:"delete-confirm-button"},a?"Deleting...":"Delete Account Type"))))),null),ee.default.createElement("div",{className:"setting-item"},ee.default.createElement("div",{className:"setting-item-info"},ee.default.createElement("div",{className:"setting-item-name"},"Available Account Types"),ee.default.createElement("div",{className:"setting-item-description"},"Current account types in your system.")),ee.default.createElement("div",{className:"setting-item-control"},ee.default.createElement("div",{className:"available-account-types"},i.length>0?ee.default.createElement("div",{className:"account-types-container"},i.map((H,Y)=>ee.default.createElement("div",{key:H,className:"account-type-badge-container",onMouseEnter:()=>m(Y),onMouseLeave:()=>m(null)},ee.default.createElement("div",{className:"account-type-badge"},D(H),p===Y&&ee.default.createElement("button",{className:"account-type-delete-btn",onClick:()=>O(H),title:`Delete ${D(H)}`,disabled:a},"\xD7")))),ee.default.createElement("div",{className:"add-account-type-section"},l?ee.default.createElement("div",{className:"add-account-type-input"},ee.default.createElement("input",{type:"text",value:d,onChange:H=>u(H.target.value),placeholder:"Enter account type name...",autoFocus:!0,onKeyPress:H=>{H.key==="Enter"?A():H.key==="Escape"&&L()},disabled:a,className:"account-type-name-input"}),ee.default.createElement("div",{className:"add-account-type-buttons"},ee.default.createElement("button",{onClick:A,disabled:a||!d.trim(),className:"add-account-type-confirm-btn",title:"Add account type"},"Add"),ee.default.createElement("button",{onClick:L,disabled:a,className:"add-account-type-cancel-btn",title:"Cancel"},"Cancel"))):ee.default.createElement("button",{onClick:N,disabled:a,className:"add-account-type-btn",title:"Add new account type"},ee.default.createElement(zi,{size:16})))):ee.default.createElement("div",{className:"no-account-types-container"},ee.default.createElement("div",{className:"no-account-types"},"No custom account types defined."),ee.default.createElement("button",{onClick:N,disabled:a,className:"add-account-type-btn",title:"Add new account type"},ee.default.createElement(zi,{size:16})))))),ee.default.createElement("div",{className:"setting-item"},ee.default.createElement("div",{className:"setting-item-info"},ee.default.createElement("div",{className:"setting-item-name"},"Dashboard Inclusion Settings"),ee.default.createElement("div",{className:"setting-item-description"},"Choose which account types to include in dashboard calculations. Also configure whether withdrawals from each account type are included in total withdrawal metrics.")),ee.default.createElement("div",{className:"setting-item-control"},ee.default.createElement("div",{className:"account-types-settings-table"},i.length>0?ee.default.createElement("div",{className:"account-types-list"},i.map(H=>{let Y=H.toLowerCase(),V=P.excludedAccountTypes.includes(Y),Q=P.includeWithdrawalsFromExcluded[Y]||!1;return ee.default.createElement("div",{key:H,className:"account-type-setting-row"},ee.default.createElement("div",{className:"account-type-name"},D(H)),ee.default.createElement("div",{className:"account-type-controls"},ee.default.createElement("label",{className:"toggle-label"},ee.default.createElement("input",{type:"checkbox",checked:!V,onChange:Z=>{let se=[...P.excludedAccountTypes];if(!Z.target.checked)se.includes(Y)||se.push(Y);else{let ie=se.indexOf(Y);ie!==-1&&se.splice(ie,1)}M({...P,excludedAccountTypes:se})}}),ee.default.createElement("span",null,"Include in Dashboard")),ee.default.createElement("label",{className:"toggle-label"},ee.default.createElement("input",{type:"checkbox",checked:Q,onChange:Z=>{M({...P,includeWithdrawalsFromExcluded:{...P.includeWithdrawalsFromExcluded,[Y]:Z.target.checked}})}}),ee.default.createElement("span",null,"Include Withdrawals"))))})):ee.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to configure.")))),ee.default.createElement("div",{className:"setting-item"},ee.default.createElement("div",{className:"setting-item-info"},ee.default.createElement("div",{className:"setting-item-name"},"Display Order"),ee.default.createElement("div",{className:"setting-item-description"},"Reorder how account types appear in the dashboard.")),ee.default.createElement("div",{className:"setting-item-control"},ee.default.createElement("div",{className:"account-type-order-container"},(()=>{let H=P.accountTypeOrder.length>0?P.accountTypeOrder:["funded","evaluation","demo","archived"],Y=[...new Set([...i.map(se=>se.toLowerCase()),...H.map(se=>se.toLowerCase())])],V=new Map;i.forEach(se=>V.set(se.toLowerCase(),se)),H.forEach(se=>{V.has(se.toLowerCase())||V.set(se.toLowerCase(),se.charAt(0).toUpperCase()+se.slice(1))});let Q=[];H.forEach(se=>{if(Y.includes(se.toLowerCase())){let ie=V.get(se.toLowerCase());ie&&Q.push(ie)}}),Y.forEach(se=>{if(!H.map(ie=>ie.toLowerCase()).includes(se)){let ie=V.get(se);ie&&Q.push(ie)}});let Z=(se,ie)=>{let Se=[...Q],qe=ie==="up"?se-1:se+1;qe>=0&&qe<Se.length&&([Se[se],Se[qe]]=[Se[qe],Se[se]],M({...P,accountTypeOrder:Se.map(ht=>ht.toLowerCase())}))};return ee.default.createElement("div",{className:"account-type-order-list"},Q.length>0?ee.default.createElement("div",{className:"order-list"},Q.map((se,ie)=>ee.default.createElement("div",{key:se,className:"order-list-item"},ee.default.createElement("span",{className:"type-name"},D(se)),ee.default.createElement("div",{className:"order-controls"},ee.default.createElement("button",{type:"button",className:"order-button",disabled:ie===0,onClick:()=>Z(ie,"up"),"aria-label":`Move ${se} up`,title:"Move up"},"\u2191"),ee.default.createElement("button",{type:"button",className:"order-button",disabled:ie===Q.length-1,onClick:()=>Z(ie,"down"),"aria-label":`Move ${se} down`,title:"Move down"},"\u2193"))))):ee.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to order."))})()))),ee.default.createElement("div",{className:"settings-modal-buttons"},ee.default.createElement($e,{variant:"primary",onClick:K,disabled:a,className:"save-settings-button"},a?"Saving...":"Save Settings"),ee.default.createElement($e,{variant:"secondary",onClick:n,disabled:a,className:"cancel-button"},"Cancel")))};function I9(e,t,r){new KF({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}Yn();var pbe=({plugin:e})=>{let[t,r]=(0,He.useState)([]),[n,a]=(0,He.useState)(!0),[o,i]=(0,He.useState)(null),[s,l]=(0,He.useState)(""),[c,d]=(0,He.useState)(0),[u,p]=(0,He.useTransition)(),m=(0,He.useDeferredValue)(s),h=(0,He.useRef)(0),f=5,b=(0,He.useCallback)(async()=>{try{if(a(!0),i(null),!e.accountPageService){if(h.current+=1,h.current>f)throw new Error("AccountPageService not initialized after multiple attempts");let A=300*Math.pow(2,h.current-1);console.warn(`AccountPageService not ready, retrying in ${A}ms (attempt ${h.current}/${f})`),setTimeout(()=>b(),A);return}h.current=0;let D=await e.accountPageService.getAllEnhancedAccounts();r(D)}catch(D){console.error("Error loading accounts:",D),i(`Error loading accounts: ${D instanceof Error?D.message:String(D)}`)}finally{h.current===0&&a(!1)}},[e]),v=(0,He.useCallback)(async()=>{e.accountPageService&&await e.accountPageService.refreshAllAccountData(),p(()=>{b()})},[b,e.accountPageService]);(0,He.useEffect)(()=>(iE(),b(),document.addEventListener("journalit:account-created",v),document.addEventListener("journalit:account-updated",v),document.addEventListener("journalit:account-deleted",v),document.addEventListener("journalit:account-transaction-added",v),document.addEventListener("journalit:account-transaction-deleted",v),document.addEventListener("journalit:trade-data-changed",v),()=>{document.removeEventListener("journalit:account-created",v),document.removeEventListener("journalit:account-updated",v),document.removeEventListener("journalit:account-deleted",v),document.removeEventListener("journalit:account-transaction-added",v),document.removeEventListener("journalit:account-transaction-deleted",v),document.removeEventListener("journalit:trade-data-changed",v)}),[b,v]);let y=(0,He.useMemo)(()=>d9(t,e.settings),[t,e.settings,c]),g=(0,He.useMemo)(()=>{var D,A;return((A=(D=e.settings)==null?void 0:D.account)==null?void 0:A.excludedAccountTypes)||["archived"]},[e.settings]),w=(0,He.useMemo)(()=>t.filter(D=>!g.includes(D.accountType.toLowerCase())).reduce((D,A)=>D+A.currentBalance,0),[t,g]),C=(0,He.useMemo)(()=>u9(t,e.settings),[t,e.settings,c]),k=(0,He.useMemo)(()=>m?t.filter(D=>D.name.toLowerCase().includes(m.toLowerCase())):t,[t,m]),x=(0,He.useMemo)(()=>p9(k),[k,c]),S=(0,He.useMemo)(()=>{var O,j,$,F;let D=Object.keys(x),A=((j=(O=e==null?void 0:e.settings)==null?void 0:O.account)==null?void 0:j.accountTypeOrder)||["funded","evaluation","demo","archived"],L=((F=($=e==null?void 0:e.optionsService)==null?void 0:$.getOptions)==null?void 0:F.call($,"account_type"))||[],N=new Set([...D.map(z=>z.toLowerCase()),...A.map(z=>z.toLowerCase()),...L.map(z=>z.toLowerCase())]),E=new Map;D.forEach(z=>E.set(z.toLowerCase(),z)),A.forEach(z=>{if(!E.has(z.toLowerCase())){let W=z.charAt(0).toUpperCase()+z.slice(1).toLowerCase();E.set(z.toLowerCase(),W)}}),L.forEach(z=>{E.has(z.toLowerCase())||E.set(z.toLowerCase(),z)});let I=[];return A.forEach(z=>{let W=E.get(z.toLowerCase());W&&N.has(z.toLowerCase())&&(I.push(W),N.delete(z.toLowerCase()))}),N.forEach(z=>{let W=E.get(z);W&&I.push(W)}),I},[x,e,c]),T=(0,He.useCallback)(D=>{e.viewManager.openAccountPageView(D)},[e.viewManager]),P=(0,He.useCallback)(()=>{YF(e.app,e,()=>{b()})},[e,b]),M=(0,He.useCallback)(()=>{I9(e.app,e,()=>{d(D=>D+1),b()})},[e,b]);return n?He.default.createElement("div",{className:"journalit-account-dashboard loading"},He.default.createElement(sr,{message:"Loading accounts..."})):o?He.default.createElement("div",{className:"journalit-account-dashboard error"},He.default.createElement("div",{className:"error-message"},o)):t.length===0?He.default.createElement("div",{className:"journalit-account-dashboard"},He.default.createElement("div",{className:"empty-state-with-action"},He.default.createElement(Ie,{message:"No Accounts Found",subMessage:"Create an account to start tracking your trading performance"}),He.default.createElement("div",{className:"empty-state-actions"},He.default.createElement($e,{variant:"primary",onClick:P,className:"create-account-primary-button"},"Create Your First Account")))):He.default.createElement("div",{className:"journalit-account-dashboard"},He.default.createElement("div",{className:"dashboard-content"},He.default.createElement("div",{className:"dashboard-header"},He.default.createElement("div",{className:"dashboard-title"},He.default.createElement("h2",null,"Account Dashboard")),He.default.createElement("div",{className:"dashboard-actions"},He.default.createElement(mu,{ariaLabel:"Create new account",onClick:P,className:"create-account-button"},He.default.createElement(zi,{size:18})),He.default.createElement(mu,{ariaLabel:"Account dashboard settings",onClick:M,className:"settings-button"},He.default.createElement(id,{size:16})))),He.default.createElement(y9,{data:C}),He.default.createElement(b9,{metrics:y}),He.default.createElement(MF,{accounts:t,accountsByType:x,accountTypesToDisplay:S,totalAUM:w,excludedTypes:g,showLegend:!0}),He.default.createElement(w9,{accountsByType:x,openAccount:T,plugin:e,refreshTrigger:c,totalAUM:w,excludedTypes:g})))},N9=He.default.memo(pbe);ca();Ct();var UT=class extends L9.ItemView{constructor(r,n){super(r);this.root=null;this.plugin=n}getViewType(){return"account-dashboard"}getDisplayText(){return"Account Dashboard"}getIcon(){return"users"}async onOpen(){var a;(a=re.account)!=null&&a.inject&&re.account.inject();let r=this.containerEl.children[1];r.empty(),r.addClass("journalit-account-dashboard-container");let n=r.createDiv();this.root=(0,M9.createRoot)(n),this.renderDashboard()}async onClose(){var r;this.root&&(this.root.unmount(),this.root=null),(r=re.account)!=null&&r.remove&&re.account.remove()}renderDashboard(){this.root&&this.root.render(JF.createElement(Co,{children:null},JF.createElement(N9,{plugin:this.plugin})))}};var Y9=_(B());var nt=_(B());Ft();Za();Ea();var Bb=class{constructor(t){this.cache=new Map;this.lastUpdateTime=0;this.updateThreshold=5e3;this.cachedEnrichedTrades=null;this.tradingDayStringCache=new Map;this.plugin=t,this.tradeService=wd.getInstance(t.app,t).getTradeService(),this.tradeDataChangeHandler=r=>{this.clearCache()},document.addEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler)}async getTradesWithPaths(){let r=(await this.tradeService.getTradeData()).map(n=>({...n,filePath:n.path||n.filePath}));if(this.plugin.missedTradeService)try{let n=new Date("2000-01-01"),a=new Date("2099-12-31"),o=await this.plugin.missedTradeService.getMissedTrades(n,a);for(let i of o){let s=this.plugin.app.metadataCache.getFileCache(i),l=s==null?void 0:s.frontmatter;l&&l.type==="missed-trade"&&r.push({...l,filePath:i.path,isMissedTrade:!0,path:i.path})}}catch(n){console.error("Error fetching missed trades for trade log:",n)}return r}async getHierarchicalData(t,r,n){let a=`${t}-${r==null?void 0:r.toISOString()}-${n==null?void 0:n.toISOString()}`,o=Date.now();if(this.cache.has(a)&&o-this.lastUpdateTime<this.updateThreshold)return this.cache.get(a).children||[];this.cachedEnrichedTrades=null;let i=await this.getTradesWithPaths(),s=this.filterTradesByDateRange(i,r,n),l=this.preComputeDateComponents(s);this.cachedEnrichedTrades=l;let c;switch(t){case"years":c=await this.buildYearNodesOptimized(l);break;case"quarters":c=await this.buildQuarterNodesOptimized(l);break;case"months":c=await this.buildMonthNodesOptimized(l);break;case"weeks":c=await this.buildWeekNodesOptimized(l);break;case"days":c=await this.buildDayNodesOptimized(l);break;case"trades":c=await this.buildTradeNodesOptimized(l);break;default:c=[]}c.length<50&&this.markBestWorstPerformers(c);let u={type:"root",id:"root",label:"All Trades",metrics:l.length>500?this.calculateMetricsLightweight(l):this.calculateMetrics(l),children:c,expanded:!0,dataLoaded:!0};return this.cache.set(a,u),this.lastUpdateTime=o,c}async getNodeChildren(t){if(!this.cachedEnrichedTrades||this.cachedEnrichedTrades.length===0){let o=await this.getTradesWithPaths();this.cachedEnrichedTrades=this.preComputeDateComponents(o)}let r=this.cachedEnrichedTrades,n=this.filterTradesByNode(r,t),a=[];switch(t.type){case"year":a=this.buildQuartersForYear(n,parseInt(t.id));break;case"quarter":a=this.buildMonthsForQuarter(n,t.id);break;case"month":a=this.buildWeeksForMonth(n,t.id);break;case"week":a=this.buildDaysForWeek(n,t.id);break;case"day":a=await this.buildTradesForDay(n,t.id);break;default:return[]}return this.markBestWorstPerformers(a),a}async buildFullHierarchy(t){let r=new Map;t.forEach(o=>{let s=new Date(o.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i-o);for(let o of a){let i=r.get(o),s=this.buildQuartersForYear(i,o);n.push({type:"year",id:o.toString(),label:o.toString(),metrics:this.calculateMetrics(i),children:s,expanded:o===new Date().getFullYear(),dataLoaded:!0})}return this.markBestWorstPerformersRecursive(n),n}async buildYearNodes(t){let r=new Map;t.forEach(o=>{let s=new Date(o.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i-o);for(let o of a){let i=r.get(o);n.push({type:"year",id:o.toString(),label:o.toString(),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}preComputeDateComponents(t){return t.map((n,a)=>{let o=n.entryTime||n["entry-time"]||n.date;if(!o)return null;let i=new Date(o);if(isNaN(i.getTime()))return null;let s=i.getFullYear(),l=i.getMonth(),c=Math.floor(l/3)+1;return{...n,_dateComponents:{date:i,year:s,month:l+1,quarter:c,dayKey:i.toISOString().split("T")[0],weekNum:this.getISOWeekNumber(i),tradingDayString:this.getTradingDayStringMemoized(i)}}}).filter(n=>n!==null)}getTradingDayStringMemoized(t){let r=t.toISOString();if(!this.tradingDayStringCache.has(r)){let n=oc(t,this.plugin);this.tradingDayStringCache.set(r,n)}return this.tradingDayStringCache.get(r)}getISOWeekNumber(t){return cl(t)}calculateMetricsLightweight(t){if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(i=>this.getTradeStatus(i)==="open"),n=t.filter(i=>this.getTradeStatus(i)!=="open"&&!i.isMissedTrade),a=n.filter(i=>(i.pnl||0)>0).length;return{totalPnL:n.reduce((i,s)=>i+(s.pnl||0),0),winRate:n.length>0?a/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length}}calculateMetrics(t){if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(d=>this.getTradeStatus(d)==="open"),n=t.filter(d=>this.getTradeStatus(d)!=="open"&&!d.isMissedTrade),a=n.filter(d=>(d.pnl||0)>0).length,o=n.filter(d=>(d.pnl||0)<0).length,i=n.reduce((d,u)=>d+(u.pnl||0),0),s=new Map;n.length<100&&n.forEach(d=>{let p=new Date(d.entryTime).toISOString().split("T")[0];s.set(p,(s.get(p)||0)+(d.pnl||0))});let l={label:"",pnl:-1/0},c={label:"",pnl:1/0};return s.size>0&&s.forEach((d,u)=>{d>l.pnl&&(l={label:u,pnl:d}),d<c.pnl&&(c={label:u,pnl:d})}),{totalPnL:i,winRate:n.length>0?a/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,bestPeriod:l.label&&s.size>0?l:void 0,worstPeriod:c.label&&s.size>0?c:void 0}}getTradeStatus(t){return ZB(t)}filterTradesByDateRange(t,r,n){return!r&&!n?t:t.filter(a=>{let o=new Date(a.entryTime);return!(r&&o<r||n&&o>n)})}filterTradesByNode(t,r){switch(r.type){case"year":let n=parseInt(r.id);return t.filter(v=>v._dateComponents?v._dateComponents.year===n:new Date(v.entryTime).getFullYear()===n);case"quarter":let[a,o]=r.id.split("-Q"),i=parseInt(o),s=parseInt(a);return t.filter(v=>{if(v._dateComponents)return v._dateComponents.year===s&&v._dateComponents.quarter===i;let y=(i-1)*3,g=y+2,w=new Date(v.entryTime);return w.getFullYear()===s&&w.getMonth()>=y&&w.getMonth()<=g});case"month":let[l,c]=r.id.split("-"),d=parseInt(c),u=parseInt(l);return t.filter(v=>{if(v._dateComponents)return v._dateComponents.year===u&&v._dateComponents.month===d;let y=new Date(v.entryTime);return y.getFullYear()===u&&y.getMonth()===d-1});case"week":let[p,m]=r.id.split("-W"),h=parseInt(m),f=parseInt(p);return t.filter(v=>{if(v._dateComponents)return v._dateComponents.year===f&&v._dateComponents.weekNum===h;let y=new Date(v.entryTime);return y.getFullYear()===f&&cl(y)===h});case"day":return t.filter((v,y)=>{if(v._dateComponents&&v._dateComponents.tradingDayString)return v._dateComponents.tradingDayString===r.id;let g=new Date(v.entryTime);return oc(g,this.plugin)===r.id});default:return t}}async buildQuarterNodes(t){let r=new Map;t.forEach(o=>{let i=new Date(o.entryTime),s=i.getFullYear(),l=zD(i),c=`${s}-Q${l}`;r.has(c)||r.set(c,[]),r.get(c).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o),[s,l]=o.split("-Q");n.push({type:"quarter",id:o,label:`Q${l} ${s}`,metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodes(t){let r=new Map;t.forEach(i=>{let s=new Date(i.entryTime),l=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;r.has(l)||r.set(l,[]),r.get(l).push(i)});let n=[],a=Array.from(r.keys()).sort((i,s)=>s.localeCompare(i)),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let i of a){let s=r.get(i),[l,c]=i.split("-");n.push({type:"month",id:i,label:`${o[parseInt(c)-1]} ${l}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodes(t){let r=new Map;t.forEach(o=>{let i=new Date(o.entryTime),s=cl(i),c=`${i.getFullYear()}-W${s.toString().padStart(2,"0")}`;r.has(c)||r.set(c,[]),r.get(c).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o);n.push({type:"week",id:o,label:o.replace("-W"," Week "),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildDayNodes(t){let r=new Map;t.forEach(o=>{let i=new Date(o.entryTime),s=oc(i,this.plugin);r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o);n.push({type:"day",id:o,label:new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}clearCache(){this.cache.clear(),this.tradingDayStringCache.clear(),this.cachedEnrichedTrades=null,this.lastUpdateTime=0,this.tradeService.clearCache()}markBestWorstPerformers(t){if(t.length===0||t[0].type==="trade")return;let r=null,n=null,a=-1/0,o=1/0;if(t.forEach(i=>{let s=i.metrics.totalPnL;s>0&&s>a&&(a=s,r=i),s<0&&s<o&&(o=s,n=i)}),t.length===1){let i=t[0];i.metrics.totalPnL>0?i.performanceIndicator="best":i.metrics.totalPnL<0&&(i.performanceIndicator="worst")}else r!==null&&a>0&&(r.performanceIndicator="best"),n!==null&&o<0&&n!==r&&(n.performanceIndicator="worst")}markBestWorstPerformersRecursive(t){this.markBestWorstPerformers(t),t.forEach(r=>{r.children&&r.children.length>0&&this.markBestWorstPerformersRecursive(r.children)})}markBestWorstTrades(t){var i;if(t.length===0)return;let r=null,n=null,a=-1/0,o=1/0;if(t.forEach(s=>{var c;let l=((c=s.trade)==null?void 0:c.pnl)||0;l>0&&l>a&&(a=l,r=s),l<0&&l<o&&(o=l,n=s)}),t.length===1){let s=t[0],l=((i=s.trade)==null?void 0:i.pnl)||0;l>0?s.trade&&(s.trade.performanceIndicator="best"):l<0&&s.trade&&(s.trade.performanceIndicator="worst")}else r!==null&&a>0&&r.trade&&(r.trade.performanceIndicator="best"),n!==null&&o<0&&n!==r&&n.trade&&(n.trade.performanceIndicator="worst")}async buildTradeNodes(t){let r=[...t].sort((o,i)=>{let s=new Date(o.entryTime);return new Date(i.entryTime).getTime()-s.getTime()});if(r.length<100)return r.map(i=>{let s=new Date(i.entryTime),l=Fe(s),c=this.getTradeStatus(i),d=c==="open",u=d?0:i.pnl||0,p=i.instrument||"Unknown",m=`${p} - ${l}${d?" (OPEN)":""}`;return{type:"trade",id:i.filePath||`trade-${p}-${s.getTime()}`,label:m,metrics:{totalPnL:u,winRate:d?0:u>0?100:0,tradeCount:1,status:c},trade:i,expanded:!1,dataLoaded:!0}});let n=[],a=50;for(let o=0;o<r.length;o+=a){let s=r.slice(o,o+a).map(l=>{let c=new Date(l.entryTime),d=Fe(c),u=this.getTradeStatus(l),p=u==="open",m=p?0:l.pnl||0,h=l.instrument||"Unknown",f=`${h} - ${d}${p?" (OPEN)":""}`;return{type:"trade",id:l.filePath||`trade-${h}-${c.getTime()}`,label:f,metrics:{totalPnL:m,winRate:p?0:m>0?100:0,tradeCount:1,status:u},trade:l,expanded:!1,dataLoaded:!0}});n.push(...s),o/a%3===0&&o+a<r.length&&await new Promise(l=>setTimeout(l,0))}return n}async buildTradesForDay(t,r){try{return await this.buildTradeNodesOptimized(t)}catch(n){return console.error("Error building trades for day:",n),[]}}buildQuartersForYear(t,r){let n=new Map;t.forEach(o=>{let i=new Date(o.entryTime),s=zD(i);n.has(s)||n.set(s,[]),n.get(s).push(o)});let a=[];for(let o=4;o>=1;o--)if(n.has(o)){let i=n.get(o);a.push({type:"quarter",id:`${r}-Q${o}`,label:`Q${o}`,metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return a}buildMonthsForQuarter(t,r){let[n,a]=r.split("-Q"),i=(parseInt(a)-1)*3,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=new Map;t.forEach(d=>{let p=new Date(d.entryTime).getMonth();l.has(p)||l.set(p,[]),l.get(p).push(d)});let c=[];for(let d=i+2;d>=i;d--)if(l.has(d)){let u=l.get(d);c.push({type:"month",id:`${n}-${(d+1).toString().padStart(2,"0")}`,label:s[d],metrics:this.calculateMetrics(u),expanded:!1,dataLoaded:!1})}return c}buildWeeksForMonth(t,r){let n=new Map;t.forEach(i=>{let s=new Date(i.entryTime),l=cl(s);n.has(l)||n.set(l,[]),n.get(l).push(i)});let a=[],o=Array.from(n.keys()).sort((i,s)=>s-i);for(let i of o){let s=n.get(i),[l]=r.split("-");a.push({type:"week",id:`${l}-W${i.toString().padStart(2,"0")}`,label:`Week ${i}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return a}buildDaysForWeek(t,r){let n=new Map,a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];t.forEach(s=>{let l=new Date(s.entryTime),c=oc(l,this.plugin);n.has(c)||n.set(c,[]),n.get(c).push(s)});let o=[],i=Array.from(n.keys()).sort((s,l)=>l.localeCompare(s));for(let s of i){let l=n.get(s),c=new Date(s),d=a[c.getDay()];o.push({type:"day",id:s,label:`${d} ${c.getDate()}`,metrics:this.calculateMetrics(l),expanded:!1,dataLoaded:!1})}return o}async buildTradeNodesOptimized(t){let r=[...t].sort((a,o)=>o._dateComponents.date.getTime()-a._dateComponents.date.getTime());return r.length>200?await this.buildTradeNodesLightweight(r):r.map((a,o)=>{let i=Fe(a._dateComponents.date),s=this.getTradeStatus(a),l=s==="open",c=l?0:a.pnl||0,d=a.instrument||"Unknown",u=`${d} - ${i}${l?" (OPEN)":""}`;return{type:"trade",id:a.filePath||`trade-${d}-${a._dateComponents.date.getTime()}`,label:u,metrics:{totalPnL:c,winRate:l?0:c>0?100:0,tradeCount:1,status:s},trade:a,expanded:!1,dataLoaded:!0}})}async buildTradeNodesLightweight(t){let r=[];for(let a=0;a<t.length;a+=100){let i=t.slice(a,a+100).map(s=>{let l=this.getTradeStatus(s),c=l==="open",d=c?0:s.pnl||0,u=s.instrument||"Unknown",p=`${u} - ${s._dateComponents.dayKey}${c?" (OPEN)":""}`;return{type:"trade",id:s.filePath||`trade-${u}-${s._dateComponents.date.getTime()}`,label:p,metrics:{totalPnL:d,winRate:c?0:d>0?100:0,tradeCount:1,status:l},trade:s,expanded:!1,dataLoaded:!0}});r.push(...i),a%200===0&&a+100<t.length&&await new Promise(s=>setTimeout(s,0))}return r}async buildYearNodesOptimized(t){let r=new Map;t.forEach(o=>{let i=o._dateComponents.year;r.has(i)||r.set(i,[]),r.get(i).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i-o);for(let o of a){let i=r.get(o);n.push({type:"year",id:o.toString(),label:o.toString(),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildQuarterNodesOptimized(t){let r=new Map;t.forEach(o=>{let i=o._dateComponents.year,s=o._dateComponents.quarter,l=`${i}-Q${s}`;r.has(l)||r.set(l,[]),r.get(l).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o),[s,l]=o.split("-Q");n.push({type:"quarter",id:o,label:`Q${l} ${s}`,metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodesOptimized(t){let r=new Map;t.forEach(i=>{let s=`${i._dateComponents.year}-${i._dateComponents.month.toString().padStart(2,"0")}`;r.has(s)||r.set(s,[]),r.get(s).push(i)});let n=[],a=Array.from(r.keys()).sort((i,s)=>s.localeCompare(i)),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let i of a){let s=r.get(i),[l,c]=i.split("-");n.push({type:"month",id:i,label:`${o[parseInt(c)-1]} ${l}`,metrics:s.length>500?this.calculateMetricsLightweight(s):this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodesOptimized(t){let r=new Map;t.forEach(o=>{let i=`${o._dateComponents.year}-W${o._dateComponents.weekNum.toString().padStart(2,"0")}`;r.has(i)||r.set(i,[]),r.get(i).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o);n.push({type:"week",id:o,label:o.replace("-W"," Week "),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildDayNodesOptimized(t){let r=new Map;t.forEach((o,i)=>{let s=o._dateComponents.tradingDayString;r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],a=Array.from(r.keys()).sort((o,i)=>i.localeCompare(o));for(let o of a){let i=r.get(o);n.push({type:"day",id:o,label:new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}destroy(){this.tradeDataChangeHandler&&(document.removeEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler)),this.tradingDayStringCache.clear(),this.cache.clear()}};var Ho=_(B());rd();var mbe=[{value:"trades",label:"Trades"},{value:"years",label:"Years"},{value:"quarters",label:"Quarters"},{value:"months",label:"Months"},{value:"weeks",label:"Weeks"},{value:"days",label:"Days"}],qT=(0,Ho.memo)(({filters:e,onFilterChange:t})=>Ho.default.createElement("div",{className:"trade-log-header"},Ho.default.createElement("div",{className:"trade-log-controls"},Ho.default.createElement("div",{className:"view-level-selector"},Ho.default.createElement("label",null,"View:"),Ho.default.createElement(la,{value:e.viewLevel,onChange:r=>t({viewLevel:r}),options:mbe})),Ho.default.createElement("div",{className:"date-range-selector"},Ho.default.createElement(bb,{dateRange:e.dateRange,onChange:r=>t({dateRange:r})}))),Ho.default.createElement("div",{className:"trade-log-filter-placeholder"},Ho.default.createElement("div",{className:"filter-placeholder-content"},Ho.default.createElement("span",{className:"filter-icon"},"\u{1F50D}"),Ho.default.createElement("span",{className:"filter-text"},"Advanced filters coming soon...")))));qT.displayName="TradeLogHeader";var Cn=_(B());function HT(){return HT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HT.apply(null,arguments)}function XF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VT(e,t){return VT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},VT(e,t)}function O9(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,VT(e,t)}var F9=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function fbe(e,t){return!!(e===t||F9(e)&&F9(t))}function gbe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!fbe(e[r],t[r]))return!1;return!0}function hbe(e,t){t===void 0&&(t=gbe);var r,n=[],a,o=!1;function i(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return o&&r===this&&t(s,n)||(a=e.apply(this,s),o=!0,r=this,n=s),a}return i}var GT=hbe;var zg=_(B());var vbe=typeof performance=="object"&&typeof performance.now=="function",j9=vbe?function(){return performance.now()}:function(){return Date.now()};function z9(e){cancelAnimationFrame(e.id)}function ybe(e,t){var r=j9();function n(){j9()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}var a={id:requestAnimationFrame(n)};return a}var QF=-1;function _9(e){if(e===void 0&&(e=!1),QF===-1||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),QF=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return QF}var jg=null;function B9(e){if(e===void 0&&(e=!1),jg===null||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?jg="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?jg="negative":jg="positive-ascending"),document.body.removeChild(t),jg}return jg}var bbe=150,xbe=function(t,r){return t};function wbe(e){var t,r=e.getItemOffset,n=e.getEstimatedTotalSize,a=e.getItemSize,o=e.getOffsetForIndexAndAlignment,i=e.getStartIndexForOffset,s=e.getStopIndexForStartIndex,l=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=function(u){O9(p,u);function p(h){var f;return f=u.call(this,h)||this,f._instanceProps=l(f.props,XF(f)),f._outerRef=void 0,f._resetIsScrollingTimeoutId=null,f.state={instance:XF(f),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof f.props.initialScrollOffset=="number"?f.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},f._callOnItemsRendered=void 0,f._callOnItemsRendered=GT(function(b,v,y,g){return f.props.onItemsRendered({overscanStartIndex:b,overscanStopIndex:v,visibleStartIndex:y,visibleStopIndex:g})}),f._callOnScroll=void 0,f._callOnScroll=GT(function(b,v,y){return f.props.onScroll({scrollDirection:b,scrollOffset:v,scrollUpdateWasRequested:y})}),f._getItemStyle=void 0,f._getItemStyle=function(b){var v=f.props,y=v.direction,g=v.itemSize,w=v.layout,C=f._getItemStyleCache(c&&g,c&&w,c&&y),k;if(C.hasOwnProperty(b))k=C[b];else{var x=r(f.props,b,f._instanceProps),S=a(f.props,b,f._instanceProps),T=y==="horizontal"||w==="horizontal",P=y==="rtl",M=T?x:0;C[b]=k={position:"absolute",left:P?void 0:M,right:P?M:void 0,top:T?0:x,height:T?"100%":S,width:T?S:"100%"}}return k},f._getItemStyleCache=void 0,f._getItemStyleCache=GT(function(b,v,y){return{}}),f._onScrollHorizontal=function(b){var v=b.currentTarget,y=v.clientWidth,g=v.scrollLeft,w=v.scrollWidth;f.setState(function(C){if(C.scrollOffset===g)return null;var k=f.props.direction,x=g;if(k==="rtl")switch(B9()){case"negative":x=-g;break;case"positive-descending":x=w-y-g;break}return x=Math.max(0,Math.min(x,w-y)),{isScrolling:!0,scrollDirection:C.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!1}},f._resetIsScrollingDebounced)},f._onScrollVertical=function(b){var v=b.currentTarget,y=v.clientHeight,g=v.scrollHeight,w=v.scrollTop;f.setState(function(C){if(C.scrollOffset===w)return null;var k=Math.max(0,Math.min(w,g-y));return{isScrolling:!0,scrollDirection:C.scrollOffset<k?"forward":"backward",scrollOffset:k,scrollUpdateWasRequested:!1}},f._resetIsScrollingDebounced)},f._outerRefSetter=function(b){var v=f.props.outerRef;f._outerRef=b,typeof v=="function"?v(b):v!=null&&typeof v=="object"&&v.hasOwnProperty("current")&&(v.current=b)},f._resetIsScrollingDebounced=function(){f._resetIsScrollingTimeoutId!==null&&z9(f._resetIsScrollingTimeoutId),f._resetIsScrollingTimeoutId=ybe(f._resetIsScrolling,bbe)},f._resetIsScrolling=function(){f._resetIsScrollingTimeoutId=null,f.setState({isScrolling:!1},function(){f._getItemStyleCache(-1,null)})},f}p.getDerivedStateFromProps=function(f,b){return Sbe(f,b),d(f),null};var m=p.prototype;return m.scrollTo=function(f){f=Math.max(0,f),this.setState(function(b){return b.scrollOffset===f?null:{scrollDirection:b.scrollOffset<f?"forward":"backward",scrollOffset:f,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},m.scrollToItem=function(f,b){b===void 0&&(b="auto");var v=this.props,y=v.itemCount,g=v.layout,w=this.state.scrollOffset;f=Math.max(0,Math.min(f,y-1));var C=0;if(this._outerRef){var k=this._outerRef;g==="vertical"?C=k.scrollWidth>k.clientWidth?_9():0:C=k.scrollHeight>k.clientHeight?_9():0}this.scrollTo(o(this.props,f,b,w,this._instanceProps,C))},m.componentDidMount=function(){var f=this.props,b=f.direction,v=f.initialScrollOffset,y=f.layout;if(typeof v=="number"&&this._outerRef!=null){var g=this._outerRef;b==="horizontal"||y==="horizontal"?g.scrollLeft=v:g.scrollTop=v}this._callPropsCallbacks()},m.componentDidUpdate=function(){var f=this.props,b=f.direction,v=f.layout,y=this.state,g=y.scrollOffset,w=y.scrollUpdateWasRequested;if(w&&this._outerRef!=null){var C=this._outerRef;if(b==="horizontal"||v==="horizontal")if(b==="rtl")switch(B9()){case"negative":C.scrollLeft=-g;break;case"positive-ascending":C.scrollLeft=g;break;default:var k=C.clientWidth,x=C.scrollWidth;C.scrollLeft=x-k-g;break}else C.scrollLeft=g;else C.scrollTop=g}this._callPropsCallbacks()},m.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&z9(this._resetIsScrollingTimeoutId)},m.render=function(){var f=this.props,b=f.children,v=f.className,y=f.direction,g=f.height,w=f.innerRef,C=f.innerElementType,k=f.innerTagName,x=f.itemCount,S=f.itemData,T=f.itemKey,P=T===void 0?xbe:T,M=f.layout,D=f.outerElementType,A=f.outerTagName,L=f.style,N=f.useIsScrolling,E=f.width,I=this.state.isScrolling,O=y==="horizontal"||M==="horizontal",j=O?this._onScrollHorizontal:this._onScrollVertical,$=this._getRangeToRender(),F=$[0],z=$[1],W=[];if(x>0)for(var U=F;U<=z;U++)W.push((0,zg.createElement)(b,{data:S,key:P(U,S),index:U,isScrolling:N?I:void 0,style:this._getItemStyle(U)}));var K=n(this.props,this._instanceProps);return(0,zg.createElement)(D||A||"div",{className:v,onScroll:j,ref:this._outerRefSetter,style:HT({position:"relative",height:g,width:E,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:y},L)},(0,zg.createElement)(C||k||"div",{children:W,ref:w,style:{height:O?"100%":K,pointerEvents:I?"none":void 0,width:O?K:"100%"}}))},m._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var f=this.props.itemCount;if(f>0){var b=this._getRangeToRender(),v=b[0],y=b[1],g=b[2],w=b[3];this._callOnItemsRendered(v,y,g,w)}}if(typeof this.props.onScroll=="function"){var C=this.state,k=C.scrollDirection,x=C.scrollOffset,S=C.scrollUpdateWasRequested;this._callOnScroll(k,x,S)}},m._getRangeToRender=function(){var f=this.props,b=f.itemCount,v=f.overscanCount,y=this.state,g=y.isScrolling,w=y.scrollDirection,C=y.scrollOffset;if(b===0)return[0,0,0,0];var k=i(this.props,C,this._instanceProps),x=s(this.props,k,C,this._instanceProps),S=!g||w==="backward"?Math.max(1,v):1,T=!g||w==="forward"?Math.max(1,v):1;return[Math.max(0,k-S),Math.max(0,Math.min(b-1,x+T)),k,x]},p}(zg.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var Sbe=function(t,r){var n=t.children,a=t.direction,o=t.height,i=t.layout,s=t.innerTagName,l=t.outerTagName,c=t.width,d=r.instance;if(0)var u};var $9=wbe({getItemOffset:function(t,r){var n=t.itemSize;return r*n},getItemSize:function(t,r){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var r=t.itemCount,n=t.itemSize;return n*r},getOffsetForIndexAndAlignment:function(t,r,n,a,o,i){var s=t.direction,l=t.height,c=t.itemCount,d=t.itemSize,u=t.layout,p=t.width,m=s==="horizontal"||u==="horizontal",h=m?p:l,f=Math.max(0,c*d-h),b=Math.min(f,r*d),v=Math.max(0,r*d-h+d+i);switch(n==="smart"&&(a>=v-h&&a<=b+h?n="auto":n="center"),n){case"start":return b;case"end":return v;case"center":{var y=Math.round(v+(b-v)/2);return y<Math.ceil(h/2)?0:y>f+Math.floor(h/2)?f:y}case"auto":default:return a>=v&&a<=b?a:a<v?v:b}},getStartIndexForOffset:function(t,r){var n=t.itemCount,a=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(r/a)))},getStopIndexForStartIndex:function(t,r,n){var a=t.direction,o=t.height,i=t.itemCount,s=t.itemSize,l=t.layout,c=t.width,d=a==="horizontal"||l==="horizontal",u=r*s,p=d?c:o,m=Math.ceil((p+n-u)/s);return Math.max(0,Math.min(i-1,r+m-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){var r=t.itemSize}});var Ks=_(B());var St=_(B());er();var he=_(B());ll();tc();Mm();Iv();er();Ft();Ea();Ct();var R9=(0,he.memo)(({mistakes:e})=>he.default.createElement("div",{className:"mistakes-tooltip"},he.default.createElement("div",{className:"tooltip-title"},"Mistakes:"),e.map((t,r)=>he.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));R9.displayName="MistakesTooltipContent";var W9=(0,he.memo)(({setups:e})=>he.default.createElement("div",{className:"setups-tooltip"},he.default.createElement("div",{className:"tooltip-title"},"Setups:"),e.map((t,r)=>he.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));W9.displayName="SetupsTooltipContent";var U9=(0,he.memo)(({thesis:e})=>he.default.createElement("div",{className:"thesis-tooltip"},he.default.createElement("div",{className:"tooltip-title"},"Thesis:"),he.default.createElement("div",{className:"tooltip-content"},e)));U9.displayName="ThesisTooltipContent";var q9=(0,he.memo)(({accounts:e})=>he.default.createElement("div",{className:"accounts-tooltip"},he.default.createElement("div",{className:"tooltip-title"},"Accounts:"),e.map((t,r)=>he.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));q9.displayName="AccountsTooltipContent";var ZF=(0,he.memo)(({trade:e,images:t,status:r,duration:n,onImageClick:a})=>{let{currency:o}=Ae(),i=(0,he.useMemo)(()=>e.mistake?Array.isArray(e.mistake)?e.mistake:[e.mistake]:[],[e.mistake]),s=(0,he.useMemo)(()=>e.setup?Array.isArray(e.setup)?e.setup:[e.setup]:[],[e.setup]),l=(0,he.useMemo)(()=>{if(!e.account&&!e.accountIds)return[];let c=e.accountIds||e.account;return Array.isArray(c)?c:[c]},[e.account,e.accountIds]);return he.default.createElement(he.default.Fragment,null,he.default.createElement("div",{className:"trade-image-cell"},t.length>0?he.default.createElement("div",{className:"trade-image-wrapper",onClick:c=>a(c,t[0])},he.default.createElement("div",{className:"trade-preview-thumbnail"},he.default.createElement("img",{src:$r.resolveMediaPath(t[0]),alt:`${e.instrument} preview`,className:"trade-image",loading:"lazy",decoding:"async",onError:c=>{console.error("Failed to load image:",t[0]),c.currentTarget.style.display="none"}})),t.length>1&&he.default.createElement("span",{className:"trade-image-count"},"+",t.length-1)):he.default.createElement(T0,{size:20,className:"trade-no-image-icon"})),he.default.createElement("div",{className:"trade-ticker-cell"},he.default.createElement("span",{className:"trade-ticker"},e.instrument||"Unknown",e.performanceIndicator&&he.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator}`,title:kbe(e)},e.performanceIndicator==="best"?he.default.createElement(Kh,{size:14}):he.default.createElement(sd,{size:14})))),he.default.createElement("div",{className:"trade-direction-cell"},he.default.createElement("span",{className:"trade-direction"},e.direction||"N/A")),he.default.createElement("div",{className:"trade-status-cell"},he.default.createElement("span",{className:`trade-status ${r.className}`},r.label)),he.default.createElement("div",{className:"trade-pnl-cell"},he.default.createElement("span",{className:`trade-pnl ${r.className==="status-open"?"open":e.pnl>0?"positive":e.pnl<0?"negative":"neutral"}`},r.className==="status-open"?"-":ue(e.pnl||0,!0,o))),he.default.createElement("div",{className:"trade-duration-cell"},he.default.createElement("span",{className:"trade-duration"},n)),he.default.createElement("div",{className:"trade-date-cell"},he.default.createElement("span",{className:"trade-date"},e.entryTime?Fe(new Date(e.entryTime),"DDMMYY","/"):"N/A")),he.default.createElement("div",{className:"trade-account-cell"},l.length>0?he.default.createElement(Jm,{content:he.default.createElement(q9,{accounts:l}),delay:0,preferredPosition:"top"},he.default.createElement("span",{className:"count-badge count-badge--accounts"},l.length)):he.default.createElement("span",{className:"trade-no-data"},"-")),he.default.createElement("div",{className:"trade-mistakes-cell"},i.length>0?he.default.createElement(Jm,{content:he.default.createElement(R9,{mistakes:i}),delay:0,preferredPosition:"top"},he.default.createElement("span",{className:"count-badge count-badge--mistakes"},i.length)):he.default.createElement("span",{className:"trade-no-data"},"-")),he.default.createElement("div",{className:"trade-setups-cell"},s.length>0?he.default.createElement(Jm,{content:he.default.createElement(W9,{setups:s}),delay:0,preferredPosition:"top"},he.default.createElement("span",{className:"count-badge count-badge--setups"},s.length)):he.default.createElement("span",{className:"trade-no-data"},"-")),he.default.createElement("div",{className:"trade-thesis-cell"},e.thesis?he.default.createElement(Jm,{content:he.default.createElement(U9,{thesis:e.thesis}),delay:200},he.default.createElement("span",{className:"trade-thesis"},e.thesis.length>40?e.thesis.substring(0,40)+"...":e.thesis)):he.default.createElement("span",{className:"trade-no-data"},"-")))});ZF.displayName="TradeDetailsContent";var e2=(0,he.memo)(({trade:e,depth:t,isLastChild:r=!1,onClick:n,viewLevel:a})=>{let[o,i]=(0,he.useState)(!1),[s,l]=(0,he.useState)(0),c=(0,he.useMemo)(()=>{switch(e$(e)){case"missed":return{label:"MISSED",className:"status-missed"};case"open":return{label:"OPEN",className:"status-open"};case"win":return{label:"WIN",className:"status-win"};case"loss":return{label:"LOSS",className:"status-loss"};case"breakeven":default:return{label:"BREAKEVEN",className:"status-breakeven"}}},[e.pnl,e.isMissedTrade,e.tradeStatus,e.exitTime,e.useDirectPnLInput,e.exits]),d=(0,he.useMemo)(()=>{if(!e.entryTime)return"N/A";if(e.tradeStatus==="OPEN"||ct(e)){let w=new Date(e.entryTime),k=new Date().getTime()-w.getTime();return OD(k)+" (ongoing)"}let v=new Date(e.entryTime),g=new Date(e.exitTime).getTime()-v.getTime();return OD(g)},[e.entryTime,e.exitTime,e.tradeStatus,e.pnl,e.useDirectPnLInput,e.exits]),u=(0,he.useMemo)(()=>{let b=[];try{if(e.images){if(Array.isArray(e.images))b=e.images;else if(typeof e.images=="string"){let v=JSON.parse(e.images);Array.isArray(v)&&(b=v.map(y=>String(y)))}}}catch(v){}return b},[e.images]),p=(0,he.useCallback)((b,v)=>{b.stopPropagation();let y=u.indexOf(v);l(y>=0?y:0),i(!0)},[u]),m=(0,he.useCallback)(()=>{i(!1)},[]),h=(0,he.useCallback)(b=>{b>=0&&b<u.length&&l(b)},[u.length]),f=(0,he.useMemo)(()=>{if(!(u.length<=1))return{images:u,currentIndex:s,onNavigate:h,altPrefix:`${e.instrument} Image`,useResolveMediaPath:!0}},[u,s,h,e.instrument]);return he.default.createElement(he.default.Fragment,null,he.default.createElement("div",{className:`trade-log-node trade-log-node--trade ${r?"is-last-child":""} ${a==="trades"?"trades-view":""}`,onClick:n},a!=="trades"&&he.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((b,v)=>he.default.createElement("span",{key:v,className:`tree-level ${v===t-1&&r?"last-level":""}`}))),a==="trades"?he.default.createElement("div",{className:"trade-details-row trades-view-row"},he.default.createElement(ZF,{trade:e,images:u,status:c,duration:d,onImageClick:p})):he.default.createElement("div",{className:"trade-details-row tree-view-row"},he.default.createElement("div",{className:"tree-indicator-cell"},t>0&&he.default.createElement("span",{className:"tree-connector tree-connector--trade"}),he.default.createElement("span",{className:"tree-leaf-node tree-leaf-node--trade"})),he.default.createElement(ZF,{trade:e,images:u,status:c,duration:d,onImageClick:p}))),o&&u.length>0&&he.default.createElement(nc,{isOpen:o,onClose:m,title:`${e.instrument} - ${Fe(new Date(e.entryTime),"DDMMYY"," ")}`,portalId:"trade-log-image-portal"},he.default.createElement(gd,{imagePath:u[s],alt:`${e.instrument} Image ${s+1}`,useResolveMediaPath:!0,navigationContext:f,onClose:m})))});e2.displayName="TradeDetailsRow";function kbe(e){let t=e.performanceIndicator==="best"?"Best":"Worst",n=new Date(e.entryTime).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return`${t} performing trade on ${n}`}Ft();Ct();var t2=(0,St.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n=!1,onToggleExpand:a,onNodeClick:o,viewLevel:i})=>{let{currency:s}=Ae(),l=p=>{p.stopPropagation(),a(e)},c=p=>{p.stopPropagation(),o(e)},d=e.children&&e.children.length>0,u=e.type!=="trade"&&(d||!e.dataLoaded);return e.type==="trade"?St.default.createElement(e2,{trade:e.trade,depth:t,isLastChild:n,onClick:c,viewLevel:i}):St.default.createElement("div",{className:`trade-log-node trade-log-node--${e.type} ${n?"is-last-child":""}`},St.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((p,m)=>St.default.createElement("span",{key:m,className:`tree-level ${m===t-1&&n?"last-level":""}`}))),St.default.createElement("div",{className:"node-wrapper"},t>0&&St.default.createElement("span",{className:"tree-connector"}),St.default.createElement("div",{className:"node-content"},St.default.createElement("div",{className:"tree-expand-wrapper"},u?St.default.createElement("button",{className:`node-chevron ${r?"expanded":""}`,onClick:l,"aria-label":r?"Collapse":"Expand"},r?St.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},St.default.createElement("rect",{x:"3",y:"3",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),St.default.createElement("path",{d:"M5 7H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})):St.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},St.default.createElement("rect",{x:"3",y:"3",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),St.default.createElement("path",{d:"M7 5V9M5 7H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}))):St.default.createElement("span",{className:"tree-leaf-node"})),St.default.createElement("span",{className:"node-label",onClick:c,title:`Navigate to ${e.type} review`},e.label,e.performanceIndicator&&St.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator}`,title:Tbe(e)},e.performanceIndicator==="best"?St.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},St.default.createElement("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C5.5 4 6 4.5 6 5v4zM18 9h1.5a2.5 2.5 0 0 0 0-5c-1 0-1.5.5-1.5 1v4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("path",{d:"M4 22h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):St.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},St.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),St.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),St.default.createElement("div",{className:"node-metrics"},St.default.createElement("span",{className:"metric metric--count"},e.metrics.tradeCount," ",e.metrics.tradeCount===1?"trade":"trades"),St.default.createElement("span",{className:`metric metric--winrate ${Cbe(e.metrics.winRate)}`},e.metrics.winRate.toFixed(1),"%"),St.default.createElement("span",{className:`metric metric--pnl ${e.metrics.totalPnL>0?"positive":e.metrics.totalPnL<0?"negative":"neutral"}`},ue(e.metrics.totalPnL,!0,s))))))});t2.displayName="TradeLogNode";function Cbe(e){return e>=60?"high":e>=40?"medium":"low"}function Tbe(e){let t=e.performanceIndicator==="best"?"Best":"Worst";switch(e.type){case"year":return`${t} performing year`;case"quarter":let r=e.id.split("-")[0];return`${t} performing quarter of ${r}`;case"month":let[n,a]=e.id.split("-"),o=Math.ceil(parseInt(a)/3);return`${t} performing month of Q${o} ${n}`;case"week":let[i,s]=e.id.split("-W"),l=Pbe(parseInt(i),parseInt(s)),d=["January","February","March","April","May","June","July","August","September","October","November","December"][l.getMonth()];return`${t} performing week of ${d} ${i}`;case"day":let u=e.id.split("-"),p=new Date(parseInt(u[0]),parseInt(u[1])-1,parseInt(u[2])),m=cl(p);return`${t} performing day of W${m} ${u[0]}`;default:return`${t} performing period`}}function Pbe(e,t){let r=new Date(e,0,4),n=r.getDay(),a=n===0?-6:1-n,o=new Date(r);o.setDate(r.getDate()+a);let i=new Date(o);return i.setDate(o.getDate()+(t-1)*7),i}var _g=null,YT=new WeakMap,Dbe=()=>(_g||(_g=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let r=YT.get(t.target);r&&(r(),_g==null||_g.unobserve(t.target),YT.delete(t.target))}})},{rootMargin:"300px 0px",threshold:0})),_g),KT=(0,Ks.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:a,onNodeClick:o,viewLevel:i})=>{let[s,l]=(0,Ks.useState)(!1),c=(0,Ks.useRef)(null),d=t===0||t===1;if((0,Ks.useEffect)(()=>{if(d){l(!0);return}let u=c.current;if(!u)return;let p=Dbe(),m=()=>l(!0);return YT.set(u,m),p.observe(u),()=>{u&&(p.unobserve(u),YT.delete(u))}},[d]),!s){let u=e.type==="trade"?60:48;return Ks.default.createElement("div",{ref:c,className:`trade-log-node-placeholder trade-log-node--${e.type}`,style:{height:`${u}px`,width:"100%",background:"var(--background-primary-alt)",borderBottom:"1px solid var(--background-modifier-border)"}})}return Ks.default.createElement(t2,{node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:a,onNodeClick:o,viewLevel:i})});KT.displayName="LazyTradeLogNode";var H9=({nodes:e,expandedNodes:t,onToggleExpand:r,onNodeClick:n,onTreeReady:a,viewLevel:o})=>{let i=(0,Cn.useRef)(null),[s,l]=(0,Cn.useState)(600);(0,Cn.useEffect)(()=>{let f=()=>{var y,g;if(i.current){let w=i.current.getBoundingClientRect(),C=((g=(y=document.querySelector(".trade-log-headers"))==null?void 0:y.getBoundingClientRect())==null?void 0:g.height)||60,k=w.height||window.innerHeight-C-100;l(Math.max(300,k))}},b=setTimeout(f,300),v=null;return i.current&&"ResizeObserver"in window&&(v=new ResizeObserver(f),v.observe(i.current)),window.addEventListener("resize",f),()=>{clearTimeout(b),window.removeEventListener("resize",f),v&&v.disconnect()}},[]);let[c,d]=(0,Cn.useState)([]),[u,p]=(0,Cn.useState)(!1);(0,Cn.useEffect)(()=>{if(e.length===0){d([]),p(!1),a==null||a();return}let f=0,b=y=>{let g=y.length;return y.forEach(w=>{w.children&&t.has(w.id)&&(g+=b(w.children))}),g};if(f=b(e),f<200){let y=[],g=(w,C)=>{w.forEach((k,x)=>{let S=x===w.length-1;y.push({node:k,depth:C,isLastChild:S}),t.has(k.id)&&k.children&&k.children.length>0&&g(k.children,C+1)})};g(e,0),d(y),p(!1),a==null||a();return}p(!0),(async()=>{let y=[],g=0,w=async(C,k)=>{for(let x=0;x<C.length;x++){let S=C[x],T=x===C.length-1;y.push({node:S,depth:k,isLastChild:T}),g++,t.has(S.id)&&S.children&&S.children.length>0&&await w(S.children,k+1),g%100===0&&await new Promise(P=>setTimeout(P,0))}};await w(e,0),d(y),p(!1),a==null||a()})()},[e,t,a]);let m=c.length>50,h=(0,Cn.useCallback)(({index:f,style:b})=>{let v=c[f];if(!v)return null;let{node:y,depth:g,isLastChild:w}=v;return Cn.default.createElement("div",{style:b},Cn.default.createElement(KT,{key:y.id,node:y,depth:g,isExpanded:t.has(y.id),isLastChild:w,onToggleExpand:r,onNodeClick:n,viewLevel:o}))},[c,t,r,n,o]);return e.length===0?Cn.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"No trade data available"):u&&c.length===0?Cn.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"Processing trade data..."):Cn.default.createElement("div",{className:"trade-log-tree",ref:i,style:{height:"100%"}},m?Cn.default.createElement($9,{height:s,itemCount:c.length,itemSize:48,overscanCount:5,width:"100%"},h):Cn.default.createElement("div",{style:{height:"100%",overflowY:"auto"}},c.map(({node:f,depth:b,isLastChild:v},y)=>Cn.default.createElement(KT,{key:f.id,node:f,depth:b,isExpanded:t.has(f.id),isLastChild:v,onToggleExpand:r,onNodeClick:n,viewLevel:o}))))};Su();vd();var V9=(e,t,r)=>{let n=!1;return e.map(o=>o.id===t?(n=!0,{...o,children:r,dataLoaded:!0}):o.children?{...o,children:V9(o.children,t,r)}:o)},G9=({plugin:e})=>{let[t,r]=(0,nt.useState)(!1),[n,a]=(0,nt.useState)(!1),[o,i]=(0,nt.useState)(new Set),[s,l]=(0,nt.useState)([]),[c,d]=(0,nt.useState)(new Set),[u,p]=(0,nt.useState)({dateRange:[null,null],viewLevel:"trades"}),m=(0,nt.useRef)(null);m.current||(m.current=new Bb(e));let h=m.current,f=KB(u,150),b=(0,nt.useCallback)(async()=>{let k=performance.now();r(!1),a(!1);try{let x=await h.getHierarchicalData(f.viewLevel,f.dateRange[0]||void 0,f.dateRange[1]||void 0);l(x),d(new Set),r(!0)}catch(x){console.error("Error loading trade log data:",x),r(!0),a(!0)}},[h,f]);(0,nt.useEffect)(()=>{b()},[b]);let v=(0,nt.useRef)(b);v.current=b,(0,nt.useEffect)(()=>{let k=async x=>{setTimeout(async()=>{e.app.workspace.trigger&&e.app.workspace.trigger("layout-change"),await new Promise(S=>setTimeout(S,100)),await v.current()},600)};return document.addEventListener("journalit:trade-data-changed",k),()=>{document.removeEventListener("journalit:trade-data-changed",k)}},[]),(0,nt.useEffect)(()=>()=>{m.current&&m.current.destroy()},[]);let y=(0,nt.useCallback)(async k=>{let x=new Set(c);if(c.has(k.id))x.delete(k.id),d(x);else if(!k.dataLoaded&&k.type!=="trade"){i(S=>new Set(S).add(k.id));try{let S=await h.getNodeChildren(k),T=V9(s,k.id,S);l(T),setTimeout(()=>{d(P=>{let M=new Set(P);return M.add(k.id),M})},0)}catch(S){console.error("Error loading node children:",S)}finally{i(S=>{let T=new Set(S);return T.delete(k.id),T})}}else x.add(k.id),d(x)},[c,h]),g=(0,nt.useCallback)(async k=>{var S,T,P;let x=wd.getInstance(e.app,e);switch(k.type){case"trade":(S=k.trade)!=null&&S.file?await e.app.workspace.openLinkText(k.trade.file.path,"",!1):(T=k.trade)!=null&&T.filePath?await e.app.workspace.openLinkText(k.trade.filePath,"",!1):k.id&&k.id.includes(".md")&&await e.app.workspace.openLinkText(k.id,"",!1);break;case"day":{let M=new Date(k.id),D=await x.getDRCService(),A=D.getDRCNotePath(M);e.app.vault.getAbstractFileByPath(A)?await e.app.workspace.openLinkText(A,"",!1):e.settings.drc.autoCreateDRCOnNavigation&&(await D.createDRC(M),await e.app.workspace.openLinkText(A,"",!1));break}case"week":{let[M,D]=k.id.split("-W"),A=parseInt(M),L=parseInt(D),E=new Date(A,0,1).getDay(),I=E===0?-6:1-E,O=new Date(A,0,1+I),j=new Date(O.getTime()+(L-1)*7*24*60*60*1e3),$=await x.getWeeklyReviewService(),F=$.getWeeklyReviewPath(j);e.app.vault.getAbstractFileByPath(F)?await e.app.workspace.openLinkText(F,"",!1):e.settings.weekly.autoCreateWeeklyReviewOnNavigation&&(await $.createWeeklyReview(j),await e.app.workspace.openLinkText(F,"",!1));break}case"month":{let[M,D]=k.id.split("-"),A=parseInt(M),L=parseInt(D)-1,N=new Date(A,L,1),E=await x.getMonthlyReviewService(),I=E.getMonthlyReviewPath(N);e.app.vault.getAbstractFileByPath(I)?await e.app.workspace.openLinkText(I,"",!1):(P=e.settings.monthly)!=null&&P.autoCreateMonthlyReviewOnNavigation&&await E.createMonthlyReview(N)&&await e.app.workspace.openLinkText(I,"",!1);break}case"quarter":case"year":console.log(`No review available for ${k.type}:`,k.id);break}},[e]),w=(0,nt.useCallback)(k=>{p(x=>({...x,...k}))},[]),C=(0,nt.useCallback)(()=>{a(!0)},[]);return t&&s.length===0?nt.default.createElement("div",{className:"journalit-trade-log"},nt.default.createElement(qT,{filters:u,onFilterChange:w}),nt.default.createElement(Ie,{message:"No trades found",subMessage:"Start creating trade notes to see them appear in your trade log.",actionButtonText:"Create Trade",onActionButtonClick:async()=>{new Jn({app:e.app,plugin:e}).open()}})):nt.default.createElement("div",{className:"journalit-trade-log"},nt.default.createElement(qT,{filters:u,onFilterChange:w}),nt.default.createElement("div",{className:`trade-log-content ${u.viewLevel==="trades"?"trades-view":""}`},u.viewLevel==="trades"&&t&&nt.default.createElement("div",{className:"trade-log-headers"},nt.default.createElement("div",{className:"trade-log-header-row"},nt.default.createElement("div",{className:"header-cell header-image"},"Image"),nt.default.createElement("div",{className:"header-cell header-ticker"},"Ticker"),nt.default.createElement("div",{className:"header-cell header-direction"},"Direction"),nt.default.createElement("div",{className:"header-cell header-status"},"Status"),nt.default.createElement("div",{className:"header-cell header-pnl"},"P&L"),nt.default.createElement("div",{className:"header-cell header-duration"},"Duration"),nt.default.createElement("div",{className:"header-cell header-date"},"Date"),nt.default.createElement("div",{className:"header-cell header-account"},"Account"),nt.default.createElement("div",{className:"header-cell header-mistakes"},"Mistakes"),nt.default.createElement("div",{className:"header-cell header-setups"},"Setups"),nt.default.createElement("div",{className:"header-cell header-thesis"},"Thesis"))),t?nt.default.createElement("div",{style:{position:"relative",height:"100%"}},!n&&nt.default.createElement(sr,{message:"Processing trade data...",fullscreen:!0}),nt.default.createElement("div",{style:{visibility:n?"visible":"hidden",height:"100%"}},nt.default.createElement(H9,{nodes:s,expandedNodes:c,onToggleExpand:y,onNodeClick:g,onTreeReady:C,viewLevel:u.viewLevel}))):nt.default.createElement(sr,{message:"Loading trades...",fullscreen:!0})))};Yn();var Ec="journalit-trade-log-view",JT=class extends Rd{constructor(t,r){super(t),this.plugin=r}getDisplayText(){return"Trade Log"}getViewType(){return Ec}getIcon(){return"folder-tree"}async onOpen(){try{await super.onOpen(),Ps(!0,!0,!0,!0,!0,!0,!0,!0,!0),Tu(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-trade-log-view-container"),setTimeout(()=>{let t=document.querySelector(".trade-log-content"),r=t==null?void 0:t.classList.contains("trades-view");if(t){let n=getComputedStyle(t);r?n.overflow==="visible"&&console.log("[TradeLogView] \u2705 Scroll constraints applied successfully"):n.maxHeight==="100%"&&n.overflowY==="auto"&&console.log("[TradeLogView] \u2705 Scroll constraints applied successfully")}},1e3))}catch(t){console.error("Error in TradeLogView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in TradeLogView.onClose:",t)}}getRenderFunction(){return()=>Y9.default.createElement(G9,{plugin:this.plugin})}};var Go=_(B());Yn();Zt();Tm();var Vo=_(B());ec();var Fr=_(B());Zt();_i();Ja();var Ol=require("obsidian"),Ve=_(B()),K9=_(vo());Ja();_i();Ft();Ct();var r2=class extends Ol.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty();let r=this.props.transaction.type==="deposit"?"Deposit":"Withdrawal";t.createEl("h2",{text:`Edit ${r}`,cls:"modal-title"}),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,K9.createRoot)(this.container),this.root.render(Ve.default.createElement(Co,null,Ve.default.createElement(Ebe,{...this.props,onModalClose:()=>this.close()})))}},Ebe=({plugin:e,accountName:t,transaction:r,onSave:n,onModalClose:a})=>{let[o,i]=(0,Ve.useState)(!1),[s,l]=(0,Ve.useState)(!1),[c,d]=(0,Ve.useState)(!1),{currency:u}=Ae(),p=()=>new Date().toISOString().split("T")[0],[m,h]=(0,Ve.useState)({type:r.type,amount:Math.abs(r.amount).toString(),date:new Date(r.date).toISOString().split("T")[0],description:r.description||""}),f=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:u,minimumFractionDigits:2}).format(Math.abs(g)),b=async()=>{var g;try{if(i(!0),!m.amount||parseFloat(m.amount)<=0){new Ol.Notice("Amount must be greater than 0");return}if(!m.date){new Ol.Notice("Date is required");return}let w=parseFloat(m.amount),C=new Date(m.date),k=new Date;if(k.setHours(23,59,59,999),C>k){new Ol.Notice("Transaction date cannot be in the future");return}await((g=e.accountPageService)==null?void 0:g.updateManualTransaction(t,r.id,{amount:w,date:C,description:m.description||void 0}));let x=m.type==="deposit"?"Deposit":"Withdrawal";new Ol.Notice(`${x} updated successfully`),n(),a()}catch(w){console.error("Error updating transaction:",w),new Ol.Notice(`Error updating transaction: ${w.message}`)}finally{i(!1)}},v=async()=>{var g;try{l(!0),await((g=e.accountPageService)==null?void 0:g.deleteManualTransaction(t,r.id));let w=r.type==="deposit"?"Deposit":"Withdrawal";new Ol.Notice(`${w} deleted successfully`),n(),a()}catch(w){console.error("Error deleting transaction:",w),new Ol.Notice(`Error deleting transaction: ${w.message}`)}finally{l(!1)}},y=r.type==="deposit"?"Deposit":"Withdrawal";return c?Ve.default.createElement("div",{className:"add-event-form"},Ve.default.createElement("div",{className:"setting-item"},Ve.default.createElement("div",{className:"setting-item-info"},Ve.default.createElement("div",{className:"setting-item-name",style:{color:"var(--text-error)"}},"Delete ",y),Ve.default.createElement("div",{className:"setting-item-description"},"Are you sure you want to delete this ",y.toLowerCase()," of ",f(r.amount)," from ",Fe(new Date(r.date),Ot()),"?"),Ve.default.createElement("div",{className:"setting-item-description warning"},"This action cannot be undone."))),Ve.default.createElement("div",{className:"add-event-buttons"},Ve.default.createElement("div",{className:"button-group-right"},Ve.default.createElement($e,{variant:"secondary",onClick:v,disabled:s,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},s?"Deleting...":`Delete ${y}`),Ve.default.createElement($e,{variant:"secondary",onClick:()=>d(!1),disabled:s,className:"cancel-button"},"Cancel")))):Ve.default.createElement("div",{className:"add-event-form"},Ve.default.createElement("div",{className:"setting-item two-column"},Ve.default.createElement("div",{className:"column"},Ve.default.createElement("div",{className:"setting-item-info"},Ve.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),Ve.default.createElement("div",{className:"setting-item-description"},"Cannot be changed when editing")),Ve.default.createElement("div",{className:"setting-item-control"},Ve.default.createElement("select",{value:m.type,disabled:!0},Ve.default.createElement("option",{value:"deposit"},"Deposit"),Ve.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),Ve.default.createElement("div",{className:"column"},Ve.default.createElement("div",{className:"setting-item-info"},Ve.default.createElement("div",{className:"setting-item-name"},"Amount"),Ve.default.createElement("div",{className:"setting-item-description"},"Amount in ",u)),Ve.default.createElement("div",{className:"setting-item-control"},Ve.default.createElement("input",{type:"number",value:m.amount,onChange:g=>h({...m,amount:g.target.value}),onFocus:g=>{(m.amount==="0"||m.amount==="")&&(g.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:o})))),Ve.default.createElement("div",{className:"setting-item two-column"},Ve.default.createElement("div",{className:"column"},Ve.default.createElement("div",{className:"setting-item-info"},Ve.default.createElement("div",{className:"setting-item-name"},"Date"),Ve.default.createElement("div",{className:"setting-item-description"},"Transaction date")),Ve.default.createElement("div",{className:"setting-item-control"},Ve.default.createElement("input",{type:"date",value:m.date,onChange:g=>h({...m,date:g.target.value}),max:p(),disabled:o}))),Ve.default.createElement("div",{className:"column"},Ve.default.createElement("div",{className:"setting-item-info"},Ve.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),Ve.default.createElement("div",{className:"setting-item-description"},"Additional notes")),Ve.default.createElement("div",{className:"setting-item-control"},Ve.default.createElement("input",{type:"text",value:m.description,onChange:g=>h({...m,description:g.target.value}),placeholder:m.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:o})))),Ve.default.createElement("div",{className:"add-event-buttons"},Ve.default.createElement("div",{className:"button-group-left"},Ve.default.createElement($e,{variant:"secondary",onClick:()=>d(!0),disabled:o,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},"Delete ",y)),Ve.default.createElement("div",{className:"button-group-right"},Ve.default.createElement($e,{variant:"primary",onClick:b,disabled:o,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},o?"Saving...":"Save Changes"),Ve.default.createElement($e,{variant:"secondary",onClick:a,disabled:o,className:"cancel-button"},"Cancel"))))};function J9(e,t,r,n,a){new r2({app:e,plugin:t,accountName:r,transaction:n,onClose:()=>{},onSave:a}).open()}Ft();Ct();er();var Abe=({transaction:e,accountName:t,onUpdate:r})=>{let n=Ee(),{currency:a}=Ae(),o=Ot(),i=p=>Da(Math.abs(p),!1,a),s=p=>Da(p,!1,a),l=()=>{n&&J9(n.app,n,t,e,r)},c=e.type==="deposit",d=c?"Deposit":"Withdrawal",u=c?"deposit":"withdrawal";return Fr.default.createElement("div",{className:`transaction-item ${u} clickable`,onClick:l,title:"Click to edit or delete this transaction"},Fr.default.createElement("div",{className:"transaction-header"},Fr.default.createElement("div",{className:"transaction-primary-info"},Fr.default.createElement("span",{className:`transaction-type ${u}`},d),Fr.default.createElement("span",{className:"transaction-date"},Fe(e.date instanceof Date?e.date:new Date(e.date),o))),Fr.default.createElement("span",{className:`transaction-amount ${c?"positive":"negative"}`},c?"+":"-",i(e.amount))),Fr.default.createElement("div",{className:"transaction-details"},e.description&&Fr.default.createElement("div",{className:"transaction-description"},Fr.default.createElement("span",{className:"description-label"},"Description:"),Fr.default.createElement("span",{className:"description-text"},e.description)),Fr.default.createElement("div",{className:"transaction-meta"},Fr.default.createElement("span",{className:"balance-after"},"Balance after: ",s(e.balanceAfter)))))},X9=()=>{let{accountPageData:e,refreshData:t}=Uo(),r=Ee();if(!e||!r)return null;let{account:n}=e,o=[...(n.transactions||[]).filter(s=>(s.type==="deposit"||s.type==="withdrawal")&&s.description!=="Initial deposit")].sort((s,l)=>new Date(l.date).getTime()-new Date(s.date).getTime()),i=()=>{WT(r.app,r,n.name,t)};return Fr.default.createElement("div",{className:"deposits-withdrawals-section"},Fr.default.createElement("div",{className:"section-header-centered"},Fr.default.createElement("span",{className:"section-header-line"}),Fr.default.createElement("h3",{className:"section-header-title"},"Deposits & Withdrawals (",o.length,")"),Fr.default.createElement("span",{className:"section-header-line"})),o.length===0?Fr.default.createElement("div",{className:"empty-transactions"},Fr.default.createElement(Ie,{message:"No manual deposits or withdrawals recorded.",subMessage:"Click the + button in the header to add your first transaction."}),Fr.default.createElement("div",{className:"empty-state-action"},Fr.default.createElement($e,{onClick:i,variant:"primary",className:"add-first-transaction-btn"},"Add First Transaction"))):Fr.default.createElement("div",{className:"transactions-list"},o.map(s=>Fr.default.createElement(Abe,{key:s.id,transaction:s,accountName:n.name,onUpdate:t}))))};var Q9=()=>{let{accountPageData:e,isLoading:t,error:r,accountName:n}=Uo();return t&&!e?Vo.default.createElement("div",{className:"account-page-loading"},Vo.default.createElement(sr,{message:"Loading account data..."})):r?Vo.default.createElement("div",{className:"account-page-error"},Vo.default.createElement("h3",null,"Error Loading Account"),Vo.default.createElement("p",null,r.message)):e?Vo.default.createElement("div",{className:"account-page-content"},Vo.default.createElement(WF,null),Vo.default.createElement(HF,null),Vo.default.createElement(UF,null),Vo.default.createElement(VF,null),Vo.default.createElement(X9,null),Vo.default.createElement(qF,null)):Vo.default.createElement(Ie,{message:`Could not find account data for "${n}"`,subMessage:"Please check if the account exists or try refreshing the page."})};var Fl="journalit-account-page-view",Bg=class extends Rd{constructor(r){super(r);this.accountName=""}getDisplayText(){return this.accountName?`Account: ${this.accountName}`:"Account Page"}getViewType(){return Fl}getIcon(){return"user-circle"}async onOpen(){try{await super.onOpen(),Eu(),this.containerEl&&(this.containerEl.classList.add("journalit-account-page-view-container"),Object.assign(this.containerEl.style,{padding:"0"}))}catch(r){console.error("Error in AccountPageView.onOpen:",r)}}async onClose(){try{await super.onClose()}catch(r){console.error("Error in AccountPageView.onClose:",r)}}setAccountName(r){this.accountName=r,this.leaf&&(this.leaf.view=this)}getAccountName(){return this.accountName}async setState(r,n){await super.setState(r,n),r!=null&&r.accountName&&this.setAccountName(r.accountName)}getState(){return{...super.getState(),accountName:this.accountName}}getRenderFunction(){return()=>Go.default.createElement(Ibe,{leaf:this.leaf,view:this})}},Ibe=({leaf:e,view:t})=>{let r=Ee(),n=t.getAccountName();return r?n?Go.default.createElement("div",{className:"journalit-account-page-view"},Go.default.createElement(Nbe,{accountName:n,plugin:r})):Go.default.createElement("div",{className:"journalit-account-page-view"},Go.default.createElement("div",{className:"account-page-error"},Go.default.createElement("h3",null,"No Account Selected"),Go.default.createElement("p",null,"Please navigate to this page from the Account Dashboard."))):Go.default.createElement("div",{className:"journalit-account-page-view"},"Loading...")},Nbe=({accountName:e,plugin:t})=>{let{service:r}=HB();return r?Go.default.createElement(C9,{app:t.app,accountPageService:r,accountName:e},Go.default.createElement("div",{className:"account-page-wrapper"},Go.default.createElement(Q9,null))):Go.default.createElement("div",{className:"account-page-loading"},Go.default.createElement("p",null,"Loading account page service..."))};vd();var _p="account-dashboard",XT=class e{constructor(t){this.registeredViews=new Set;this.plugin=t}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}async registerAllViews(){}async registerDashboardView(){if(!this.registeredViews.has(ds))try{this.plugin.app.workspace.getLeavesOfType(ds).length===0?(this.plugin.registerView(ds,r=>new zb(r)),this.registeredViews.add(ds)):this.registeredViews.add(ds)}catch(t){console.error("Error registering dashboard view:",t)}}async registerAccountDashboardView(){if(!this.registeredViews.has(_p))try{this.plugin.app.workspace.getLeavesOfType(_p).length===0?(this.plugin.registerView(_p,r=>new UT(r,this.plugin)),this.registeredViews.add(_p)):this.registeredViews.add(_p)}catch(t){console.error("Error registering account dashboard view:",t)}}async registerTradeLogView(){if(!this.registeredViews.has(Ec))try{this.plugin.app.workspace.getLeavesOfType(Ec).length===0?(this.plugin.registerView(Ec,r=>new JT(r,this.plugin)),this.registeredViews.add(Ec)):this.registeredViews.add(Ec)}catch(t){console.error("Error registering trade log view:",t)}}async registerTradeFormView(){}async openDashboardView(){await this.registerDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(ds);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:ds,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async openAccountDashboardView(){await this.registerAccountDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(_p);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:_p,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async openTradeLogView(){await this.registerTradeLogView();let t=this.plugin.app.workspace.getLeavesOfType(Ec);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:Ec,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async registerAccountPageView(){if(!this.registeredViews.has(Fl))try{this.plugin.app.workspace.getLeavesOfType(Fl).length===0?(this.plugin.registerView(Fl,r=>new Bg(r)),this.registeredViews.add(Fl)):this.registeredViews.add(Fl)}catch(t){console.error("Error registering account page view:",t)}}async openAccountPageView(t){await this.registerAccountPageView();let r=this.plugin.app.workspace.getLeavesOfType(Fl);for(let a of r){let o=a.view;if(o instanceof Bg&&typeof o.getAccountName=="function"&&o.getAccountName()===t){this.plugin.app.workspace.revealLeaf(a);return}}let n=this.plugin.app.workspace.getLeaf("tab");n&&(await n.setViewState({type:Fl,active:!0,state:{accountName:t}}),this.plugin.app.workspace.revealLeaf(n))}async closeAccountPageViews(t){let r=this.plugin.app.workspace.getLeavesOfType(Fl);for(let n of r){let a=n.view;a instanceof Bg&&typeof a.getAccountName=="function"&&a.getAccountName()===t&&n.detach()}}async navigateToAccountDashboard(){await this.openAccountDashboardView()}async openTradeFormView(t){new Jn({app:this.plugin.app,plugin:this.plugin,isEditMode:!1,initialData:t||{},filePath:""}).open()}async openTradeFormInEditMode(t,r){new Jn({app:this.plugin.app,plugin:this.plugin,isEditMode:!0,initialData:t||{},filePath:r||""}).open()}isViewRegistered(t){return this.registeredViews.has(t)}cleanupViews(){try{for(let t of this.registeredViews)this.plugin.app.workspace.getLeavesOfType(t).forEach(r=>{r.detach()});this.registeredViews.clear()}catch(t){console.error("Error cleaning up views:",t)}}};a0();ca();ca();var Lbe=`
  /* Fix for duplicate tooltips */
  .journalit-icon-button,
  .journalit-button,
  .drc-note-grade-dropdown select {
    position: relative !important;
  }
  
  /* Hide Obsidian's native tooltips on our buttons */
  .tooltip[style*="visibility: visible"],
  .another-tooltip[style*="visibility: visible"],
  .is-tooltip[style*="visibility: visible"],
  .tooltip,
  .another-tooltip,
  .is-tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Fix for grade display tooltips */
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown select::before,
  .drc-note-grade-dropdown select::after {
    content: none !important;
    display: none !important;
  }

  /* Hide any tooltips that appear within our custom components */
  .drc-container .tooltip,
  .drc-note-grade-dropdown .tooltip,
  .drc-note-grade-value .tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    z-index: -1 !important;
  }

  /* CRITICAL FIX: Ensure our grade elements display properly with accurate vertical centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    margin: 0 auto !important;
    font-size: 18px !important;
    /* The padding-bottom adjustment is critical for proper vertical centering of text */
    padding: 0 0 4px 0 !important; 
    overflow: visible !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    line-height: 1 !important; /* Critical for proper vertical centering */
    vertical-align: middle !important;
  }

  /* Ensure text is properly centered in all browsers */
  .drc-note-grade-value,
  .drc-note-grade-dropdown select,
  .drc-note-grade-dropdown option {
    text-align: center !important;
    text-align-last: center !important;
  }

  /* No-tooltip button styles - match IconButton */
  .journalit-no-tooltip-button {
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    border-radius: 4px;
    transition: all 0.2s ease;
    color: var(--text-muted);
    width: 30px;
    height: 30px;
    margin: 0 2px;
    box-sizing: content-box;
  }

  /* Style hover state for buttons */
  .journalit-no-tooltip-button:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }

  /* Style active state for buttons */
  .journalit-no-tooltip-button:active {
    background-color: var(--background-modifier-active);
    transform: translateY(1px);
  }

  /* Custom tooltip implementation */
  .journalit-no-tooltip-button {
    position: relative;
  }

  /* Define tooltip using ::before pseudo-element */
  .journalit-no-tooltip-button::before {
    content: attr(data-label);
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    margin-bottom: 0;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    pointer-events: none;
  }

  /* Show tooltip on hover */
  .journalit-no-tooltip-button:hover::before {
    opacity: 1;
    visibility: visible;
    bottom: 100%;
    margin-bottom: 4px;
  }

  /* Fix for SVG within buttons */
  .journalit-no-tooltip-button svg {
    width: 18px;
    height: 18px;
    pointer-events: none;
    fill: none;
  }

  /* Style the debug outline */
  .journalit-no-tooltip-button.debug {
    outline: 1px solid red;
  }

  .journalit-no-tooltip-button:hover.debug {
    outline: 2px solid green;
  }
`;function Mbe(){let e=document.createElement("style");e.id="tooltip-fix-styles",e.textContent=Lbe,document.head.appendChild(e)}function Obe(){let e=document.head.querySelector("#tooltip-fix-styles");e&&e.remove()}re.tooltip={inject:Mbe,remove:Obe};ca();kv();re.shared={inject:Lw,remove:tE};ca();aE();re.combobox={inject:rE,remove:S$};ca();wv();re.chart={inject:Nw,remove:QD};ca();Sv();re.image={inject:Du,remove:x$};ca();gv();re.weeklyReview={inject:UD,remove:s$};Ew();ca();OE();re.tradeForm={inject:Yw,remove:Kw};ca();JD();re.dashboard={inject:Am,remove:h$};ca();var Fbe=`
/* Account Note Styles */
.journalit-account-note {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: var(--font-text);
  color: var(--text-normal);
}

/* Account Balance Chart Styles */
.journalit-account .account-balance-chart-container {
  margin-bottom: 25px;
  border-radius: 8px;
  padding: 12px 16px;
  /* Removed border to make chart feel less cramped */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .account-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .account-name {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-type {
  font-size: 1rem;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  padding: 4px 8px;
  border-radius: 4px;
}

.journalit-account .account-summary {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 30px;
}

.journalit-account .account-metric {
  flex: 1;
  min-width: 200px;
  padding: 15px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .metric-value {
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-details,
.journalit-account .account-performance {
  margin-bottom: 30px;
}

.journalit-account h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .details-grid,
.journalit-account .metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
}

.journalit-account .detail-item,
.journalit-account .metric-item {
  padding: 10px;
  background-color: var(--background-secondary);
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
}

.journalit-account .detail-label,
.journalit-account .metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .detail-value,
.journalit-account .metric-value {
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--text-normal);
}

/* Cost details styles */
.journalit-account .cost-details {
  margin-top: 5px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

.journalit-account .cost-total {
  font-weight: 500;
}

.journalit-account .cost-months {
  font-style: italic;
  font-size: 0.8rem;
}

/* Profit Target Styles */
.journalit-account .profit-target-item {
  grid-column: 1 / -1; /* Make the profit target item span the full width */
  width: 100%;
  box-sizing: border-box;
  margin: 0;
}

.journalit-account .target-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  font-style: italic;
  margin-left: 5px;
}

.journalit-account .target-progress {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-left: 5px;
}

.journalit-account .profit-target-progress {
  margin-top: 10px;
}

.journalit-account .progress-container {
  width: 100%;
  height: 10px;
  background-color: var(--background-modifier-border);
  border-radius: 5px;
  overflow: hidden;
}

.journalit-account .progress-bar {
  height: 100%;
  background-color: var(--interactive-accent);
  border-radius: 5px;
  transition: width 0.5s ease;
}

.journalit-account .progress-bar.complete {
  background-color: gold; /* Gold color when target is reached */
}

/* Transaction Table Styles */
.journalit-account .account-transactions {
  margin-top: 20px;
}

.journalit-account .transactions-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.9rem;
}

.journalit-account .transactions-table thead {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table th {
  text-align: left;
  padding: 10px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 2px solid var(--background-modifier-border);
}

.journalit-account .transactions-table td {
  padding: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .transactions-table .transaction-row:hover {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table .positive {
  color: var(--interactive-success);
}

.journalit-account .transactions-table .negative {
  color: var(--text-error);
}

.journalit-account .transactions-table .deposit {
  background-color: rgba(var(--interactive-success-rgb), 0.05);
}

.journalit-account .transactions-table .withdrawal {
  background-color: rgba(var(--text-error-rgb), 0.05);
}

.journalit-account .empty-transactions {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  border-radius: 4px;
}

/* Account Dashboard View Styles */
.journalit-account-dashboard-container {
  padding: 20px;
  height: 100%;
  overflow-y: auto;
  background-color: var(--background-primary);
}

.journalit-account-dashboard {
  width: 100%;
  padding: 20px;
}

.journalit-account-dashboard .dashboard-content {
  display: flex;
  flex-direction: column;
  width: 100%;
}

/* AUM Chart Styles */
.journalit-account-dashboard .aum-chart {
  width: 100%;
  margin-bottom: 10px;
}

/* Dashboard Header Styles */
.journalit-account-dashboard .dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 20px;
  padding: 16px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.journalit-account-dashboard .dashboard-title h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .dashboard-title p {
  margin: 0;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.journalit-account-dashboard .dashboard-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.journalit-account-dashboard .create-account-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-button:hover {
  background-color: var(--interactive-accent-hover);
  border-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .settings-button {
  flex-shrink: 0;
  background-color: transparent;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.journalit-account-dashboard .settings-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

/* Account Dashboard Settings Modal Styles */
.account-dashboard-settings-modal-container {
  max-width: 700px;
  margin: 0 auto;
  padding: 0 12px;
}

.account-dashboard-settings-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.account-dashboard-settings-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.account-dashboard-settings-form .setting-item:last-child {
  border-bottom: 1px solid var(--background-modifier-border);
}

.account-dashboard-settings-form .setting-item-info {
  width: 100%;
}

.account-dashboard-settings-form .setting-item-name {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 3px;
}

.account-dashboard-settings-form .setting-item-description {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
  margin-bottom: 4px;
}

.account-dashboard-settings-form .setting-item-control {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types > div {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-start;
  align-items: flex-start;
}

.account-type-badge {
  padding: 6px 12px;
  border-radius: 6px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
  font-size: 13px;
  font-weight: 500;
}

.no-account-types {
  color: var(--text-muted);
  font-style: italic;
  text-align: left;
}

/* Account Types Settings Table */
.account-types-settings-table {
  width: 100%;
}

.account-types-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.account-type-setting-row {
  display: flex;
  align-items: center;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
}

.account-type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  margin-right: 16px;
  min-width: 0;
  text-align: left;
}

.account-type-controls {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-shrink: 0;
  margin-left: auto;
}

.toggle-label {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--text-normal);
  cursor: pointer;
  white-space: nowrap;
}

.toggle-label input[type="checkbox"] {
  margin: 0;
  cursor: pointer;
  transform: scale(0.9);
}

/* Account Type Order Management */
.account-type-order-container {
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
}

.account-type-order-list {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  padding: 8px;
}

.order-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.order-list-item {
  display: flex;
  align-items: center;
  padding: 8px 10px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  transition: background-color 0.15s ease;
}

.order-list-item:hover {
  background-color: var(--background-modifier-hover);
}

.order-list-item .type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  font-size: 13px;
  text-align: left;
  margin-right: 12px;
}

.order-controls {
  display: flex;
  gap: 2px;
  margin-left: auto;
  flex-shrink: 0;
}

.order-button {
  background-color: transparent;
  border: 1px solid var(--background-modifier-border);
  color: var(--text-muted);
  border-radius: 3px;
  padding: 4px 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  transition: all 0.15s ease;
  min-width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.order-button:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

.order-button:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.settings-modal-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
}

.settings-modal-buttons .save-settings-button {
  min-width: 90px;
  padding: 8px 16px;
}

.settings-modal-buttons .cancel-button {
  min-width: 60px;
  padding: 8px 12px;
}

/* Mobile responsiveness */
@media (max-width: 600px) {
  .account-dashboard-settings-modal-container {
    padding: 0 8px;
  }
  
  .account-dashboard-settings-form .setting-item {
    padding: 12px;
  }
  
  .account-type-setting-row {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
    padding: 10px;
  }
  
  .account-type-name {
    margin-right: 0;
    margin-bottom: 4px;
  }
  
  .account-type-controls {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .toggle-label {
    justify-content: flex-start;
  }
  
  .settings-modal-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .settings-modal-buttons .save-settings-button,
  .settings-modal-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

.journalit-account-dashboard .create-account-primary-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 12px 24px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-primary-button:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .empty-state-with-action {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  padding: 40px 20px;
}

.journalit-account-dashboard .empty-state-actions {
  display: flex;
  justify-content: center;
}

/* Dashboard placeholder styles */
.journalit-account-dashboard-placeholder {
  text-align: center;
  padding: 40px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  margin-top: 20px;
}

.journalit-account-dashboard-placeholder h2 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: var(--text-normal);
}

.journalit-account-dashboard-placeholder p {
  font-size: 1rem;
  color: var(--text-muted);
  margin-bottom: 15px;
}

.journalit-account-dashboard-placeholder ul {
  text-align: left;
  max-width: 400px;
  margin: 20px auto;
}

.journalit-account-dashboard-placeholder li {
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* New Account Dashboard Styles */

/* Dashboard Metrics Styles */
.journalit-account-dashboard .dashboard-metrics {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  gap: 10px;
  margin-bottom: 30px;
  margin-top: 10px;
  padding: 0 10px;
  overflow-x: auto;
}

.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Sections Styles */
.journalit-account-dashboard .account-sections {
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 0 10px;
}

.journalit-account-dashboard .account-section {
  background-color: var(--background-primary);
  border-radius: 8px;
  padding: 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .account-section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
}

/* Account Section Content - for empty state and virtualized list */
.journalit-account-dashboard .account-section-content {
  padding: 0 0 20px 0;
}

.journalit-account-dashboard .account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 20px;
  padding: 0 0 20px 0;
}

/* Modern Account Card Styles */
.journalit-account-dashboard .account-card {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 0;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%; /* Ensure all cards have consistent height */
}

.journalit-account-dashboard .account-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
  border-color: var(--interactive-accent-hover);
}

/* Header Section */
.journalit-account-dashboard .account-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 20px 20px 16px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
}

.journalit-account-dashboard .account-identity {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.journalit-account-dashboard .account-name {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  line-height: 1.2;
  margin: 0;
}

.journalit-account-dashboard .account-type-badge {
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--background-modifier-form-field);
  padding: 4px 8px;
  border-radius: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  width: fit-content;
}

.journalit-account-dashboard .account-balance {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}

.journalit-account-dashboard .balance-amount {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text-normal);
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth {
  font-size: 0.8rem;
  font-weight: 500;
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .balance-growth.negative {
  color: var(--text-error);
}

/* Body Section */
.journalit-account-dashboard .account-card-body {
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  flex: 1; /* Allow body to grow and push footer to bottom */
}

/* Overall Dashboard Metrics - Original styles restored */
.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Card Key Metrics - Specific styles */
.journalit-account-dashboard .account-card .key-metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item {
  flex: none;
  min-width: 0;
  max-width: none;
  padding: 10px 6px;
  background: var(--background-modifier-form-field);
  transition: none;
  overflow: hidden;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: var(--background-modifier-form-field);
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 4px;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  line-height: 1.2;
  white-space: nowrap;
}

/* Progress Section */
.journalit-account-dashboard .progress-section {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.journalit-account-dashboard .progress-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 44px; /* Consistent height for all progress items */
}

.journalit-account-dashboard .progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 20px; /* Fixed height for consistent alignment */
}

.journalit-account-dashboard .progress-label {
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
}

/* Progress Label with Badge Container */
.journalit-account-dashboard .progress-label-with-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

/* Dashboard Status Badges (matching AccountPage badges) */
.journalit-account-dashboard .dashboard-status-badge {
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 8px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  border: 1px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.journalit-account-dashboard .dashboard-status-badge.in-progress {
  border-color: #f59e0b;
  color: #f59e0b;
  background: rgba(245, 158, 11, 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.journalit-account-dashboard .progress-value {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .progress-value.not-set {
  color: var(--text-muted);
  font-style: italic;
  font-weight: 500;
}

/* Mute appearance for items without targets set */
.journalit-account-dashboard .progress-item.not-set {
  opacity: 0.7;
}

.journalit-account-dashboard .progress-bar-container {
  width: 100%;
  height: 8px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  margin-top: 8px; /* Consistent spacing */
}

.journalit-account-dashboard .progress-bar {
  height: 100%;
  border-radius: 4px;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: absolute;
  left: 0;
  top: 0;
  min-width: 0;
}

/* Progress bar colors */
.journalit-account-dashboard .progress-bar.profit-target {
  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.journalit-account-dashboard .progress-bar.profit-target.complete {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.safe {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.warning {
  background: linear-gradient(90deg, #eab308 0%, #ca8a04 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.critical {
  background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
}

/* Empty progress bar styling for consistency */
.journalit-account-dashboard .progress-bar.empty {
  background: transparent !important;
  width: 0% !important;
}

/* Hide progress bars when width is effectively 0 to prevent border-radius artifacts */
.journalit-account-dashboard .progress-bar[style*="width: 0%"] {
  display: none;
}

/* Footer */
.journalit-account-dashboard .account-card-footer {
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 24px; /* Consistent footer height */
  gap: 12px;
}

.journalit-account-dashboard .footer-metric {
  display: flex;
  align-items: center;
  gap: 6px;
  min-width: 0; /* Allow shrinking */
}

.journalit-account-dashboard .footer-metric:first-child {
  flex: 1; /* Monthly cost takes remaining space */
}

.journalit-account-dashboard .footer-metric:last-child {
  flex: 0 0 auto; /* Total costs stays fixed size on the right */
  justify-content: flex-end;
}

.journalit-account-dashboard .footer-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 500;
  white-space: nowrap;
}

.journalit-account-dashboard .footer-value {
  font-size: 0.75rem;
  color: var(--text-normal);
  font-weight: 600;
  white-space: nowrap;
}

/* Loading and Error States */
.journalit-account-dashboard.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 1.2rem;
  color: var(--text-muted);
}

.journalit-account-dashboard.error {
  padding: 20px;
  color: var(--text-error);
  background-color: rgba(var(--text-error-rgb), 0.05);
  border-left: 3px solid var(--text-error);
  margin: 20px;
  border-radius: 0 4px 4px 0;
}

.journalit-account-dashboard .loading-spinner {
  padding: 20px;
  text-align: center;
}

.journalit-account-dashboard .error-message {
  padding: 20px;
  font-weight: 500;
}

/* Enhanced Account Type Header Styles - Sleek Horizontal Layout */
.journalit-account-dashboard {
  /* Custom properties for easier overrides */
  --account-type-header-gap: 20px;
  --account-type-metrics-gap: 20px;
  --account-type-metrics-justify: flex-end;
  --account-type-metric-max-width: 120px;
}

.journalit-account-dashboard .account-type-header {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: var(--account-type-header-gap, 20px);
  padding: 12px 10px;
  margin: 20px 0 16px 0;
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  position: relative;
  overflow: hidden;
}

/* Account Type Name Section - Enhanced Prominence */
.journalit-account-dashboard .account-type-header .account-type-name {
  /* Prevent inheritance from the generic .account-type-name { flex: 1 } rule */
  flex: 0 0 auto;
  margin-right: 0; /* rely on container gap for spacing */
  min-width: auto;
}

.journalit-account-dashboard .account-type-header .account-type-name h3 {
  margin: 0;
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-normal);
  border: none;
  padding: 0;
  line-height: 1.2;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Metrics Container - Enhanced Responsiveness */
.journalit-account-dashboard .account-type-header .account-type-metrics {
  display: flex;
  align-items: center;
  gap: var(--account-type-metrics-gap, 20px);
  flex: 1;
  justify-content: var(--account-type-metrics-justify, flex-end);
  flex-wrap: wrap;
  min-width: 0; /* Allow container to shrink */
  margin-left: auto; /* Push metrics block to the right edge */
}

/* Individual Metric Items - Enhanced Flexibility */
.journalit-account-dashboard .account-type-header .metric-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  min-width: 0;
  flex-shrink: 1;
  flex-basis: auto;
  padding: 0;
  background: none;
  border-radius: 0;
  transition: none;
  text-align: center;
  max-width: var(--account-type-metric-max-width, 120px); /* Prevent items from getting too wide */
}

.journalit-account-dashboard .account-type-header .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: none;
}

/* Metric Values - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Weight percent gets special emphasis */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.weight-percent {
  font-size: 1rem;
  font-weight: 700;
  color: var(--interactive-accent);
}

/* Excluded status styling */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.excluded-status {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-muted);
  font-style: italic;
}

/* Growth color coding */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .account-type-header .metric-item .metric-value.negative {
  color: var(--text-error);
}

/* Metric Labels - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Align responsiveness with AccountCard single-column behavior (~370px) */
@media (max-width: 400px) {
  .journalit-account-dashboard .account-type-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    padding: 16px 10px;
  }
  
  .journalit-account-dashboard .account-type-header .account-type-name {
    margin-right: 0;
    text-align: center;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    justify-content: center;
    gap: 16px;
  }
}

/* Grid layout for better metric organization */
@media (max-width: 350px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px 20px;
    justify-content: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.9rem;
    white-space: normal; /* Allow text wrapping */
    word-break: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.7rem;
    white-space: normal;
    word-break: break-word;
  }
}

/* More compact layout for smaller screens */
@media (max-width: 300px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px 16px;
    text-align: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item {
    align-items: center;
    min-width: 0; /* Prevent overflow */
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.8rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.65rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
    line-height: 1.1;
  }
}

/* Extra small devices - hide less critical metrics */
@media (max-width: 480px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    gap: 10px 12px;
  }
  
  /* Hide withdrawals and trade count on very small screens to prioritize key metrics */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(3), /* Withdrawals */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(5) { /* Total Trades */
    display: none;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.75rem;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.6rem;
  }
}
`;function Z9(){let e="journalit-account-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Fbe,document.head.appendChild(t)}function e7(){let e=document.getElementById("journalit-account-styles");e&&e.remove()}var jbe=`
.transaction-modal-container {
  width: 100%;
  padding: 0;
}

.transaction-modal {
  padding: 16px;
  font-family: var(--font-text);
  color: var(--text-normal);
}

.transaction-modal h3 {
  margin-top: 0;
  margin-bottom: 16px;
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 8px;
}

.transaction-modal-error {
  margin-bottom: 16px;
  padding: 8px 12px;
  background-color: rgba(var(--text-error-rgb), 0.1);
  border-left: 3px solid var(--text-error);
  color: var(--text-error);
  border-radius: 0 4px 4px 0;
}

.transaction-modal-field {
  margin-bottom: 16px;
}

.transaction-modal-field label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  font-size: 0.9rem;
  color: var(--text-normal);
}

.transaction-modal-field input,
.transaction-modal-field select {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 0.9rem;
  text-overflow: ellipsis;
  min-height: 36px; /* Ensure consistent height */
  max-width: 100%; /* Prevent overflow */
}

.transaction-modal-field input:focus,
.transaction-modal-field select:focus {
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  outline: none;
}

/* Specific styling for transaction type dropdown */
.transaction-type-selector {
  width: 100%;
  padding: 8px 10px;
  height: auto; /* Allow height to adjust to content */
  min-height: 36px;
  text-overflow: ellipsis;
  white-space: normal; /* Allow text to wrap if needed */
  overflow: visible; /* Show overflow content */
  -webkit-appearance: menulist; /* Ensures proper dropdown appearance */
  appearance: menulist;
  display: block; /* Prevent text cutoff */
  line-height: 1.5; /* Improve text rendering */
}

/* Style for dropdown options to ensure they display properly */
.transaction-type-selector option {
  white-space: normal; /* Allow option text to wrap */
  padding: 8px;
  text-overflow: ellipsis;
}

.transaction-modal-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 24px;
}

/* Styling for account transaction button */
.account-transactions-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.account-transactions-header h3 {
  margin: 0;
}

.add-transaction-button {
  padding: 4px 8px;
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.add-transaction-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Styling for transaction rows to indicate they're clickable */
.journalit-account .transactions-table .deposit,
.journalit-account .transactions-table .withdrawal {
  cursor: pointer;
}

.journalit-account .transactions-table .deposit:hover,
.journalit-account .transactions-table .withdrawal:hover {
  background-color: var(--background-secondary-alt);
}
`;function t7(){let e="journalit-transaction-modal-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=jbe,document.head.appendChild(t)}function r7(){let e=document.getElementById("journalit-transaction-modal-styles");e&&e.remove()}KE();sE();re.account={inject:Z9,remove:e7};re.transactionModal={inject:t7,remove:r7};re.accountLinkModal={inject:GE,remove:YE};re.accountWeightBar={inject:oE,remove:k$};ca();var zbe=`
/* Trade Log View Container 
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-trade-log-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-trade-log-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Main Container */
.journalit-trade-log {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Header */
.trade-log-header {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
}

.trade-log-controls {
  display: flex;
  gap: 16px;
  align-items: center;
  margin-bottom: 12px;
}

.view-level-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}

.view-level-selector label {
  font-weight: 500;
  color: var(--text-muted);
}

.date-range-selector {
  flex: 1;
  display: flex;
  justify-content: flex-end;
}

/* Filter Placeholder */
.trade-log-filter-placeholder {
  padding: 12px;
  background: var(--background-primary-alt);
  border-radius: 4px;
  border: 1px dashed var(--background-modifier-border);
}

.filter-placeholder-content {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--text-muted);
  font-size: 14px;
}

.filter-icon {
  font-size: 16px;
}

/* Content Area */
.trade-log-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 0 40px 0;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}

/* Ensure proper scrolling in trades view */
.trade-log-content.trades-view {
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
  height: 100%; /* Force container to constrain children height */
  max-height: 100%; /* AnuPpuccin theme compatibility */
  overflow: visible; /* Remove outer scroll bar - let inner tree handle scrolling like days view */
}

/* Use native scrollbar for better performance */
.trade-log-content::-webkit-scrollbar {
  width: 8px;
}

.trade-log-content::-webkit-scrollbar-thumb {
  background: var(--background-modifier-border);
  border-radius: 4px;
}

/* Loading State */
.trade-log-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
}

.spinner {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.spinner::before {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid var(--text-muted);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Tree View */
.trade-log-tree {
  width: 100%;
  padding: 8px 0;
  flex: 1 0 auto; /* Allow tree to grow but not shrink */
  contain: layout; /* Improve rendering performance */
  min-height: 0; /* Critical for flexbox scrolling */
  /* Force proper overflow behavior in all browsers */
  overflow: visible;
}

/* Tree container for virtualized list */
.trade-log-tree-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Empty state for when no data is available */
.trade-log-tree--empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
  font-style: italic;
}

/* Node Styles */
.trade-log-node {
  display: flex;
  align-items: stretch;
  min-height: 48px;
  position: relative;
  /* Fade in animation for lazy-loaded nodes */
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.trade-log-node:hover {
  background-color: var(--background-modifier-hover);
}

/* Placeholder styles for lazy loading */
.trade-log-node-placeholder {
  display: flex;
  align-items: center;
  position: relative;
  opacity: 0.3;
}

/* Tree Structure Visualization */
.tree-structure {
  display: flex;
  align-items: stretch;
  position: relative;
}

.tree-level {
  width: 24px;
  position: relative;
}

.tree-level::before {
  content: '';
  position: absolute;
  left: 11px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: var(--background-modifier-border);
}

/* Special case for last child - clip the vertical line */
.trade-log-node.is-last-child .tree-level.last-level::before {
  height: 24px;
}

/* Hide expand/collapse lines for leaf nodes */
.trade-log-node--trade .tree-expand-wrapper {
  height: auto;
  width: 12px;
  margin-right: 0;
}

/* Node wrapper */
.node-wrapper {
  flex: 1;
  display: flex;
  align-items: center;
  position: relative;
}

/* Trade node specific wrapper adjustment */
.trade-log-node--trade .node-wrapper {
  padding-left: 0;
}

/* Tree node indicator for trade items */
.tree-node-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  position: relative;
  margin-right: 8px;
}

/* Tree connector line */
.tree-connector {
  position: absolute;
  left: -13px;
  top: 50%;
  width: 12px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-connector--trade {
  top: 0;
}

/* Expand/collapse wrapper */
.tree-expand-wrapper {
  width: 20px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-right: 4px;
}

/* Tree leaf node (no children) */
.tree-leaf-node {
  width: 2px;
  height: 2px;
  background: var(--text-muted);
  border-radius: 50%;
  position: relative;
}

.tree-leaf-node::before {
  content: '';
  position: absolute;
  left: -5px;
  top: 50%;
  width: 5px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-leaf-node--trade {
  background: var(--text-normal);
  margin-right: 0;
}

/* When in the tree indicator cell, adjust positioning */
.tree-indicator-cell .tree-leaf-node {
  margin-left: 7px;
}

.tree-indicator-cell .tree-connector {
  left: -6px;
  width: 6px;
  transform: translateY(-50%);
}


.node-content {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 8px;
  padding-right: 16px;
}

/* Chevron Button */
.node-chevron {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  padding: 0;
  border: none;
  background: none;
  color: var(--text-muted);
  cursor: pointer;
  position: relative;
}

.node-chevron:hover {
  color: var(--text-normal);
}

.node-chevron svg {
  width: 14px;
  height: 14px;
}

/* Node Label */
.node-label {
  flex: 0 0 auto;
  font-weight: 500;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.node-label:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-accent);
}

/* Node type-specific styles */
.trade-log-node--year .node-label {
  font-size: 16px;
  font-weight: 600;
}

.trade-log-node--quarter .node-label,
.trade-log-node--month .node-label {
  font-size: 15px;
}

.trade-log-node--week .node-label,
.trade-log-node--day .node-label {
  font-size: 14px;
}

/* Metrics */
.node-metrics {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-left: auto;
  padding-right: 16px;
}

.metric {
  font-size: 13px;
  white-space: nowrap;
}

.metric--count {
  color: var(--text-muted);
}

.metric--winrate {
  font-weight: 500;
}

.metric--winrate.high {
  color: rgb(76, 175, 80);
}

.metric--winrate.medium {
  color: rgb(255, 193, 7);
}

.metric--winrate.low {
  color: rgb(244, 67, 54);
}

.metric--pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
}

.metric--pnl.positive {
  color: rgb(76, 175, 80);
}

.metric--pnl.negative {
  color: rgb(244, 67, 54);
}

.metric--pnl.neutral {
  color: rgb(128, 128, 128);
}

/* Performance Indicators */
.performance-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 8px;
  vertical-align: middle;
}

.performance-indicator svg {
  width: 16px;
  height: 16px;
  vertical-align: text-bottom;
}

.performance-indicator--best {
  color: #FFD700; /* Gold color for crown */
}

.performance-indicator--worst {
  color: rgb(244, 67, 54); /* Red color for alert */
}

/* Make indicators more prominent on hover */
.node-label:hover .performance-indicator--best {
  color: #FFA500; /* Orange on hover */
}

.node-label:hover .performance-indicator--worst {
  color: rgb(255, 100, 100); /* Lighter red on hover */
}

/* Column Headers */
.trade-log-headers {
  position: sticky;
  top: 0;
  background: var(--background-secondary);
  border-bottom: 2px solid var(--background-modifier-border);
  z-index: 10;
  padding: 0 8px;
  flex-shrink: 0; /* Prevent headers from shrinking */
}

.trade-log-header-row {
  display: grid;
  grid-template-columns: 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 8px;
  align-items: center;
  padding: 12px 16px 12px 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
}

.header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.header-image {
  text-align: center;
}

.header-ticker {
  text-align: center;
}

.header-direction {
  text-align: center;
}

.header-duration {
  text-align: center;
}

.header-status {
  text-align: center;
}

.header-pnl {
  text-align: center;
}

.header-date {
  text-align: center;
}

.header-account {
  text-align: center;
}

.header-mistakes {
  text-align: center;
}

.header-setups {
  text-align: center;
}

/* Trade Details Row */
.trade-details-row {
  display: grid;
  grid-template-columns: 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 8px;
  align-items: center;
  flex: 1;
  padding: 0 16px 0 8px;
}

/* Tree view trade details row */
.trade-details-row.tree-view-row {
  grid-template-columns: 20px 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 6px;
  padding: 0 16px 0 0;
}

/* Tree indicator cell */
.tree-indicator-cell {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  position: relative;
  width: 20px;
}

/* Trades view mode specific styles */
.trade-log-content.trades-view .trade-log-node--trade {
  padding: 0;
}

.trade-log-content.trades-view .trade-details-row.trades-view-row {
  padding: 0 16px;
  width: 100%;
}

/* Make trade rows clickable */
.trade-log-node--trade {
  cursor: pointer;
}

.trade-log-node--trade:hover {
  background-color: var(--background-modifier-hover);
}

/* Trade cells */
.trade-image-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image-wrapper {
  position: relative;
  cursor: pointer;
  /* Remove transition for better scroll performance */
  /* transition: transform 0.15s ease; */
}

.trade-image-wrapper:hover {
  /* Simpler hover effect without transform */
  opacity: 0.8;
}

.trade-preview-thumbnail {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
  /* Prevent layout shift while images load */
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  /* Optimize image rendering */
  image-rendering: -webkit-optimize-contrast;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.trade-image-count {
  position: absolute;
  bottom: -4px;
  right: -4px;
  background: var(--background-primary);
  color: var(--text-muted);
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 3px;
  border: 1px solid var(--background-modifier-border);
  font-weight: 600;
}

.trade-no-image-icon {
  color: var(--text-faint);
}

.trade-ticker-cell {
  text-align: center;
}

.trade-ticker {
  font-weight: 600;
  color: var(--text-normal);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.trade-direction-cell {
  text-align: center;
}

.trade-direction {
  font-size: 13px;
  font-weight: 500;
  text-transform: uppercase;
  color: var(--text-normal);
}

/* Trade Status */
.trade-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.status-win {
  background: rgba(76, 175, 80, 0.15);
  color: rgb(76, 175, 80);
}

.status-loss {
  background: rgba(244, 67, 54, 0.15);
  color: rgb(244, 67, 54);
}

.status-breakeven {
  background: rgba(128, 128, 128, 0.15);
  color: rgb(128, 128, 128);
}

.status-missed {
  background: rgba(255, 149, 0, 0.15);
  color: rgb(255, 149, 0);
}

.status-open {
  background: rgba(33, 150, 243, 0.15);
  color: rgb(33, 150, 243);
}

.trade-pnl-cell {
  text-align: center;
}

.trade-pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
  font-size: 15px;
}

.trade-pnl.positive {
  color: rgb(76, 175, 80);
}

.trade-pnl.negative {
  color: rgb(244, 67, 54);
}

.trade-pnl.neutral {
  color: rgb(128, 128, 128);
}

.trade-pnl.open {
  color: rgb(33, 150, 243);
  font-style: italic;
}

.trade-status-cell {
  text-align: center;
}

.trade-duration-cell {
  text-align: center;
}

.trade-duration {
  color: var(--text-muted);
  font-size: 13px;
}

.trade-date-cell {
  text-align: center;
}

.trade-date {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mistakes-cell,
.trade-setups-cell,
.trade-account-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-thesis {
  font-size: 13px;
  color: var(--text-normal);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  cursor: help;
}

.trade-no-data {
  color: var(--text-faint);
  font-size: 13px;
}

/* Count Badges */
.count-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: 12px;
  font-weight: 600;
  cursor: help;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
}

.count-badge--mistakes {
  background: rgba(244, 67, 54, 0.15);
  color: rgb(244, 67, 54);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.count-badge--mistakes:hover {
  background: rgba(244, 67, 54, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--setups {
  background: rgba(33, 150, 243, 0.15);
  color: rgb(33, 150, 243);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.count-badge--setups:hover {
  background: rgba(33, 150, 243, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--accounts {
  background: rgba(156, 39, 176, 0.15);
  color: rgb(156, 39, 176);
  border: 1px solid rgba(156, 39, 176, 0.3);
}

.count-badge--accounts:hover {
  background: rgba(156, 39, 176, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

/* Tooltip Styles */
.tooltip-trigger {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.journalit-tooltip {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  max-width: 250px;
  min-width: 120px;
  font-size: 13px;
  color: var(--text-normal);
  z-index: 9999;
  pointer-events: none;
  position: fixed !important;
}

.tooltip-title {
  font-weight: 600;
  margin-bottom: 4px;
  color: var(--text-normal);
}

.tooltip-item {
  color: var(--text-muted);
  margin: 2px 0;
  line-height: 1.4;
  white-space: nowrap;
}

.mistakes-tooltip .tooltip-title {
  color: rgb(244, 67, 54);
}

.setups-tooltip .tooltip-title {
  color: rgb(33, 150, 243);
}

.accounts-tooltip .tooltip-title {
  color: rgb(156, 39, 176);
}

.thesis-tooltip .tooltip-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  color: var(--text-normal);
}

/* Responsive Design */
@media (max-width: 1200px) {
  .trade-details-row,
  .trade-log-header-row {
    grid-template-columns: 50px 100px 60px 60px 80px 60px 60px 60px 50px 50px 1fr;
  }
  
  .trade-details-row.tree-view-row {
    grid-template-columns: 20px 50px 100px 60px 60px 80px 60px 60px 60px 50px 50px 1fr;
  }
  
  .metric--best,
  .metric--worst {
    display: none;
  }
  
  .trade-pnl {
    font-size: 14px;
  }
}

@media (max-width: 900px) {
  .trade-details-row,
  .trade-log-header-row {
    grid-template-columns: 50px 80px 60px 60px 80px 60px 60px 1fr;
  }
  
  .trade-account-cell,
  .header-account,
  .trade-mistakes-cell,
  .trade-setups-cell,
  .header-mistakes,
  .header-setups {
    display: none;
  }
  
  .trade-pnl {
    font-size: 13px;
  }
}

@media (max-width: 600px) {
  .trade-pnl {
    font-size: 12px;
  }
}

`;function n7(){let e=document.createElement("style");e.id="trade-log-styles",e.textContent=zbe,document.head.appendChild(e)}function a7(){let e=document.head.querySelector("#trade-log-styles");e&&e.remove()}re.tradeLog={inject:n7,remove:a7};Zt();PE();window&&(document.querySelectorAll("script").forEach(t=>{let r=t.textContent||"";(r.includes("DROPDOWN_FIX")||r.includes("COMBOBOX")||r.includes("TRADEFORM"))&&t.remove()}),window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1);var Vg=class Vg extends ln.Plugin{constructor(){super(...arguments);this.backendIntegrationService=null;this.tradeNoteProcessor=null;this.drcNoteProcessor=null;this.weeklyReviewProcessor=null}async onload(){let r=Date.now();window.__obsidianStartTime=r,window.journalitPlugin=this,window.JournalitPlugin=Vg,Vg.instance=this,await this.loadSettings(),this.lastFileOpenTime=Date.now(),Ps(!1,!1,!0,!0),$R(),this.serviceManager=wd.getInstance(this.app,this),this.processorManager=WC.getInstance(this.app,this),this.viewManager=XT.getInstance(this),WB(this),await Promise.resolve().then(()=>{this.serviceManager.initializeCoreServices(),this.authManager=this.serviceManager.getAuthManager(),this.tradeService=this.serviceManager.getTradeService(),this.customFieldsService=this.serviceManager.getCustomFieldsService()}),await Promise.resolve().then(()=>{this.addSettingTab(new zw(this.app,this))}),this.registerEvent(this.app.workspace.on("file-open",n=>{this.lastFileOpenTime=Date.now()})),await Promise.resolve().then(()=>{this.registerAuthCommands()}),await Promise.resolve().then(()=>{this.viewManager.registerDashboardView()}),setTimeout(()=>{this.viewManager.registerAccountDashboardView()},20),setTimeout(()=>{this.viewManager.registerTradeLogView()},30),setTimeout(()=>{this.viewManager.registerAccountPageView()},40),this.app.workspace.onLayoutReady(()=>{this.initializeNonCriticalComponents()})}async initializeNonCriticalComponents(){var n,a;let r=Date.now();try{RR();try{this.serviceManager.preInitializeServices(["onboardingService"]),(n=window.requestIdleCallback)==null||n.call(window,()=>{this.checkAndShowOnboarding()}),(a=window.requestIdleCallback)==null||a.call(window,()=>{Promise.resolve().then(()=>(t1(),e1)).then(()=>console.log("[Journalit] Pre-loaded OnboardingWizardModalWrapper")).catch(()=>{})})}catch(o){console.warn("[Journalit] Failed to warm-up onboarding modules:",o)}await Bv([()=>{this.registerRemainingCommands(),this.addRibbonIcons()},async()=>{await this.processorManager.initializeRequiredProcessors(),this.processorManager.registerProcessor("missed-trade",new qm(this.app,this)),this.processorManager.registerRenderer("missed-trade",new Um(this.app));let o=this.processorManager.getAllInitializedProcessors();this.tradeNoteProcessor=o.tradeNoteProcessor,this.drcNoteProcessor=o.drcNoteProcessor,this.weeklyReviewProcessor=o.weeklyReviewProcessor},async()=>{try{this.setupService=await this.serviceManager.getSetupService(),this.drcService=await this.serviceManager.getDRCService()}catch(o){console.error("Error initializing high-priority services:",o)}},async()=>{try{this.weeklyReviewService=await this.serviceManager.getWeeklyReviewService(),this.monthlyReviewService=await this.serviceManager.getMonthlyReviewService(),this.missedTradeService=await this.serviceManager.getMissedTradeService(),this.optionsService=await this.serviceManager.getOptionsService(),rc.getInstance().initialize()}catch(o){console.error("Error initializing secondary services:",o)}},async()=>{try{this.accountPageService=await this.serviceManager.getAccountPageService()}catch(o){console.error("Error initializing background services:",o)}},async()=>{await this.viewManager.registerAllViews()},async()=>{await this.handleInitialFileRendering()},async()=>{var o;try{if((o=this.settings.backendIntegration)!=null&&o.syncEnabled){let i=await this.serviceManager.getBackendIntegrationService();this.backendIntegrationService=i,await i.registerVault()}}catch(i){console.error("Error initializing backend integration:",i)}}],30)}catch(o){console.error("Error during non-critical initialization:",o)}this.initializeDynamicLinkMaintenance()}async handleInitialFileRendering(){let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),a=n==null?void 0:n.frontmatter;if(a&&(a.type==="drc"&&(this.drcNoteProcessor||(this.drcNoteProcessor=await this.processorManager.getDRCNoteProcessor())),a.type==="trade"&&(this.tradeNoteProcessor||(this.tradeNoteProcessor=await this.processorManager.getTradeNoteProcessor())),a.type==="weekly-review")){let o=document.querySelectorAll(`.journalit-weekly-review-view[data-file-path="${r.path}"]`);if(o.length>0&&Array.from(o).some(s=>s.querySelector(".weekly-review-container")))return;this.weeklyReviewProcessor||(this.weeklyReviewProcessor=await this.processorManager.getWeeklyReviewProcessor()),this.weeklyReviewProcessor&&(await this.weeklyReviewProcessor.renderActiveWeeklyReview(),this.weeklyReviewProcessor.registerCurrentLeaves())}}registerAuthCommands(){}registerRemainingCommands(){this.addCommand({id:"journalit-add-trade",name:"Add New Trade",callback:async()=>{new Jn({app:this.app,plugin:this}).open()}}),this.addCommand({id:"journalit-create-drc",name:"Create Daily Report Card",callback:async()=>{try{let n=await(await this.serviceManager.getDRCService()).getTodayDRC();await this.openFile(n,!0)}catch(r){console.error("Failed to create DRC:",r),new ln.Notice("Failed to create Daily Report Card: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-create-weekly-review",name:"Create Weekly Review",callback:async()=>{try{await(await this.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(r){console.error("Failed to create Weekly Review:",r),new ln.Notice("Failed to create Weekly Review: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-create-monthly-review",name:"Create Monthly Review",callback:async()=>{try{let n=await(await this.serviceManager.getMonthlyReviewService()).createMonthlyReview(new Date);n?await this.openFile(n.path,!0):new ln.Notice("Failed to create Monthly Review")}catch(r){console.error("Failed to create Monthly Review:",r),new ln.Notice("Failed to create Monthly Review: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-open-dashboard",name:"Open Trading Dashboard",callback:async()=>{await this.viewManager.openDashboardView()}}),this.addCommand({id:"journalit-open-account-dashboard",name:"Open Account Dashboard",callback:async()=>{await this.openAccountDashboard()}}),this.addCommand({id:"journalit-open-trade-log",name:"Open Trade Log",callback:async()=>{await this.viewManager.openTradeLogView()}}),this.addCommand({id:"journalit-force-sync",name:"Force Sync Trades",callback:async()=>{try{let n=await(await this.serviceManager.getBackendIntegrationService()).forceSync()}catch(r){console.error("Failed to force sync trades:",r),new ln.Notice("Failed to sync trades: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-cancel-sync",name:"Cancel Trade Sync",callback:async()=>{try{(await this.serviceManager.getBackendIntegrationService()).cancelSync()}catch(r){new ln.Notice("\u274C No sync in progress")}}}),this.addCommand({id:"journalit-replay-onboarding",name:"Replay Onboarding Flow",callback:async()=>{try{let r=await this.serviceManager.getOnboardingService();await r.startOnboarding();let{OnboardingWizardModalWrapper:n}=await Promise.resolve().then(()=>(t1(),e1));new n(this.app,this,async()=>{},async()=>{await r.skipOnboarding()},void 0,void 0,r).open()}catch(r){console.error("Failed to launch onboarding flow:",r),new ln.Notice("Failed to open onboarding flow. Check console for details.")}}}),this.addCommand({id:"journalit-migrate-accounts",name:"Migrate Account Data (AccountService \u2192 AccountPageService)",callback:async()=>{try{let{AccountMigrationModal:r}=await Promise.resolve().then(()=>(S7(),w7));new r(this.app,this).open()}catch(r){console.error("Failed to open account migration modal:",r),new ln.Notice("Failed to open account migration modal: "+(r instanceof Error?r.message:String(r)))}}})}addRibbonIcons(){this.addRibbonIcon("receipt-text","Add Trade",async()=>{new Jn({app:this.app,plugin:this}).open()}),this.addRibbonIcon("calendar-check","Create Daily Report Card",async()=>{try{let n=await(await this.serviceManager.getDRCService()).getTodayDRC();await this.openFile(n,!0)}catch(r){console.error("Failed to create DRC from ribbon:",r),new ln.Notice("Failed to create Daily Report Card: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("calendar-days","Create Weekly Review",async()=>{try{await(await this.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(r){console.error("Failed to create Weekly Review from ribbon:",r),new ln.Notice("Failed to create Weekly Review: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("calendar-range","Open Monthly Review",async()=>{try{let r=await this.serviceManager.getMonthlyReviewService(),n=new Date,a=r.getMonthlyReviewPath(n);if(this.app.vault.getAbstractFileByPath(a))await this.openFile(a,!0);else{let i=await r.createMonthlyReview(n);i&&await this.openFile(i.path,!0)}}catch(r){console.error("Failed to open Monthly Review from ribbon:",r),new ln.Notice("Failed to open Monthly Review: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("grip","Open Trading Dashboard",async()=>{await this.viewManager.openDashboardView()}),this.addRibbonIcon("users","Open Account Dashboard",async()=>{await this.openAccountDashboard()}),this.addRibbonIcon("folder-tree","Open Trade Log",async()=>{await this.viewManager.openTradeLogView()})}onunload(){window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1,window.__JOURNALIT_INJECT_DRC_STYLES=void 0,window.__obsidianStartTime=void 0;try{this.viewManager?this.viewManager.cleanupViews():this.app.workspace.getLeavesOfType(ds).forEach(n=>{n.detach()})}catch(n){console.error("Error detaching view leaves:",n)}try{this.processorManager?this.processorManager.cleanupProcessors():(this.tradeNoteProcessor&&this.tradeNoteProcessor.cleanup(),this.drcNoteProcessor&&this.drcNoteProcessor.cleanup(),this.weeklyReviewProcessor&&this.weeklyReviewProcessor.cleanup())}catch(n){console.error("Error cleaning up processors:",n)}this.tradeNoteProcessor=null,this.drcNoteProcessor=null,this.weeklyReviewProcessor=null;try{rc.getInstance().cleanup()}catch(n){console.error("Error cleaning up GlobalPasteManager:",n)}try{Ps(!1,!1,!1,!1,!1,!1,!1,!1)}catch(n){console.error("Error during style cleanup:",n)}[".journalit-trade-view",".journalit-trade-note-wrapper",".journalit-drc-view",".journalit-drc-note-wrapper",".weekly-review-wrapper",".journalit-weekly-review-view",".weekly-review"].forEach(n=>{try{document.querySelectorAll(n).forEach(o=>{try{n===".weekly-review"&&typeof o.empty=="function"&&o.empty(),o.remove()}catch(i){console.error(`Error removing element ${n}:`,i)}})}catch(a){console.error(`Error processing selector ${n}:`,a)}}),window.journalitPlugin=void 0,window.JournalitPlugin=void 0,Vg.instance=null,this.serviceManager?this.serviceManager.cleanupServices():(this.authManager=null,this.tradeService=null,this.setupService=null,this.drcService=null,this.weeklyReviewService=null,this.monthlyReviewService=null,this.optionsService=null,this.customFieldsService=null,this.backendIntegrationService=null),this.backendIntegrationService=null}async loadSettings(){let r=await this.loadData();this.settings=this.deepMergeSettings(Pa,r||{})}deepMergeSettings(r,n){var o,i,s,l,c,d,u,p;let a={...r};return n&&(n.trade&&(a.trade={...r.trade,...n.trade},a.trade.skipWeekends===void 0&&(a.trade.skipWeekends=!0)),n.drc&&(a.drc={...r.drc,...n.drc,checklistItems:n.drc.checklistItems||r.drc.checklistItems,reviewQuestions:n.drc.reviewQuestions||r.drc.reviewQuestions}),n.customOptions?a.customOptions={...r.customOptions,...n.customOptions}:n.customOptions!==void 0&&(a.customOptions={...r.customOptions,...n.customOptions}),n.customTradeFields&&(a.customTradeFields={...r.customTradeFields,...n.customTradeFields}),n.customFieldOptions&&(a.customFieldOptions={...r.customFieldOptions,...n.customFieldOptions}),n.weekly&&(a.weekly={...r.weekly,...n.weekly,reviewQuestions:n.weekly.reviewQuestions||r.weekly.reviewQuestions}),n.dashboard&&(a.dashboard={...r.dashboard,layouts:{...((o=r.dashboard)==null?void 0:o.layouts)||{},...n.dashboard.layouts||{}},activeLayout:n.dashboard.activeLayout||((i=r.dashboard)==null?void 0:i.activeLayout),defaultFilters:{...((s=r.dashboard)==null?void 0:s.defaultFilters)||{},...n.dashboard.defaultFilters||{}},lastUsedFilters:n.dashboard.lastUsedFilters||((l=r.dashboard)==null?void 0:l.lastUsedFilters)},!a.dashboard.layouts.Default&&((d=(c=r.dashboard)==null?void 0:c.layouts)!=null&&d.Default)&&(a.dashboard.layouts.Default=r.dashboard.layouts.Default),a.dashboard.activeLayout&&!a.dashboard.layouts[a.dashboard.activeLayout]&&(console.warn("Active layout not found in saved layouts, resetting to Default"),a.dashboard.activeLayout="Default")),n.account&&(a.account={...r.account,...n.account,excludedAccountTypes:n.account.excludedAccountTypes||((u=r.account)==null?void 0:u.excludedAccountTypes),includeWithdrawalsFromExcluded:n.account.includeWithdrawalsFromExcluded||((p=r.account)==null?void 0:p.includeWithdrawalsFromExcluded)}),n.backendIntegration&&(a.backendIntegration={...r.backendIntegration,...n.backendIntegration}),n.uiCustomization&&(a.uiCustomization={...r.uiCustomization,...n.uiCustomization}),n.reviews&&(a.reviews={...r.reviews,...n.reviews}),n.general&&(a.general={...r.general,...n.general})),a}async openAccountDashboard(){try{await this.viewManager.openAccountDashboardView()}catch(r){console.error("Error opening account dashboard:",r),new ln.Notice("Failed to open account dashboard: "+(r instanceof Error?r.message:String(r)))}}initializeDynamicLinkMaintenance(){this.registerEvent(this.app.vault.on("create",r=>{r instanceof ln.TFile&&r.extension==="md"&&this.handleFileCreated(r)})),this.registerEvent(this.app.vault.on("rename",(r,n)=>{r instanceof ln.TFile&&r.extension==="md"&&this.handleFileRenamed(r,n)})),this.registerEvent(this.app.vault.on("delete",r=>{r instanceof ln.TFile&&r.extension==="md"&&this.handleFileDeleted(r)}))}async handleFileCreated(r){try{if(await new Promise(a=>setTimeout(a,100)),!this.app.vault.getAbstractFileByPath(r.path))return;let n=await Na.detectNoteType(r,this.app.vault);if(n.type==="trade"&&n.date){let a=await IR(n.date,this),o=await this.app.vault.read(r),i=Na.updateLinksSection(o,a);if(i!==o)try{await this.app.vault.modify(r,i)}catch(s){console.error(`[FileHandler] Failed to modify trade file ${r.basename}:`,s),setTimeout(async()=>{try{let l=await this.app.vault.read(r),c=Na.updateLinksSection(l,a);c!==l&&await this.app.vault.modify(r,c)}catch(l){console.error(`[FileHandler] Final retry failed for trade file ${r.basename}:`,l)}},500)}}else if(n.type==="drc"&&n.date){let a=await Lv(n.date,this),o=await this.app.vault.read(r),i=Na.updateLinksSection(o,a);if(i!==o)try{await this.app.vault.modify(r,i)}catch(s){console.error(`[FileHandler] Failed to modify DRC file ${r.basename}:`,s)}}else if(n.type==="weekly"&&n.date){let a=await NR(n.date,this),o=await this.app.vault.read(r),i=Na.updateLinksSection(o,a);if(i!==o)try{await this.app.vault.modify(r,i)}catch(s){console.error(`[FileHandler] Failed to modify weekly file ${r.basename}:`,s)}}else if(n.type==="monthly"&&n.date){let a=await this.app.vault.read(r),o=Na.removeLinksSection(a);if(o!==a)try{await this.app.vault.modify(r,o)}catch(i){console.error(`[FileHandler] Failed to modify monthly file ${r.basename}:`,i)}}}catch(n){console.error(`[FileHandler] Error handling file creation for ${r.path}:`,n)}}async handleFileRenamed(r,n){try{console.log(`File renamed from ${n} to ${r.path}`)}catch(a){console.error(`Error handling file rename from ${n} to ${r.path}:`,a)}}async handleFileDeleted(r){try{console.log(`File deleted: ${r.path}`)}catch(n){console.error(`Error handling file deletion for ${r.path}:`,n)}}async saveSettings(){try{this.settings.weekly||(this.settings.weekly=Pa.weekly),this.settings.dashboard||(this.settings.dashboard=Pa.dashboard),(!this.settings.dashboard.layouts||Object.keys(this.settings.dashboard.layouts).length===0)&&(this.settings.dashboard.layouts=Pa.dashboard.layouts),this.settings.dashboard.layouts.Default||(this.settings.dashboard.layouts.Default=Pa.dashboard.layouts.Default),(!this.settings.dashboard.activeLayout||!this.settings.dashboard.layouts[this.settings.dashboard.activeLayout])&&(this.settings.dashboard.activeLayout="Default"),this.settings.backendIntegration||(this.settings.backendIntegration=Pa.backendIntegration),await this.saveData(this.settings)}catch(r){console.error("Error saving settings:",r),await this.saveData(this.settings)}}async openTradeFormInEditMode(r,n){try{new Jn({app:this.app,plugin:this,isEditMode:!0,initialData:r||{},filePath:n||""}).open()}catch(a){console.error("Failed to open trade form in edit mode:",a),new ln.Notice("Failed to open trade form in edit mode: "+(a instanceof Error?a.message:String(a)))}}async openFile(r,n=!0){try{let a=this.app.vault.getAbstractFileByPath(r);a instanceof ln.TFile?await(n?this.app.workspace.getLeaf("tab"):this.app.workspace.getLeaf()).openFile(a):console.error(`Could not open file: ${r} - File not found or not a valid file`)}catch(a){console.error(`Error opening file: ${r}`,a)}}async checkAndShowOnboarding(){try{let r=`journalit-onboarding-ever-shown-${this.app.vault.getName()}`;if(localStorage.getItem(r)){console.log("[Journalit] Onboarding has been shown before, skipping automatic display");return}let a=await this.serviceManager.getOnboardingService();if(a.shouldShowOnboarding()){localStorage.setItem(r,"true"),console.log("[Journalit] First-time onboarding triggered"),await a.startOnboarding();let{OnboardingWizardModalWrapper:o}=await Promise.resolve().then(()=>(t1(),e1));new o(this.app,this,async()=>{},async()=>{await a.skipOnboarding()},void 0,void 0,a).open()}}catch(r){console.error("Error checking/showing onboarding:",r)}}};Vg.instance=null;var r1=Vg;
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/shared/src/utils.js:
lucide-react/dist/esm/defaultAttributes.js:
lucide-react/dist/esm/Icon.js:
lucide-react/dist/esm/createLucideIcon.js:
lucide-react/dist/esm/icons/award.js:
lucide-react/dist/esm/icons/check.js:
lucide-react/dist/esm/icons/clipboard-paste.js:
lucide-react/dist/esm/icons/ellipsis.js:
lucide-react/dist/esm/icons/ghost.js:
lucide-react/dist/esm/icons/plus.js:
lucide-react/dist/esm/icons/rotate-ccw.js:
lucide-react/dist/esm/icons/square-pen.js:
lucide-react/dist/esm/icons/trash.js:
lucide-react/dist/esm/icons/triangle-alert.js:
lucide-react/dist/esm/icons/x.js:
lucide-react/dist/esm/lucide-react.js:
  (**
   * @license lucide-react v0.526.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

react-is/cjs/react-is.production.min.js:
  (**
   * @license React
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

use-sync-external-store/cjs/use-sync-external-store-with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
